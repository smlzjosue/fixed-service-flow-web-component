import{a as e,f as t,r,c as a,h as o,H as i,d as n}from"./p-6Be1tPfL.js";const s=(e,t,r)=>{const a=e.get(t);if(!a){e.set(t,[r])}else if(!a.includes(r)){a.push(r)}};const c=(e,t)=>{let r;return(...a)=>{if(r){clearTimeout(r)}r=setTimeout((()=>{r=0;e(...a)}),t)}};const l=e=>!("isConnected"in e)||e.isConnected;const d=c((e=>{for(let t of e.keys()){e.set(t,e.get(t).filter(l))}}),2e3);const p=()=>{if(typeof e!=="function"){return{}}const r=new Map;return{dispose:()=>r.clear(),get:t=>{const a=e();if(a){s(r,t,a)}},set:e=>{const a=r.get(e);if(a){r.set(e,a.filter(t))}d(r)},reset:()=>{r.forEach((e=>e.forEach(t)));d(r)}}};const u=e=>typeof e==="function"?e():e;const h=(e,t=(e,t)=>e!==t)=>{const r=u(e);let a=new Map(Object.entries(r??{}));const o={dispose:[],get:[],set:[],reset:[]};const i=new Map;const n=()=>{a=new Map(Object.entries(u(e)??{}));o.reset.forEach((e=>e()))};const s=()=>{o.dispose.forEach((e=>e()));n()};const c=e=>{o.get.forEach((t=>t(e)));return a.get(e)};const l=(e,r)=>{const i=a.get(e);if(t(r,i,e)){a.set(e,r);o.set.forEach((t=>t(e,r,i)))}};const d=typeof Proxy==="undefined"?{}:new Proxy(r,{get(e,t){return c(t)},ownKeys(e){return Array.from(a.keys())},getOwnPropertyDescriptor(){return{enumerable:true,configurable:true}},has(e,t){return a.has(t)},set(e,t,r){l(t,r);return true}});const p=(e,t)=>{o[e].push(t);return()=>{f(o[e],t)}};const h=(t,r)=>{const a=(e,a)=>{if(e===t){r(a)}};const o=()=>r(u(e)[t]);const n=p("set",a);const s=p("reset",o);i.set(r,{setHandler:a,resetHandler:o,propName:t});return()=>{n();s();i.delete(r)}};const m=(...e)=>{const t=e.reduce(((e,t)=>{if(t.set){e.push(p("set",t.set))}if(t.get){e.push(p("get",t.get))}if(t.reset){e.push(p("reset",t.reset))}if(t.dispose){e.push(p("dispose",t.dispose))}return e}),[]);return()=>t.forEach((e=>e()))};const b=e=>{const t=a.get(e);o.set.forEach((r=>r(e,t,t)))};const g=(e,t)=>{const r=i.get(t);if(r&&r.propName===e){f(o.set,r.setHandler);f(o.reset,r.resetHandler);i.delete(t)}};return{state:d,get:c,set:l,on:p,onChange:h,use:m,dispose:s,reset:n,forceUpdate:b,removeListener:g}};const f=(e,t)=>{const r=e.indexOf(t);if(r>=0){e[r]=e[e.length-1];e.length--}};const m=(e,t)=>{const r=h(e,t);r.use(p());return r};const b={currentStep:1,token:null,correlationId:null,location:null,availablePlans:[],selectedPlan:null,selectedContract:null,formData:null,orderId:null,requestError:null,isLoading:false,error:null};const{state:g,onChange:y,reset:x}=m(b);const _={setToken:(e,t)=>{g.token=e;g.correlationId=t;sessionStorage.setItem("token",e);sessionStorage.setItem("correlationId",t)},getStoredToken:()=>({token:sessionStorage.getItem("token"),correlationId:sessionStorage.getItem("correlationId")}),hasToken:()=>!!g.token||!!sessionStorage.getItem("token"),clearToken:()=>{g.token=null;g.correlationId=null;sessionStorage.removeItem("token");sessionStorage.removeItem("correlationId")},setStep:e=>{g.currentStep=e},nextStep:()=>{if(g.currentStep<5){g.currentStep=g.currentStep+1}},prevStep:()=>{if(g.currentStep>1){g.currentStep=g.currentStep-1}},setLocation:e=>{g.location=e;sessionStorage.setItem("latitud",btoa(String(e.latitude)));sessionStorage.setItem("longitud",btoa(String(e.longitude)));sessionStorage.setItem("planCodeInternet",btoa(e.serviceType))},setAvailablePlans:e=>{g.availablePlans=e},selectPlan:e=>{g.selectedPlan=e;sessionStorage.setItem("planId",String(e.planId));sessionStorage.setItem("planPrice",String(e.decPrice));sessionStorage.setItem("plan",JSON.stringify(e))},setContract:e=>{g.selectedContract=e;sessionStorage.setItem("typeContractId",String(e.typeId));sessionStorage.setItem("contractInstallment",String(e.deadlines));sessionStorage.setItem("contractInstallation",String(e.installation));sessionStorage.setItem("contractActivation",String(e.activation));sessionStorage.setItem("contractModen",String(e.modem))},setFormData:e=>{g.formData=e},setOrderResult:(e,t)=>{g.orderId=e;g.requestError=t},setLoading:e=>{g.isLoading=e},setError:e=>{g.error=e},clearError:()=>{g.error=null},resetFlow:()=>{const e=["planCodeInternet","latitud","longitud","planId","planPrice","plan","typeContractId","contractInstallment","contractInstallation","contractActivation","contractModen"];e.forEach((e=>sessionStorage.removeItem(e)));x()},getSubmissionData:()=>({location:g.location,plan:g.selectedPlan,contract:g.selectedContract,formData:g.formData})};if(typeof window!=="undefined"&&window.__FSF_DEBUG__){y("currentStep",(e=>{console.log("[FSF Store] Step changed:",e)}));y("isLoading",(e=>{console.log("[FSF Store] Loading:",e)}));y("error",(e=>{if(e){console.error("[FSF Store] Error:",e)}}))}class v extends Error{status;response;constructor(e,t,r){super(e);this.status=t;this.response=r;this.name="HttpError"}}class w{baseUrl="";defaultTimeout=6e4;setBaseUrl(e){this.baseUrl=e.replace(/\/$/,"")}getBaseUrl(){return this.baseUrl}setTimeout(e){this.defaultTimeout=e}getHeaders(e,t){const r=new Headers;if(!t){r.set("Content-Type","application/json")}const a=g.token||sessionStorage.getItem("token");const o=g.correlationId||sessionStorage.getItem("correlationId");if(a){r.set("Authorization",`Bearer ${a}`)}if(o){r.set("X-Correlation-ID",o)}r.set("App","shop");r.set("Platform","web");if(e){Object.entries(e).forEach((([e,t])=>{r.set(e,t)}))}return r}async request(e){const{method:t,endpoint:r,body:a,headers:o,timeout:i,isFormData:n}=e;const s=r.startsWith("/")?r:`/${r}`;const c=`${this.baseUrl}${s}`;const l=new AbortController;const d=setTimeout((()=>l.abort()),i||this.defaultTimeout);try{const e={method:t,headers:this.getHeaders(o,n),signal:l.signal};if(a&&t!=="GET"){if(n&&a instanceof FormData){e.body=a}else{e.body=JSON.stringify(a)}}const r=await fetch(c,e);clearTimeout(d);let i;const s=r.headers.get("content-type");const p=await r.text();if(p&&(p.startsWith("{")||p.startsWith("["))){try{i=JSON.parse(p)}catch{i=p}}else if(s&&s.includes("application/json")){try{i=JSON.parse(p)}catch{i=p}}else{i=p}if(!r.ok){throw new v(`HTTP Error: ${r.status} ${r.statusText}`,r.status,i)}return{data:i,status:r.status,ok:r.ok}}catch(e){clearTimeout(d);if(e instanceof v){throw e}if(e.name==="AbortError"){throw new v("Request timeout",408)}throw new v(e.message||"Network error",0)}}async get(e,t){const r=await this.request({method:"GET",endpoint:e,headers:t});return r.data}async post(e,t,r){const a=await this.request({method:"POST",endpoint:e,body:t,headers:r});return a.data}async postFormData(e,t,r){const a=await this.request({method:"POST",endpoint:e,body:t,headers:r,isFormData:true});return a.data}async put(e,t,r){const a=await this.request({method:"PUT",endpoint:e,body:t,headers:r});return a.data}async delete(e,t){const r=await this.request({method:"DELETE",endpoint:e,headers:t});return r.data}}const k=new w;class C{isInitializing=false;initPromise=null;async fetchToken(){const e=await k.post("api/Token/getToken",{agentName:""});if(e.hasError){throw new Error(e.message||"Failed to obtain token")}return e}async initialize(){if(this.isInitializing&&this.initPromise){return this.initPromise}this.isInitializing=true;this.initPromise=(async()=>{try{const e=_.getStoredToken();if(e.token&&e.correlationId){_.setToken(e.token,e.correlationId);console.log("[TokenService] Using existing token from sessionStorage");return true}console.log("[TokenService] Fetching new token...");const t=await this.fetchToken();_.setToken(t.token,t.correlationId);console.log("[TokenService] Token obtained and stored successfully");return true}catch(e){console.error("[TokenService] Failed to initialize token:",e);_.setError("Error al obtener el token de autenticación");return false}finally{this.isInitializing=false}})();return this.initPromise}hasToken(){return _.hasToken()}getToken(){const e=_.getStoredToken();return e.token}getCorrelationId(){const e=_.getStoredToken();return e.correlationId}clearToken(){_.clearToken();console.log("[TokenService] Token cleared")}async refreshToken(){this.clearToken();return this.initialize()}async ensureToken(){if(!this.hasToken()){const e=await this.initialize();if(!e){throw new Error("Failed to obtain authentication token")}}}}const S=new C;const A=[{typeId:1,type:"Con Contrato",contract:[{contractId:2,deadlines:12,installation:80,activation:0,modem:0},{contractId:3,deadlines:24,installation:0,activation:0,modem:0}]},{typeId:0,type:"Sin Contrato",contract:[{contractId:1,deadlines:0,installation:160,activation:0,modem:0}]}];const F={NO_COVERAGE:"¡Fuera de área! Por el momento no contamos con cobertura en tu zona."};class I{async validateCoverage(e,t){await S.ensureToken();const r=await k.post("api/Catalogue/getInternetPlans",{latitud:String(e),longitud:String(t)});return r}async checkCoverage(e,t,r,a,o){const i=await this.validateCoverage(e,t);if(i.hasError){return{latitude:e,longitude:t,address:r,city:a,zipCode:o,serviceType:"",serviceMessage:F.NO_COVERAGE,isValid:false}}const n=i.priorityService;let s=F.NO_COVERAGE;if(i.attributes&&i.attributes.length>0){const e=i.attributes.find((e=>e.servicE_NAME===n));if(e){s=e.servicE_MESSAGE}}const c=["GPON","VRAD","CLARO HOGAR"];const l=c.includes(n);if(!l){return{latitude:e,longitude:t,address:r,city:a,zipCode:o,serviceType:"",serviceMessage:F.NO_COVERAGE,isValid:false}}console.log("[CoverageService] Returning valid coverage");return{latitude:e,longitude:t,address:r,city:a,zipCode:o,serviceType:n,serviceMessage:s,isValid:true}}getServiceDisplayName(e){const t={GPON:"Fibra Óptica",VRAD:"Internet DSL","CLARO HOGAR":"Internet Inalámbrico"};return t[e]||e}isClaroHogar(e){return e.toLowerCase()==="claro hogar"}}const E=new I;class P{currentCartId=0;async getPlans(e,t=0){await S.ensureToken();let r=e;if(e==="CLARO HOGAR"){r="internet"}console.log("[PlansService] Fetching plans for type:",r,"catalogId:",t);const a=await k.post("api/Plans/getPlansInternet",{catalogID:t,type:r});console.log("[PlansService] Response:",a);if(a.hasError){console.error("[PlansService] API error:",a.message);throw new Error(a.message||"Failed to fetch plans")}console.log("[PlansService] Plans found:",a.planList?.length||0);return a.planList||[]}async addToCart(e,t=0,r=0,a=0,o=""){await S.ensureToken();const i=S.getToken()||"";const n=this.getEffectivePrice(e);const s={token:i,productId:e.planId,notificationDetailID:0,chvSource:"",promoCode:sessionStorage.getItem("discountCoupon")||"",installments:a,decPrice:n,decDeposit:0,decDownPayment:0,decTotalPrice:n,Qty:1,flowId:1,ssoToken:"",userID:"0",parentProductId:r,parentCartId:t,creditClass:o,downgradeAllowed:false,pendingAccelerated:0,acceletartedAmount:0,pastDueAmount:0,delicuency:false};const c=await k.post("api/Card/addToCart",{cartItems:JSON.stringify([s])});if(c.hasError){throw new Error(c.message||"Failed to add plan to cart")}if(c.code){this.currentCartId=c.code}this.storePlanInSession(e);return c}async addToCartCurrentPlan(e,t){await S.ensureToken();const r=new FormData;r.append("productId",String(e));r.append("cartId",String(t));return await k.postFormData("api/Plans/addToCartCurrentPlan",r)}async deleteFromCart(e,t=0){await S.ensureToken();const r=await k.post("api/Card/deleteItem",{cartId:e,productId:t});if(!r.hasError){if(e===this.currentCartId){this.currentCartId=0}}return r}storePlanInSession(e){try{sessionStorage.setItem("plan",JSON.stringify(e));sessionStorage.setItem("planId",String(e.planId));const t=this.getEffectivePrice(e);sessionStorage.setItem("planPrice",String(t));sessionStorage.setItem("planCodeInternet",btoa(e.planSoc||String(e.planId)))}catch(e){console.error("[PlansService] Error storing plan in session:",e)}}getStoredPlan(){try{const e=sessionStorage.getItem("plan");return e?JSON.parse(e):null}catch{return null}}getStoredPlanId(){const e=sessionStorage.getItem("planId");return e?parseInt(e,10):0}getCartId(){return this.currentCartId}setCartId(e){this.currentCartId=e}clearPlan(){this.currentCartId=0;sessionStorage.removeItem("plan");sessionStorage.removeItem("planId");sessionStorage.removeItem("planPrice");sessionStorage.removeItem("planCodeInternet")}formatPrice(e){return`$${e.toFixed(2)}`}parsePlanFeatures(e){if(!e)return[];const t=/<li[^>]*>([^<]+)<\/li>/gi;const r=[];let a;while((a=t.exec(e))!==null){r.push(a[1].trim())}return r}getDiscountPercentage(e,t){if(!t||t>=e)return 0;return Math.round((e-t)/e*100)}hasPromotion(e){return e.bitPromotion||e.decSalePrice&&e.decSalePrice<e.decPrice}getEffectivePrice(e){if(e.decSalePrice&&e.decSalePrice<e.decPrice){return e.decSalePrice}return e.decPrice}sortByPrice(e,t=true){return[...e].sort(((e,r)=>{const a=this.getEffectivePrice(e);const o=this.getEffectivePrice(r);return t?a-o:o-a}))}}const D=new P;class z{async submitRequest(e){await S.ensureToken();const t=new FormData;Object.entries(e).forEach((([e,r])=>{if(r!==undefined&&r!==null){t.append(e,String(r))}}));const r=await k.postFormData("api/Orders/internetServiceRequest",t);return r}async getOrder(e){await S.ensureToken();const t=await k.get(`api/Orders/getOrder?orderId=${encodeURIComponent(e)}`);return t}async sendConfirmation(e,t){await S.ensureToken();const r=new FormData;r.append("orderId",e);r.append("email",t);const a=await k.postFormData("api/Orders/sendConfirmation",r);return a}buildPayload(e,t,r,a){return{type:t.typeId,name:e.personal.firstName,second_name:e.personal.secondName||"",last_name:e.personal.lastName,second_surname:e.personal.secondLastName,date_birth:e.personal.birthDate||"1990-01-01",email:e.personal.email,telephone1:e.personal.phone1,telephone2:e.personal.phone2||"",zipCode:e.address.zipCode,address:e.address.address,city:e.address.city,id_type:e.personal.identificationType==="license"?"1":"2",id:e.personal.identificationNumber,identification_expiration:e.personal.identificationExpiration,frontFlowId:this.generateFlowId(),plan_id:String(r.planId),plan_name:r.planName,deadlines:String(t.deadlines),installation:String(t.installation),activation:String(t.activation),moden:String(t.modem),claro_customer:e.isExistingCustomer,latitud:String(a.latitude),longitud:String(a.longitude),business_name:e.business.businessName,business_position:e.business.position}}generateFlowId(){return`FSF-${Date.now()}-${Math.random().toString(36).substr(2,9)}`}validateSubmissionData(e,t,r,a){const o=[];if(!a){o.push("location")}if(!r){o.push("plan")}if(!t){o.push("contract")}if(!e){o.push("formData")}else{if(!e.personal.firstName)o.push("firstName");if(!e.personal.lastName)o.push("lastName");if(!e.personal.secondLastName)o.push("secondLastName");if(!e.personal.identificationNumber)o.push("identificationNumber");if(!e.personal.identificationExpiration)o.push("identificationExpiration");if(!e.personal.phone1)o.push("phone1");if(!e.personal.email)o.push("email");if(!e.business.businessName)o.push("businessName");if(!e.business.position)o.push("position");if(!e.address.address)o.push("address");if(!e.address.city)o.push("city");if(!e.address.zipCode)o.push("zipCode")}return{isValid:o.length===0,missingFields:o}}}const N=new z;const T={DEFAULT_CENTER:{lat:18.333036,lng:-66.4161211},DEFAULT_ZOOM:17,MAP_ID:"8481b97098c495ab",DEFAULT_MAP_TYPE:"satellite"};const O={NO_COVERAGE:"¡Fuera de área! Por el momento no contamos con cobertura en tu zona.",COVERAGE_ERROR:"Error al verificar la cobertura. Por favor, intenta de nuevo.",REQUEST_ERROR:"¡Lo sentimos, ha ocurrido un error en el proceso de solicitud! En este momento estamos presentando inconvenientes en nuestro sistema. Por favor, inténtalo nuevamente.",GEOLOCATION_DENIED:"Permiso de ubicación denegado. Por favor, permite el acceso a tu ubicación.",GEOLOCATION_UNAVAILABLE:"No se pudo obtener tu ubicación. Por favor, ingresa tu dirección manualmente.",GEOLOCATION_TIMEOUT:"Tiempo de espera agotado al obtener tu ubicación."};const M={REQUEST_SUCCESS:"¡Tu solicitud fue enviada con éxito!",REQUEST_SUCCESS_SUBTITLE:"Pronto nos comunicaremos contigo."};class L{apiKey="";isLoaded=false;loadPromise=null;map=null;marker=null;autocomplete=null;infoWindow=null;setApiKey(e){this.apiKey=e}async loadGoogleMaps(){if(this.isLoaded){return}if(this.loadPromise){return this.loadPromise}if(!this.apiKey){throw new Error("Google Maps API key is required")}this.loadPromise=new Promise(((e,t)=>{if(window.google?.maps){this.isLoaded=true;e();return}const r=document.createElement("script");r.src=`https://maps.googleapis.com/maps/api/js?key=${this.apiKey}&libraries=places,marker&v=weekly`;r.async=true;r.defer=true;r.onload=()=>{this.isLoaded=true;e()};r.onerror=()=>{t(new Error("Failed to load Google Maps API"))};document.head.appendChild(r)}));return this.loadPromise}isGoogleMapsLoaded(){return this.isLoaded&&!!window.google?.maps}async initMap(e,t){await this.loadGoogleMaps();const r={center:T.DEFAULT_CENTER,zoom:T.DEFAULT_ZOOM,mapTypeId:T.DEFAULT_MAP_TYPE,mapId:T.MAP_ID,disableDefaultUI:false,zoomControl:true,mapTypeControl:true,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.HORIZONTAL_BAR,position:google.maps.ControlPosition.LEFT_TOP,mapTypeIds:["roadmap","satellite"]},streetViewControl:false,fullscreenControl:false};this.map=new google.maps.Map(e,{...r,...t});return this.map}getMap(){return this.map}centerMap(e){if(this.map){this.map.setCenter(e)}}setZoom(e){if(this.map){this.map.setZoom(e)}}async setMarker(e){if(!this.map){throw new Error("Map not initialized")}if(this.marker){this.marker.map=null}const{AdvancedMarkerElement:t}=await google.maps.importLibrary("marker");this.marker=new t({map:this.map,position:e,gmpDraggable:true});this.map.setCenter(e)}addMapClickListener(e){if(!this.map){console.warn("Map not initialized");return}this.map.addListener("click",(t=>{if(t.latLng){const r={lat:t.latLng.lat(),lng:t.latLng.lng()};e(r)}}))}clear(){this.removeMarker()}getMarkerPosition(){if(!this.marker?.position){return null}const e=this.marker.position;return{lat:e.lat,lng:e.lng}}removeMarker(){if(this.marker){this.marker.map=null;this.marker=null}}showInfoWindow(e,t){if(!this.map||!this.marker){console.warn("Map or marker not initialized");return}this.closeInfoWindow();const r=`<style>\n      .gm-ui-hover-effect { display: none !important; }\n      .gm-style .gm-style-iw-c { padding: 0px !important; width: 600px !important; max-width: none !important; }\n      .gm-style .gm-style-iw-d { padding: 0px !important; overflow: unset !important; width: 100% !important; max-width: none !important; }\n      .gm-style .gm-style-iw-tc { display: none !important; }\n      .gm-style-iw { width: 600px !important; max-width: none !important; }\n    </style>`;this.infoWindow=new google.maps.InfoWindow({content:r+e,maxWidth:600});this.infoWindow.open({anchor:this.marker,map:this.map});this.infoWindow.addListener("domready",(()=>{setTimeout((()=>{const e=document.querySelector(".gm-style-iw-c");const t=document.querySelector(".gm-style-iw-d");if(e){e.style.setProperty("width","600px","important");e.style.setProperty("max-width","none","important");e.style.setProperty("padding","0","important")}if(t){t.style.setProperty("width","100%","important");t.style.setProperty("max-width","none","important");t.style.setProperty("overflow","visible","important")}const r=document.querySelector(".gm-style-iw");if(r){r.style.setProperty("width","600px","important");r.style.setProperty("max-width","none","important")}}),50)}));if(t){window.__infoWindowContinueCallback=t}}closeInfoWindow(){if(this.infoWindow){this.infoWindow.close();this.infoWindow=null}}getInfoWindow(){return this.infoWindow}async initAutocomplete(e,t){await this.loadGoogleMaps();const r={componentRestrictions:{country:"pr"},fields:["address_components","geometry","formatted_address"],types:["address"]};this.autocomplete=new google.maps.places.Autocomplete(e,r);this.autocomplete.addListener("place_changed",(()=>{const e=this.autocomplete?.getPlace();if(!e?.geometry?.location){return}const r=this.parseAddressComponents(e);t(r);if(this.map){this.centerMap(r.coordinates);this.setMarker(r.coordinates)}}))}parseAddressComponents(e){const t=e.address_components||[];let r="";let a="";let o="";let i="";for(const e of t){const t=e.types[0];switch(t){case"street_number":r=e.long_name;break;case"route":a=e.long_name;break;case"locality":case"administrative_area_level_2":o=o||e.long_name;break;case"postal_code":i=e.long_name;break}}const n=[r,a].filter(Boolean).join(" ");const s=e.geometry?.location;return{address:n,city:o,zipCode:i,coordinates:{lat:s?.lat()||0,lng:s?.lng()||0},formattedAddress:e.formatted_address||""}}async geocodeAddress(e){await this.loadGoogleMaps();const t=new google.maps.Geocoder;return new Promise((r=>{t.geocode({address:e,componentRestrictions:{country:"pr"}},((e,t)=>{if(t==="OK"&&e&&e[0]){const t=e[0];const a=this.parseGeocoderResult(t);r(a)}else{r(null)}}))}))}async reverseGeocode(e){await this.loadGoogleMaps();const t=new google.maps.Geocoder;return new Promise((r=>{t.geocode({location:e},((e,t)=>{if(t==="OK"&&e&&e[0]){const t=e[0];const a=this.parseGeocoderResult(t);r(a)}else{r(null)}}))}))}parseGeocoderResult(e){const t=e.address_components||[];let r="";let a="";let o="";let i="";for(const e of t){const t=e.types[0];switch(t){case"street_number":r=e.long_name;break;case"route":a=e.long_name;break;case"locality":case"administrative_area_level_2":o=o||e.long_name;break;case"postal_code":i=e.long_name;break}}const n=[r,a].filter(Boolean).join(" ");const s=e.geometry.location;return{address:n,city:o,zipCode:i,coordinates:{lat:s.lat(),lng:s.lng()},formattedAddress:e.formatted_address}}async getCurrentLocation(){return new Promise(((e,t)=>{if(!navigator.geolocation){t(new Error("Geolocation is not supported by this browser"));return}navigator.geolocation.getCurrentPosition((t=>{e({lat:t.coords.latitude,lng:t.coords.longitude})}),(e=>{let r="Error getting location";switch(e.code){case e.PERMISSION_DENIED:r="Location permission denied";break;case e.POSITION_UNAVAILABLE:r="Location information unavailable";break;case e.TIMEOUT:r="Location request timed out";break}t(new Error(r))}),{enableHighAccuracy:true,timeout:1e4,maximumAge:0})}))}async getCurrentLocationWithAddress(){const e=await this.getCurrentLocation();return this.reverseGeocode(e)}destroy(){this.closeInfoWindow();this.removeMarker();this.autocomplete=null;this.map=null}}const R=new L;class B{HOGAR_CATALOGUE_ID=6;DEFAULT_PAGE_ITEMS=300;FILTER_INTERNET_TELEFONIA="39";FILTER_INTERNET_INALAMBRICO="23";async listCatalogue(e=this.FILTER_INTERNET_INALAMBRICO,t=1,r="",a="",o=""){await S.ensureToken();const i={catalogId:this.HOGAR_CATALOGUE_ID,pageNo:t,pageItems:this.DEFAULT_PAGE_ITEMS,creditClass:"C",orderBy:7,news:0,offers:"0",categoryID:"0",brand:a,filter:r,price:o,labels:[]};console.log("[CatalogueService] Request:",JSON.stringify(i));const n=await k.post("api/Catalogue/listCatalogue",i);console.log("[CatalogueService] API Response keys:",Object.keys(n||{}));if(n.hasError){throw new Error(n.message||"Failed to fetch catalogue")}const s=parseInt(e,10);const c=this.extractProductsFromSubcatalog(n,this.HOGAR_CATALOGUE_ID,s);console.log("[CatalogueService] Extracted products:",c.length);return{hasError:false,products:c,totalItems:c.length}}extractProductsFromSubcatalog(e,t,r){if(!e.catalogs||!Array.isArray(e.catalogs)){console.log("[CatalogueService] No catalogs in response");return[]}const a=e.catalogs.find((e=>e.catalogId===t));if(!a){console.log("[CatalogueService] Parent catalog not found:",t);for(const t of e.catalogs){if(t.catalog){const e=t.catalog.find((e=>e.catalogId===r));if(e){console.log("[CatalogueService] Found subcatalog in:",t.catalogId);return e.products||[]}}}return[]}console.log("[CatalogueService] Found parent catalog:",a.catalogId,a.catalogName);if(!a.catalog||!Array.isArray(a.catalog)){console.log("[CatalogueService] No subcatalogs in parent");return a.products||[]}const o=a.catalog.find((e=>e.catalogId===r));if(!o){console.log("[CatalogueService] Subcatalog not found:",r);console.log("[CatalogueService] Available subcatalogs:",a.catalog.map((e=>({id:e.catalogId,name:e.catalogName}))));return a.catalog[0]?.products||[]}console.log("[CatalogueService] Found subcatalog:",o.catalogId,o.catalogName);return o.products||[]}_findCatalogById(e,t){const r=[...e];while(r.length>0){const e=r.shift();if(e.catalogId===t){return e}if(e.catalog&&e.catalog.length>0){r.push(...e.catalog)}}return null}getProductTypeFilters(){return[{value:this.FILTER_INTERNET_TELEFONIA,label:"Internet + Telefonía"},{value:this.FILTER_INTERNET_INALAMBRICO,label:"Internet Inalámbrico"}]}formatInstallmentPrice(e){return`$${e.toFixed(2)}/mes`}formatRegularPrice(e){return`$${e.toFixed(2)}`}calculateInstallment(e,t){if(t<=0)return e;return Number((e/t).toFixed(2))}cleanDescription(e){if(!e)return"";return e.replace(/<[^>]*>/g,"").trim()}truncateText(e,t=80){if(!e||e.length<=t)return e;return e.substring(0,t).trim()+"..."}parseColors(e){if(!e||!Array.isArray(e))return[];return e.map((e=>e.webColor)).filter(Boolean)}storeProductInSession(e){try{sessionStorage.setItem("selectedProduct",JSON.stringify(e));sessionStorage.setItem("productId",String(e.productId))}catch(e){console.error("[CatalogueService] Error storing product in session:",e)}}getStoredProduct(){try{const e=sessionStorage.getItem("selectedProduct");return e?JSON.parse(e):null}catch{return null}}clearProduct(){sessionStorage.removeItem("selectedProduct");sessionStorage.removeItem("productId")}}const j=new B;const U={CART:"cart",CART_ID:"cartId",MAIN_ID:"mainId",DISCOUNT_COUPON:"discountCoupon",CART_TOTAL:"cartTotal",CART_PRODUCTS:"cartProducts"};const $={HOME:6};const q="C";class J{async getCart(e=""){try{await S.ensureToken();const t=e||this.getDiscountCoupon()||"";const r={promoCode:t};console.log("[CartService] Getting cart with promo:",t||"none");const a=await k.post("api/Card/getCart",r);if(a.hasError){console.error("[CartService] API error:",a.message);return{hasError:true,message:a.message||"Error al obtener el carrito",errorDisplay:a.errorDisplay}}this.storeCartInSession(a);return a}catch(e){console.error("[CartService] Exception:",e);return{hasError:true,message:"Error de conexión al obtener el carrito"}}}async addToCart(e,t,r=1,a,o){try{await S.ensureToken();const i=S.getToken()||"";const n={token:i,productId:String(e.productId),notificationDetailID:0,chvSource:"",promoCode:"",installments:t,decPrice:e.update_price||0,decDeposit:0,decDownPayment:e.decDownPayment||0,decTotalPrice:e.regular_price||0,Qty:r,flowId:$.HOME,ssoToken:"",userID:"0",parentProductId:o||0,parentCartId:a||0,creditClass:q,downgradeAllowed:false,pendingAccelerated:0,acceletartedAmount:0,pastDueAmount:0,delicuency:false};const s=JSON.stringify([n]);const c={cartItems:s};console.log("[CartService] Adding to cart:",e.productName);console.log("[CartService] Request payload:",c);const l=await k.post("api/Card/addToCart",c);if(l.hasError){console.error("[CartService] Add to cart error:",l.message);return{code:0,hasError:true,message:l.message||"Error al agregar al carrito",errorDisplay:l.errorDisplay}}if(l.code){this.storeMainId(l.code)}console.log("[CartService] Added to cart, mainId:",l.code);return l}catch(e){console.error("[CartService] Exception:",e);return{code:0,hasError:true,message:"Error de conexión al agregar al carrito"}}}async addPlanToCart(e,t,r){try{await S.ensureToken();const a=S.getToken()||"";const o={token:a,productId:String(e.planId),notificationDetailID:0,chvSource:"",promoCode:"",installments:1,decPrice:e.decSalePrice||e.decPrice,decDeposit:0,decDownPayment:0,decTotalPrice:e.decPrice,Qty:1,flowId:$.HOME,ssoToken:"",userID:"0",parentProductId:r,parentCartId:t,creditClass:q,downgradeAllowed:false,pendingAccelerated:0,acceletartedAmount:0,pastDueAmount:0,delicuency:false};const i=JSON.stringify([o]);const n={cartItems:i};console.log("[CartService] Adding plan to cart:",e.planName);const s=await k.post("api/Card/addToCart",n);if(s.hasError){console.error("[CartService] Add plan error:",s.message);return{code:0,hasError:true,message:s.message||"Error al agregar el plan",errorDisplay:s.errorDisplay}}console.log("[CartService] Plan added to cart");return s}catch(e){console.error("[CartService] Exception:",e);return{code:0,hasError:true,message:"Error de conexión al agregar el plan"}}}async deleteItem(e,t){try{await S.ensureToken();const r={cartId:e,productId:t};console.log("[CartService] Deleting item:",e,t);const a=await k.post("api/Card/deleteItem",r);if(a.hasError){console.error("[CartService] Delete error:",a.message);return{hasError:true,message:a.message||"Error al eliminar del carrito"}}console.log("[CartService] Item deleted successfully");return{hasError:false}}catch(e){console.error("[CartService] Exception:",e);return{hasError:true,message:"Error de conexión al eliminar del carrito"}}}async clearCart(){try{const e=await this.getCart();if(e.hasError||!e.products?.length){return{hasError:false}}for(const t of e.products){const e=await this.deleteItem(t.cartId,t.productId);if(e.hasError){return e}}this.clearCartSession();return{hasError:false}}catch(e){console.error("[CartService] Clear cart error:",e);return{hasError:true,message:"Error al limpiar el carrito"}}}storeCartInSession(e){try{sessionStorage.setItem(U.CART,JSON.stringify(e));if(e.totalPrice!==undefined){sessionStorage.setItem(U.CART_TOTAL,String(e.totalPrice))}if(e.products){sessionStorage.setItem(U.CART_PRODUCTS,JSON.stringify(e.products))}}catch(e){console.error("[CartService] Error storing cart:",e)}}getCachedCart(){try{const e=sessionStorage.getItem(U.CART);return e?JSON.parse(e):null}catch{return null}}storeMainId(e){try{sessionStorage.setItem(U.MAIN_ID,String(e))}catch(e){console.error("[CartService] Error storing mainId:",e)}}getMainId(){try{const e=sessionStorage.getItem(U.MAIN_ID);return e?parseInt(e,10):null}catch{return null}}storeDiscountCoupon(e){try{sessionStorage.setItem(U.DISCOUNT_COUPON,e)}catch(e){console.error("[CartService] Error storing coupon:",e)}}getDiscountCoupon(){try{return sessionStorage.getItem(U.DISCOUNT_COUPON)}catch{return null}}clearDiscountCoupon(){try{sessionStorage.removeItem(U.DISCOUNT_COUPON)}catch(e){console.error("[CartService] Error clearing coupon:",e)}}clearCartSession(){try{Object.values(U).forEach((e=>{sessionStorage.removeItem(e)}));console.log("[CartService] Cleared cart session")}catch(e){console.error("[CartService] Error clearing session:",e)}}calculateTotals(e){let t=0;let r=0;e.forEach((e=>{t+=(e.decPrice||0)*e.qty;r+=(e.decTotalPerMonth||e.decPrice||0)*e.qty}));const a=.115;const o=t*a;const i=t+o;return{subtotal:Number(t.toFixed(2)),tax:Number(o.toFixed(2)),total:Number(i.toFixed(2)),monthlyPayment:Number(r.toFixed(2))}}getEquipmentItems(e){return e.filter((e=>e.equipment===true||e.home===true))}getPlanItems(e){return e.filter((e=>e.plan===true))}hasEquipment(e){return e.some((e=>e.equipment===true||e.home===true))}hasPlan(e){return e.some((e=>e.plan===true))}getItemCount(e){return e.reduce(((e,t)=>e+t.qty),0)}formatPrice(e){return`$${e.toFixed(2)}`}}const V=new J;const G={SELECTED_PRODUCT:"selectedProduct",PRODUCT_ID:"productId",MAIN_ID:"mainId",CHILDREN_ID:"childrenId",PARENT_ID:"parentId",DEVICE_TYPE:"deviceType",SELECTED_COLOR:"selectedColor",SELECTED_STORAGE:"selectedStorage",SUBCATALOG_ID:"subcatalogId"};const H=1;class X{extractStockAndImagesFromColors(e){const t=[];let r=undefined;let a=undefined;let o=false;if(!e||e.length===0){console.log("[ProductService] No colors array in response, stock will be undefined");return{stock:r,images:t,childrenId:a}}for(let i=0;i<e.length;i++){const n=e[i];if(!n.storages||n.storages.length===0)continue;for(let e=0;e<n.storages.length;e++){const i=n.storages[e];if(!i.products||i.products.length===0)continue;const s=i.products[0];if(n.defaultColor&&i.defaultStorage){if(s.stock!==undefined&&s.stock>H){r=s.stock;a=s.productId;o=true;if(s.imgUrl)t.push(s.imgUrl);if(s.side_image)t.push(s.side_image);if(s.back_image)t.push(s.back_image);console.log("[ProductService] Found default with stock:",r,"childrenId:",a);break}}}if(o)break}if(!o){for(let i=0;i<e.length;i++){const n=e[i];if(!n.storages||n.storages.length===0)continue;for(let e=0;e<n.storages.length;e++){const i=n.storages[e];if(!i.products||i.products.length===0)continue;const s=i.products[0];if(s.stock!==undefined&&s.stock>H){r=s.stock;a=s.productId;o=true;if(s.imgUrl)t.push(s.imgUrl);if(s.side_image)t.push(s.side_image);if(s.back_image)t.push(s.back_image);console.log("[ProductService] Found any with stock:",r,"childrenId:",a);break}}if(o)break}}if(r===undefined&&e.length>0){const o=e[0];if(o.storages&&o.storages.length>0){const e=o.storages[0];if(e.products&&e.products.length>0){const o=e.products[0];r=o.stock;a=o.productId;if(o.imgUrl)t.push(o.imgUrl);if(o.side_image)t.push(o.side_image);if(o.back_image)t.push(o.back_image);console.log("[ProductService] Using first product stock:",r,"childrenId:",a)}}}return{stock:r,images:t,childrenId:a}}async getEquipmentDetail(e){try{await S.ensureToken();const t=S.getToken()||"";const r={productId:e,userID:0,token:t};console.log("[ProductService] Fetching equipment detail:",e);const a=await k.post("api/Catalogue/equipmentDetail",r);if(a.hasError){console.error("[ProductService] API error:",a.message);return{hasError:true,message:a.message||"Error al cargar el detalle del producto",errorDisplay:a.errorDisplay}}const{stock:o,images:i,childrenId:n}=this.extractStockAndImagesFromColors(a.colors);const s=[];if(a.imgUrl)s.push(a.imgUrl);if(a.detailImage&&a.detailImage!==a.imgUrl){s.push(a.detailImage)}i.forEach((e=>{if(e&&!s.includes(e)){s.push(e)}}));if(a.images?.length){a.images.forEach((e=>{if(e&&!s.includes(e)){s.push(e)}}))}const c=o!==undefined?o:a.stock;const l={productId:a.productId||e,productName:a.productName||"",brandName:a.brandName,imgUrl:a.imgUrl||"",detailImage:a.detailImage,images:s.length>0?s:undefined,shortDescription:a.shortDescription,longDescription:a.longDescription,regular_price:a.regular_price||0,update_price:a.update_price||0,installments:a.installments||0,decDownPayment:a.decDownPayment,decDeposit:a.decDeposit,creditClass:a.creditClass,colors:a.colors,storages:a.storages,specifications:a.specifications,features:a.features,catalogId:a.catalogId,home:a.home,stock:c};console.log("[ProductService] Product stock from nested structure:",o,"root:",a.stock,"final:",c);if(n){this.storeChildrenId(n);console.log("[ProductService] Stored childrenId from colors:",n)}this.storeMainId(e);return{hasError:false,product:l}}catch(e){console.error("[ProductService] Exception:",e);return{hasError:true,message:"Error de conexión al cargar el detalle del producto"}}}storeMainId(e){try{sessionStorage.setItem(G.MAIN_ID,String(e));console.log("[ProductService] Stored mainId:",e)}catch(e){console.error("[ProductService] Error storing mainId:",e)}}getMainId(){try{const e=sessionStorage.getItem(G.MAIN_ID);return e?parseInt(e,10):null}catch{return null}}storeSelectedProduct(e,t){try{sessionStorage.setItem(G.SELECTED_PRODUCT,JSON.stringify(e));sessionStorage.setItem(G.PRODUCT_ID,String(e.productId));if(t){sessionStorage.setItem(G.SUBCATALOG_ID,String(t));console.log("[ProductService] Stored subcatalogId:",t)}console.log("[ProductService] Stored selected product:",e.productName)}catch(e){console.error("[ProductService] Error storing product:",e)}}storeSubcatalogId(e){try{sessionStorage.setItem(G.SUBCATALOG_ID,String(e));console.log("[ProductService] Stored subcatalogId:",e)}catch(e){console.error("[ProductService] Error storing subcatalogId:",e)}}getSubcatalogId(){try{const e=sessionStorage.getItem(G.SUBCATALOG_ID);return e?parseInt(e,10):0}catch{return 0}}getSelectedProduct(){try{const e=sessionStorage.getItem(G.SELECTED_PRODUCT);return e?JSON.parse(e):null}catch{return null}}getProductId(){try{const e=sessionStorage.getItem(G.PRODUCT_ID);return e?parseInt(e,10):null}catch{return null}}storeSelectedColor(e,t,r){try{const a={colorId:e,colorName:t,webColor:r};sessionStorage.setItem(G.SELECTED_COLOR,JSON.stringify(a))}catch(e){console.error("[ProductService] Error storing color:",e)}}getSelectedColor(){try{const e=sessionStorage.getItem(G.SELECTED_COLOR);return e?JSON.parse(e):null}catch{return null}}storeSelectedStorage(e,t){try{const r={storageId:e,storageName:t};sessionStorage.setItem(G.SELECTED_STORAGE,JSON.stringify(r))}catch(e){console.error("[ProductService] Error storing storage:",e)}}getSelectedStorage(){try{const e=sessionStorage.getItem(G.SELECTED_STORAGE);return e?JSON.parse(e):null}catch{return null}}storeChildrenId(e){try{sessionStorage.setItem(G.CHILDREN_ID,String(e))}catch(e){console.error("[ProductService] Error storing childrenId:",e)}}getChildrenId(){try{const e=sessionStorage.getItem(G.CHILDREN_ID);return e?parseInt(e,10):null}catch{return null}}storeParentId(e){try{sessionStorage.setItem(G.PARENT_ID,String(e))}catch(e){console.error("[ProductService] Error storing parentId:",e)}}getParentId(){try{const e=sessionStorage.getItem(G.PARENT_ID);return e?parseInt(e,10):null}catch{return null}}storeDeviceType(e){try{sessionStorage.setItem(G.DEVICE_TYPE,e)}catch(e){console.error("[ProductService] Error storing deviceType:",e)}}getDeviceType(){try{return sessionStorage.getItem(G.DEVICE_TYPE)}catch{return null}}clearProductSession(){try{Object.values(G).forEach((e=>{sessionStorage.removeItem(e)}));console.log("[ProductService] Cleared product session")}catch(e){console.error("[ProductService] Error clearing session:",e)}}formatPrice(e){return`$${e.toFixed(2)}`}formatInstallmentPrice(e){return`$${e.toFixed(2)}/mes`}calculateInstallment(e,t){if(t<=0)return e;return Number((e/t).toFixed(2))}cleanDescription(e){if(!e)return"";return e.replace(/<[^>]*>/g,"").trim()}isHomeProduct(e){return e.home===true||e.catalogId===6}}const Y=new X;const W={get(e){try{const t=sessionStorage.getItem(e);return t}catch{return null}},set(e,t){try{sessionStorage.setItem(e,t)}catch(e){console.error("[StorageUtils] Error setting value:",e)}},getJSON(e){try{const t=sessionStorage.getItem(e);if(!t)return null;return JSON.parse(t)}catch{return null}},setJSON(e,t){try{sessionStorage.setItem(e,JSON.stringify(t))}catch(e){console.error("[StorageUtils] Error setting JSON value:",e)}},remove(e){try{sessionStorage.removeItem(e)}catch(e){console.error("[StorageUtils] Error removing value:",e)}},clear(){try{sessionStorage.clear()}catch(e){console.error("[StorageUtils] Error clearing storage:",e)}},getEncoded(e){try{const t=sessionStorage.getItem(e);if(!t)return null;return atob(t)}catch{return null}},setEncoded(e,t){try{sessionStorage.setItem(e,btoa(t))}catch(e){console.error("[StorageUtils] Error setting encoded value:",e)}},getEncodedJSON(e){try{const t=sessionStorage.getItem(e);if(!t)return null;const r=atob(t);return JSON.parse(r)}catch{return null}},setEncodedJSON(e,t){try{const r=JSON.stringify(t);sessionStorage.setItem(e,btoa(r))}catch(e){console.error("[StorageUtils] Error setting encoded JSON value:",e)}}};const Z=[{label:"Adjuntas",value:"00601"},{label:"Adjuntas",value:"00631"},{label:"Aguada",value:"00602"},{label:"Aguadilla",value:"00603"},{label:"Aguadilla",value:"00604"},{label:"Aguadilla",value:"00605"},{label:"Aguadilla",value:"00690"},{label:"Aguas Buenas",value:"00703"},{label:"Aibonito",value:"00705"},{label:"La Plata",value:"00786"},{label:"Añasco",value:"00610"},{label:"Angeles",value:"00611"},{label:"Arecibo",value:"00612"},{label:"Arecibo",value:"00613"},{label:"Arecibo",value:"00614"},{label:"Arecibo",value:"00616"},{label:"Arecibo",value:"00652"},{label:"Arecibo",value:"00688"},{label:"Arroyo",value:"00714"},{label:"Barceloneta",value:"00617"},{label:"Barranquitas",value:"00794"},{label:"Bayamón",value:"00956"},{label:"Bayamón",value:"00957"},{label:"Bayamón",value:"00959"},{label:"Bayamón",value:"00961"},{label:"Bayamón",value:"00958"},{label:"Cabo Rojo",value:"00623"},{label:"Boquerón",value:"00622"},{label:"Caguas",value:"00725"},{label:"Caguas",value:"00727"},{label:"Caguas",value:"00726"},{label:"Camuy",value:"00627"},{label:"Canóvanas",value:"00729"},{label:"Canóvanas",value:"00745"},{label:"Carolina",value:"00979"},{label:"Carolina",value:"00982"},{label:"Carolina",value:"00983"},{label:"Carolina",value:"00985"},{label:"Carolina",value:"00987"},{label:"Carolina",value:"00981"},{label:"Carolina",value:"00984"},{label:"Carolina",value:"00986"},{label:"Carolina",value:"00988"},{label:"Cataño",value:"00962"},{label:"Cataño",value:"00963"},{label:"Cayey",value:"00736"},{label:"Cayey",value:"00737"},{label:"Ceiba",value:"00735"},{label:"Ceiba",value:"00742"},{label:"Ciales",value:"00638"},{label:"Cidra",value:"00739"},{label:"Coamo",value:"00769"},{label:"Comerio",value:"00782"},{label:"Corozal",value:"00783"},{label:"Culebra",value:"00775"},{label:"Dorado",value:"00646"},{label:"Fajardo",value:"00738"},{label:"Fajardo",value:"00740"},{label:"Florida",value:"00650"},{label:"Guánica",value:"00653"},{label:"Guánica",value:"00647"},{label:"Guayama",value:"00784"},{label:"Guayama",value:"00704"},{label:"Guayama",value:"00785"},{label:"Guayanilla",value:"00656"},{label:"Guaynabo",value:"00965"},{label:"Guaynabo",value:"00966"},{label:"Guaynabo",value:"00968"},{label:"Guaynabo",value:"00971"},{label:"Guaynabo",value:"00970"},{label:"Guaynabo",value:"00969"},{label:"Gurabo",value:"00778"},{label:"Hatillo",value:"00659"},{label:"Hormigueros",value:"00660"},{label:"Humacao",value:"00791"},{label:"Humacao",value:"00792"},{label:"Humacao",value:"00741"},{label:"Isabela",value:"00662"},{label:"Jayuya",value:"00664"},{label:"Juana Díaz",value:"00795"},{label:"Juncos",value:"00777"},{label:"Lajas",value:"00667"},{label:"Lares",value:"00669"},{label:"Las Marías",value:"00670"},{label:"Las Piedras",value:"00771"},{label:"Loíza",value:"00772"},{label:"Luquillo",value:"00773"},{label:"Manatí",value:"00674"},{label:"Maricao",value:"00606"},{label:"Maunabo",value:"00707"},{label:"Mayaguez",value:"00680"},{label:"Mayaguez",value:"00682"},{label:"Mayaguez",value:"00681"},{label:"Moca",value:"00676"},{label:"Morovis",value:"00687"},{label:"Naguabo",value:"00718"},{label:"Rio Blanco",value:"00744"},{label:"Naranjito",value:"00719"},{label:"Orocovis",value:"00720"},{label:"Patillas",value:"00723"},{label:"Peñuelas",value:"00624"},{label:"Ponce",value:"00716"},{label:"Ponce",value:"00717"},{label:"Ponce",value:"00728"},{label:"Ponce",value:"00730"},{label:"Ponce",value:"00731"},{label:"Ponce",value:"00733"},{label:"Ponce",value:"00780"},{label:"Ponce",value:"00715"},{label:"Ponce",value:"00732"},{label:"Ponce",value:"00734"},{label:"Quebradillas",value:"00678"},{label:"Rincón",value:"00677"},{label:"Río Grande",value:"00721"},{label:"Río Grande",value:"00745"},{label:"Sabana Grande",value:"00637"},{label:"Salinas",value:"00751"},{label:"San Germán",value:"00683"},{label:"San Germán",value:"00636"},{label:"San Juan",value:"00921"},{label:"San Juan",value:"00923"},{label:"San Juan",value:"00924"},{label:"San Juan",value:"00929"},{label:"San Juan",value:"00915"},{label:"San Juan",value:"00916"},{label:"San Juan",value:"00920"},{label:"San Juan",value:"00909"},{label:"San Juan",value:"00910"},{label:"Fort Buchanan",value:"00934"},{label:"San Juan",value:"00936"},{label:"San Juan",value:"00917"},{label:"San Juan",value:"00919"},{label:"San Juan",value:"00911"},{label:"San Juan",value:"00912"},{label:"San Juan",value:"00913"},{label:"San Juan",value:"00914"},{label:"San Juan",value:"00940"},{label:"San Juan",value:"00901"},{label:"San Juan",value:"00902"},{label:"San Juan",value:"00906"},{label:"San Juan",value:"00925"},{label:"San Juan",value:"00926"},{label:"San Juan",value:"00927"},{label:"San Juan",value:"00928"},{label:"San Juan",value:"00930"},{label:"San Juan",value:"00907"},{label:"San Juan",value:"00908"},{label:"San Juan",value:"00931"},{label:"San Juan",value:"00933"},{label:"San Lorenzo",value:"00754"},{label:"San Sebastián",value:"00685"},{label:"Santa Isabel",value:"00757"},{label:"Toa Alta",value:"00953"},{label:"Toa Alta",value:"00954"},{label:"Toa Baja",value:"00949"},{label:"Toa Baja",value:"00950"},{label:"Toa Baja",value:"00951"},{label:"Toa Baja",value:"00952"},{label:"Trujillo Alto",value:"00976"},{label:"Trujillo Alto",value:"00977"},{label:"Saint Just",value:"00978"},{label:"Utuado",value:"00641"},{label:"Utuado",value:"00611"},{label:"Vega Alta",value:"00692"},{label:"Vega Baja",value:"00693"},{label:"Vega Baja",value:"00694"},{label:"Vieques",value:"00765"},{label:"Villalba",value:"00766"},{label:"Yabucoa",value:"00767"},{label:"Yauco",value:"00698"}];const K=["PO BOX","P.O. BOX","P O BOX","HC ","RR ","APARTADO"];const Q={SHIPMENT_ID:"shipmentId",ZIP_CODE:"zipCode",SHIPPING_ADDRESS:"shippingAddress",DELIVERY_METHOD:"deliveryMethodInfo"};class ee{http;constructor(){this.http=k}async createAddress(e,t="6"){const r=W.get("wBCUserID")||"0";const a=S.getToken();const o=new FormData;o.append("token",a);o.append("flowId",t);o.append("userId",r);o.append("name",e.name);o.append("email",e.email);o.append("phone",this.cleanPhoneNumber(e.phone));o.append("phone2",this.cleanPhoneNumber(e.phone2||""));o.append("address1",e.address1);o.append("address2",e.address2||"");o.append("city",e.city);o.append("zip",e.zip+"-0000");o.append("state",e.state);o.append("town",e.city);o.append("notes",e.notes||"");o.append("chvAuthorizerName",e.authorizerName||"");o.append("chvAuthorizerPhone",this.cleanPhoneNumber(e.authorizerPhone||""));try{const t=await this.http.postFormData("api/Address/create",o);if(!t.hasError&&t.response){this.setShipmentId(t.response);this.setZipCode(e.zip);this.storeShippingAddress(e)}return t}catch(e){console.error("[ShippingService] Create address error:",e);return{hasError:true,message:"Error al crear la dirección de envío"}}}async getDeliveryMethods(){const e=S.getToken();const t=new FormData;t.append("token",e);try{const e=await this.http.postFormData("api/Address/getDeliveryMethods",t);return e}catch(e){console.error("[ShippingService] Get delivery methods error:",e);return{hasError:true,errorDesc:"Error al obtener métodos de entrega"}}}getShipmentId(){const e=W.get(Q.SHIPMENT_ID);return e?parseInt(e,10):0}setShipmentId(e){W.set(Q.SHIPMENT_ID,e.toString())}getZipCode(){return W.get(Q.ZIP_CODE)||""}setZipCode(e){W.set(Q.ZIP_CODE,e)}storeShippingAddress(e){W.setJSON(Q.SHIPPING_ADDRESS,e)}getStoredShippingAddress(){return W.getJSON(Q.SHIPPING_ADDRESS)}storeDeliveryMethod(e){W.setJSON(Q.DELIVERY_METHOD,e)}getStoredDeliveryMethod(){return W.getJSON(Q.DELIVERY_METHOD)}clearShippingData(){W.remove(Q.SHIPMENT_ID);W.remove(Q.ZIP_CODE);W.remove(Q.SHIPPING_ADDRESS);W.remove(Q.DELIVERY_METHOD)}validateZipCode(e){const t=Z.find((t=>t.value===e));return t?t.label:null}getMunicipalityByZip(e){return this.validateZipCode(e)||""}getAllZipCodes(){return Z}isValidPhysicalAddress(e){const t=e.toUpperCase();return!K.some((e=>t.includes(e)))}isValidEmail(e){const t=/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/;return t.test(e)}isValidPhone(e){const t=this.cleanPhoneNumber(e);return t.length===10}cleanPhoneNumber(e){return e.replace(/\(|\)|-|\s/g,"")}formatPhoneNumber(e){const t=this.cleanPhoneNumber(e);if(t.length!==10)return e;return`(${t.slice(0,3)}) ${t.slice(3,6)}-${t.slice(6)}`}}const te=new ee;const re={ORDER_BAN:"orderBan",PAYMENT_RESULT:"paymentResult"};class ae{paymentIframeUrl="";setPaymentIframeUrl(e){this.paymentIframeUrl=e}getPaymentIframeUrl(){return this.paymentIframeUrl}async createOrder(e){const t=S.getToken();const r=new FormData;r.append("token",t);r.append("flowId",e.flowId);r.append("frontFlowId",e.frontFlowId);r.append("frontFlowName",e.frontFlowName);r.append("banExisting",e.banExisting||"");r.append("subscriberExisting",e.subscriberExisting||"");r.append("amount",e.amount);r.append("email",e.email);r.append("zipCode",e.zipCode);r.append("deposit",e.deposit);r.append("pastDueAmount",e.pastDueAmount||"0");try{const e=await k.postFormData("api/Orders/creationOfOrder",r);if(!e.hasError&&e.ban){this.storeOrderBan(e.ban)}return e}catch(e){console.error("[PaymentService] Create order error:",e);return{hasError:true,errorDisplay:"Error al crear la orden"}}}async recordPayment(e){const t=S.getToken();const r=new FormData;r.append("token",t);r.append("ban",e.ban);r.append("cardNumber",e.cardNumber);r.append("cardType",e.cardType);r.append("authorizationNumber",e.authorizationNumber);r.append("referenceNumber",e.referenceNumber);r.append("description",e.description);r.append("operationId",e.operationId);r.append("amount",e.amount);r.append("deposit",e.deposit);try{const e=await k.postFormData("api/Payment/record",r);return e}catch(e){console.error("[PaymentService] Record payment error:",e);return{hasError:true,errorDisplay:"Error al registrar el pago"}}}async recordPaymentError(e,t,r,a,o,i,n,s){const c=S.getToken();const l=new FormData;l.append("token",c);l.append("ban",e);l.append("subscriber",t);l.append("description",r);l.append("operationId",a);l.append("deposit",o);l.append("cardType",i);l.append("cardNumber",n);l.append("amount",s);try{return await k.postFormData("api/Payment/error",l)}catch(e){console.error("[PaymentService] Record error error:",e);return{hasError:true}}}async getPaymentIframe(e){try{const t=await k.post("api/Payment/getPaymentIframe",e);return t}catch(e){console.error("[PaymentService] Get iframe error:",e);return{errorInfo:{hasError:true,errorDisplay:"Error al obtener el iframe de pago"}}}}storeOrderBan(e){W.set(re.ORDER_BAN,e)}getOrderBan(){return W.get(re.ORDER_BAN)||""}storePaymentResult(e){W.setJSON(re.PAYMENT_RESULT,e)}getPaymentResult(){return W.getJSON(re.PAYMENT_RESULT)}clearPaymentData(){W.remove(re.ORDER_BAN);W.remove(re.PAYMENT_RESULT)}buildPaymentItems(e){const t=[];if(e.depositAmount&&e.depositAmount>0){t.push({paymentType:"DEPOSIT",amount:e.depositAmount})}if(e.totalDownPayment&&e.totalDownPayment>0){t.push({paymentType:"DOWNPAYMENT",amount:e.totalDownPayment})}if(e.totalTax&&e.totalTax>0){const r=(e.totalPrice||0)-(e.depositAmount||0)-(e.totalDownPayment||0)-(e.installmentAmount||0);if(r>0){t.push({paymentType:"TAXES",amount:Number(r.toFixed(2))})}}if(e.cartUpdateResponse?.acceletartedAmount){t.push({paymentType:"INSTALLMENT",amount:e.cartUpdateResponse.acceletartedAmount})}return t}calculateTotalAmount(e){return e.reduce(((e,t)=>e+t.amount),0)}}const oe=new ae;const ie=()=>`@keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes slideUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}@keyframes spin{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}:host{display:block;width:100%;font-family:"AMX", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, sans-serif;color:#333333;line-height:1.5}.fsf-container{width:100%;max-width:1200px;margin:0 auto;padding:1rem}@media (min-width: 768px){.fsf-container{padding:1.5rem}}.fsf-loading{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:300px;padding:2rem}.fsf-loading__spinner{width:48px;height:48px;border:4px solid #E5E5E5;border-top-color:#0097A9;border-radius:50%;animation:spin 1s linear infinite}.fsf-loading__text{margin-top:1rem;font-size:1rem;font-weight:400;line-height:1.5;color:#666666}.fsf-error{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:300px;padding:2rem;text-align:center}.fsf-error__icon{display:flex;align-items:center;justify-content:center;width:64px;height:64px;font-size:1.75rem;font-weight:700;color:#FFFFFF;background-color:#DA291C;border-radius:50%}.fsf-error__title{margin-top:1rem;font-size:1.5rem;font-weight:600;line-height:1.35;color:#333333}.fsf-error__message{margin-top:0.5rem;font-size:1rem;font-weight:400;line-height:1.5;color:#666666;max-width:400px}.fsf-error__button{display:inline-flex;align-items:center;justify-content:center;gap:0.5rem;padding:0 1.5rem;font-family:"AMX", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, sans-serif;font-size:1rem;font-weight:600;line-height:1;text-decoration:none;border:none;border-radius:9999px;cursor:pointer;transition:all 150ms ease}.fsf-error__button:disabled{opacity:0.5;cursor:not-allowed}.fsf-error__button{height:48px;background-color:#DA291C;color:#FFFFFF}.fsf-error__button:hover:not(:disabled){background-color:rgb(181.843902439, 34.2, 23.356097561)}.fsf-error__button:active:not(:disabled){background-color:rgb(163.7658536585, 30.8, 21.0341463415)}.fsf-error__button{margin-top:1.5rem}.step-placeholder{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:400px;padding:2rem;text-align:center;background:#FFFFFF;border-radius:0.75rem;box-shadow:0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);margin:1rem}.step-placeholder h2{font-size:1.75rem;font-weight:700;line-height:1.2;color:#333333;margin-bottom:1rem}.step-placeholder p{font-size:1rem;font-weight:400;line-height:1.5;color:#666666;margin-bottom:1.5rem}.step-placeholder button{display:inline-flex;align-items:center;justify-content:center;gap:0.5rem;padding:0 1.5rem;font-family:"AMX", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, sans-serif;font-size:1rem;font-weight:600;line-height:1;text-decoration:none;border:none;border-radius:9999px;cursor:pointer;transition:all 150ms ease}.step-placeholder button:disabled{opacity:0.5;cursor:not-allowed}.step-placeholder button{height:48px;background-color:#DA291C;color:#FFFFFF}.step-placeholder button:hover:not(:disabled){background-color:rgb(181.843902439, 34.2, 23.356097561)}.step-placeholder button:active:not(:disabled){background-color:rgb(163.7658536585, 30.8, 21.0341463415)}.step-placeholder button{margin:0.5rem}.step-placeholder button:last-child{display:inline-flex;align-items:center;justify-content:center;gap:0.5rem;padding:0 1.5rem;font-family:"AMX", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, sans-serif;font-size:1rem;font-weight:600;line-height:1;text-decoration:none;border:none;border-radius:9999px;cursor:pointer;transition:all 150ms ease}.step-placeholder button:last-child:disabled{opacity:0.5;cursor:not-allowed}.step-placeholder button:last-child{height:48px;background-color:#0097A9;color:#FFFFFF}.step-placeholder button:last-child:hover:not(:disabled){background-color:rgb(0, 114.5455621302, 128.2)}.step-placeholder button:last-child:active:not(:disabled){background-color:rgb(0, 96.3183431953, 107.8)}@keyframes spin{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}`;const ne={LOCATION:1,CATALOGUE:2,PRODUCT_DETAIL:3,PLANS:4,ORDER_SUMMARY:5,SHIPPING:6,PAYMENT:7,CONFIRMATION:8};const se=5;const ce=8;const le=class{constructor(e){r(this,e);this.flowComplete=a(this,"flowComplete");this.flowError=a(this,"flowError");this.flowCancel=a(this,"flowCancel");this.stepChange=a(this,"stepChange")}apiUrl;googleMapsKey;correlationId;initialStep=1;debug=false;currentStep=1;isLoading=true;error=null;isInitialized=false;flowComplete;flowError;flowCancel;stepChange;handleApiUrlChange(e){if(e){k.setBaseUrl(e)}}async componentWillLoad(){if(this.debug){window.__FSF_DEBUG__=true}if(this.apiUrl){k.setBaseUrl(this.apiUrl)}if(this.initialStep){this.currentStep=this.initialStep;_.setStep(this.initialStep)}await this.initializeToken()}componentDidLoad(){this.log("Component loaded")}disconnectedCallback(){this.log("Component disconnected")}async initializeToken(){this.isLoading=true;this.error=null;try{const e=await S.initialize();if(!e){this.error="Error al inicializar la sesión";this.emitError(new Error(this.error),false)}this.isInitialized=true}catch(e){this.error=e.message||"Error de inicialización";this.emitError(e,false)}finally{this.isLoading=false}}handleStepChange=e=>{const t=this.currentStep;const r=this.isClaroHogar()?ce:se;let a;if(e==="forward"){a=Math.min(this.currentStep+1,r);_.nextStep()}else{a=Math.max(this.currentStep-1,1);_.prevStep()}this.currentStep=a;_.setStep(a);this.stepChange.emit({from:t,to:a,direction:e});this.log(`Step changed: ${t} -> ${a}`)};_goToStep=e=>{const t=this.currentStep;const r=e>t?"forward":"backward";_.setStep(e);this.currentStep=e;this.stepChange.emit({from:t,to:e,direction:r});this.log(`Step changed: ${t} -> ${e}`)};handleFlowComplete=e=>{this.log("Flow completed",e);this.flowComplete.emit(e)};handleFlowCancel=()=>{this.log("Flow cancelled");_.resetFlow();this.currentStep=1;_.setStep(1);this.flowCancel.emit()};emitError(e,t=true){this.flowError.emit({step:this.currentStep,error:e,recoverable:t})}log(...e){if(this.debug){console.log("[FixedServiceFlow]",...e)}}isClaroHogar(){const e=g.location?.serviceType?.toUpperCase();return e==="CLARO HOGAR"}renderStep(){const e={onNext:()=>this.handleStepChange("forward"),onBack:()=>this.handleStepChange("backward"),onComplete:this.handleFlowComplete,googleMapsKey:this.googleMapsKey};if(this.isClaroHogar()){this.log("CLARO HOGAR flow - step:",this.currentStep);return this.renderClaroHogarStep(e)}return this.renderStandardStep(e)}renderStandardStep(e){switch(this.currentStep){case 1:return o("step-location",{...e});case 2:return o("step-plans",{...e});case 3:return o("step-contract",{...e});case 4:return o("step-form",{...e});case 5:return o("step-confirmation",{...e,onCancel:this.handleFlowCancel});default:return null}}renderClaroHogarStep(e){switch(this.currentStep){case ne.LOCATION:return o("step-location",{...e});case ne.CATALOGUE:return o("step-catalogue",{...e});case ne.PRODUCT_DETAIL:return o("step-product-detail",{...e});case ne.PLANS:return o("step-plans",{...e});case ne.ORDER_SUMMARY:return o("step-order-summary",{...e});case ne.SHIPPING:return o("step-shipping",{...e});case ne.PAYMENT:return o("step-payment",{...e});case ne.CONFIRMATION:return o("step-confirmation",{...e,onCancel:this.handleFlowCancel});default:return null}}renderLoading(){return o("div",{class:"fsf-loading"},o("div",{class:"fsf-loading__spinner"}),o("p",{class:"fsf-loading__text"},"Cargando..."))}renderError(){return o("div",{class:"fsf-error"},o("div",{class:"fsf-error__icon"},"!"),o("h3",{class:"fsf-error__title"},"Error"),o("p",{class:"fsf-error__message"},this.error),o("button",{class:"fsf-error__button",onClick:()=>this.initializeToken()},"Reintentar"))}render(){if(this.isLoading){return o(i,null,this.renderLoading())}if(this.error&&!this.isInitialized){return o(i,null,this.renderError())}return o(i,null,o("div",{class:"fsf-container"},this.renderStep()))}static get watchers(){return{apiUrl:["handleApiUrlChange"]}}};le.style=ie();const de=()=>`@keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes slideUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}@keyframes spin{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}:host{display:block}.step-catalogue{width:100%;padding:0 1rem}.container-filter{display:grid;grid-gap:10px;padding:20px 0;align-items:center;justify-content:space-between;border-bottom:1px solid #DBDBDB;grid-template-columns:auto 1fr auto}@media (max-width: 991px){.container-filter{grid-template-columns:1fr;gap:15px}}.filter-title-main{margin:0;font-size:24px;font-weight:700;color:#333333}@media (max-width: 991px){.filter-title-main{font-size:20px}}.filter-content{display:flex;gap:10px;align-items:center;justify-content:flex-end}@media (max-width: 991px){.filter-content{width:100%}}.input-filter-wrapper{position:relative;display:flex;align-items:center;width:300px}@media (max-width: 991px){.input-filter-wrapper{flex:1;width:auto}}.search-icon{position:absolute;left:12px;width:20px;height:20px;color:#999999}.input-filter{width:100%;height:40px;padding:8px 12px 8px 40px;font-size:16px;border:1px solid #DBDBDB;border-radius:12px;outline:none;transition:border-color 0.2s}.input-filter:focus{border-color:#DA291C}.input-filter::placeholder{color:#999999}.btn-search{height:40px;padding:0 24px;background:#DA291C;color:#FFFFFF;border:none;border-radius:22px;font-size:16px;font-weight:700;cursor:pointer;white-space:nowrap;transition:background-color 0.2s}.btn-search:hover{background:rgb(181.843902439, 34.2, 23.356097561)}@media (max-width: 767px){.btn-search{padding:0 16px;font-size:14px}}.btn-hidden-filter{display:flex;align-items:center;gap:8px;height:40px;padding:0 16px;background:transparent;color:#0097A9;border:1px solid #0097A9;border-radius:22px;font-size:14px;font-weight:600;cursor:pointer;transition:all 0.2s}.btn-hidden-filter:hover{background:rgba(0, 151, 169, 0.1)}.btn-hidden-filter .filter-icon{width:16px;height:16px}@media (max-width: 991px){.btn-hidden-filter{display:none}}.catalogue-content{display:grid;grid-template-columns:280px 1fr;gap:24px;padding:20px 0}@media (max-width: 1199px){.catalogue-content{grid-template-columns:240px 1fr}}@media (max-width: 991px){.catalogue-content{grid-template-columns:1fr}}.filter-container{border-radius:12px;border:1px solid #DBDBDB;background:#FFFFFF;height:fit-content}@media (max-width: 991px){.filter-container{display:none !important}}.filter-header{padding:20px;display:flex;align-items:baseline;justify-content:space-between;border-bottom:1px solid #DBDBDB}.filter-title{margin:0;font-size:24px;font-weight:700;color:#333333}.reset-filter{margin:0;color:#0097A9;cursor:pointer;font-size:14px;font-weight:700;text-decoration:none}.reset-filter:hover{text-decoration:underline}.filter-result{padding:20px;border-bottom:1px solid #DBDBDB}.filter-result .result{margin:0;font-size:14px;font-weight:700;color:#666666}.filter-type-product{border-bottom:1px solid #DBDBDB}.filter-type-product:last-child{border-bottom:none}.filter-type-title{display:flex;padding:20px;cursor:pointer;align-items:center;justify-content:space-between}.filter-title-section{margin:0;font-size:16px;font-weight:700;color:#333333}.chevron-icon{width:20px;height:20px;color:#666666}.slot-radio{padding:0 20px 20px}.radio-group{display:flex;flex-direction:column;gap:12px}.radio-button{display:flex;align-items:center;gap:10px;cursor:pointer}.radio-button input[type=radio]{width:18px;height:18px;accent-color:#0097A9;cursor:pointer}.radio-button .radio-label{font-size:14px;color:#333333}.products-section{min-height:400px}.loading-container{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:400px;padding:2rem;background:rgba(255, 255, 255, 0.95);border-radius:16px}.loading-container p{margin-top:1rem;font-size:18px;font-weight:600;color:#333333}.error-container,.empty-container{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:300px;color:#666666}.error-container p,.empty-container p{margin-top:1rem;font-size:16px}.error-container button,.empty-container button{margin-top:1rem;padding:8px 24px;background:#0097A9;color:#FFFFFF;border:none;border-radius:20px;cursor:pointer}.spinner{width:48px;height:48px;border:4px solid #E5E5E5;border-top-color:#DA291C;border-radius:50%;animation:spin 1s linear infinite}@keyframes spin{to{transform:rotate(360deg)}}.container-product{display:grid;grid-gap:1.5rem;align-items:stretch;grid-template-columns:1fr 1fr 1fr}@media (max-width: 1399px){.container-product{grid-template-columns:1fr 1fr}}@media (max-width: 767px){.container-product{grid-template-columns:1fr}}.container-product-filter-off{grid-template-columns:1fr 1fr 1fr 1fr}@media (max-width: 1399px){.container-product-filter-off{grid-template-columns:1fr 1fr 1fr}}@media (max-width: 1199px){.container-product-filter-off{grid-template-columns:1fr 1fr}}@media (max-width: 767px){.container-product-filter-off{grid-template-columns:1fr}}.new-product-item{width:100%;height:100%;overflow:hidden;position:relative;border-radius:12px;border:solid 1px #dbdbdb;background:#FFFFFF;box-shadow:2px 3px 27px -3px rgb(211, 211, 211);transition:transform 0.2s, box-shadow 0.2s;display:flex;flex-direction:column}.new-product-item:hover{transform:translateY(-2px);box-shadow:2px 6px 32px -3px rgb(180, 180, 180)}.new-product-item__top{display:grid;margin-top:20px;position:relative;grid-column-gap:16px;padding:16px 16px 8px;grid-template-columns:1fr 2fr}@media (max-width: 1199px){.new-product-item__top{display:flex;flex-direction:column}}.new-product-item__img{display:flex;align-items:center;justify-content:center}.new-product-item__img img{max-width:100%;max-height:120px;object-fit:contain}@media (max-width: 1199px){.new-product-item__img{width:100px;margin:0 auto 16px}}.new-product-item__info .title{margin-top:10px;color:#3c3c3c;font-size:18px;font-weight:700;line-height:24px;margin-bottom:16px;font-family:Roboto, sans-serif}@media (max-width: 1199px){.new-product-item__info .title{margin-top:0;font-size:16px;min-height:48px}}.new-product-item__info .financed-price .financed-price-text{margin-top:4px;color:#3c3c3c;font-size:16px;font-weight:700;line-height:16px}.new-product-item__info .financed-price .financed-price__value{color:#DA291C;font-size:18px;font-weight:700;line-height:24px}.new-product-item__info .financed-price .installments-text{color:#3c3c3c;font-size:14px;font-weight:700;line-height:16px}.new-product-item__info .regular-price{color:#6c6c6c;font-size:14px;font-weight:400;margin-top:10px;line-height:16px}.container-colors{display:flex;gap:8px;padding:10px 25px 15px;flex-wrap:wrap}.color-dot{width:14px;height:14px;border-radius:50%;border:1px solid #3c3c3c;cursor:pointer}.color-dot:active{transform:scale(0.95)}.new-product-item__middle{padding:15px;color:#3c3c3c;min-height:65px;font-size:14px;line-height:1.4;border-top:2px solid #dbdbdb;border-bottom:2px solid #dbdbdb;flex-grow:1}.new-product-item__middle .description-text{display:block}.new-product-item__middle .see-detail{display:inline-block;margin-top:8px;font-size:14px;color:#0097A9;cursor:pointer;text-decoration:underline}.new-product-item__bottom{padding:1rem;display:flex;justify-content:center;align-items:center}.action-button{color:#DA291C;text-align:center;font-size:16px;font-weight:700;line-height:16px;border:solid 1px #DA291C;border-radius:30px;padding:0.5rem 2.5rem;background:transparent;cursor:pointer;transition:all 0.2s}.action-button:hover{background-color:#DA291C;color:#FFFFFF}.back-button-container{display:flex;justify-content:center;padding:24px 0 40px}.btn-back{padding:12px 32px;background:transparent;color:#0097A9;border:2px solid #0097A9;border-radius:30px;font-size:16px;font-weight:600;cursor:pointer;transition:all 0.2s}.btn-back:hover{background:#0097A9;color:#FFFFFF}.modal-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0, 0, 0, 0.5);display:flex;align-items:center;justify-content:center;z-index:1000;padding:20px}.modal-content{position:relative;background:#FFFFFF;border-radius:12px;max-width:500px;width:100%;max-height:80vh;overflow:hidden;box-shadow:0 4px 20px rgba(0, 0, 0, 0.15);animation:modalFadeIn 0.2s ease-out}@keyframes modalFadeIn{from{opacity:0;transform:scale(0.95)}to{opacity:1;transform:scale(1)}}.modal-close{position:absolute;top:12px;right:12px;width:32px;height:32px;background:transparent;border:none;border-radius:50%;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:background 0.2s}.modal-close svg{width:20px;height:20px;color:#3c3c3c}.modal-close:hover{background:#f0f0f0}.modal-title{padding:20px;padding-right:50px;border-bottom:1px solid #dbdbdb;color:#3c3c3c;font-size:20px;font-weight:700;line-height:1.3}.modal-title .modal-subtitle{font-size:14px;font-weight:500;color:#6c6c6c;margin-bottom:8px}@media (max-width: 767px){.modal-title{font-size:18px;padding:16px;padding-right:45px}}.modal-body{padding:20px;max-height:300px;overflow-y:auto;scrollbar-width:thin;scrollbar-color:#ccc transparent}.modal-body::-webkit-scrollbar{width:6px}.modal-body::-webkit-scrollbar-track{background:transparent}.modal-body::-webkit-scrollbar-thumb{background:#ccc;border-radius:3px}.modal-text{margin:0;color:#3c3c3c;font-size:16px;font-weight:400;line-height:1.5;text-align:justify}@media (max-width: 767px){.modal-text{font-size:14px}}`;const pe=class{constructor(e){r(this,e)}onNext;onBack;products=[];filteredProducts=[];isLoading=true;error=null;searchText="";selectedFilter="";showFilters=true;filterOptions=[];showDetailModal=false;modalTitle="";modalContent="";componentWillLoad(){this.filterOptions=j.getProductTypeFilters();this.selectedFilter=j.FILTER_INTERNET_INALAMBRICO}componentDidLoad(){this.loadProducts()}async loadProducts(){this.isLoading=true;this.error=null;try{const e=await j.listCatalogue(this.selectedFilter,1,this.searchText);this.products=e.products||[];this.filteredProducts=this.products}catch(e){console.error("[StepCatalogue] Error loading products:",e);this.error="Error al cargar el catálogo de productos"}finally{this.isLoading=false}}handleFilterChange=async e=>{this.selectedFilter=e;await this.loadProducts()};handleSearchInput=e=>{this.searchText=e.target.value};handleSearch=async()=>{await this.loadProducts()};handleKeyPress=e=>{if(e.key==="Enter"){this.handleSearch()}};_toggleFilters=()=>{this.showFilters=!this.showFilters};clearFilters=()=>{this.selectedFilter=j.FILTER_INTERNET_INALAMBRICO;this.searchText="";this.loadProducts()};handleViewMore=e=>{const t=parseInt(this.selectedFilter,10);j.storeProductInSession(e);Y.storeSelectedProduct(e,t);console.log("[StepCatalogue] Product selected:",e.productName,"subcatalogId:",t);this.onNext?.()};cleanHTML(e){return j.cleanDescription(e)}getSelectedFilterCount(){return this.selectedFilter?1:0}handleSeeDetail=e=>{const t=this.cleanHTML(e.shortDescription||"");this.modalTitle=e.productName;this.modalContent=t;this.showDetailModal=true};closeDetailModal=()=>{this.showDetailModal=false;this.modalTitle="";this.modalContent=""};renderFilterSidebar(){const e=this.getSelectedFilterCount();return o("aside",{class:"filter-container",style:{display:this.showFilters?"block":"none"}},o("div",{class:"filter-header"},o("span",{class:"filter-title"},"Filtrar por:"),o("a",{class:"reset-filter",onClick:this.clearFilters},"Limpiar filtros")),o("div",{class:"filter-result"},o("p",{class:"result"},e>0?`filtros seleccionados (${e})`:"Ningún filtro seleccionado")),o("div",{class:"filter-type-product"},o("div",{class:"filter-type-title"},o("h4",{class:"filter-title-section"},"Tipo de producto"),o("svg",{class:"chevron-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},o("polyline",{points:"6 9 12 15 18 9"}))),o("div",{class:"slot-radio"},o("div",{class:"radio-group"},this.filterOptions.map((e=>o("label",{class:"radio-button"},o("input",{type:"radio",name:"productType",value:e.value,checked:this.selectedFilter===e.value,onChange:()=>this.handleFilterChange(e.value)}),o("span",{class:"radio-label"},e.label))))))))}renderProductCard(e){const t=this.cleanHTML(e.shortDescription||"");const r=j.truncateText(t,80);return o("div",{class:"new-product-item"},o("div",{class:"new-product-item__top"},o("div",{class:"new-product-item__img"},o("img",{src:e.imgUrl,alt:e.productName,loading:"lazy"})),o("div",{class:"new-product-item__info"},o("div",{class:"title"},e.productName),e.installments>0&&o("div",{class:"financed-price"},o("div",{class:"financed-price-text"},"Financiado"),o("div",{class:"financed-price__value"},"$",e.update_price?.toFixed(2)||"0.00","/mes"),o("div",{class:"installments-text"},e.installments," Plazos")),o("div",{class:"regular-price"},"Precio regular: $",e.regular_price?.toFixed(2)||"0.00"))),e.colors&&e.colors.length>0&&o("div",{class:"container-colors"},e.colors.map((e=>o("div",{class:"color-dot",style:{backgroundColor:e.webColor}})))),o("div",{class:"new-product-item__middle"},t?o("span",{class:"description-text"},r,t.length>80&&o("a",{class:"see-detail",onClick:t=>{t.stopPropagation();this.handleSeeDetail(e)}},"Ver detalle")):o("span",{class:"description-text"}," ")),o("div",{class:"new-product-item__bottom"},o("button",{class:"action-button",onClick:()=>this.handleViewMore(e)},"Ver más")))}render(){const e=this.selectedFilter===j.FILTER_INTERNET_INALAMBRICO?"Internet Inalámbrico":"Internet + Telefonía";return o(i,{key:"1d039e0886b26c3b2d248b58dc19eba3e95b39dd"},o("div",{key:"0fea0f07a26ab17953f23c3205f2c328ef1c9a54",class:"step-catalogue"},o("div",{key:"d5517730f8f9bedc0f09fbf0a51cfd3a18dc3dce",class:"container-filter"},o("h1",{key:"8ff3960af6aaccfc4dccab2432e95db8f534b14f",class:"filter-title-main"},e),o("div",{key:"50173802907da0d15f13201412db24e0f817bf99",class:"filter-content"},o("div",{key:"18f2bc15ebd502525768b79bba73d13d239dc2ef",class:"input-filter-wrapper"},o("svg",{key:"5ac2b02cf6691d7c138bdc8d6618778c4202da53",class:"search-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},o("circle",{key:"5bc9fbf6d6194a87a03b976a80c4c13a85823252",cx:"11",cy:"11",r:"8"}),o("path",{key:"4723e015a9c94331741bed88d873c2a536a31834",d:"m21 21-4.35-4.35"})),o("input",{key:"799681d42ba267c147e477c8f4f645d51069fa50",type:"text",class:"input-filter",placeholder:"Buscar articulo",value:this.searchText,onInput:this.handleSearchInput,onKeyPress:this.handleKeyPress})),o("button",{key:"9d13777022d9949eb4245034f38533373ef0db05",class:"btn-search",onClick:this.handleSearch},"Buscar"))),o("div",{key:"343c9edbe94686e15f21affec70a3f68ed5965f8",class:"catalogue-content"},this.renderFilterSidebar(),o("div",{key:"d51f10033f77682dc03d8d958cf004d574838954",class:"products-section"},this.isLoading&&o("div",{key:"1542625375f5d2b265bbecff44ab65468c6d4f4d",class:"loading-container"},o("div",{key:"b48473e6d22f9a536cf7b9c6d9d4a839e34c23a3",class:"spinner"}),o("p",{key:"702f744448fd22ec0d409d793c129356190dc195"},"Cargando productos...")),this.error&&!this.isLoading&&o("div",{key:"b82d6659d975570d777397909715cc488f97dbe5",class:"error-container"},o("p",{key:"5c0d488ed32e225157052291c5f495188c06e400"},this.error),o("button",{key:"fddf301ab62cffc59b0842a551052c4cddfd254f",onClick:()=>this.loadProducts()},"Reintentar")),!this.isLoading&&!this.error&&o("div",{key:"24aaff67c25f41f0bc71b5ce07e9a87f64638896",class:{"container-product":true,"container-product-filter-off":!this.showFilters}},this.filteredProducts.map((e=>this.renderProductCard(e)))),!this.isLoading&&!this.error&&this.filteredProducts.length===0&&o("div",{key:"5ae49ef2980aab9518bdf6694a4960e0838cd5f4",class:"empty-container"},o("p",{key:"220c85131df9697d53d68d3ec621a067d44ad649"},"No hay productos disponibles para esta categoría")))),o("div",{key:"1c759d41bf1b1dac3ef539c3ef36623723035494",class:"back-button-container"},o("button",{key:"28b296115d047f38f0311fdaebf43d595154a599",class:"btn-back",onClick:this.onBack},"Regresar"))),this.showDetailModal&&o("div",{key:"02995010245195e6520bda1264d2fe2efb7fc0ae",class:"modal-overlay",onClick:this.closeDetailModal},o("div",{key:"f966900e2d3cd3a2f0e7a72cf2a128c35e60b1b3",class:"modal-content",onClick:e=>e.stopPropagation()},o("button",{key:"a762de75addd97999a2f9650ed00b57278607f21",class:"modal-close",onClick:this.closeDetailModal},o("svg",{key:"fc2a4e5bdc6bea5020f478b702c485a358c5e281",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},o("line",{key:"d1b8b336ee9d0f39770e1707deaa2b19d312ec33",x1:"18",y1:"6",x2:"6",y2:"18"}),o("line",{key:"7fc1ea360318bd51f315964e2149488a9f648bd6",x1:"6",y1:"6",x2:"18",y2:"18"}))),o("div",{key:"d91d7d8e23e652f3b7e6077271235b2add677d8b",class:"modal-title"},o("div",{key:"711ea47e08e5fd17bfa30979a8373bcce66553e8",class:"modal-subtitle"},"Descripción completa"),this.modalTitle),o("div",{key:"0cfbd7a95944d5a96504699156d9a0377de59296",class:"modal-body"},o("p",{key:"1cb734b48ec1cd332fc5074e790df3e42759ee4e",class:"modal-text"},this.modalContent)))))}};pe.style=de();const ue=()=>`@keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes slideUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}@keyframes spin{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}:host{display:block}.step-confirmation{width:100%}.step-confirmation__header{margin-bottom:1.5rem;padding-bottom:1rem;position:relative}.step-confirmation__header::after{content:"";position:absolute;bottom:0;left:50%;transform:translateX(-50%);width:100vw;height:1px;background:#E5E5E5}.step-confirmation__header-title{font-size:1.75rem;font-weight:700;line-height:1.2;color:#333333}.step-confirmation__content{background-color:#FFFFFF;border:1px solid #E5E5E5;border-radius:0.75rem;box-shadow:0 2px 8px rgba(0, 0, 0, 0.08);transition:box-shadow 150ms ease, border-color 150ms ease;padding:3rem 2rem;text-align:center;min-height:300px;display:flex;flex-direction:column;align-items:center;justify-content:center}.step-confirmation__loading{display:flex;flex-direction:column;align-items:center;justify-content:center}.step-confirmation__loading p{margin-top:1rem;font-size:1rem;font-weight:400;line-height:1.5;color:#666666}.step-confirmation__spinner{width:48px;height:48px;border:4px solid #E5E5E5;border-top-color:#0097A9;border-radius:50%;animation:spin 1s linear infinite}.step-confirmation__result{display:flex;flex-direction:column;align-items:center;justify-content:center;width:100%;max-width:500px}.step-confirmation__icon{display:flex;align-items:center;justify-content:center;margin-bottom:1rem}.step-confirmation__icon img{width:48px;height:48px}.step-confirmation__icon svg{width:40px;height:40px}.step-confirmation__title{font-size:1.5rem;font-weight:600;line-height:1.35;color:#333333;margin-bottom:0.5rem}.step-confirmation__title--success{color:#15A045}.step-confirmation__title--error{color:#E00814}.step-confirmation__message{font-size:1rem;font-weight:400;line-height:1.5;color:#666666;margin-bottom:1.5rem}.step-confirmation__order-id{font-size:0.875rem;font-weight:400;line-height:1.5;color:#666666;margin-bottom:1.5rem;padding:0.5rem 1rem;background:#FAFAFA;border-radius:0.5rem}.step-confirmation__actions{margin-top:1.5rem;text-align:center}.step-confirmation__btn{display:inline-flex;align-items:center;justify-content:center;gap:0.5rem;padding:0 1.5rem;font-family:"AMX", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, sans-serif;font-size:1rem;font-weight:600;line-height:1;text-decoration:none;border:none;border-radius:9999px;cursor:pointer;transition:all 150ms ease}.step-confirmation__btn:disabled{opacity:0.5;cursor:not-allowed}.step-confirmation__btn{height:48px;background-color:transparent;color:#0097A9;border:2px solid #0097A9}.step-confirmation__btn:hover:not(:disabled){background-color:rgba(0, 151, 169, 0.1)}.step-confirmation__btn:active:not(:disabled){background-color:rgba(0, 151, 169, 0.2)}.step-confirmation__btn{min-width:180px}.step-confirmation__btn--error{display:inline-flex;align-items:center;justify-content:center;gap:0.5rem;padding:0 1.5rem;font-family:"AMX", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, sans-serif;font-size:1rem;font-weight:600;line-height:1;text-decoration:none;border:none;border-radius:9999px;cursor:pointer;transition:all 150ms ease}.step-confirmation__btn--error:disabled{opacity:0.5;cursor:not-allowed}.step-confirmation__btn--error{height:48px;background-color:#DA291C;color:#FFFFFF}.step-confirmation__btn--error:hover:not(:disabled){background-color:rgb(181.843902439, 34.2, 23.356097561)}.step-confirmation__btn--error:active:not(:disabled){background-color:rgb(163.7658536585, 30.8, 21.0341463415)}@keyframes spin{to{transform:rotate(360deg)}}`;const he=class{constructor(e){r(this,e)}onComplete;onCancel;onBack;status="loading";orderId=null;orderNumber=null;confirmationSent=false;errorMessage="";async componentWillLoad(){const e=this.isCatalogueFlow();if(e){await this.handleCatalogueFlowConfirmation()}else{await this.submitRequest()}}isCatalogueFlow(){const e=oe.getPaymentResult();const t=!!g.selectedContract;const r=!!g.formData;return!!e&&!t&&!r}async handleCatalogueFlowConfirmation(){this.status="loading";try{const e=oe.getPaymentResult();if(!e||!e.success){throw new Error("No se encontró información del pago")}const t=oe.getOrderBan();this.orderId=t||e.operationId||null;console.log("[StepConfirmation] Catalogue flow - payment success:",{orderId:this.orderId,operationId:e.operationId,authorizationNumber:e.authorizationNumber});this.status="success";_.setOrderResult(this.orderId,null);this.onComplete?.({orderId:this.orderId,plan:g.selectedPlan,contract:null,customer:null,location:g.location})}catch(e){console.error("[StepConfirmation] Catalogue flow error:",e);this.status="error";this.errorMessage=e.message||O.REQUEST_ERROR;_.setOrderResult(null,this.errorMessage)}}async submitRequest(){this.status="loading";try{const{location:e,plan:t,contract:r,formData:a}={location:g.location,plan:g.selectedPlan,contract:g.selectedContract,formData:g.formData};const o=N.validateSubmissionData(a,r,t,e);if(!o.isValid){throw new Error(`Datos incompletos: ${o.missingFields.join(", ")}`)}const i=N.buildPayload(a,r,t,e);const n=await N.submitRequest(i);if(n.hasError){throw new Error(n.errorDisplay||n.message||O.REQUEST_ERROR)}this.orderId=n.orderId||null;if(this.orderId){this.fetchOrderDetails(this.orderId);this.sendConfirmationEmail(this.orderId,a.personal.email)}this.status="success";_.setOrderResult(this.orderId,null);this.onComplete?.({orderId:this.orderId,plan:t,contract:r,customer:a,location:e})}catch(e){console.error("Request submission failed:",e);this.status="error";this.errorMessage=e.message||O.REQUEST_ERROR;_.setOrderResult(null,this.errorMessage)}}async fetchOrderDetails(e){try{const t=await N.getOrder(e);if(!t.hasError&&t.orderNumber){this.orderNumber=t.orderNumber}}catch(e){console.warn("Could not fetch order details:",e)}}async sendConfirmationEmail(e,t){try{const r=await N.sendConfirmation(e,t);if(!r.hasError&&r.sent){this.confirmationSent=true}}catch(e){console.warn("Could not send confirmation email:",e)}}handleRetry=()=>{this.submitRequest()};handleClose=()=>{this.clearSessionStorage();_.resetFlow();this.onCancel?.()};clearSessionStorage(){console.log("[StepConfirmation] Clearing all sessionStorage data");try{V.clearCartSession();Y.clearProductSession();te.clearShippingData();oe.clearPaymentData();D.clearPlan();_.clearToken()}catch(e){console.warn("[StepConfirmation] Error clearing service data:",e)}const e=["token","correlationId","latitud","longitud","planCodeInternet","plan","planId","planPrice","typeContractId","contractInstallment","contractInstallation","contractActivation","contractModen","cart","cartId","cartTotal","cartProducts","mainId","discountCoupon","selectedProduct","productId","subcatalogId","selectedColor","selectedStorage","childrenId","parentId","deviceType","shipmentId","zipCode","shippingAddress","deliveryMethod","orderBan","paymentResult","serviceLatitude","serviceLongitude","serviceAddress","serviceCity","serviceZipCode","serviceType","serviceMessage","planName","planSoc","planFeatures","customerFirstName","customerSecondName","customerLastName","customerSecondLastName","customerIdType","customerIdNumber","customerIdExpiration","customerPhone1","customerPhone2","customerEmail","customerBirthDate","businessName","businessPosition","isExistingCustomer","shoppingCart"];e.forEach((e=>{sessionStorage.removeItem(e)}));console.log("[StepConfirmation] SessionStorage cleared successfully")}renderLoading(){return o("div",{class:"step-confirmation__loading"},o("div",{class:"step-confirmation__spinner"}),o("p",null,"Procesando tu solicitud..."))}renderSuccess(){const e=this.orderNumber||this.orderId;return o("div",{class:"step-confirmation__result step-confirmation__result--success"},o("div",{class:"step-confirmation__icon step-confirmation__icon--success"},o("svg",{width:"49",height:"48",viewBox:"0 0 49 48",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o("path",{d:"M24.4237 2C12.0492 2 2 11.8441 2 23.9661C2 36.0881 12.0492 45.9322 24.4237 45.9322C36.7983 45.9322 46.8475 36.0881 46.8475 23.9661",stroke:"#0EA651","stroke-width":"4","stroke-miterlimit":"10","stroke-linecap":"round","stroke-linejoin":"round"}),o("path",{d:"M44.5225 4.19666L21.1852 30.8L12.3818 22.2577",stroke:"#0EA651","stroke-width":"4","stroke-miterlimit":"10","stroke-linecap":"round","stroke-linejoin":"round"}))),o("h2",{class:"step-confirmation__title step-confirmation__title--success"},M.REQUEST_SUCCESS),o("p",{class:"step-confirmation__message"},M.REQUEST_SUCCESS_SUBTITLE),e&&o("p",{class:"step-confirmation__order-id"},"Número de orden: ",e),this.confirmationSent&&o("p",{class:"step-confirmation__email-sent"},"Se ha enviado un correo de confirmación a tu email."))}renderError(){return o("div",{class:"step-confirmation__result step-confirmation__result--error"},o("div",{class:"step-confirmation__icon step-confirmation__icon--error"},o("svg",{width:"49",height:"49",viewBox:"0 0 49 49",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o("path",{d:"M24.5 0C38.0096 9.05167e-07 49 10.9899 49 24.5C49 38.0101 38.0096 49 24.5 49C10.9904 49 0 38.0101 0 24.5C0 10.9899 10.99 0 24.5 0ZM24.5 3.78516C13.0775 3.78516 3.78418 13.0774 3.78418 24.5C3.78418 35.9215 13.0774 45.2148 24.5 45.2148C35.9225 45.2148 45.2158 35.922 45.2158 24.5C45.2158 13.078 35.9225 3.78516 24.5 3.78516ZM24.5 31.8809C25.5449 31.8809 26.3915 32.7276 26.3916 33.7725V35.3486C26.3916 36.3936 25.5449 37.2412 24.5 37.2412C23.4551 37.2412 22.6084 36.3936 22.6084 35.3486V33.7725C22.6085 32.7276 23.4551 31.8809 24.5 31.8809ZM24.5 11.7588C25.5449 11.7588 26.3915 12.6055 26.3916 13.6504V27.7725C26.3916 28.8174 25.5449 29.6641 24.5 29.6641C23.4551 29.6641 22.6084 28.8174 22.6084 27.7725V13.6504C22.6085 12.6055 23.4551 11.7588 24.5 11.7588Z",fill:"#B41E13"}))),o("h2",{class:"step-confirmation__title step-confirmation__title--error"},"¡Lo sentimos, ha ocurrido un error en el proceso de solicitud!"),o("p",{class:"step-confirmation__message"},"En este momento estamos presentando inconvenientes en nuestro sistema.",o("br",null),"Por favor, inténtalo nuevamente."))}render(){return o(i,{key:"e0eceafd99b97d025bd5f35e3df9f4ee4230e464"},o("div",{key:"5eee1e9849c360af57aedf8c814f08f4ebc7dfef",class:"step-confirmation"},o("header",{key:"ba063cc7fe7b1ce5415c728fd545db9c7285888e",class:"step-confirmation__header"},o("h1",{key:"9774de7b3e8a2676ac166dc37b41c8e38fe078a5",class:"step-confirmation__header-title"},"Confirmación de Solicitud")),o("div",{key:"b09c1a71dc5d00c76dbbb53607614ddf662b792a",class:"step-confirmation__content"},this.status==="loading"&&this.renderLoading(),this.status==="success"&&this.renderSuccess(),this.status==="error"&&this.renderError()),this.status==="success"&&o("div",{key:"de5c20cbb95532044a47037c1b99c4fa3687d0af",class:"step-confirmation__actions"},o("button",{key:"6613d3fd9a74882ca546b41480d0d62f4a9b061a",class:"step-confirmation__btn",onClick:this.handleClose},"Cerrar")),this.status==="error"&&o("div",{key:"09f4a1fd41e742b70b66d2ba33dcd5aec6ad4390",class:"step-confirmation__actions"},o("button",{key:"4cf91fa8b9b99c6c7c5944e20f76e2ab95695abc",class:"step-confirmation__btn step-confirmation__btn--error",onClick:this.handleRetry},"Volver a intentar"))))}};he.style=ue();const fe=(e,t=true)=>{const r={style:"currency",currency:"USD",minimumFractionDigits:t?2:0,maximumFractionDigits:t?2:0};return new Intl.NumberFormat("en-US",r).format(e)};const me=e=>fe(e);const be=e=>{const t=e.replace(/\D/g,"");if(t.length===0)return"";if(t.length<=3)return`(${t}`;if(t.length<=6)return`(${t.slice(0,3)}) ${t.slice(3)}`;return`(${t.slice(0,3)}) ${t.slice(3,6)}-${t.slice(6,10)}`};const ge=e=>e.replace(/\D/g,"").slice(0,10);const ye=()=>`@keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes slideUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}@keyframes spin{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}:host{display:block}.step-contract{width:100%}.step-contract__header{display:flex;align-items:center;justify-content:space-between;padding-bottom:1rem;margin-bottom:1rem;position:relative}.step-contract__header::after{content:"";position:absolute;bottom:0;left:50%;transform:translateX(-50%);width:100vw;height:1px;background:#E5E5E5}.step-contract__title{font-size:1.75rem;font-weight:700;line-height:1.2;color:#333333}.step-contract__btn-back{display:inline-flex;align-items:center;justify-content:center;gap:0.5rem;padding:0 1.5rem;font-family:"AMX", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, sans-serif;font-size:1rem;font-weight:600;line-height:1;text-decoration:none;border:none;border-radius:9999px;cursor:pointer;transition:all 150ms ease}.step-contract__btn-back:disabled{opacity:0.5;cursor:not-allowed}.step-contract__btn-back{height:48px;background-color:transparent;color:#0097A9;border:2px solid #0097A9}.step-contract__btn-back:hover:not(:disabled){background-color:rgba(0, 151, 169, 0.1)}.step-contract__btn-back:active:not(:disabled){background-color:rgba(0, 151, 169, 0.2)}.step-contract__btn-back{height:40px}.step-contract__tabs{display:flex;margin-bottom:1.5rem;background:#FFFFFF;border-radius:0 0 0.75rem 0.75rem;box-shadow:0 2px 4px rgba(0, 0, 0, 0.08);overflow:hidden}.step-contract__tab{flex:1;padding:1.25rem 1rem;background:transparent;border:none;cursor:pointer;text-align:center;position:relative;transition:all 150ms ease}.step-contract__tab:first-child{border-right:1px solid #E5E5E5}.step-contract__tab::after{content:"";position:absolute;bottom:0;left:0;right:0;height:4px;background:transparent;transition:background-color 150ms ease}.step-contract__tab--active::after{background:#0097A9}.step-contract__tab:hover:not(.step-contract__tab--active){background:#FAFAFA}.step-contract__tab-title{display:block;font-size:1rem;font-weight:700;color:#333333;margin-bottom:0.25rem}.step-contract__tab-subtitle{display:block;font-size:0.875rem;color:#666666;line-height:1.5}.step-contract__options{display:flex;flex-direction:column;gap:1rem;align-items:center}@media (min-width: 768px){.step-contract__options{flex-direction:row;justify-content:center}}.step-contract__options--single{justify-content:center}.step-contract__option{flex:0 0 auto;width:280px;display:flex;align-items:center;padding:1rem 1.25rem;background:#FFFFFF;border:1px solid #CCCCCC;border-radius:0.75rem;cursor:pointer;transition:all 150ms ease;position:relative;overflow:hidden}@media (max-width: 767px){.step-contract__option{width:100%;max-width:320px}}.step-contract__option::before{content:"";position:absolute;left:0;top:0;bottom:0;width:4px;background:#CCCCCC;border-radius:0.75rem 0 0 0.75rem;transition:background-color 150ms ease}.step-contract__option input[type=radio]{width:20px;height:20px;margin-right:0.75rem;accent-color:#0097A9;flex-shrink:0}.step-contract__option:hover{border-color:#999999}.step-contract__option--selected::before{background:#0097A9}.step-contract__option-content{flex:1;display:flex;flex-direction:column;gap:0.25rem}.step-contract__option-title{display:block;font-size:1rem;font-weight:600;color:#333333;line-height:1.35}.step-contract__option-price{display:block;font-size:0.875rem;color:#666666}.step-contract__option-price strong,.step-contract__option-price b{font-weight:600}.step-contract__actions{margin-top:1.5rem;padding-top:1.5rem;border-top:1px solid #E5E5E5;text-align:center}.step-contract__btn-continue{display:inline-flex;align-items:center;justify-content:center;gap:0.5rem;padding:0 1.5rem;font-family:"AMX", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, sans-serif;font-size:1rem;font-weight:600;line-height:1;text-decoration:none;border:none;border-radius:9999px;cursor:pointer;transition:all 150ms ease}.step-contract__btn-continue:disabled{opacity:0.5;cursor:not-allowed}.step-contract__btn-continue{height:48px;background-color:#DA291C;color:#FFFFFF}.step-contract__btn-continue:hover:not(:disabled){background-color:rgb(181.843902439, 34.2, 23.356097561)}.step-contract__btn-continue:active:not(:disabled){background-color:rgb(163.7658536585, 30.8, 21.0341463415)}.step-contract__btn-continue{min-width:280px;height:44px;padding:0 2rem;border-radius:22px;font-size:1rem}.step-contract__btn-continue:disabled{background-color:#999999;border-color:#999999;cursor:not-allowed;opacity:1}.step-contract__btn-continue:disabled:hover{background-color:#999999;border-color:#999999}.step-contract__btn-back-mobile{display:none;width:100%;margin-top:1rem;padding:0.5rem;background:transparent;border:none;color:#0097A9;font-size:1rem;cursor:pointer;text-decoration:none;text-align:center}.step-contract__btn-back-mobile:hover{text-decoration:underline}@media (max-width: 767px){.step-contract{padding:0 1rem}.step-contract__header{flex-direction:column;align-items:flex-start;gap:0.5rem;padding-bottom:0.75rem;margin-bottom:1rem}.step-contract__header .step-contract__title{font-size:1.25rem;line-height:1.35}.step-contract__header .step-contract__btn-back{order:-1;height:auto;padding:0.5rem 0;border:none;background:transparent;color:#0097A9;font-size:0.875rem}.step-contract__header .step-contract__btn-back:hover{background:transparent;text-decoration:underline}.step-contract__tabs{margin-bottom:1rem}.step-contract__tab{padding:0.75rem 0.5rem}.step-contract__tab-title{font-size:0.875rem}.step-contract__tab-subtitle{font-size:0.75rem;line-height:1.35}.step-contract__options{padding:0}.step-contract__option{width:100%;max-width:none}.step-contract__actions{margin-top:1rem;padding-top:1rem}.step-contract__btn-continue{width:100%;min-width:auto}.step-contract__btn-back-mobile{display:block}.step-contract__btn-back{display:none}}`;const xe=class{constructor(e){r(this,e)}onNext;onBack;activeTab=1;selectedOption=null;componentWillLoad(){this.restorePreviousSelection()}restorePreviousSelection(){if(g.selectedContract){this.selectedOption=g.selectedContract;this.activeTab=g.selectedContract.typeId;return}const e=sessionStorage.getItem("typeContractId");if(e!==null){const t=parseInt(e);const r=parseInt(sessionStorage.getItem("contractInstallment")||"0");const a=parseInt(sessionStorage.getItem("contractInstallation")||"0");const o=parseInt(sessionStorage.getItem("contractActivation")||"0");const i=parseInt(sessionStorage.getItem("contractModen")||"0");const n=A.find((e=>e.typeId===t));this.selectedOption={typeId:t,typeName:n?.type||"",deadlines:r,installation:a,activation:o,modem:i};this.activeTab=t;_.setContract(this.selectedOption)}}handleTabChange=e=>{this.activeTab=e;if(this.selectedOption?.typeId!==e){this.selectedOption=null}};handleSelectOption=(e,t)=>{const r=A.find((t=>t.typeId===e));this.selectedOption={typeId:e,typeName:r?.type||"",deadlines:t.deadlines,installation:t.installation,activation:t.activation,modem:t.modem};_.setContract(this.selectedOption)};handleContinue=()=>{if(this.selectedOption){this.onNext?.()}};getTotalInstallationCost(e){return e.installation+e.activation+e.modem}formatContractLabel(e){if(e===0)return"Sin contrato";return`${e} Meses de Contrato`}render(){const e=A.find((e=>e.typeId===1));const t=A.find((e=>e.typeId===0));return o(i,{key:"73b98b5cf5d386bb18c0b9a87de1ee94f522ae06"},o("div",{key:"da718e5fa4e5e9bd81c9e8c36b3535678d49b205",class:"step-contract"},o("header",{key:"40fda6a530e609dda8a9b20bdcbf64d765767491",class:"step-contract__header"},o("h1",{key:"8c1ff3fd242f2a6cb27e01a987a6df0ef4199b00",class:"step-contract__title"},"Selecciona un tipo de contrato"),o("button",{key:"bf9aa661368be724e6b1521663289fbfa3b9d433",class:"step-contract__btn-back",onClick:this.onBack},"Regresar")),o("div",{key:"7fef8469c756a814a1d233c00f090e545c487c96",class:"step-contract__tabs"},o("button",{key:"949bd4bc3bbb1ccbaf5bf29e6fde2f49bbbf15a7",class:{"step-contract__tab":true,"step-contract__tab--active":this.activeTab===1},onClick:()=>this.handleTabChange(1)},o("span",{key:"54a89fcfdb912495a4955c73cd62ac25fd71c69e",class:"step-contract__tab-title"},"Con contrato"),o("span",{key:"1daa33b5cb332fc2feb94f80694405f560b6b1eb",class:"step-contract__tab-subtitle"},"12 y 24 meses de contrato")),o("button",{key:"f701fb3b4d46661df2e1ca2d0016926b4507e356",class:{"step-contract__tab":true,"step-contract__tab--active":this.activeTab===0},onClick:()=>this.handleTabChange(0)},o("span",{key:"5ac2103a653ebf3cc0d64d29b351c5ebe27ff855",class:"step-contract__tab-title"},"Sin contrato"),o("span",{key:"5f959ccb57f11053f15f68f2ce3fb23805a0188b",class:"step-contract__tab-subtitle"},"Plan mensual con pago por adelantado"))),o("div",{key:"c19ec6ec322d7547eb1afcbb860297ee4912d172",class:"step-contract__content"},this.activeTab===1&&e&&o("div",{key:"fa0e33d74261a223ede9a349330420eb02b7afe9",class:"step-contract__options"},e.contract.map((e=>{const t=this.getTotalInstallationCost(e);return o("label",{class:{"step-contract__option":true,"step-contract__option--selected":this.selectedOption?.deadlines===e.deadlines&&this.selectedOption?.typeId===1}},o("input",{type:"radio",name:"contract",checked:this.selectedOption?.deadlines===e.deadlines&&this.selectedOption?.typeId===1,onChange:()=>this.handleSelectOption(1,e)}),o("div",{class:"step-contract__option-content"},o("span",{class:"step-contract__option-title"},this.formatContractLabel(e.deadlines)),o("span",{class:"step-contract__option-price"},"Instalación: ",t>0?me(t):"$0.00")))}))),this.activeTab===0&&t&&o("div",{key:"960c31f56eb79aee44ece402f81bce7aae7563fc",class:"step-contract__options step-contract__options--single"},t.contract.map((e=>{const t=this.getTotalInstallationCost(e);return o("label",{class:{"step-contract__option":true,"step-contract__option--selected":this.selectedOption?.typeId===0}},o("input",{type:"radio",name:"contract",checked:this.selectedOption?.typeId===0,onChange:()=>this.handleSelectOption(0,e)}),o("div",{class:"step-contract__option-content"},o("span",{class:"step-contract__option-title"},"Sin contrato"),o("span",{class:"step-contract__option-price"},"Instalación: ",me(t))))})))),o("div",{key:"c4a7e733a3059a8240741de67386417fedc53dc6",class:"step-contract__actions"},o("button",{key:"27ba1b393678129d75dd67bef3d08346e5d6a718",class:"step-contract__btn-continue",onClick:this.handleContinue,disabled:!this.selectedOption},"Continuar"),o("button",{key:"629f3ae675dee5c469bc381123d6f42c805b54a9",type:"button",class:"step-contract__btn-back-mobile",onClick:this.onBack},"Regresar"))))}};xe.style=ye();const _e={required:"Este campo es requerido",minLength:e=>`Debe tener al menos ${e} caracteres`,maxLength:e=>`No puede exceder ${e} caracteres`,email:"Ingrese un correo electrónico válido",phone:"Ingrese un número de teléfono válido (10 dígitos)",zipCode:"Ingrese un código postal válido (5 dígitos)",date:"Ingrese una fecha válida",futureDate:"La fecha debe ser futura",identification:"La identificación debe tener al menos 10 caracteres",numeric:"Solo se permiten números",alphanumeric:"Solo se permiten letras y números"};const ve=()=>({isValid:true,message:""});const we=e=>({isValid:false,message:e});const ke=e=>{if(!e||e.trim()===""){return we(_e.required)}return ve()};const Ce=e=>t=>{if(t&&t.length<e){return we(_e.minLength(e))}return ve()};const Se=e=>{if(!e)return ve();const t=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;if(!t.test(e)){return we(_e.email)}return ve()};const Ae=e=>{if(!e)return ve();const t=e.replace(/\D/g,"");if(t.length!==10){return we(_e.phone)}return ve()};const Fe=e=>{if(!e)return ve();const t=/^\d{5}$/;if(!t.test(e)){return we(_e.zipCode)}return ve()};const Ie=e=>{if(!e)return ve();const t=/^\d{4}-\d{2}-\d{2}$/;if(!t.test(e)){return we(_e.date)}const r=new Date(e);if(isNaN(r.getTime())){return we(_e.date)}return ve()};const Ee=e=>{if(!e)return ve();const t=Ie(e);if(!t.isValid)return t;const r=new Date(e);const a=new Date;a.setHours(0,0,0,0);if(r<=a){return we(_e.futureDate)}return ve()};const Pe=e=>{if(!e)return ve();if(e.length<10){return we(_e.identification)}return ve()};const De=(...e)=>t=>{for(const r of e){const e=r(t);if(!e.isValid){return e}}return ve()};const ze={firstName:De(ke,Ce(3)),lastName:De(ke,Ce(3)),secondLastName:De(ke,Ce(3)),identificationNumber:De(ke,Pe),identificationExpiration:De(ke,Ee),phone1:De(ke,Ae),phone2:Ae,email:De(ke,Se),businessName:ke,position:ke,address:ke,city:ke,zipCode:De(ke,Fe)};const Ne=()=>`@keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes slideUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}@keyframes spin{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}:host{display:block}.step-form{width:100%;max-width:800px;margin:0 auto}.step-form__header{display:flex;align-items:center;justify-content:space-between;margin-bottom:1rem;padding-bottom:1rem;position:relative}.step-form__header::after{content:"";position:absolute;bottom:0;left:50%;transform:translateX(-50%);width:100vw;height:1px;background:#E5E5E5}.step-form__title{font-size:1.75rem;font-weight:700;line-height:1.2;color:#333333}.step-form__btn-back{display:inline-flex;align-items:center;justify-content:center;gap:0.5rem;padding:0 1.5rem;font-family:"AMX", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, sans-serif;font-size:1rem;font-weight:600;line-height:1;text-decoration:none;border:none;border-radius:9999px;cursor:pointer;transition:all 150ms ease}.step-form__btn-back:disabled{opacity:0.5;cursor:not-allowed}.step-form__btn-back{height:48px;background-color:transparent;color:#0097A9;border:2px solid #0097A9}.step-form__btn-back:hover:not(:disabled){background-color:rgba(0, 151, 169, 0.1)}.step-form__btn-back:active:not(:disabled){background-color:rgba(0, 151, 169, 0.2)}.step-form__btn-back{height:40px}.step-form__stepper{display:none;margin-bottom:1.5rem;padding:1rem 0}@media (max-width: 767px){.step-form__stepper{display:block}}.step-form form{border:1px solid #E5E5E5;border-radius:0.75rem;padding:1.5rem;background:white}.step-form__instructions{font-size:0.875rem;font-weight:400;line-height:1.5;color:#666666;margin-bottom:1.5rem;padding:0;background:transparent}.step-form__section{margin-bottom:1.5rem;padding-bottom:0.5rem}.step-form__row{display:grid;grid-template-columns:1fr;gap:1rem;margin-bottom:1rem}@media (min-width: 768px){.step-form__row{grid-template-columns:1fr 1fr}}.step-form__row:last-child{margin-bottom:0}.step-form__field{display:flex;flex-direction:column}@media (min-width: 768px){.step-form__field--id{grid-column:span 1}}.step-form__label{display:block;margin-bottom:0.5rem;font-size:0.875rem;font-weight:500;color:#333333}.step-form__label .required{color:#DA291C}.step-form__required{color:#333333;margin-right:0.25rem}.step-form__input{width:100%;height:44px;padding:0 1rem;font-family:"AMX", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, sans-serif;font-size:1rem;color:#333333;background-color:#FFFFFF;border:1px solid #CCCCCC;border-radius:0.5rem;transition:border-color 150ms ease, box-shadow 150ms ease}.step-form__input::placeholder{color:#999999}.step-form__input:focus{outline:none;border-color:#0097A9;box-shadow:0 0 0 3px rgba(0, 151, 169, 0.15)}.step-form__input:disabled{background-color:#F5F5F5;cursor:not-allowed}.step-form__input.error{border-color:#DA291C}.step-form__input.error:focus{box-shadow:0 0 0 3px rgba(218, 41, 28, 0.15)}.step-form__input--error{border-color:#DA291C}.step-form__input--error:focus{box-shadow:0 0 0 3px rgba(218, 41, 28, 0.15)}.step-form__error{margin-top:0.25rem;font-size:0.75rem;color:#DA291C}.step-form__id-row{display:flex;flex-direction:column;gap:0.5rem}@media (min-width: 768px){.step-form__id-row{flex-direction:row;align-items:flex-start}.step-form__id-row input[type=text].step-form__input{flex:1}}.step-form__id-row input[type=text].step-form__input{margin-top:4px;width:100%;height:44px;min-height:44px;padding:0 1rem;font-family:"AMX", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, sans-serif;font-size:1rem;color:#333333;background-color:#FFFFFF;border:1px solid #CCCCCC;border-radius:0.5rem;box-sizing:border-box;appearance:none;-webkit-appearance:none}.step-form__id-row input[type=text].step-form__input::placeholder{color:#999999}.step-form__id-row input[type=text].step-form__input:focus{outline:none;border-color:#0097A9;box-shadow:0 0 0 3px rgba(0, 151, 169, 0.15)}.step-form__radio-group{display:flex;flex-direction:row;align-items:flex-start;gap:1rem}.step-form__radio-group--horizontal{flex-direction:row;gap:1rem}.step-form__radio{display:flex;align-items:flex-start;gap:0.25rem;font-size:0.875rem;font-weight:400;line-height:1.5;color:#333333;cursor:pointer;max-width:90px;line-height:1.2;margin-top:14px}.step-form__radio input[type=radio]{accent-color:#0097A9;margin-top:2px;flex-shrink:0}.step-form__actions{margin-top:1.5rem;padding-top:1.5rem;border-top:1px solid #E5E5E5;text-align:center}.step-form__btn-submit{display:inline-flex;align-items:center;justify-content:center;gap:0.5rem;padding:0 1.5rem;font-family:"AMX", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, sans-serif;font-size:1rem;font-weight:600;line-height:1;text-decoration:none;border:none;border-radius:9999px;cursor:pointer;transition:all 150ms ease}.step-form__btn-submit:disabled{opacity:0.5;cursor:not-allowed}.step-form__btn-submit{height:48px;background-color:#DA291C;color:#FFFFFF}.step-form__btn-submit:hover:not(:disabled){background-color:rgb(181.843902439, 34.2, 23.356097561)}.step-form__btn-submit:active:not(:disabled){background-color:rgb(163.7658536585, 30.8, 21.0341463415)}.step-form__btn-submit{min-width:280px;height:44px;padding:0 2rem;border-radius:22px;font-size:1rem}.step-form__btn-submit:disabled{background-color:#999999;border-color:#999999;cursor:not-allowed;opacity:1}.step-form__btn-submit:disabled:hover{background-color:#999999;border-color:#999999}@media (max-width: 767px){.step-form__btn-submit{width:100%;min-width:auto}}.step-form__btn-back-mobile{display:none;width:100%;margin-top:1rem;padding:0.5rem;background:transparent;border:none;color:#0097A9;font-size:1rem;cursor:pointer;text-decoration:none;text-align:center}.step-form__btn-back-mobile:hover{text-decoration:underline}@media (max-width: 767px){.step-form__header{flex-direction:column;align-items:flex-start;gap:0.75rem}.step-form__header .step-form__title{font-size:1.25rem;order:1}.step-form__header .step-form__btn-back{order:2;align-self:flex-start;height:auto;padding:0.5rem 0;border:none;background:transparent;color:#0097A9;font-size:0.875rem}.step-form__header .step-form__btn-back:hover{background:transparent;text-decoration:underline}.step-form form{padding:1rem}.step-form__instructions{font-size:0.875rem}.step-form__row{grid-template-columns:1fr}.step-form__id-row{flex-direction:column;gap:0.75rem}.step-form__id-row .step-form__input{width:100%;margin-top:0}.step-form__actions{padding-top:1rem;margin-top:1rem}.step-form__btn-back-mobile{display:block}.step-form__btn-back{display:none}}`;const Te=768;const Oe=[{label:"Identificación"},{label:"Contacto"}];const Me=class{constructor(e){r(this,e)}onNext;onBack;formData={personal:{firstName:"",secondName:"",lastName:"",secondLastName:"",identificationType:"license",identificationNumber:"",identificationExpiration:"",phone1:"",phone2:"",email:""},business:{businessName:"",position:""},address:{address:g.location?.address||"",city:g.location?.city||"",zipCode:g.location?.zipCode||""},isExistingCustomer:false};errors={};touched={};currentSection="identification";isMobile=false;componentWillLoad(){this.checkMobile();window.addEventListener("resize",this.handleResize)}disconnectedCallback(){window.removeEventListener("resize",this.handleResize)}handleResize=()=>{this.checkMobile()};checkMobile(){this.isMobile=window.innerWidth<Te}getCurrentStepNumber(){return this.currentSection==="identification"?1:2}getIdentificationFields(){return[{field:"firstName",value:this.formData.personal.firstName},{field:"lastName",value:this.formData.personal.lastName},{field:"secondLastName",value:this.formData.personal.secondLastName},{field:"identificationNumber",value:this.formData.personal.identificationNumber},{field:"identificationExpiration",value:this.formData.personal.identificationExpiration}]}getContactFields(){return[{field:"phone1",value:this.formData.personal.phone1},{field:"email",value:this.formData.personal.email},{field:"businessName",value:this.formData.business.businessName},{field:"position",value:this.formData.business.position},{field:"address",value:this.formData.address.address},{field:"city",value:this.formData.address.city},{field:"zipCode",value:this.formData.address.zipCode}]}isIdentificationValid(){for(const{field:e,value:t}of this.getIdentificationFields()){const r=ze[e];if(r){const e=r(t);if(!e.isValid){return false}}}return true}isContactValid(){for(const{field:e,value:t}of this.getContactFields()){const r=ze[e];if(r){const e=r(t);if(!e.isValid){return false}}}return true}validateIdentificationSection(){const e=this.getIdentificationFields();let t=true;const r={...this.touched};const a={...this.errors};for(const{field:o,value:i}of e){r[o]=true;const e=ze[o];if(e){const r=e(i);if(!r.isValid){t=false;a[o]=r.message}else{delete a[o]}}}this.touched=r;this.errors=a;return t}handleInput=(e,t)=>r=>{const a=r.target;let o=a.value;if(t==="phone1"||t==="phone2"){o=ge(o)}this.formData={...this.formData,[e]:{...this.formData[e],[t]:o}};this.touched={...this.touched,[t]:true};this.validateField(t,o)};handleRadioChange=(e,t)=>{if(e==="identificationType"){this.formData={...this.formData,personal:{...this.formData.personal,identificationType:t}}}else if(e==="isExistingCustomer"){this.formData={...this.formData,isExistingCustomer:t}}};validateField(e,t){const r=ze[e];if(!r)return{isValid:true,message:""};const a=r(t);if(!a.isValid){this.errors={...this.errors,[e]:a.message}}else{const{[e]:t,...r}=this.errors;this.errors=r}return a}getFieldsToValidate(){return[{field:"firstName",value:this.formData.personal.firstName},{field:"lastName",value:this.formData.personal.lastName},{field:"secondLastName",value:this.formData.personal.secondLastName},{field:"identificationNumber",value:this.formData.personal.identificationNumber},{field:"identificationExpiration",value:this.formData.personal.identificationExpiration},{field:"phone1",value:this.formData.personal.phone1},{field:"email",value:this.formData.personal.email},{field:"businessName",value:this.formData.business.businessName},{field:"position",value:this.formData.business.position},{field:"address",value:this.formData.address.address},{field:"city",value:this.formData.address.city},{field:"zipCode",value:this.formData.address.zipCode}]}isFormValid(){for(const{field:e,value:t}of this.getFieldsToValidate()){const r=ze[e];if(r){const e=r(t);if(!e.isValid){return false}}}return true}isCurrentSectionValid(){if(!this.isMobile){return this.isFormValid()}if(this.currentSection==="identification"){return this.isIdentificationValid()}else{return this.isContactValid()}}validateForm(){const e=this.getFieldsToValidate();let t=true;const r={};for(const{field:a,value:o}of e){const e=this.validateField(a,o);if(!e.isValid){t=false;r[a]=e.message}}this.errors=r;return t}handleSubmit=e=>{e.preventDefault();if(this.isMobile){if(this.currentSection==="identification"){if(this.validateIdentificationSection()){this.currentSection="contact"}return}}this.touched={firstName:true,lastName:true,secondLastName:true,identificationNumber:true,identificationExpiration:true,phone1:true,email:true,businessName:true,position:true,address:true,city:true,zipCode:true};if(this.validateForm()){_.setFormData(this.formData);this.onNext?.()}};handleBack=()=>{if(this.isMobile&&this.currentSection==="contact"){this.currentSection="identification";return}this.onBack?.()};renderInput(e,t,r,a,i={}){const{type:n="text",placeholder:s="",required:c=false,disabled:l=false}=i;const d=this.touched[t]&&this.errors[t];const p=t==="phone1"||t==="phone2"?be(a):a;return o("div",{class:"step-form__field"},o("label",{class:"step-form__label"},c&&o("span",{class:"step-form__required"},"*"),e,":"),o("input",{type:n,class:{"step-form__input":true,"step-form__input--error":!!d},value:p,placeholder:s,disabled:l,onInput:this.handleInput(r,t)}),d&&o("span",{class:"step-form__error"},this.errors[t]))}renderIdentificationSection(){return o("div",{class:"step-form__section"},o("div",{class:"step-form__row"},this.renderInput("Nombre","firstName","personal",this.formData.personal.firstName,{placeholder:"Ingrese nombre",required:true}),this.renderInput("Segundo nombre","secondName","personal",this.formData.personal.secondName||"",{placeholder:"Ingrese segundo nombre (Opcional)"})),o("div",{class:"step-form__row"},this.renderInput("Apellido","lastName","personal",this.formData.personal.lastName,{placeholder:"Ingrese apellido",required:true}),this.renderInput("Segundo apellido","secondLastName","personal",this.formData.personal.secondLastName,{placeholder:"Ingrese segundo apellido",required:true})),o("div",{class:"step-form__row"},o("div",{class:"step-form__field step-form__field--id"},o("label",{class:"step-form__label"},o("span",{class:"step-form__required"},"*"),"Identificación:"),o("div",{class:"step-form__id-row"},o("div",{class:"step-form__radio-group"},o("label",{class:"step-form__radio"},o("input",{type:"radio",name:"idType",checked:this.formData.personal.identificationType==="license",onChange:()=>this.handleRadioChange("identificationType","license")}),"Licencia de conducir"),o("label",{class:"step-form__radio"},o("input",{type:"radio",name:"idType",checked:this.formData.personal.identificationType==="passport",onChange:()=>this.handleRadioChange("identificationType","passport")}),"Pasaporte")),o("input",{type:"text",class:{"step-form__input":true,"step-form__input--error":!!(this.touched["identificationNumber"]&&this.errors["identificationNumber"])},value:this.formData.personal.identificationNumber,placeholder:"Ingrese nro de identificación",onInput:this.handleInput("personal","identificationNumber")})),this.touched["identificationNumber"]&&this.errors["identificationNumber"]&&o("span",{class:"step-form__error"},this.errors["identificationNumber"])),this.renderInput("Fecha de vencimiento","identificationExpiration","personal",this.formData.personal.identificationExpiration,{type:"date",required:true})))}renderContactSection(){return[o("div",{class:"step-form__section"},o("div",{class:"step-form__row"},this.renderInput("Teléfono de contacto 1","phone1","personal",this.formData.personal.phone1,{type:"tel",placeholder:"Ingrese nro de teléfono",required:true}),this.renderInput("Teléfono de contacto 2","phone2","personal",this.formData.personal.phone2||"",{type:"tel",placeholder:"Ingrese nro de teléfono"}))),o("div",{class:"step-form__section"},o("div",{class:"step-form__row"},this.renderInput("Nombre legal de Empresa (según IRS)","businessName","business",this.formData.business.businessName,{placeholder:"Ingresar nombre legal de empresa",required:true}),this.renderInput("Posición en la Empresa","position","business",this.formData.business.position,{placeholder:"Ingrese posición actual",required:true}))),o("div",{class:"step-form__section"},o("div",{class:"step-form__row"},this.renderInput("Dirección","address","address",this.formData.address.address,{placeholder:"Ingrese dirección",required:true}),this.renderInput("Ciudad","city","address",this.formData.address.city,{placeholder:"Ingrese ciudad",required:true})),o("div",{class:"step-form__row"},this.renderInput("Código postal","zipCode","address",this.formData.address.zipCode,{placeholder:"Ingrese código postal",required:true}),this.renderInput("Correo electrónico","email","personal",this.formData.personal.email,{type:"email",placeholder:"Ingrese correo electrónico",required:true}))),o("div",{class:"step-form__section"},o("div",{class:"step-form__field"},o("label",{class:"step-form__label"},o("span",{class:"step-form__required"},"*"),"Cliente existente de Claro PR:"),o("div",{class:"step-form__radio-group step-form__radio-group--horizontal"},o("label",{class:"step-form__radio"},o("input",{type:"radio",name:"existingCustomer",checked:this.formData.isExistingCustomer===true,onChange:()=>this.handleRadioChange("isExistingCustomer",true)}),"Sí"),o("label",{class:"step-form__radio"},o("input",{type:"radio",name:"existingCustomer",checked:this.formData.isExistingCustomer===false,onChange:()=>this.handleRadioChange("isExistingCustomer",false)}),"No"))))]}render(){const e=this.getCurrentStepNumber();return o(i,{key:"0ff3baeb8d758c4ab60d3af46716223f9cc41dbb"},o("div",{key:"b7c5b885e03241a732c5e234bf059d3d7f001372",class:"step-form"},o("header",{key:"5d149adc54d4e3c36abc554476aa0774d77dd2f8",class:"step-form__header"},o("h1",{key:"7824074ec9cfebc87d57159953874a854c5849c4",class:"step-form__title"},"Formulario de solicitud de servicio fijo"),o("button",{key:"554400631442f25b7b9ae8c0c21fcc793672ae66",type:"button",class:"step-form__btn-back",onClick:this.handleBack},"Regresar")),this.isMobile&&o("div",{key:"ab28ab7cbcac54cf0a0c2c0e11b13c7289cdb18f",class:"step-form__stepper"},o("ui-stepper",{key:"6575f57a4351c8a586e612ea0dc05ad38b3d56c9",steps:Oe,currentStep:e})),o("form",{key:"c9af47b6e343737b09412ba09500bed39a1c47d8",onSubmit:this.handleSubmit},o("p",{key:"47578d738b67c231804db4c961cac430e1d9c57d",class:"step-form__instructions"},"Por favor, ingresa la información personal solicitada. Su nombre y apellido deben ser iguales a su identificación de gobierno."),!this.isMobile&&[this.renderIdentificationSection(),...this.renderContactSection()],this.isMobile&&this.currentSection==="identification"&&this.renderIdentificationSection(),this.isMobile&&this.currentSection==="contact"&&this.renderContactSection(),o("div",{key:"67dcdd884f9778fce2b9844b8e9bd2f5b78bb390",class:"step-form__actions"},o("button",{key:"e4da19eb9543cdf255b6caf882f5eb4f17dd2c87",type:"submit",class:"step-form__btn-submit",disabled:!this.isCurrentSectionValid()},"Continuar"),o("button",{key:"f517b1101d80971753a7176113f18be80ae36a4b",type:"button",class:"step-form__btn-back-mobile",onClick:this.handleBack},"Regresar")))))}};Me.style=Ne();const Le=()=>`@keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes slideUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}@keyframes spin{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}:host{display:block}.step-location{width:100%;position:relative}.step-location__validating-overlay{position:absolute;top:0;left:0;right:0;bottom:0;background:rgba(255, 255, 255, 0.9);display:flex;align-items:center;justify-content:center;z-index:1000;animation:fadeIn 0.2s ease-out}.step-location__validating-content{display:flex;flex-direction:column;align-items:center;gap:1rem;padding:1.5rem;background:#FFFFFF;border-radius:16px;box-shadow:0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)}.step-location__validating-spinner{width:48px;height:48px;border:4px solid #E5E5E5;border-top-color:#DA291C;border-radius:50%;animation:spin 1s linear infinite}.step-location__validating-text{margin:0;font-size:18px;font-weight:600;color:#333333}.step-location__header{text-align:center;margin-bottom:1rem}.step-location__title{font-size:1.5rem;font-weight:600;line-height:1.35;color:#333333;font-weight:400}.step-location__title--highlight{color:#DA291C;font-weight:700}.step-location__map-container{position:relative;border-radius:0.75rem;overflow:hidden;box-shadow:0 2px 8px rgba(0, 0, 0, 0.08)}.step-location__controls{position:absolute;top:3.5rem;left:0.75rem;right:0.75rem;z-index:1;display:flex;flex-direction:column;gap:0.5rem}@media (min-width: 576px){.step-location__controls{left:120px;right:50px}}@media (min-width: 768px){.step-location__controls{top:3.5rem;left:130px;right:60px}}.step-location__input-group{display:flex;align-items:center;background:#FFFFFF;border-radius:10px;box-shadow:0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);overflow:hidden;border:1px solid #E5E5E5}.step-location__input-icon{display:flex;align-items:center;justify-content:center;padding-left:0.75rem;color:#999999}.step-location__input-icon svg{width:20px;height:20px}.step-location__input{flex:1;padding:0.75rem 0.75rem;border:none;font-size:0.875rem;outline:none;background:transparent;min-width:0}.step-location__input::placeholder{color:#999999}.step-location__btn-validate{padding:0.75rem 1.25rem;background:#DA291C;color:#FFFFFF;border:none;font-size:0.875rem;font-weight:600;cursor:pointer;transition:background-color 150ms ease;white-space:nowrap;min-width:100px}.step-location__btn-validate:hover:not(:disabled){background:rgb(181.843902439, 34.2, 23.356097561)}.step-location__btn-validate:disabled{opacity:0.6;cursor:not-allowed}.step-location__btn-validate--loading{pointer-events:none}.step-location__btn-validate-content{display:inline-flex;align-items:center;gap:0.5rem}.step-location__btn-spinner{display:inline-block;width:14px;height:14px;border:2px solid rgba(255, 255, 255, 0.3);border-top-color:#FFFFFF;border-radius:50%;animation:btn-spin 0.8s linear infinite}@keyframes btn-spin{to{transform:rotate(360deg)}}.step-location__btn-location{display:inline-flex;align-items:center;gap:0.5rem;padding:0.5rem 0.75rem;background:#0097A9;color:#FFFFFF;border:none;border-radius:0.25rem;font-size:0.75rem;font-weight:500;cursor:pointer;box-shadow:0 1px 2px 0 rgba(0, 0, 0, 0.05);transition:background-color 150ms ease;white-space:nowrap;align-self:flex-start}.step-location__btn-location:hover:not(:disabled){background:rgb(0, 114.5455621302, 128.2)}.step-location__btn-location:disabled{opacity:0.6;cursor:not-allowed}.step-location__btn-location-icon{width:16px;height:16px}.step-location__map{position:relative;width:100%;height:400px;background:#E5E5E5}@media (min-width: 768px){.step-location__map{height:500px}}.step-location__map-canvas{width:100%;height:100%}.step-location__map-loading{display:flex;flex-direction:column;align-items:center;justify-content:center;position:absolute;top:0;left:0;right:0;bottom:0;background:#F5F5F5;color:#666666;z-index:5}.step-location__map-loading p{font-size:1rem;font-weight:400;line-height:1.5;margin-top:1rem}.step-location__map-error{display:flex;flex-direction:column;align-items:center;justify-content:center;position:absolute;top:0;left:0;right:0;bottom:0;background:#F5F5F5;color:#666666;z-index:5;padding:1rem;text-align:center}.step-location__map-error p{font-size:1rem;font-weight:400;line-height:1.5;color:#DA291C}.step-location__map-error small{margin-top:0.5rem;font-size:0.75rem}.step-location__spinner{width:40px;height:40px;border:3px solid #CCCCCC;border-top-color:#0097A9;border-radius:50%;animation:spin 1s linear infinite}.step-location__map-placeholder{display:flex;flex-direction:column;align-items:center;justify-content:center;width:100%;height:100%;color:#666666}.step-location__map-placeholder p{font-size:1rem;font-weight:400;line-height:1.5}.step-location__map-placeholder small{margin-top:0.5rem;font-size:0.75rem}.step-location__modal-backdrop{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0, 0, 0, 0.5);z-index:400;display:flex;align-items:center;justify-content:center}.step-location__modal{position:relative;width:90%;max-width:400px;background:#FFFFFF;border-radius:0.75rem;padding:2rem 1.5rem;text-align:center;box-shadow:0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)}.step-location__modal--error .step-location__modal-error-bar{display:block}.step-location__modal-close{position:absolute;top:0.75rem;right:0.75rem;width:32px;height:32px;background:transparent;border:none;font-size:1.5rem;color:#666666;cursor:pointer;line-height:1}.step-location__modal-close:hover{color:#333333}.step-location__modal-error-bar{display:none;background:#DA291C;color:#FFFFFF;padding:0.5rem 1rem;margin:-2rem -1.5rem 1rem;font-weight:600}.step-location__modal-success-icon{width:60px;height:60px;margin:0 auto 1rem;color:#44AF69}.step-location__modal-success-icon svg{width:100%;height:100%}.step-location__modal-message{font-size:1rem;font-weight:400;line-height:1.5;color:#333333;margin-bottom:1.5rem}.step-location__modal-btn{display:inline-flex;align-items:center;justify-content:center;gap:0.5rem;padding:0 1.5rem;font-family:"AMX", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, sans-serif;font-size:1rem;font-weight:600;line-height:1;text-decoration:none;border:none;border-radius:9999px;cursor:pointer;transition:all 150ms ease}.step-location__modal-btn:disabled{opacity:0.5;cursor:not-allowed}.step-location__modal-btn{height:48px;background-color:#0097A9;color:#FFFFFF}.step-location__modal-btn:hover:not(:disabled){background-color:rgb(0, 114.5455621302, 128.2)}.step-location__modal-btn:active:not(:disabled){background-color:rgb(0, 96.3183431953, 107.8)}.step-location__modal-btn{min-width:150px}`;const Re=class{constructor(e){r(this,e)}get el(){return n(this)}googleMapsKey;onNext;onBack;address="";isValidating=false;isLoadingMap=true;isGettingLocation=false;locationData=null;mapError=null;currentCoordinates=null;geocodeResult=null;showErrorModal=false;errorMessage="";mapContainer;addressInput;async componentDidLoad(){await this.initializeMap()}disconnectedCallback(){R.destroy()}async initializeMap(){if(!this.googleMapsKey){this.mapError="Google Maps API key no configurada";this.isLoadingMap=false;return}try{R.setApiKey(this.googleMapsKey);await R.initMap(this.mapContainer);if(this.addressInput){await R.initAutocomplete(this.addressInput,(e=>{this.handlePlaceSelected(e)}))}R.addMapClickListener((async e=>{await this.handleMapClick(e)}));this.isLoadingMap=false}catch(e){console.error("Error initializing map:",e);this.mapError="Error al cargar Google Maps";this.isLoadingMap=false}}handleAddressChange=e=>{this.address=e.target.value};handleKeyPress=e=>{if(e.key==="Enter"||e.code==="Enter"||e.code==="NumpadEnter"){e.preventDefault();this.handleValidate()}};handleMapClick=async e=>{R.clear();const t=await R.reverseGeocode(e);if(t){this.geocodeResult=t;this.address=t.formattedAddress||t.address;this.currentCoordinates=t.coordinates;R.setMarker(t.coordinates)}else{this.currentCoordinates=e;R.setMarker(e)}await this.handleValidate()};handlePlaceSelected=e=>{this.geocodeResult=e;this.address=e.formattedAddress||e.address;this.currentCoordinates=e.coordinates;R.setMarker(e.coordinates);R.centerMap(e.coordinates)};handleValidate=async()=>{if(!this.currentCoordinates&&!this.address.trim()){return}this.isValidating=true;try{let e=this.currentCoordinates;let t=this.geocodeResult?.city||"";let r=this.geocodeResult?.zipCode||"";if(!e&&this.address.trim()){const a=await R.geocodeAddress(this.address);if(a){e=a.coordinates;t=a.city;r=a.zipCode;this.currentCoordinates=e;this.geocodeResult=a;R.setMarker(e);R.centerMap(e)}else{this.errorMessage="No se pudo encontrar la dirección. Por favor, intenta con otra dirección.";this.showErrorModal=true;this.isValidating=false;return}}if(!e){this.errorMessage="Por favor, ingresa una dirección válida.";this.showErrorModal=true;this.isValidating=false;return}const a=await E.checkCoverage(e.lat,e.lng,this.address||this.geocodeResult?.address||"",t,r);this.locationData=a;if(a.isValid){this.showCoverageInfoWindow(a.serviceMessage,true)}else{this.showCoverageInfoWindow(O.NO_COVERAGE,false)}}catch(e){console.error("Coverage validation error:",e);this.errorMessage=O.COVERAGE_ERROR;this.showErrorModal=true}finally{this.isValidating=false}};showCoverageInfoWindow(e,t){const r=`\n      <div class="general-container" style="font-family: 'Open Sans', Arial, sans-serif; width: 100%; box-sizing: border-box;">\n        <div class="info ${t?"infoOn":"infoOff"}" style="\n          padding: ${t?"20px":"15px 20px"};\n          width: 100%;\n          height: auto;\n          box-sizing: border-box;\n          background: ${t?"#1F97AF":"#EE122C"};\n          color: #ffffff;\n          font-size: 14px;\n          line-height: 1.5;\n          white-space: normal;\n        ">\n          ${e}\n        </div>\n        <div class="continue-map" style="\n          width: 100%;\n          height: auto;\n          padding: 20px;\n          font-size: 16px;\n          text-align: center;\n          background: #ffffff;\n          color: #1F97AF;\n          cursor: pointer;\n          box-sizing: border-box;\n        ">\n          ${!t?`\n            <div style="color: #333; margin-bottom: 8px;">\n              Actualmente usted se encuentra fuera del rango de cobertura.\n            </div>\n          `:""}\n          <div\n            id="infowindow-continue-btn"\n            class="no-link continue-button"\n            onclick="if(window.__infoWindowContinueCallback) window.__infoWindowContinueCallback();"\n            style="\n              text-decoration: none;\n              color: #1F97AF;\n              font-size: 16px;\n              cursor: pointer;\n              font-weight: 600;\n            "\n          >\n            ${t?"Continuar":"Cerrar"}\n          </div>\n        </div>\n      </div>\n    `;R.showInfoWindow(r,(()=>{if(t&&this.locationData&&this.locationData.isValid){this.handleInfoWindowContinue()}else{R.closeInfoWindow()}}))}handleInfoWindowContinue=()=>{if(this.locationData&&this.locationData.isValid){R.closeInfoWindow();this.storeLocationInSession(this.locationData);_.setLocation(this.locationData);this.onNext?.()}};storeLocationInSession(e){try{sessionStorage.setItem("latitud",btoa(String(e.latitude)));sessionStorage.setItem("longitud",btoa(String(e.longitude)));if(e.serviceType.toUpperCase()==="CLARO HOGAR"){sessionStorage.removeItem("planCodeInternet");console.log("[StepLocation] CLARO HOGAR detected - planCodeInternet removed")}else{sessionStorage.setItem("planCodeInternet",btoa(e.serviceType));console.log("[StepLocation] Service type stored:",e.serviceType)}sessionStorage.setItem("plan",JSON.stringify({serviceType:e.serviceType,serviceMessage:e.serviceMessage,address:e.address,city:e.city,zipCode:e.zipCode}));console.log("[StepLocation] Location data stored in sessionStorage")}catch(e){console.error("[StepLocation] Error storing location in sessionStorage:",e)}}handleUseCurrentLocation=async()=>{this.isGettingLocation=true;try{const e=await R.getCurrentLocationWithAddress();if(e){this.geocodeResult=e;this.address=e.formattedAddress||e.address;this.currentCoordinates=e.coordinates;R.setMarker(e.coordinates);R.centerMap(e.coordinates);R.setZoom(17)}else{const e=await R.getCurrentLocation();this.currentCoordinates=e;R.setMarker(e);R.centerMap(e);R.setZoom(17)}}catch(e){console.error("Geolocation error:",e);if(e.message.includes("denied")){this.errorMessage=O.GEOLOCATION_DENIED}else if(e.message.includes("unavailable")){this.errorMessage=O.GEOLOCATION_UNAVAILABLE}else{this.errorMessage=O.GEOLOCATION_TIMEOUT}this.showErrorModal=true}finally{this.isGettingLocation=false}};render(){return o(i,{key:"a0e39ccf15c31beadf5745a12b68eb6978c3c4fb"},o("div",{key:"29e3069719060c1b3ffdedbe3dfb4b1fb75f26a6",class:"step-location"},this.isValidating&&o("div",{key:"cd414f53d6795dddb702cdf4d40154041a69fd21",class:"step-location__validating-overlay"},o("div",{key:"6303dca28d5f98260f5cf60c3c5a0b3fa31b79a1",class:"step-location__validating-content"},o("div",{key:"d7e01f97aa7552f2f80721b2aade6c43e34a3bda",class:"step-location__validating-spinner"}),o("p",{key:"f468f21dd7e903b99759029cf7966cc62d4f1e46",class:"step-location__validating-text"},"Validando cobertura..."))),o("header",{key:"d199addc6a2be5361a867292498904efa375bb43",class:"step-location__header"},o("h1",{key:"8c4ee99ad1633ff1af97cc89c7be518dab81e2c9",class:"step-location__title"},o("span",{key:"d5c12910a1421efbae94a1e3683e9c781f52538d",class:"step-location__title--highlight"},"Servicio fijo empresarial")," ","en tu área")),o("div",{key:"32566aabafe10db547a578dc5066f5df0e1b01d0",class:"step-location__map-container"},o("div",{key:"52f93d98e524bf887f17c70c6a0e7d724c6d3f2e",class:"step-location__controls"},o("div",{key:"c0c0202f1df12acbaaa3f1d997fc87fccb322f6e",class:"step-location__input-group"},o("span",{key:"7ebfce7e2ff99c11e83c8164cbc3c3368135c9f9",class:"step-location__input-icon"},o("svg",{key:"cb0a1b98f6ef2645596b4222a025e268194245d2",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},o("path",{key:"e0064d0fc51ac25d10a9718394e9861121bfa263",d:"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"}),o("circle",{key:"e6885929b60851f3a4f628ab5cd05ff5fa0bbbeb",cx:"12",cy:"10",r:"3"}))),o("input",{key:"1ac6b661a47ddf27d1605112e84ee3846f704604",type:"text",class:"step-location__input",placeholder:"Ingrese su dirección",value:this.address,onInput:this.handleAddressChange,onKeyPress:this.handleKeyPress,ref:e=>this.addressInput=e}),o("button",{key:"ca0e84097fd91267937541df90dc7fb3f3404bb9",class:{"step-location__btn-validate":true,"step-location__btn-validate--loading":this.isValidating},onClick:this.handleValidate,disabled:this.isValidating||!this.address.trim()&&!this.currentCoordinates},this.isValidating?o("span",{class:"step-location__btn-validate-content"},o("span",{class:"step-location__btn-spinner"}),"Validando..."):"Validar")),o("button",{key:"e869cf4c4543e8e8b23fe4b2a1e6c00131ae02a6",class:"step-location__btn-location",onClick:this.handleUseCurrentLocation,disabled:this.isGettingLocation||this.isLoadingMap},o("svg",{key:"d348516737de953040485157235a47d951be3e8b",class:"step-location__btn-location-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},o("circle",{key:"d98bc6ab679863ce5d1e5a94180b926ca4a88db4",cx:"12",cy:"12",r:"10"}),o("circle",{key:"b22d454be6686e057d91746535026d6aebe8f793",cx:"12",cy:"12",r:"3"}),o("line",{key:"7c835cbf33507f21fe0b59b18856e31e56285ee4",x1:"12",y1:"2",x2:"12",y2:"6"}),o("line",{key:"24919757ce7dc1f9afe0438d45546c1822775795",x1:"12",y1:"18",x2:"12",y2:"22"}),o("line",{key:"6ef0ff7c8ddd9b8be597aa646c262916db7794de",x1:"2",y1:"12",x2:"6",y2:"12"}),o("line",{key:"3c11883af54ddaff01ddf88208704bbf83a3b171",x1:"18",y1:"12",x2:"22",y2:"12"})),this.isGettingLocation?"Obteniendo ubicación...":"Utilizar Ubicación Actual")),o("div",{key:"678e04c53c79555bd5268515bdbe1774b6fd5ba2",class:"step-location__map"},this.isLoadingMap&&!this.mapError&&o("div",{key:"bd4381f0ccfdc46eda1ca526911fda09e48b70c2",class:"step-location__map-loading"},o("div",{key:"f6ed91a500b319052324b8f79cc4bc199a596d73",class:"step-location__spinner"}),o("p",{key:"76401eb2fa68492e07543fa04a012edf2f355b5b"},"Cargando mapa...")),this.mapError&&o("div",{key:"64efa54b41a451333213327beabbe1d36ae874c7",class:"step-location__map-error"},o("p",{key:"4b3652acd2aabe5026e5acb287b6d0e24ce716ea"},this.mapError),!this.googleMapsKey&&o("small",{key:"a084a7a9d993f36f8886147afa180c770273d57b"},"Configura la prop google-maps-key en el componente")),o("div",{key:"6c6ee52902c57df2c5dc2e919689c4a0f1095a24",class:"step-location__map-canvas",ref:e=>this.mapContainer=e,style:{display:this.mapError?"none":"block"}}))),this.showErrorModal&&o("div",{key:"d03ec2dd73fee9a4528457c7c076dc6abf49c443",class:"step-location__modal-backdrop"},o("div",{key:"5a50009d8570659606f9abe463fc5d7adf01843c",class:"step-location__modal step-location__modal--error"},o("button",{key:"a5be2ce167fc6b19cbf3d1b36103638b8c5216f1",class:"step-location__modal-close",onClick:()=>this.showErrorModal=false},"×"),o("div",{key:"5411fbcb00b4ee72ceaf8fa9919ca7b7847597cb",class:"step-location__modal-error-bar"},"Error"),o("p",{key:"98759c5ce7a8774f681ad58560a96f56963c34b1",class:"step-location__modal-message"},this.errorMessage),o("button",{key:"9242de88c7371d61399809512b915adbcbc62083",class:"step-location__modal-btn",onClick:()=>this.showErrorModal=false},"Cerrar")))))}};Re.style=Le();const Be=()=>`:host{display:block;width:100%;min-height:100%;background-color:#FAFAFA}.step-order-summary{width:100%;max-width:1200px;margin:0 auto;padding:1.5rem}.header{display:flex;align-items:center;gap:1rem;margin-bottom:1.5rem;flex-wrap:wrap}.header .btn-back{display:flex;align-items:center;gap:0.25rem;background:none;border:none;color:#0097A9;font-size:0.875rem;cursor:pointer;padding:0.25rem;transition:color 0.2s}.header .btn-back svg{width:20px;height:20px}.header .btn-back:hover{color:rgb(0, 105.4319526627, 118);text-decoration:underline}.header__title-group{display:flex;align-items:center;gap:1rem;flex:1}.header .title{font-size:1.75rem;font-weight:700;color:#1A1A1A;margin:0}.header .item-count{font-size:0.875rem;color:#666666;background:#E5E5E5;padding:0.25rem 0.5rem;border-radius:9999px;font-weight:500}.state-container{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:400px;text-align:center;background:white;border-radius:0.75rem;padding:2rem;box-shadow:0 1px 2px 0 rgba(0, 0, 0, 0.05)}.state-container .state-icon{width:80px;height:80px;color:#999999;margin-bottom:1rem}.state-container h3{font-size:1.5rem;color:#4D4D4D;margin:0 0 0.5rem 0}.state-container p{color:#808080;margin:0 0 1.5rem 0}.state-container--error .state-icon{color:#DA291C}.state-container--error p{color:#DA291C}.state-container--empty .state-icon{color:#CCCCCC}.spinner{width:48px;height:48px;border:4px solid #E5E5E5;border-top-color:#DA291C;border-radius:50%;animation:spin 1s linear infinite;margin-bottom:1rem}.spinner-small{display:inline-block;width:16px;height:16px;border:2px solid rgba(255, 255, 255, 0.3);border-top-color:currentColor;border-radius:50%;animation:spin 0.8s linear infinite}@keyframes spin{to{transform:rotate(360deg)}}.btn-retry,.btn-back-catalog{background:#DA291C;color:white;border:none;padding:0.5rem 1.5rem;border-radius:9999px;cursor:pointer;font-weight:600;transition:background 0.2s}.btn-retry:hover,.btn-back-catalog:hover{background:rgb(172.8048780488, 32.5, 22.1951219512)}.btn-back-catalog{background:#0097A9}.btn-back-catalog:hover{background:rgb(0, 105.4319526627, 118)}.content-layout{display:grid;grid-template-columns:1fr 380px;gap:1.5rem}@media (max-width: 992px){.content-layout{grid-template-columns:1fr}}.products-column{display:flex;flex-direction:column;gap:1rem}.summary-column{display:flex;flex-direction:column;gap:1rem}@media (max-width: 992px){.summary-column{order:-1}}.product-card{background:white;border-radius:0.75rem;box-shadow:0 1px 2px 0 rgba(0, 0, 0, 0.05);overflow:hidden}.product-card__badge{display:flex;gap:0.25rem;padding:0.5rem 1rem;background:#FAFAFA;border-bottom:1px solid #F5F5F5}.product-card__main{display:grid;grid-template-columns:100px 1fr auto auto;gap:1rem;padding:1rem;align-items:center}@media (max-width: 768px){.product-card__main{grid-template-columns:80px 1fr auto;grid-template-rows:auto auto}}.product-card__main--plan{grid-template-columns:60px 1fr auto auto}@media (max-width: 768px){.product-card__main--plan{grid-template-columns:60px 1fr auto}}.product-card__image{width:100px;height:100px;background:#FAFAFA;border-radius:0.5rem;display:flex;align-items:center;justify-content:center;overflow:hidden}@media (max-width: 768px){.product-card__image{width:80px;height:80px}}.product-card__image img{max-width:90%;max-height:90%;object-fit:contain}.product-card__image--plan{width:60px;height:60px;background:linear-gradient(135deg, #DA291C 0%, rgb(150.2073170732, 28.25, 19.2926829268) 100%);border-radius:0.5rem}.product-card__image--plan img{filter:brightness(0) invert(1);width:40px;height:40px}.product-card__details{display:flex;flex-direction:column;gap:0.25rem}.product-card__pricing{display:flex;flex-direction:column;align-items:flex-end;gap:0.25rem}@media (max-width: 768px){.product-card__pricing{grid-column:2/-1;flex-direction:row;justify-content:space-between;align-items:center;width:100%}}.product-card__actions{display:flex;align-items:center}.product-card--plan .product-card__main{grid-template-columns:60px 1fr auto auto}.section-header{display:flex;align-items:center;gap:0.5rem;padding:1rem 1.5rem;border-bottom:1px solid #F5F5F5}.section-header__icon{width:36px;height:36px;border-radius:0.5rem;display:flex;align-items:center;justify-content:center}.section-header__icon svg{width:20px;height:20px}.section-header__text{display:flex;align-items:center;gap:0.5rem;flex:1}.section-header__label{font-size:0.875rem;font-weight:700;letter-spacing:0.5px}.section-header__badge{font-size:0.75rem;font-weight:600;padding:2px 0.5rem;border-radius:9999px;text-transform:uppercase;letter-spacing:0.5px}.section-header--equipment{background:linear-gradient(135deg, rgba(0, 151, 169, 0.08) 0%, rgba(0, 151, 169, 0.02) 100%);border-left:4px solid #0097A9}.section-header--equipment .section-header__icon{background:#0097A9;color:white}.section-header--equipment .section-header__label{color:#0097A9}.section-header--equipment .section-header__badge{background:rgba(218, 41, 28, 0.15);color:#DA291C}.section-header--plan{background:linear-gradient(135deg, rgba(218, 41, 28, 0.08) 0%, rgba(218, 41, 28, 0.02) 100%);border-left:4px solid #DA291C}.section-header--plan .section-header__icon{background:#DA291C;color:white}.section-header--plan .section-header__label{color:#DA291C}.badge{display:inline-flex;align-items:center;padding:2px 0.5rem;border-radius:9999px;font-size:0.75rem;font-weight:600;text-transform:uppercase;letter-spacing:0.5px}.badge--equipment{background:rgba(0, 151, 169, 0.15);color:#0097A9}.badge--main{background:rgba(218, 41, 28, 0.15);color:#DA291C}.badge--plan{background:rgba(68, 175, 105, 0.15);color:#44AF69}.product-name{font-size:1rem;font-weight:600;color:#1A1A1A;margin:0;line-height:1.3}.product-specs{display:flex;flex-wrap:wrap;gap:0.5rem;align-items:center}.spec-item{display:flex;align-items:center;gap:4px}.spec-label{font-size:0.875rem;color:#666666}.plan-type{font-size:0.875rem;color:#808080}.financing-info{display:flex;flex-direction:column;gap:2px;margin-top:0.25rem;padding-top:0.25rem;border-top:1px dashed #E5E5E5}.financing-label{font-size:0.75rem;font-weight:600;color:#4D4D4D}.financing-detail{font-size:0.75rem;color:#808080}.color-circle{display:inline-block;width:16px;height:16px;border-radius:50%;border:2px solid #E5E5E5;box-shadow:inset 0 0 0 1px rgba(0, 0, 0, 0.1)}.storage-badge{display:inline-flex;align-items:center;padding:2px 0.25rem;background:#F5F5F5;border-radius:0.25rem;font-size:0.75rem;font-weight:600;color:#4D4D4D}.qty-label{font-size:0.875rem;color:#808080}.price-financing,.price-single{text-align:right}@media (max-width: 768px){.price-financing,.price-single{text-align:left}}.price-monthly{font-size:1.25rem;font-weight:700;color:#DA291C}.price-period{font-size:0.875rem;color:#808080}.price-installments{display:block;font-size:0.75rem;color:#808080;margin-top:2px}.price-total{font-size:1.25rem;font-weight:700;color:#1A1A1A}.price-full{display:flex;gap:0.25rem;font-size:0.875rem}.price-full .label{color:#808080}.price-full .value{font-weight:600;color:#4D4D4D}.btn-action{background:none;border:none;cursor:pointer;padding:0.25rem;transition:all 0.2s;display:flex;align-items:center;justify-content:center}.btn-action svg{width:20px;height:20px}.btn-action--delete{color:#999999;border-radius:0.5rem}.btn-action--delete:hover:not(:disabled){color:#DA291C;background:rgba(218, 41, 28, 0.1)}.btn-action--delete:disabled{opacity:0.5;cursor:not-allowed}.btn-action--delete-small{color:#999999}.btn-action--delete-small svg{width:16px;height:16px}.btn-action--delete-small:hover:not(:disabled){color:#DA291C}.btn-action--delete-small:disabled{opacity:0.5;cursor:not-allowed}.plan-section{border-top:none}.plan-section .section-header--plan{margin:0;border-radius:0;border-left-width:0;padding-left:calc(1.5rem + 4px);border-top:1px dashed #E5E5E5}.plan-section__content{display:flex;align-items:center;gap:1rem;padding:1rem 1.5rem;background:linear-gradient(to right, rgba(218, 41, 28, 0.03), white)}.plan-section .plan-label{font-size:0.75rem;color:#808080;text-transform:uppercase;letter-spacing:0.5px;font-weight:600}.plan-section .plan-info{flex:1;display:flex;flex-direction:column;gap:2px}.plan-section .plan-name{font-size:0.875rem;font-weight:600;color:#333333}.plan-section .plan-type{font-size:0.75rem;color:#808080}.plan-section .plan-price{display:flex;align-items:baseline;gap:2px}.plan-section .plan-price .price{font-size:1.25rem;font-weight:700;color:#DA291C}.plan-section .plan-price .period{font-size:0.875rem;color:#808080}.summary-card{background:white;border-radius:0.75rem;padding:1.5rem;box-shadow:0 1px 2px 0 rgba(0, 0, 0, 0.05)}.summary-card__title{display:flex;align-items:center;gap:0.5rem;font-size:0.875rem;font-weight:600;color:#4D4D4D;margin:0 0 1rem 0;text-transform:uppercase;letter-spacing:0.5px}.summary-card__title svg{width:18px;height:18px;color:#999999}.promo-section .promo-input-group{display:flex;gap:0.5rem}.promo-section .promo-input{flex:1;height:44px;border:1px solid #CCCCCC;border-radius:0.5rem;padding:0 1rem;font-size:0.875rem;transition:border-color 0.2s}.promo-section .promo-input:focus{outline:none;border-color:#0097A9}.promo-section .promo-input.error{border-color:#DA291C}.promo-section .promo-input.success{border-color:#44AF69}.promo-section .promo-input:disabled{background:#F5F5F5;cursor:not-allowed}.promo-section .promo-button{height:44px;padding:0 1.5rem;background:#E5E5E5;color:#4D4D4D;border:none;border-radius:0.5rem;font-weight:600;cursor:pointer;transition:all 0.2s;white-space:nowrap;min-width:90px;display:flex;align-items:center;justify-content:center}.promo-section .promo-button:hover:not(:disabled){background:#CCCCCC}.promo-section .promo-button:disabled{opacity:0.5;cursor:not-allowed}.promo-section .promo-message{display:flex;align-items:center;gap:0.25rem;font-size:0.875rem;margin-top:0.5rem}.promo-section .promo-message svg{width:14px;height:14px;flex-shrink:0}.promo-section .promo-message.error{color:#DA291C}.promo-section .promo-message.success{color:#44AF69}.payment-summary{padding:0;overflow:hidden}.rent-section{background:linear-gradient(135deg, #DA291C 0%, rgb(172.8048780488, 32.5, 22.1951219512) 100%);padding:1.5rem;color:white}.rent-section .rent-row{display:flex;justify-content:space-between;align-items:center}.rent-section .rent-label{font-size:1rem;font-weight:500}.rent-section .rent-value{font-size:1.75rem;font-weight:700}.rent-section .rent-note{font-size:0.75rem;opacity:0.8;margin:0.25rem 0 0 0}.payment-breakdown{padding:1.5rem}.payment-breakdown .detail-rows{margin-bottom:1rem}.detail-row{display:flex;justify-content:space-between;align-items:center;padding:0.5rem 0;border-bottom:1px solid #F5F5F5}.detail-row:last-child{border-bottom:none}.detail-row .label{font-size:0.875rem;color:#666666}.detail-row .value{font-size:0.875rem;font-weight:500;color:#1A1A1A}.detail-row .value--free{color:#44AF69;font-weight:700;font-size:0.75rem;text-transform:uppercase;letter-spacing:0.5px}.detail-row--discount .label{color:#44AF69}.detail-row--discount .value{color:#44AF69;font-weight:600}.detail-row--shipping{background:rgba(68, 175, 105, 0.05);margin:0 -1.5rem;padding:0.5rem 1.5rem;border-bottom:none}.total-section{background:#FAFAFA;margin:0 -1.5rem -1.5rem;padding:1.5rem;border-top:2px solid #E5E5E5}.total-row{display:flex;justify-content:space-between;align-items:center}.total-label{font-size:1rem;font-weight:600;color:#1A1A1A}.total-value{font-size:1.75rem;font-weight:700;color:#DA291C}.terms-section{background:white;border-radius:0.75rem;padding:1rem 1.5rem;box-shadow:0 1px 2px 0 rgba(0, 0, 0, 0.05)}.terms-checkbox{display:flex;align-items:flex-start;gap:0.5rem;cursor:pointer}.terms-checkbox input[type=checkbox]{display:none}.terms-checkbox .checkmark{width:22px;height:22px;border:2px solid #CCCCCC;border-radius:0.25rem;flex-shrink:0;display:flex;align-items:center;justify-content:center;transition:all 0.2s;background:white}.terms-checkbox .checkmark svg{width:14px;height:14px;stroke:white;opacity:0;transition:opacity 0.2s}.terms-checkbox input[type=checkbox]:checked+.checkmark{background:#0097A9;border-color:#0097A9}.terms-checkbox input[type=checkbox]:checked+.checkmark svg{opacity:1}.terms-checkbox .terms-text{font-size:0.875rem;color:#666666;line-height:1.5}.terms-checkbox .terms-text a{color:#0097A9;text-decoration:none;font-weight:500}.terms-checkbox .terms-text a:hover{text-decoration:underline}.btn-proceed{display:flex;align-items:center;justify-content:center;gap:0.5rem;width:100%;height:56px;background:#DA291C;color:white;border:none;border-radius:9999px;font-size:1rem;font-weight:600;cursor:pointer;transition:all 0.2s;box-shadow:0 4px 12px rgba(218, 41, 28, 0.3)}.btn-proceed svg{width:20px;height:20px;transition:transform 0.2s}.btn-proceed:hover:not(:disabled){background:rgb(172.8048780488, 32.5, 22.1951219512);box-shadow:0 6px 16px rgba(218, 41, 28, 0.4)}.btn-proceed:hover:not(:disabled) svg{transform:translateX(4px)}.btn-proceed:disabled,.btn-proceed.disabled{background:#CCCCCC;box-shadow:none;cursor:not-allowed}.btn-proceed:disabled svg,.btn-proceed.disabled svg{transform:none}`;const je=class{constructor(e){r(this,e)}onNext;onBack;cart=null;isLoading=true;error=null;promoCode="";isApplyingPromo=false;promoError=null;promoSuccess=false;termsAccepted=false;deletingItemId=null;componentWillLoad(){this.loadCart()}async loadCart(){this.isLoading=true;this.error=null;try{const e=await V.getCart();if(e.hasError){this.error=e.message||"Error al cargar el carrito";return}this.cart=e;console.log("[StepOrderSummary] Cart loaded:",this.cart);console.log("[StepOrderSummary] Products:",this.cart.products?.map((e=>({cartId:e.cartId,name:e.productName,equipment:e.equipment,home:e.home,plan:e.plan,parentCartId:e.parentCartId,installments:e.installments,price:e.decPrice}))))}catch(e){console.error("[StepOrderSummary] Error:",e);this.error="Error de conexión al cargar el carrito"}finally{this.isLoading=false}}handlePromoCodeChange=e=>{this.promoCode=e.target.value.toUpperCase();this.promoError=null;this.promoSuccess=false};handleApplyPromo=async()=>{if(!this.promoCode.trim()){this.promoError="Ingresa un código promocional";return}this.isApplyingPromo=true;this.promoError=null;this.promoSuccess=false;try{V.storeDiscountCoupon(this.promoCode);const e=await V.getCart(this.promoCode);if(e.hasError){this.promoError="Código promocional inválido";V.clearDiscountCoupon();return}this.cart=e;this.promoSuccess=true;console.log("[StepOrderSummary] Promo applied successfully")}catch(e){console.error("[StepOrderSummary] Promo error:",e);this.promoError="Error al aplicar el código";V.clearDiscountCoupon()}finally{this.isApplyingPromo=false}};handleRemoveItem=async e=>{this.deletingItemId=e.cartId;try{const t=await V.deleteItem(e.cartId,e.productId);if(t.hasError){console.error("[StepOrderSummary] Delete error:",t.message);return}await this.loadCart()}catch(e){console.error("[StepOrderSummary] Error removing item:",e)}finally{this.deletingItemId=null}};handleTermsChange=e=>{this.termsAccepted=e.target.checked};handleProceed=()=>{if(!this.termsAccepted){return}this.onNext?.()};formatPrice(e){return`$${(e||0).toFixed(2)}`}getItemCount(){return this.cart?.products?.reduce(((e,t)=>e+t.qty),0)||0}getEquipmentItems(){if(!this.cart?.products)return[];console.log("[StepOrderSummary] Classifying products...");return this.cart.products.filter((e=>{console.log("[StepOrderSummary] Item:",e.productName,{catalogName:e.catalogName,equipment:e.equipment,home:e.home,plan:e.plan,parentCartId:e.parentCartId,installments:e.installments});if(e.catalogName==="Catalogo de Planes Fijos"){console.log("[StepOrderSummary] -> PLAN (catalogName: Catalogo de Planes Fijos)");return false}if(e.plan){console.log("[StepOrderSummary] -> PLAN (explicit plan flag)");return false}if(e.parentCartId&&e.parentCartId>0){console.log("[StepOrderSummary] -> PLAN (has parentCartId)");return false}if(e.home&&e.internet){console.log("[StepOrderSummary] -> PLAN (home + internet flags)");return false}if(e.home&&e.installments>0){console.log("[StepOrderSummary] -> EQUIPMENT (home with installments)");return true}if(e.home&&(!e.installments||e.installments===0)){console.log("[StepOrderSummary] -> PLAN (home without installments = monthly plan)");return false}if(e.equipment||e.accesory){console.log("[StepOrderSummary] -> EQUIPMENT");return true}console.log("[StepOrderSummary] -> UNKNOWN (not classified)");return false}))}getPlanItems(){if(!this.cart?.products)return[];return this.cart.products.filter((e=>{if(e.catalogName==="Catalogo de Planes Fijos")return true;if(e.plan)return true;if(e.parentCartId&&e.parentCartId>0)return true;if(e.home&&e.internet)return true;if(e.home&&(!e.installments||e.installments===0))return true;return false}))}renderEquipmentItem(e,t){const r=this.deletingItemId===e.cartId;const a=this.getPlanItems().find((t=>t.parentCartId===e.cartId));return o("div",{class:"product-card",key:`equip-${e.cartId}`},o("div",{class:"section-header section-header--equipment"},o("div",{class:"section-header__icon"},o("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},o("rect",{x:"5",y:"2",width:"14",height:"20",rx:"2",ry:"2"}),o("line",{x1:"12",y1:"18",x2:"12.01",y2:"18"}))),o("div",{class:"section-header__text"},o("span",{class:"section-header__label"},"EQUIPO"),t===0&&o("span",{class:"section-header__badge"},"Principal"))),o("div",{class:"product-card__main"},o("div",{class:"product-card__image"},o("img",{src:e.imgUrl||e.detailImage||"/assets/placeholder.png",alt:e.productName,onError:e=>e.target.src="/assets/placeholder.png"})),o("div",{class:"product-card__details"},o("h3",{class:"product-name"},e.productName),o("div",{class:"product-specs"},e.colorName&&o("div",{class:"spec-item"},o("span",{class:"color-circle",style:{backgroundColor:e.webColor||"#ccc"}}),o("span",{class:"spec-label"},e.colorName)),e.storageName&&e.storage&&o("div",{class:"spec-item"},o("span",{class:"storage-badge"},e.storage,"GB")),o("div",{class:"spec-item"},o("span",{class:"qty-label"},"Cant: ",e.qty))),e.installments>1&&o("div",{class:"financing-info"},o("span",{class:"financing-label"},"Financiamiento de Equipo:"),o("span",{class:"financing-detail"},"Término de pago (",e.installments," meses)"))),o("div",{class:"product-card__pricing"},e.installments>1?o("div",{class:"price-financing"},o("span",{class:"price-monthly"},this.formatPrice(e.decTotalPerMonth||e.decPrice)),o("span",{class:"price-period"},"/mes")):o("div",{class:"price-single"},o("span",{class:"price-total"},this.formatPrice(e.decTotalPrice||e.decPrice)))),o("div",{class:"product-card__actions"},o("button",{class:"btn-action btn-action--delete",onClick:()=>this.handleRemoveItem(e),disabled:r,title:"Eliminar"},r?o("span",{class:"spinner-small"}):o("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},o("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"}),o("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),o("line",{x1:"14",y1:"11",x2:"14",y2:"17"}))))),a&&this.renderAssociatedPlan(a))}renderAssociatedPlan(e){const t=this.deletingItemId===e.cartId;return o("div",{class:"plan-section"},o("div",{class:"section-header section-header--plan"},o("div",{class:"section-header__icon"},o("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},o("path",{d:"M22 12h-4l-3 9L9 3l-3 9H2"}))),o("div",{class:"section-header__text"},o("span",{class:"section-header__label"},"TU PLAN"))),o("div",{class:"plan-section__content"},o("div",{class:"plan-info"},o("span",{class:"plan-name"},e.productName),o("span",{class:"plan-type"},"Plan de Internet")),o("div",{class:"plan-price"},o("span",{class:"price"},this.formatPrice(e.decPrice||e.decTotalPerMonth)),o("span",{class:"period"},"/mes")),o("button",{class:"btn-action btn-action--delete-small",onClick:()=>this.handleRemoveItem(e),disabled:t,title:"Eliminar plan"},t?o("span",{class:"spinner-small"}):o("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},o("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})))))}renderStandalonePlan(e){const t=this.deletingItemId===e.cartId;return o("div",{class:"product-card product-card--plan",key:`plan-${e.cartId}`},o("div",{class:"section-header section-header--plan"},o("div",{class:"section-header__icon"},o("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},o("path",{d:"M22 12h-4l-3 9L9 3l-3 9H2"}))),o("div",{class:"section-header__text"},o("span",{class:"section-header__label"},"PLAN DE INTERNET"))),o("div",{class:"product-card__main product-card__main--plan"},o("div",{class:"product-card__image product-card__image--plan"},o("img",{src:e.imgUrl||e.detailImage||"/assets/placeholder.png",alt:e.productName,onError:e=>e.target.src="/assets/placeholder.png"})),o("div",{class:"product-card__details"},o("h3",{class:"product-name"},e.productName),o("span",{class:"plan-type"},"Renta mensual")),o("div",{class:"product-card__pricing"},o("div",{class:"price-financing"},o("span",{class:"price-monthly"},this.formatPrice(e.decPrice||e.decTotalPerMonth)),o("span",{class:"price-period"},"/mes"))),o("div",{class:"product-card__actions"},o("button",{class:"btn-action btn-action--delete",onClick:()=>this.handleRemoveItem(e),disabled:t,title:"Eliminar"},t?o("span",{class:"spinner-small"}):o("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},o("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"}))))))}renderPromoCode(){return o("div",{class:"summary-card promo-section"},o("h4",{class:"summary-card__title"},o("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},o("path",{d:"M20.59 13.41l-7.17 7.17a2 2 0 01-2.83 0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"}),o("line",{x1:"7",y1:"7",x2:"7.01",y2:"7"})),"Cupón de descuento"),o("div",{class:"promo-input-group"},o("input",{type:"text",class:{"promo-input":true,error:!!this.promoError,success:this.promoSuccess},placeholder:"Ingresa tu código",value:this.promoCode,onInput:this.handlePromoCodeChange,disabled:this.isApplyingPromo}),o("button",{class:"promo-button",onClick:this.handleApplyPromo,disabled:this.isApplyingPromo||!this.promoCode.trim()},this.isApplyingPromo?o("span",{class:"spinner-small"}):"Aplicar")),this.promoError&&o("span",{class:"promo-message error"},o("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"14",height:"14"},o("circle",{cx:"12",cy:"12",r:"10"}),o("line",{x1:"12",y1:"8",x2:"12",y2:"12",stroke:"white","stroke-width":"2"}),o("line",{x1:"12",y1:"16",x2:"12.01",y2:"16",stroke:"white","stroke-width":"2"})),this.promoError),this.promoSuccess&&o("span",{class:"promo-message success"},o("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"14",height:"14"},o("circle",{cx:"12",cy:"12",r:"10"}),o("polyline",{points:"9 12 11 14 15 10",fill:"none",stroke:"white","stroke-width":"2"})),"¡Cupón aplicado!"))}renderPaymentSummary(){if(!this.cart)return null;const e=this.cart.subTotalPerMonth||0;const t=this.cart.subTotalPrice||0;const r=this.cart.totalTax||0;const a=this.cart.totalPrice||0;const i=this.cart.totalDownPayment||0;const n=0;return o("div",{class:"summary-card payment-summary"},e>0&&o("div",{class:"rent-section"},o("div",{class:"rent-row"},o("span",{class:"rent-label"},"Renta mensual"),o("span",{class:"rent-value"},this.formatPrice(e))),o("p",{class:"rent-note"},"*No incluye cargos estatales y federales")),o("div",{class:"payment-breakdown"},o("h4",{class:"summary-card__title"},o("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},o("rect",{x:"1",y:"4",width:"22",height:"16",rx:"2",ry:"2"}),o("line",{x1:"1",y1:"10",x2:"23",y2:"10"})),"Detalle del pago"),o("div",{class:"detail-rows"},t>0&&o("div",{class:"detail-row"},o("span",{class:"label"},"Subtotal equipos"),o("span",{class:"value"},this.formatPrice(t))),i>0&&o("div",{class:"detail-row"},o("span",{class:"label"},"Pago inicial"),o("span",{class:"value"},this.formatPrice(i))),n>0,o("div",{class:"detail-row"},o("span",{class:"label"},"Cargos estatales y federales"),o("span",{class:"value"},this.formatPrice(r))),o("div",{class:"detail-row detail-row--shipping"},o("span",{class:"label"},"Costo de envío"),o("span",{class:"value value--free"},"GRATIS"))),o("div",{class:"total-section"},o("div",{class:"total-row"},o("span",{class:"total-label"},"Paga hoy"),o("span",{class:"total-value"},this.formatPrice(a))))))}renderTermsCheckbox(){return o("div",{class:"terms-section"},o("label",{class:"terms-checkbox"},o("input",{type:"checkbox",checked:this.termsAccepted,onChange:this.handleTermsChange}),o("span",{class:"checkmark"},o("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3"},o("polyline",{points:"20 6 9 17 4 12"}))),o("span",{class:"terms-text"},"Acepto los ",o("a",{href:"#",onClick:e=>e.preventDefault()},"términos y condiciones")," de Claro Puerto Rico")))}render(){const e=this.getItemCount();const t=e>0;const r=t&&this.termsAccepted;const a=this.getEquipmentItems();const n=this.getPlanItems().filter((e=>!e.parentCartId));return o(i,{key:"f3078779259454151b63caefbeebeb148f5732a8"},o("div",{key:"a09063862b6280f45f2d5d305ddcd640012bd4b1",class:"step-order-summary"},o("header",{key:"f0ca8385aa82fdda838145443541d7e65f6e4c1f",class:"header"},o("button",{key:"c3558e8d2c0db9f9af21e711ac6f428a4a49acd6",class:"btn-back",onClick:this.onBack},o("svg",{key:"28558bb462310b7a6a23608c7467a9e8ce2ea3b2",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},o("path",{key:"d645c1e278c6cbab619f67818675df71827ac33d",d:"M19 12H5M12 19l-7-7 7-7"})),o("span",{key:"af0c12aaec5c0221556e2b3b094a82741540417c"},"Regresar")),o("div",{key:"e6802e1f9159a00dd01c547d958bb5279838bc78",class:"header__title-group"},o("h1",{key:"0ab7ef82ad47d7664b31cf24a945a88fd4cbdedf",class:"title"},"Resumen de tu orden"),t&&o("span",{key:"57bcf4371865e75eabce8a4da2f4bc5598a1cf43",class:"item-count"},e," ",e===1?"artículo":"artículos"))),this.isLoading&&o("div",{key:"e8ec7673aa7331762e22728e12987534ee0b3f37",class:"state-container"},o("div",{key:"976f03187aeb44f5f3eae498c8df312f477069c7",class:"spinner"}),o("p",{key:"5a06e8d94acabbcf0833472cd8cb37a1617e8db6"},"Cargando tu carrito...")),this.error&&!this.isLoading&&o("div",{key:"bc0914b1ab30fc1f57b2045467b3dcac859c0300",class:"state-container state-container--error"},o("svg",{key:"8b855cfe9c88ee6b8fc2dd84a8f4c07664115022",class:"state-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},o("circle",{key:"f6356ee719d4c1f3c06c05dbf2b7205fde228b0b",cx:"12",cy:"12",r:"10"}),o("line",{key:"5e5aedc072e5199916363ada43e233ae9b85f015",x1:"12",y1:"8",x2:"12",y2:"12"}),o("line",{key:"6c03cd384b149c328b299d589ef78afdb360a403",x1:"12",y1:"16",x2:"12.01",y2:"16"})),o("p",{key:"9a0f64eda564cc5ff6fd67d1aa5261704e30f2e2"},this.error),o("button",{key:"9256deb1eb125209c379b3049da7cc608dcbf9a8",class:"btn-retry",onClick:()=>this.loadCart()},"Reintentar")),!this.isLoading&&!this.error&&!t&&o("div",{key:"6956c7ac65ace723f08e25acba5f9dc8367f8656",class:"state-container state-container--empty"},o("svg",{key:"15a42e13d01378aa83d52fff595b95608ee86960",class:"state-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},o("circle",{key:"9b6f07f084390e8cbefdbca9d864d0395d192025",cx:"9",cy:"21",r:"1"}),o("circle",{key:"6db62811ec31fd409b01506226fa69419d01d1d5",cx:"20",cy:"21",r:"1"}),o("path",{key:"c68a17a366dd168222b0e22b0d13e24ddc7c7a6d",d:"M1 1h4l2.68 13.39a2 2 0 002 1.61h9.72a2 2 0 002-1.61L23 6H6"})),o("h3",{key:"f32baa1ad21d0726fe5142cb94c0e3814310ad90"},"Tu carrito está vacío"),o("p",{key:"3aa024bce7c2236936f10f81ffcefa23fca6fdca"},"Agrega productos para continuar con tu compra"),o("button",{key:"6e9d8620d8b5c871102931f64da36ccb0854ef16",class:"btn-back-catalog",onClick:this.onBack},"Ir al catálogo")),!this.isLoading&&!this.error&&t&&o("div",{key:"40c508f97742927150f8b5b3d5119d2eb9d033bc",class:"content-layout"},o("div",{key:"abcdc24817a266417a2860d1d4e55d2d7171567b",class:"products-column"},a.map(((e,t)=>this.renderEquipmentItem(e,t))),n.map((e=>this.renderStandalonePlan(e)))),o("div",{key:"6aa4ab795217930bdd493fec770503f4eba7fe5b",class:"summary-column"},this.renderPromoCode(),this.renderPaymentSummary(),this.renderTermsCheckbox(),o("button",{key:"a55359ecc577a012268835e3813ebcd5f76ba925",class:{"btn-proceed":true,disabled:!r},onClick:this.handleProceed,disabled:!r},o("span",{key:"28a482c024ac541c6e6925586a0ce2071b4adeea"},"Procesar orden"),o("svg",{key:"5c28b25c13af19eac07b61a4ac3d62aa1db177cd",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},o("path",{key:"4bdd38dee0876c05542c2b23ddd8c0e7125d6add",d:"M5 12h14M12 5l7 7-7 7"})))))))}};je.style=Be();const Ue=()=>`:host{display:block;width:100%;min-height:100%;background-color:#FAFAFA}.step-payment{width:100%;max-width:800px;margin:0 auto;padding:1.5rem;min-height:100vh}.header{display:flex;align-items:center;gap:1rem;margin-bottom:1.5rem;flex-wrap:wrap}.header .btn-back-nav{display:flex;align-items:center;gap:0.25rem;background:none;border:none;color:#0097A9;font-size:0.875rem;cursor:pointer;padding:0.25rem}.header .btn-back-nav svg{width:20px;height:20px}.header .btn-back-nav:hover{text-decoration:underline}.header .title{font-size:1.75rem;font-weight:700;color:#1A1A1A;margin:0;flex:1}.content{background:white;border-radius:0.75rem;padding:1.5rem;box-shadow:0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);min-height:400px}.loading-container{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:300px;text-align:center;padding:2rem}.loading-container h3{font-size:1.5rem;color:#1A1A1A;margin:1rem 0 0.5rem 0}.loading-container p{color:#666666;margin:0 0 0.5rem 0}.loading-container .warning{color:#DA291C;font-weight:500;font-size:0.875rem}.spinner{width:48px;height:48px;border:4px solid #E5E5E5;border-top-color:#DA291C;border-radius:50%;animation:spin 1s linear infinite}@keyframes spin{to{transform:rotate(360deg)}}.payment-container{display:flex;flex-direction:column;gap:1.5rem}.payment-summary{background:#FAFAFA;border-radius:0.5rem;padding:1rem}.payment-summary h3{font-size:1rem;font-weight:600;color:#1A1A1A;margin:0 0 1rem 0}.amount-display{display:flex;justify-content:space-between;align-items:center;padding:0.5rem 0;border-bottom:1px solid #E5E5E5}.amount-display .label{font-size:1rem;color:#666666}.amount-display .value{font-size:1.5rem;font-weight:700;color:#DA291C}.payment-items{margin-top:1rem}.payment-items .payment-item{display:flex;justify-content:space-between;align-items:center;padding:0.25rem 0;font-size:0.875rem}.payment-items .payment-item .item-type{color:#666666}.payment-items .payment-item .item-amount{color:#1A1A1A;font-weight:500}.iframe-container{border:1px solid #E5E5E5;border-radius:0.5rem;overflow:hidden;min-height:400px}.iframe-container iframe{display:block;border:none;width:100%}.iframe-placeholder{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:300px;background:#FAFAFA}.iframe-placeholder p{color:#666666;margin-top:1rem}.success-container{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:300px;text-align:center;padding:2rem}.success-container .success-icon{width:80px;height:80px;background:rgb(209.6296296296, 237.3703703704, 219.2222222222);border-radius:50%;display:flex;align-items:center;justify-content:center;margin-bottom:1rem}.success-container .success-icon svg{width:48px;height:48px;color:#44AF69}.success-container h3{font-size:1.5rem;color:#44AF69;margin:0 0 0.5rem 0}.success-container p{color:#666666;margin:0 0 0.5rem 0}.success-container .redirect-note{font-size:0.875rem;color:#808080}.error-container{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:300px;text-align:center;padding:2rem}.error-container .error-icon{width:80px;height:80px;background:rgb(245.2682926829, 183.75, 179.2317073171);border-radius:50%;display:flex;align-items:center;justify-content:center;margin-bottom:1rem}.error-container .error-icon svg{width:48px;height:48px;color:#DA291C}.error-container h3{font-size:1.5rem;color:#DA291C;margin:0 0 0.5rem 0}.error-container p{color:#666666;margin:0 0 1.5rem 0;max-width:400px}.error-actions{display:flex;gap:1rem;flex-wrap:wrap;justify-content:center}.btn-retry{height:44px;padding:0 1.5rem;background:#DA291C;color:white;border:none;border-radius:9999px;font-size:1rem;font-weight:600;cursor:pointer;transition:background 0.2s}.btn-retry:hover{background:rgb(172.8048780488, 32.5, 22.1951219512)}.btn-back{height:44px;padding:0 1.5rem;background:white;color:#4D4D4D;border:1px solid #CCCCCC;border-radius:9999px;font-size:1rem;font-weight:600;cursor:pointer;transition:all 0.2s}.btn-back:hover{background:#FAFAFA;border-color:#999999}.btn-cancel{align-self:center;height:44px;padding:0 1.5rem;background:white;color:#666666;border:1px solid #CCCCCC;border-radius:9999px;font-size:0.875rem;cursor:pointer;transition:all 0.2s}.btn-cancel:hover{background:#FAFAFA;border-color:#999999}`;const $e=class{constructor(e){r(this,e)}get el(){return n(this)}onNext;onBack;paymentIframeUrl;screen="loading";error=null;cart=null;orderBan="";totalAmount=0;paymentItems=[];iframeUrl="";iframeHeight="500px";paymentResult=null;userName="";userLastName="";userEmail="";componentWillLoad(){this.loadCartAndPreparePayment()}componentDidLoad(){window.addEventListener("message",this.handleIframeMessage)}disconnectedCallback(){window.removeEventListener("message",this.handleIframeMessage)}async loadCartAndPreparePayment(){this.screen="loading";this.error=null;try{const e=await V.getCart();if(e.hasError){this.error=e.message||"Error al cargar el carrito";this.screen="error";return}if(!e.products||e.products.length===0){this.error="El carrito está vacío";this.screen="error";return}this.cart=e;this.paymentItems=oe.buildPaymentItems({depositAmount:e.depositAmount,totalDownPayment:e.totalDownPayment,totalTax:e.totalTax,totalPrice:e.totalPrice,installmentAmount:e.installmentAmount,cartUpdateResponse:e.cartUpdateResponse});this.totalAmount=this.paymentItems.length>0?oe.calculateTotalAmount(this.paymentItems):e.totalPrice||0;const t=te.getStoredShippingAddress();if(t){const e=t.name.split(" ");this.userName=e[0]||"";this.userLastName=e.slice(1).join(" ")||"";this.userEmail=t.email}await this.createOrder()}catch(e){console.error("[StepPayment] Error:",e);this.error="Error de conexión";this.screen="error"}}async createOrder(){this.screen="creating-order";try{const e=te.getZipCode();const t=await oe.createOrder({flowId:"5",frontFlowId:"1",frontFlowName:"CLARO HOGAR Purchase",amount:this.totalAmount.toString(),email:this.userEmail,zipCode:e,deposit:(this.cart?.totalDownPayment||0).toString()});if(t.hasError){this.error=t.errorDisplay||t.message||"Error al crear la orden";this.screen="error";return}this.orderBan=t.ban||"";await this.initializePaymentIframe()}catch(e){console.error("[StepPayment] Create order error:",e);this.error="Error al crear la orden";this.screen="error"}}async initializePaymentIframe(){if(this.totalAmount<=0){await this.handleFreePayment();return}try{const e={firstName:this.userName,lastName:this.userLastName,email:this.userEmail,amount:this.totalAmount,transactionType:this.paymentItems.length>0?"MULTIPLE":"payment",selectBan:this.orderBan,permissions:{provision:true,displayConfirmation:true,emailNotification:true,showInstrument:true,stroeInstrument:true,useBanZipCode:true},paymentItems:this.paymentItems.length>0?this.paymentItems:undefined};const t=await oe.getPaymentIframe(e);if(t.errorInfo?.hasError||!t.url){this.error=t.errorInfo?.errorDisplay||"Error al inicializar el pago";this.screen="error";return}this.iframeUrl=t.url;this.screen="payment"}catch(e){console.error("[StepPayment] Init iframe error:",e);this.error="Error al inicializar el formulario de pago";this.screen="error"}}handleIframeMessage=e=>{if(typeof e.data!=="string")return;try{const t=JSON.parse(atob(e.data));if(t.state==="dimensions"){this.iframeHeight=t.data.height}if(t.state==="canceled"){this.handlePaymentCancel()}if(t.state==="paymentResult"){if(t.data){const e=t.data;const r=JSON.parse(e).paymentResult;const a=JSON.parse(atob(r));if(a.success){this.handlePaymentSuccess(a)}else{this.handlePaymentError(a)}}}}catch{}};async handlePaymentSuccess(e){this.screen="processing";this.paymentResult=e;try{const t=await oe.recordPayment({ban:this.orderBan,cardNumber:e.paymentCard||"",cardType:e.paymentMethod||"",authorizationNumber:e.authorizationNumber||"",referenceNumber:e.provisioning?.referenceNumber||"",description:e.description||"",operationId:e.operationId||"",amount:this.totalAmount.toString(),deposit:(this.cart?.totalDownPayment||0).toString()});if(t.hasError){this.error=t.errorDisplay||"Error al registrar el pago";this.screen="error";return}oe.storePaymentResult(e);this.screen="success";setTimeout((()=>{this.onNext?.()}),2e3)}catch(e){console.error("[StepPayment] Record payment error:",e);this.error="Error al registrar el pago";this.screen="error"}}async handlePaymentError(e){await oe.recordPaymentError(this.orderBan,"",e.description||"Payment failed",e.operationId||"",(this.cart?.totalDownPayment||0).toString(),e.paymentMethod||"",e.paymentCard||"",this.totalAmount.toString());this.error=e.description||"El pago no pudo ser procesado";this.screen="error"}handlePaymentCancel(){this.onBack?.()}async handleFreePayment(){this.screen="processing";try{const e=Math.floor(Math.random()*9e5+1e5).toString();const t=await oe.recordPayment({ban:this.orderBan,cardNumber:"1111",cardType:"V",authorizationNumber:"FREEPR",referenceNumber:"FREEPROMO",description:"Free promotion",operationId:e,amount:"0",deposit:"0"});if(t.hasError){this.error=t.errorDisplay||"Error al procesar";this.screen="error";return}this.screen="success";setTimeout((()=>{this.onNext?.()}),2e3)}catch(e){console.error("[StepPayment] Free payment error:",e);this.error="Error al procesar";this.screen="error"}}handleRetry=()=>{this.loadCartAndPreparePayment()};formatPrice(e){return`$${(e||0).toFixed(2)}`}renderLoading(){return o("div",{class:"loading-container"},o("div",{class:"spinner"}),o("p",null,"Cargando información del pago..."))}renderCreatingOrder(){return o("div",{class:"loading-container"},o("div",{class:"spinner"}),o("h3",null,"Preparando tu orden"),o("p",null,"Por favor espera mientras procesamos tu solicitud..."),o("p",{class:"warning"},"No cierres esta ventana ni navegues a otra página."))}renderPaymentForm(){return o("div",{class:"payment-container"},o("div",{class:"payment-summary"},o("h3",null,"Resumen del pago"),o("div",{class:"amount-display"},o("span",{class:"label"},"Total a pagar:"),o("span",{class:"value"},this.formatPrice(this.totalAmount))),this.paymentItems.length>0&&o("div",{class:"payment-items"},this.paymentItems.map((e=>o("div",{class:"payment-item"},o("span",{class:"item-type"},this.getPaymentTypeLabel(e.paymentType)),o("span",{class:"item-amount"},this.formatPrice(e.amount))))))),o("div",{class:"iframe-container"},this.iframeUrl?o("iframe",{src:this.iframeUrl,width:"100%",height:this.iframeHeight,frameBorder:"0",title:"Payment Form"}):o("div",{class:"iframe-placeholder"},o("div",{class:"spinner"}),o("p",null,"Cargando formulario de pago..."))),o("button",{class:"btn-cancel",onClick:()=>this.handlePaymentCancel()},"Cancelar"))}renderProcessing(){return o("div",{class:"loading-container"},o("div",{class:"spinner"}),o("h3",null,"Procesando pago"),o("p",null,"Por favor espera mientras confirmamos tu pago..."))}renderSuccess(){return o("div",{class:"success-container"},o("div",{class:"success-icon"},o("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},o("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),o("polyline",{points:"22 4 12 14.01 9 11.01"}))),o("h3",null,"Pago exitoso"),o("p",null,"Tu pago ha sido procesado correctamente."),o("p",{class:"redirect-note"},"Redirigiendo a la confirmación..."))}renderError(){return o("div",{class:"error-container"},o("div",{class:"error-icon"},o("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},o("circle",{cx:"12",cy:"12",r:"10"}),o("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),o("line",{x1:"9",y1:"9",x2:"15",y2:"15"}))),o("h3",null,"Error en el pago"),o("p",null,this.error),o("div",{class:"error-actions"},o("button",{class:"btn-retry",onClick:this.handleRetry},"Intentar nuevamente"),o("button",{class:"btn-back",onClick:()=>this.onBack?.()},"Volver")))}getPaymentTypeLabel(e){const t={DEPOSIT:"Depósito",DOWNPAYMENT:"Pago inicial",TAXES:"Impuestos",INSTALLMENT:"Cuotas",PASTDUEONLY:"Balance pendiente"};return t[e]||e}render(){return o(i,{key:"244b9d9cfebdceabf3d3a3bdf632c909587dc300"},o("div",{key:"fe4eb660c01f29c76bba4d0e0fb3bf70093f9f48",class:"step-payment"},o("div",{key:"6539d4c6899c638f8b7c1d752116746891995a0c",class:"header"},this.screen!=="processing"&&this.screen!=="success"&&o("button",{key:"7c544aef3f7fbfaaeda24e705a2e01b20fe91bcc",class:"btn-back-nav",onClick:()=>this.onBack?.()},o("svg",{key:"85e53558ee358a157bb99693e64ce1e9fbc4aae8",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},o("path",{key:"5783eb28e66f54e2fd54d0c3e716265b23a57662",d:"M19 12H5M12 19l-7-7 7-7"})),"Regresar"),o("h1",{key:"4aa590ba3bb6c7dadc0669e82b357fcdbb824fe2",class:"title"},"Pago")),o("div",{key:"8f4705155f8b553de4bc31e712041f91adebcbfd",class:"content"},this.screen==="loading"&&this.renderLoading(),this.screen==="creating-order"&&this.renderCreatingOrder(),this.screen==="payment"&&this.renderPaymentForm(),this.screen==="processing"&&this.renderProcessing(),this.screen==="success"&&this.renderSuccess(),this.screen==="error"&&this.renderError())))}};$e.style=Ue();const qe=()=>`@keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes slideUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}@keyframes spin{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}:host{display:block}.step-plans{width:100%;min-height:100vh;padding:1.5rem;padding-bottom:180px}@media (min-width: 768px){.step-plans{padding:2rem;padding-bottom:140px}}.step-plans__header{display:flex;align-items:center;justify-content:space-between;padding-bottom:1rem;margin-bottom:1.5rem;position:relative}.step-plans__header::after{content:"";position:absolute;bottom:0;left:50%;transform:translateX(-50%);width:100vw;height:1px;background:#E5E5E5}.step-plans__title{font-size:1.5rem;font-weight:700;color:#333333;margin:0}@media (min-width: 768px){.step-plans__title{font-size:1.75rem}}.step-plans__btn-back{background:#FFFFFF;border:2px solid #0097A9;color:#0097A9;padding:0.5rem 1.5rem;border-radius:9999px;font-size:0.875rem;font-weight:600;cursor:pointer;transition:all 0.2s ease}.step-plans__btn-back:hover{background:#0097A9;color:#FFFFFF}.step-plans__loading{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:3rem;color:#666666}.step-plans__spinner{width:40px;height:40px;border:3px solid #E5E5E5;border-top-color:#0097A9;border-radius:50%;animation:spin 1s linear infinite;margin-bottom:1rem}.step-plans__error{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:2rem;text-align:center;color:#DA291C}.step-plans__error button{display:inline-flex;align-items:center;justify-content:center;gap:0.5rem;padding:0 1.5rem;font-family:"AMX", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, sans-serif;font-size:1rem;font-weight:600;line-height:1;text-decoration:none;border:none;border-radius:9999px;cursor:pointer;transition:all 150ms ease}.step-plans__error button:disabled{opacity:0.5;cursor:not-allowed}.step-plans__error button{height:48px;background-color:transparent;color:#0097A9;border:2px solid #0097A9}.step-plans__error button:hover:not(:disabled){background-color:rgba(0, 151, 169, 0.1)}.step-plans__error button:active:not(:disabled){background-color:rgba(0, 151, 169, 0.2)}.step-plans__error button{margin-top:1rem}.step-plans__carousel-container{padding:1rem 0 3rem}.step-plans__empty{display:flex;align-items:center;justify-content:center;padding:3rem;color:#666666}.step-plans__footer{position:fixed;bottom:0;left:0;right:0;background:#FFFFFF;border-top:1px solid #E5E5E5;padding:0.75rem 1.5rem;z-index:200;box-shadow:0 -4px 12px rgba(0, 0, 0, 0.1);display:flex;align-items:center;justify-content:space-between}@media (max-width: 767px){.step-plans__footer{flex-direction:column;gap:0.75rem;padding:1rem}}.step-plans__footer-left{display:flex;flex-direction:column}@media (max-width: 767px){.step-plans__footer-left{width:100%}}.step-plans__footer-info{display:flex;gap:1.5rem}.step-plans__footer-item{display:flex;flex-direction:column}.step-plans__footer-item--separator{padding-left:1.5rem;border-left:1px solid #E5E5E5}.step-plans__footer-label{font-size:0.75rem;color:#666666}.step-plans__footer-value{font-size:1.25rem;font-weight:700;color:#333333}.step-plans__footer-value--highlight{color:#DA291C}.step-plans__footer-note{font-size:0.75rem;color:#808080;margin:0.25rem 0 0}.step-plans__footer-btn{display:inline-flex;align-items:center;justify-content:center;gap:0.5rem;padding:0 1.5rem;font-family:"AMX", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, sans-serif;font-size:1rem;font-weight:600;line-height:1;text-decoration:none;border:none;border-radius:9999px;cursor:pointer;transition:all 150ms ease}.step-plans__footer-btn:disabled{opacity:0.5;cursor:not-allowed}.step-plans__footer-btn{height:48px;background-color:#DA291C;color:#FFFFFF}.step-plans__footer-btn:hover:not(:disabled){background-color:rgb(181.843902439, 34.2, 23.356097561)}.step-plans__footer-btn:active:not(:disabled){background-color:rgb(163.7658536585, 30.8, 21.0341463415)}.step-plans__footer-btn{min-width:160px}@media (max-width: 767px){.step-plans__footer-btn{width:100%}}.plan-card{background:#FFFFFF;border-radius:16px;border:2px solid #0097A9;box-shadow:0 2px 12px rgba(0, 0, 0, 0.1);overflow:hidden;cursor:pointer;transition:all 0.2s ease;display:flex;flex-direction:column;min-height:340px}.plan-card:hover{box-shadow:0 6px 20px rgba(0, 151, 169, 0.25);transform:translateY(-2px)}.plan-card--selected{border-color:#0097A9;box-shadow:0 6px 24px rgba(0, 151, 169, 0.3)}.plan-card--processing{pointer-events:none;opacity:0.8}.plan-card__header{display:flex;justify-content:center;padding-top:0}.plan-card__name{background:#1a1a1a;color:#FFFFFF;font-size:0.875rem;font-weight:700;text-transform:uppercase;letter-spacing:0.5px;line-height:1.3;padding:0.75rem 1rem;width:70%;text-align:center;border-radius:0 0 12px 12px}.plan-card__body{flex:1;padding:1.25rem 1rem;text-align:center;display:flex;flex-direction:column}.plan-card__includes-label{font-size:1rem;color:#666666;margin:0 0 0.75rem;font-weight:500}.plan-card__features{list-style:none;padding:0;margin:0 0 1rem;text-align:center;flex:1}.plan-card__feature{margin-bottom:0.5rem;font-size:0.875rem;color:#333333;font-weight:600}.plan-card__feature:last-child{margin-bottom:0}.plan-card__price{font-size:1.75rem;font-weight:700;color:#0097A9;margin:1rem 0 0}.plan-card__footer{padding:1rem}.plan-card__btn{width:100%;padding:0.75rem 1rem;border-radius:25px;font-size:1rem;font-weight:600;cursor:pointer;transition:all 0.2s ease;background:#FFFFFF;color:#0097A9;border:2px solid #0097A9}.plan-card__btn:hover{background:rgba(0, 151, 169, 0.1)}.plan-card__btn--selected{background:#0097A9;color:#FFFFFF;border-color:#0097A9}.plan-card__btn--selected:hover{background:rgb(0, 114.5455621302, 128.2)}.plan-card__btn--loading{cursor:wait;opacity:0.8}.plan-card__btn:disabled{cursor:not-allowed;opacity:0.6}.plan-card__btn-loading{display:inline-flex;align-items:center;gap:0.5rem}.plan-card__btn-spinner{width:14px;height:14px;border:2px solid rgba(255, 255, 255, 0.3);border-top-color:#FFFFFF;border-radius:50%;animation:spin 0.8s linear infinite}@keyframes spin{to{transform:rotate(360deg)}}`;const Je=class{constructor(e){r(this,e)}onNext;onBack;plans=[];selectedPlan=null;isLoading=true;error=null;isAddingToCart=false;async componentWillLoad(){await this.loadPlans();const e=D.getStoredPlanId();if(e>0){const t=this.plans.find((t=>t.planId===e));if(t){this.selectedPlan=t;_.selectPlan(t)}}}async loadPlans(){this.isLoading=true;this.error=null;try{const e=g.location?.serviceType||"GPON";let t=0;if(e==="CLARO HOGAR"){t=Y.getSubcatalogId();console.log("[StepPlans] CLARO HOGAR - using subcatalogId:",t)}this.plans=await D.getPlans(e,t);this.plans=D.sortByPrice(this.plans)}catch(e){this.error="Error al cargar los planes";console.error(e)}finally{this.isLoading=false}}handleSelectPlan=async e=>{if(this.selectedPlan?.planId===e.planId){return}this.isAddingToCart=true;this.error=null;try{const t=D.getStoredPlanId();const r=D.getCartId();if(t>0&&t!==e.planId&&r>0){console.log("[StepPlans] Removing previous plan from cart:",t);await D.deleteFromCart(r)}console.log("[StepPlans] Adding plan to cart:",e.planId,e.planName);await D.addToCart(e);this.selectedPlan=e;_.selectPlan(e);console.log("[StepPlans] Plan added successfully")}catch(t){console.error("[StepPlans] Error adding plan to cart:",t);this.error="Error al agregar el plan. Por favor intente de nuevo.";this.selectedPlan=e;_.selectPlan(e)}finally{this.isAddingToCart=false}};handleContinue=()=>{if(this.selectedPlan&&!this.isAddingToCart){this.onNext?.()}};renderPlanCard(e){const t=this.selectedPlan?.planId===e.planId;const r=this.isAddingToCart&&t;const a=D.parsePlanFeatures(e.planDesc||"");const i=a.length>0?a:["Internet fibra 1","Internet 2","Internet 3"];return o("div",{class:{"plan-card":true,"plan-card--selected":t,"plan-card--processing":r},onClick:()=>!this.isAddingToCart&&this.handleSelectPlan(e)},o("div",{class:"plan-card__header"},o("span",{class:"plan-card__name"},e.planName)),o("div",{class:"plan-card__body"},o("p",{class:"plan-card__includes-label"},"Plan incluye"),o("ul",{class:"plan-card__features"},i.slice(0,4).map((e=>o("li",{class:"plan-card__feature"},e)))),o("p",{class:"plan-card__price"},me(e.decPrice))),o("div",{class:"plan-card__footer"},o("button",{class:{"plan-card__btn":true,"plan-card__btn--selected":t,"plan-card__btn--loading":r},disabled:this.isAddingToCart},r?o("span",{class:"plan-card__btn-loading"},o("span",{class:"plan-card__btn-spinner"}),"Agregando..."):t?"Plan seleccionado":"Solicitar plan")))}render(){const e=this.selectedPlan?this.selectedPlan.decPrice:0;const t=0;return o(i,{key:"3b5f35cdfc65071e8812f2fed7ee34235d79f286"},o("div",{key:"965c768228db89a86b0750530448f181e4c2df2c",class:"step-plans"},o("header",{key:"d25edd634609f7b234b7fae6eb240d296b015593",class:"step-plans__header"},o("h1",{key:"b1a105e2c2bbb544b4daab329c6912087cf62704",class:"step-plans__title"},"Elige tu plan"),o("button",{key:"6ef1b13c36060d6fdb88a9cb58b723d99dc369f5",class:"step-plans__btn-back",onClick:this.onBack},"Regresar")),this.isLoading&&o("div",{key:"15df9d2b0979776f1a4b955fc24c6ea0d104dc62",class:"step-plans__loading"},o("div",{key:"da32e48865d242ac96eb417c9ca73c62c8d553fc",class:"step-plans__spinner"}),o("p",{key:"65718e3a2daf46185c69beb8904daf5738fbd271"},"Cargando planes...")),this.error&&o("div",{key:"caaeda8da6c56994f58bb9ffe6330ea90ba8dd98",class:"step-plans__error"},o("p",{key:"53dc7b6ebef2312749c01822d0a6fbfe800b0674"},this.error),o("button",{key:"1aed81ca60266a511e186b474a373e5ba8ab551b",onClick:()=>this.loadPlans()},"Reintentar")),!this.isLoading&&!this.error&&this.plans.length>0&&o("div",{key:"aa59736d6519793c9d996640e983f2d506faf44c",class:"step-plans__carousel-container"},o("ui-carousel",{key:"44f6ce2018f3291c2eefedb55dcb0c69d1700214",totalItems:this.plans.length,gap:24,showNavigation:false,showPagination:true,breakpoints:[{minWidth:0,slidesPerView:1},{minWidth:500,slidesPerView:2},{minWidth:800,slidesPerView:3},{minWidth:1100,slidesPerView:4}]},this.plans.map((e=>this.renderPlanCard(e))))),!this.isLoading&&!this.error&&this.plans.length===0&&o("div",{key:"f2307ae3051846e8856bc79357c1e0484c932230",class:"step-plans__empty"},o("p",{key:"5aac2fe50868431fadc98608ffaaaee27e8a949f"},"No hay planes disponibles para tu área.")),o("footer",{key:"946020db3fcb9988b69c917e47eafb3d4e0c3580",class:"step-plans__footer"},o("div",{key:"38d5db323807e7dee0e81802f2a74b3ece20f22a",class:"step-plans__footer-left"},o("div",{key:"55a16f53a716352a46a05d5978ae1fcc922aeaa8",class:"step-plans__footer-info"},o("div",{key:"dfce819c5772d8a823242afe30d58f0f7c2d2638",class:"step-plans__footer-item"},o("span",{key:"6906f80d9838041847a6c9243522ff2da5ae0f3e",class:"step-plans__footer-label"},"Pago mensual"),o("span",{key:"ad72c7c7777399ae3bf8fc8511fce1ba0aebce54",class:"step-plans__footer-value"},me(e))),o("div",{key:"ac4e5f57aa18cb7cae2687b663be7bd5d2c44b81",class:"step-plans__footer-item step-plans__footer-item--separator"},o("span",{key:"e6e40cd9ef813aa8400a01f639d93e71c77e3454",class:"step-plans__footer-label"},"Paga hoy"),o("span",{key:"71af6c8f8b90dd23f539188c4a41977c4fb3c423",class:"step-plans__footer-value step-plans__footer-value--highlight"},me(t)))),o("p",{key:"ce00ab6c4a85cc7e76b426d685398282a90478ff",class:"step-plans__footer-note"},"Renta mensual aproximada no incluye cargos estatales, federales, ni otros impuestos.")),o("button",{key:"e1cc610390e28136802f93cc1e2f0a86836fa2f1",class:"step-plans__footer-btn",onClick:this.handleContinue,disabled:!this.selectedPlan||this.isAddingToCart},this.isAddingToCart?"Procesando...":"Continuar"))))}};Je.style=qe();const Ve=()=>`:host{display:block;width:100%;min-height:100%;background-color:#FAFAFA}.step-product-detail{width:100%;max-width:1200px;margin:0 auto;padding:1.5rem}.loading-container,.error-container{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:400px;text-align:center;padding:2rem}.spinner{width:48px;height:48px;border:4px solid #E5E5E5;border-top-color:#DA291C;border-radius:50%;animation:spin 1s linear infinite;margin-bottom:1rem}.spinner-small{display:inline-block;width:16px;height:16px;border:2px solid rgba(255, 255, 255, 0.3);border-top-color:white;border-radius:50%;animation:spin 0.8s linear infinite;margin-right:0.25rem;vertical-align:middle}@keyframes spin{to{transform:rotate(360deg)}}.error-container p{color:#DA291C;margin-bottom:1rem;font-size:1.25rem}.error-container button{margin:0.25rem}.btn-retry{background:#DA291C;color:white;border:none;padding:0.5rem 1.5rem;border-radius:9999px;cursor:pointer;font-weight:600}.btn-retry:hover{background:rgb(172.8048780488, 32.5, 22.1951219512)}.breadcrumb{display:flex;align-items:center;gap:0.5rem;margin-bottom:1.5rem;font-size:0.875rem;color:#666666}.breadcrumb-item{cursor:pointer;transition:color 0.2s}.breadcrumb-item:hover{color:#0097A9}.breadcrumb-item.active{color:#1A1A1A;font-weight:500;cursor:default}.breadcrumb-item.active:hover{color:#1A1A1A}.breadcrumb-separator{color:#999999}.product-container{background:white;border-radius:0.75rem;box-shadow:0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);padding:2rem}.product-grid{display:grid;grid-template-columns:1fr 1fr;gap:2rem}@media (max-width: 768px){.product-grid{grid-template-columns:1fr}}.product-image-section{display:flex;align-items:flex-start;justify-content:center;width:100%;max-width:450px;margin:0 auto}.product-image-section ui-image-carousel{width:100%}.image-container{width:100%;max-width:400px;aspect-ratio:1;display:flex;align-items:center;justify-content:center;background:#FAFAFA;border-radius:0.5rem;padding:1rem}.product-image{max-width:100%;max-height:100%;object-fit:contain}.product-details-section{display:flex;flex-direction:column;gap:1rem}.brand-name{font-size:0.875rem;color:#808080;text-transform:uppercase;letter-spacing:0.5px}.product-name{font-size:1.75rem;font-weight:700;color:#1A1A1A;margin:0;line-height:1.2}.product-description{font-size:1rem;color:#666666;line-height:1.6;margin:0}.selector-section{padding:1rem 0;border-top:1px solid #F5F5F5}.selector-section:first-of-type{border-top:none}.selector-title{font-size:0.875rem;font-weight:600;color:#4D4D4D;margin:0 0 0.5rem 0;text-transform:uppercase;letter-spacing:0.5px}.color-options{display:flex;gap:0.5rem;flex-wrap:wrap;margin-bottom:0.25rem}.color-circle{width:40px;height:40px;border-radius:50%;border:2px solid transparent;cursor:pointer;transition:all 0.2s;display:flex;align-items:center;justify-content:center;padding:0}.color-circle:hover{transform:scale(1.1)}.color-circle.selected{border-color:#0097A9;box-shadow:0 0 0 2px white, 0 0 0 4px #0097A9}.color-circle .check-icon{width:18px;height:18px}.selected-label{font-size:0.875rem;color:#666666}.storage-options{display:flex;gap:0.5rem;flex-wrap:wrap}.storage-button{padding:0.5rem 1rem;border:2px solid #E5E5E5;border-radius:0.5rem;background:white;cursor:pointer;font-size:0.875rem;font-weight:500;color:#4D4D4D;transition:all 0.2s}.storage-button:hover{border-color:#0097A9;color:#0097A9}.storage-button.selected{border-color:#0097A9;background:rgba(0, 151, 169, 0.1);color:#0097A9}.installment-options{display:flex;gap:0.5rem;flex-wrap:wrap}.installment-button{display:flex;flex-direction:column;align-items:center;padding:0.5rem 1rem;border:2px solid #E5E5E5;border-radius:0.5rem;background:white;cursor:pointer;transition:all 0.2s;min-width:100px}.installment-button:hover{border-color:#0097A9}.installment-button.selected{border-color:#0097A9;background:rgba(0, 151, 169, 0.1)}.installment-button.selected .months,.installment-button.selected .price{color:#0097A9}.installment-button .months{font-size:0.875rem;font-weight:600;color:#4D4D4D}.installment-button .price{font-size:0.75rem;color:#808080;margin-top:2px}.quantity-selector{display:flex;align-items:center;gap:1rem}.qty-button{width:36px;height:36px;border:2px solid #CCCCCC;border-radius:0.5rem;background:white;cursor:pointer;font-size:1.25rem;font-weight:600;color:#4D4D4D;display:flex;align-items:center;justify-content:center;transition:all 0.2s}.qty-button:hover:not(:disabled){border-color:#0097A9;color:#0097A9}.qty-button:disabled{opacity:0.4;cursor:not-allowed}.qty-value{font-size:1.25rem;font-weight:600;color:#1A1A1A;min-width:30px;text-align:center}.price-section{background:#FAFAFA;border-radius:0.5rem;padding:1rem;margin-top:0.5rem}.price-row{display:flex;justify-content:space-between;align-items:center;padding:0.25rem 0}.price-row.monthly .value{font-size:1.5rem;font-weight:700;color:#DA291C}.price-row.total{border-top:1px solid #E5E5E5;padding-top:0.5rem;margin-top:0.25rem}.price-row.total .value{font-weight:600}.price-row .label{font-size:0.875rem;color:#666666}.price-row .value{font-size:1rem;color:#1A1A1A}.btn-add-to-cart{width:100%;padding:1rem;background:#DA291C;color:white;border:none;border-radius:9999px;font-size:1rem;font-weight:600;cursor:pointer;transition:all 0.2s;margin-top:1rem}.btn-add-to-cart:hover:not(:disabled){background:rgb(172.8048780488, 32.5, 22.1951219512)}.btn-add-to-cart:disabled{opacity:0.7;cursor:not-allowed}.btn-add-to-cart.loading{background:#808080}.btn-add-to-cart .loading-text{display:flex;align-items:center;justify-content:center}.btn-back-link{background:none;border:none;color:#0097A9;font-size:0.875rem;cursor:pointer;padding:0.5rem;margin-top:0.25rem;transition:color 0.2s}.btn-back-link:hover{color:rgb(0, 105.4319526627, 118);text-decoration:underline}.btn-back{background:#E5E5E5;color:#4D4D4D;border:none;padding:0.5rem 1.5rem;border-radius:9999px;cursor:pointer;font-weight:500}.btn-back:hover{background:#CCCCCC}.features-section{margin-top:2rem;padding-top:2rem;border-top:1px solid #E5E5E5}.features-title,.specs-title{font-size:1.25rem;font-weight:600;color:#1A1A1A;margin:0 0 1rem 0}.features-list{margin:0;padding:0 0 0 1.5rem}.features-list .feature-item{padding:0.25rem 0;color:#4D4D4D;line-height:1.5}.specs-section{margin-top:2rem;padding-top:2rem;border-top:1px solid #E5E5E5}.specs-grid{display:grid;grid-template-columns:repeat(2, 1fr);gap:0.5rem}@media (max-width: 576px){.specs-grid{grid-template-columns:1fr}}.spec-item{display:flex;justify-content:space-between;padding:0.5rem;background:#FAFAFA;border-radius:0.25rem}.spec-item .spec-label{font-size:0.875rem;color:#666666}.spec-item .spec-value{font-size:0.875rem;font-weight:500;color:#1A1A1A}.availability-status{display:flex;align-items:center;gap:0.25rem;padding:0.5rem 0}.availability-status--available{display:flex;align-items:center;gap:0.25rem;color:#44AF69;font-weight:500;font-size:0.875rem}.availability-status--unavailable{display:flex;align-items:center;gap:0.25rem;color:#DA291C;font-weight:500;font-size:0.875rem}.availability-icon{width:18px;height:18px}.unavailable-alert-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0, 0, 0, 0.6);display:flex;align-items:center;justify-content:center;z-index:1000;padding:1rem}.unavailable-alert{background:white;border-radius:0.75rem;padding:2rem;max-width:400px;width:100%;text-align:center;box-shadow:0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);animation:alertSlideIn 0.3s ease-out}.unavailable-alert__icon{width:64px;height:64px;margin:0 auto 1rem;background:rgba(218, 41, 28, 0.1);border-radius:50%;display:flex;align-items:center;justify-content:center}.unavailable-alert__icon svg{width:32px;height:32px;color:#DA291C}.unavailable-alert__title{font-size:1.5rem;font-weight:700;color:#1A1A1A;margin:0 0 0.5rem 0}.unavailable-alert__message{font-size:1rem;color:#666666;line-height:1.6;margin:0 0 1.5rem 0}.unavailable-alert__btn{width:100%;padding:1rem;background:#DA291C;color:white;border:none;border-radius:9999px;font-size:1rem;font-weight:600;cursor:pointer;transition:background 0.2s}.unavailable-alert__btn:hover{background:rgb(172.8048780488, 32.5, 22.1951219512)}@keyframes alertSlideIn{from{opacity:0;transform:translateY(-20px) scale(0.95)}to{opacity:1;transform:translateY(0) scale(1)}}.btn-add-to-cart.disabled{background:#999999;cursor:not-allowed}.btn-add-to-cart.disabled:hover{background:#999999}`;const Ge=class{constructor(e){r(this,e)}onNext;onBack;product=null;catalogueProduct=null;isLoading=true;error=null;isAddingToCart=false;selectedColorIndex=0;selectedStorageIndex=0;selectedInstallments=36;quantity=1;isAvailable=true;showUnavailableAlert=false;colorOptions=[];storageOptions=[];installmentOptions=[];productImages=[];ENTRY_BARRIER=1;componentWillLoad(){this.loadProductDetail()}async loadProductDetail(){this.isLoading=true;this.error=null;try{const e=j.getStoredProduct();if(!e){this.error="No se encontró el producto seleccionado";this.isLoading=false;return}this.catalogueProduct=e;const t=await Y.getEquipmentDetail(e.productId);if(t.hasError||!t.product){console.warn("[StepProductDetail] API failed, using catalogue data");this.product=this.mapCatalogueToDetail(e)}else{this.product=t.product}this.parseColorOptions();this.parseStorageOptions();this.parseInstallmentOptions();this.buildProductImages();this.checkAvailability();Y.storeSelectedProduct(this.product);Y.storeDeviceType("home")}catch(e){console.error("[StepProductDetail] Error:",e);this.error="Error al cargar el detalle del producto"}finally{this.isLoading=false}}mapCatalogueToDetail(e){return{productId:e.productId,productName:e.productName,imgUrl:e.imgUrl,regular_price:e.regular_price,update_price:e.update_price,installments:e.installments,shortDescription:e.shortDescription,colors:e.colors?.map(((e,t)=>({colorId:t,colorName:`Color ${t+1}`,webColor:e.webColor}))),home:true,catalogId:6}}parseColorOptions(){if(!this.product?.colors||this.product.colors.length===0){this.colorOptions=[{colorId:0,colorName:"Default",webColor:"#333333"}];return}this.colorOptions=this.product.colors.map(((e,t)=>({colorId:e.colorId||t,colorName:e.colorName||`Color ${t+1}`,webColor:e.webColor||"#333333",productId:e.productId,imgUrl:e.imgUrl})))}parseStorageOptions(){if(!this.product?.storages||this.product.storages.length===0){this.storageOptions=[];return}this.storageOptions=this.product.storages.map(((e,t)=>({storageId:e.storageId||t,storageName:e.storageName||e.name||`${e.size}GB`,productId:e.productId,price:e.price})))}parseInstallmentOptions(){const e=this.product?.regular_price||0;const t=this.product?.installments||36;const r=[12,24,36];this.installmentOptions=r.map((t=>({months:t,monthlyPrice:Number((e/t).toFixed(2)),totalPrice:e})));this.selectedInstallments=t}buildProductImages(){if(!this.product){this.productImages=[];return}const e=[];if(this.product.images?.length){e.push(...this.product.images)}else if(this.product.imgUrl){e.push(this.product.imgUrl)}if(this.colorOptions?.length>0){this.colorOptions.forEach((t=>{if(t.imgUrl&&!e.includes(t.imgUrl)){e.push(t.imgUrl)}}))}this.productImages=e;console.log("[StepProductDetail] Product images:",this.productImages.length)}checkAvailability(){if(!this.product){this.isAvailable=false;this.showUnavailableAlert=true;return}if(this.product.stock===undefined||this.product.stock===null){this.isAvailable=true;console.log("[StepProductDetail] Availability check - stock undefined (no colors structure), assuming available")}else{this.isAvailable=this.product.stock>this.ENTRY_BARRIER;console.log("[StepProductDetail] Availability check (TEL pattern) - stock:",this.product.stock,"> entryBarrier:",this.ENTRY_BARRIER,"=",this.isAvailable);if(!this.isAvailable){this.showUnavailableAlert=true}}}handleGoBackFromAlert=()=>{this.showUnavailableAlert=false;this.onBack?.()};handleColorSelect=e=>{this.selectedColorIndex=e;const t=this.colorOptions[e];Y.storeSelectedColor(t.colorId,t.colorName,t.webColor);if(t.imgUrl&&this.product){this.product={...this.product,imgUrl:t.imgUrl}}};handleStorageSelect=e=>{this.selectedStorageIndex=e;const t=this.storageOptions[e];Y.storeSelectedStorage(t.storageId,t.storageName);if(t.productId){Y.storeChildrenId(t.productId)}};handleInstallmentSelect=e=>{this.selectedInstallments=e};handleAddToCart=async()=>{if(!this.product||this.isAddingToCart)return;this.isAddingToCart=true;try{const e=await V.addToCart(this.product,this.selectedInstallments,this.quantity);if(e.hasError){console.error("[StepProductDetail] Add to cart failed:",e.message);this.error=e.message||"Error al agregar al carrito";return}if(e.code){V.storeMainId(e.code);Y.storeMainId(e.code)}console.log("[StepProductDetail] Added to cart, proceeding to plans");this.onNext?.()}catch(e){console.error("[StepProductDetail] Error:",e);this.error="Error al agregar el producto al carrito"}finally{this.isAddingToCart=false}};getCurrentMonthlyPrice(){const e=this.installmentOptions.find((e=>e.months===this.selectedInstallments));return e?.monthlyPrice||this.product?.update_price||0}formatPrice(e){return`$${e.toFixed(2)}`}renderBreadcrumb(){return o("div",{class:"breadcrumb"},o("span",{class:"breadcrumb-item",onClick:this.onBack},"Catálogo"),o("span",{class:"breadcrumb-separator"},">"),o("span",{class:"breadcrumb-item active"},this.product?.productName||"Detalle"))}renderColorSelector(){if(this.colorOptions.length<=1)return null;return o("div",{class:"selector-section"},o("h4",{class:"selector-title"},"Color"),o("div",{class:"color-options"},this.colorOptions.map(((e,t)=>o("button",{class:{"color-circle":true,selected:this.selectedColorIndex===t},style:{backgroundColor:e.webColor},onClick:()=>this.handleColorSelect(t),title:e.colorName},this.selectedColorIndex===t&&o("svg",{class:"check-icon",viewBox:"0 0 24 24",fill:"none",stroke:"white","stroke-width":"3"},o("polyline",{points:"20 6 9 17 4 12"})))))),o("span",{class:"selected-label"},this.colorOptions[this.selectedColorIndex]?.colorName))}renderStorageSelector(){if(this.storageOptions.length===0)return null;return o("div",{class:"selector-section"},o("h4",{class:"selector-title"},"Almacenamiento"),o("div",{class:"storage-options"},this.storageOptions.map(((e,t)=>o("button",{class:{"storage-button":true,selected:this.selectedStorageIndex===t},onClick:()=>this.handleStorageSelect(t)},e.storageName)))))}renderInstallmentSelector(){return o("div",{class:"selector-section"},o("h4",{class:"selector-title"},"Plazos de pago"),o("div",{class:"installment-options"},this.installmentOptions.map((e=>o("button",{class:{"installment-button":true,selected:this.selectedInstallments===e.months},onClick:()=>this.handleInstallmentSelect(e.months)},o("span",{class:"months"},e.months," meses"),o("span",{class:"price"},this.formatPrice(e.monthlyPrice),"/mes"))))))}renderQuantitySelector(){return o("div",{class:"selector-section"})}renderPriceSection(){const e=this.getCurrentMonthlyPrice();const t=this.product?.regular_price||0;return o("div",{class:"price-section"},o("div",{class:"price-row monthly"},o("span",{class:"label"},"Pago mensual"),o("span",{class:"value"},this.formatPrice(e))),o("div",{class:"price-row total"},o("span",{class:"label"},"Precio total"),o("span",{class:"value"},this.formatPrice(t))),o("div",{class:"price-row installments"},o("span",{class:"label"},"Financiado a"),o("span",{class:"value"},this.selectedInstallments," meses")))}renderAvailabilityStatus(){return o("div",{class:"availability-status"},this.isAvailable?o("div",{class:"availability-status--available"},o("svg",{class:"availability-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},o("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),o("polyline",{points:"22 4 12 14.01 9 11.01"})),o("span",null,"Disponible")):o("div",{class:"availability-status--unavailable"},o("svg",{class:"availability-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},o("path",{d:"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"}),o("line",{x1:"12",y1:"9",x2:"12",y2:"13"}),o("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})),o("span",null,"No disponible")))}renderUnavailableAlert(){if(!this.showUnavailableAlert)return null;return o("div",{class:"unavailable-alert-overlay"},o("div",{class:"unavailable-alert"},o("div",{class:"unavailable-alert__icon"},o("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},o("path",{d:"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"}),o("line",{x1:"12",y1:"9",x2:"12",y2:"13"}),o("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"}))),o("h3",{class:"unavailable-alert__title"},"Producto no disponible"),o("p",{class:"unavailable-alert__message"},"Lo sentimos, este equipo no está disponible actualmente. Por favor seleccione otro equipo del catálogo."),o("button",{class:"unavailable-alert__btn",onClick:this.handleGoBackFromAlert},"Volver al catálogo")))}render(){return o(i,{key:"ec599c85df9634685dcbeca3bfb60545f3bbc818"},o("div",{key:"0d3e46d8eb5b2100f52a4ada26c878bded73692f",class:"step-product-detail"},this.renderUnavailableAlert(),this.isLoading&&o("div",{key:"dab10545bbcc2adb16a87159398769f6b151cfd7",class:"loading-container"},o("div",{key:"710724344c26776082e119b4de4be42e2c5260a8",class:"spinner"}),o("p",{key:"26e4b4161af289c2f0c91420283a68c05ed658da"},"Cargando producto...")),this.error&&!this.isLoading&&o("div",{key:"bfc3ba31d341423b392a0afafa8538574a591bed",class:"error-container"},o("p",{key:"d5cc0e1b010d142ef85014a40c23d2bd4ed5bb12"},this.error),o("button",{key:"880499a8c6558ff4db1823e3baf0cad854929ac4",class:"btn-retry",onClick:()=>this.loadProductDetail()},"Reintentar"),o("button",{key:"f865760a6a78223722efa6c731b7def3a3bc9e9d",class:"btn-back",onClick:this.onBack},"Volver al catálogo")),!this.isLoading&&!this.error&&this.product&&o("div",{key:"4d9c73442ef5d090f535f34a941572cc78f742f2",class:"product-container"},this.renderBreadcrumb(),o("div",{key:"6077f2a11b1c3ce8aa1c373e9b6d110be625fd09",class:"product-grid"},o("div",{key:"463d15927e22751496d953176ce00a7eed06b6f0",class:"product-image-section"},o("ui-image-carousel",{key:"b0e7a63596a0499fc4dc193bc6e0c8aa27a8063d",images:this.productImages,loop:true,showNavigation:this.productImages.length>1,showIndicators:this.productImages.length>1,autoplayInterval:0})),o("div",{key:"91a693a7018965300fd066a3ff9d8d62426752c2",class:"product-details-section"},this.product.brandName&&o("span",{key:"afc011f6349fcebeba4a7228fd90546917b0aea1",class:"brand-name"},this.product.brandName),o("h1",{key:"aead2118444e7f6e754378b17876d61cfb0b8105",class:"product-name"},this.product.productName),this.product.shortDescription&&o("p",{key:"dc329466d7b221a50512f97fe188e223ce9b2ca1",class:"product-description"},Y.cleanDescription(this.product.shortDescription)),this.renderAvailabilityStatus(),this.renderColorSelector(),this.renderStorageSelector(),this.renderInstallmentSelector(),this.renderQuantitySelector(),this.renderPriceSection(),o("button",{key:"d02a2be36a1880adba4e268acb9334f5c6b93baa",class:{"btn-add-to-cart":true,loading:this.isAddingToCart,disabled:!this.isAvailable},onClick:this.handleAddToCart,disabled:this.isAddingToCart||!this.isAvailable},this.isAddingToCart?o("span",{class:"loading-text"},o("span",{class:"spinner-small"}),"Agregando..."):!this.isAvailable?"No disponible":"Continuar"),o("button",{key:"9a01af609867e908bd78542a3cdcfd19fb8b8ccd",class:"btn-back-link",onClick:this.onBack},"← Volver al catálogo"))),this.product.features&&this.product.features.length>0&&o("div",{key:"8c45755e5f98347f38ce98a80922de8a525a7736",class:"features-section"},o("h3",{key:"23a3da0edf2e5552b89d3c82d4ece5c9b9ccc075",class:"features-title"},"Características"),o("ul",{key:"ba70146cb1c6cdf4535b9fc741c88de5a528c1f8",class:"features-list"},this.product.features.map((e=>o("li",{class:"feature-item"},e))))),this.product.specifications&&this.product.specifications.length>0&&o("div",{key:"01be8aca98cd2d1b2083f2c23258033b06fb81e1",class:"specs-section"},o("h3",{key:"191bcae475f50149aa2f0bd6277d2d0f04177347",class:"specs-title"},"Especificaciones"),o("div",{key:"1064b960367de26d496fc82b2a24e8ffba345352",class:"specs-grid"},this.product.specifications.map((e=>o("div",{class:"spec-item"},o("span",{class:"spec-label"},e.name),o("span",{class:"spec-value"},e.value)))))))))}};Ge.style=Ve();const He=()=>`:host{display:block;width:100%;min-height:100%;background-color:white}.step-shipping{width:100%;max-width:900px;margin:0 auto;padding:1.5rem 1rem}.info-message{font-size:0.875rem;color:#666666;margin:0 0 1.5rem 0;padding:0 !important;background:transparent !important;background-color:transparent !important;line-height:1.5;border:none !important;border-radius:0 !important}.error-alert{display:flex;align-items:center;gap:0.5rem;background:rgb(248.1707317073, 205, 201.8292682927);color:rgb(172.8048780488, 32.5, 22.1951219512);padding:1rem;border-radius:0.5rem;margin-bottom:1.5rem;font-size:0.875rem}.error-alert svg{width:20px;height:20px;flex-shrink:0}.form-container{width:100%}.form-row{display:grid;grid-template-columns:1fr 1fr;gap:1rem 1.5rem;margin-bottom:0.25rem}@media (max-width: 700px){.form-row{grid-template-columns:1fr}}.form-group{margin-bottom:1rem}.form-group.existing-customer{margin-top:0.5rem}.form-label{display:block;font-size:0.875rem;font-weight:500;color:#4D4D4D;margin-bottom:0.25rem}.form-label .required{color:#4D4D4D;margin-right:2px}.form-input{width:100%;padding:10px 12px;border:1px solid #CCCCCC;border-radius:0.25rem;font-size:0.875rem;color:#1A1A1A;background:white;transition:border-color 0.2s, box-shadow 0.2s;box-sizing:border-box}.form-input::placeholder{color:#999999}.form-input:focus{outline:none;border-color:#0097A9;box-shadow:0 0 0 2px rgba(0, 151, 169, 0.1)}.form-input:disabled{background:#F5F5F5;color:#808080;cursor:not-allowed}.form-input.error{border-color:#DA291C}.form-input.error:focus{box-shadow:0 0 0 2px rgba(218, 41, 28, 0.1)}input[type=date]::-webkit-calendar-picker-indicator{cursor:pointer;opacity:0.6}.date-input-wrapper{position:relative}.error-message{display:block;font-size:0.75rem;color:#DA291C;margin-top:0.25rem}.id-field{display:flex;align-items:center;gap:0.5rem;flex-wrap:wrap}.id-field .radio-group{display:flex;flex-direction:row;align-items:center;gap:1rem;flex-shrink:0}.id-field .id-input{flex:1;min-width:150px}.radio-group{display:flex;flex-direction:row;align-items:center;gap:1rem}.radio-group.horizontal{flex-direction:row}.radio-label{display:flex;align-items:center;gap:6px;cursor:pointer;font-size:0.875rem}.radio-label input[type=radio]{display:none}.radio-label .radio-custom{width:16px;height:16px;border:2px solid #999999;border-radius:50%;display:flex;align-items:center;justify-content:center;transition:all 0.2s;flex-shrink:0}.radio-label .radio-custom::after{content:"";width:8px;height:8px;border-radius:50%;background:transparent;transition:background 0.2s}.radio-label input[type=radio]:checked+.radio-custom{border-color:#666666}.radio-label input[type=radio]:checked+.radio-custom::after{background:#666666}.radio-label .radio-text{color:#4D4D4D;font-size:0.75rem;white-space:nowrap}.btn-container{display:flex;justify-content:center;margin-top:1.5rem;padding-top:1rem}.btn-submit{min-width:200px;height:44px;background:#666666;color:white;border:none;border-radius:9999px;font-size:0.875rem;font-weight:500;cursor:pointer;transition:all 0.2s;display:flex;align-items:center;justify-content:center;padding:0 2rem}.btn-submit:hover:not(:disabled){background:#4D4D4D}.btn-submit:disabled{background:#CCCCCC;cursor:not-allowed}.btn-submit.loading{background:#999999}.btn-loading{display:flex;align-items:center;gap:0.5rem}.spinner{width:18px;height:18px;border:2px solid rgba(255, 255, 255, 0.3);border-top-color:white;border-radius:50%;animation:spin 1s linear infinite}@keyframes spin{to{transform:rotate(360deg)}}@media (max-width: 500px){.step-shipping{padding:1rem}.id-field{flex-direction:column;align-items:flex-start}.id-field .radio-group{margin-bottom:0.25rem}.id-field .id-input{width:100%}}`;const Xe=class{constructor(e){r(this,e)}onNext;onBack;isLoading=false;error=null;name="";secondName="";lastname="";secondLastname="";idType="";idNumber="";expirationDate="";phone="";phone2="";businessName="";position="";address="";city="";zipcode="";email="";existingCustomer="";formErrors={};touched={};componentWillLoad(){this.loadStoredData()}loadStoredData(){const e=te.getStoredShippingAddress();if(e){const t=e.name.split(" ");this.name=t[0]||"";this.lastname=t.slice(1).join(" ")||"";this.email=e.email;this.phone=this.formatPhoneDisplay(e.phone);this.phone2=e.phone2?this.formatPhoneDisplay(e.phone2):"";this.address=e.address1;this.zipcode=e.zip;this.city=e.city}}formatPhoneDisplay(e){const t=e.replace(/\D/g,"");if(t.length===10){return`(${t.slice(0,3)}) ${t.slice(3,6)}-${t.slice(6)}`}return e}handleInputChange=e=>t=>{const r=t.target;let a=r.value;if(e==="phone"||e==="phone2"){a=this.formatPhoneInput(a)}if(e==="zipcode"){a=a.replace(/\D/g,"").slice(0,5);const e=te.getMunicipalityByZip(a);if(e){this.city=e}else if(a.length===5){this.city=""}}this[e]=a;this.touched[e]=true;this.validateField(e)};formatPhoneInput(e){const t=e.replace(/\D/g,"").slice(0,10);if(t.length===0)return"";if(t.length<=3)return`(${t}`;if(t.length<=6)return`(${t.slice(0,3)}) ${t.slice(3)}`;return`(${t.slice(0,3)}) ${t.slice(3,6)}-${t.slice(6)}`}handleRadioChange=(e,t)=>()=>{this[e]=t;this.touched[e]=true;this.validateField(e)};validateField(e){const t={...this.formErrors};switch(e){case"name":if(!this.name.trim()){t.name="El nombre es requerido"}else{delete t.name}break;case"lastname":if(!this.lastname.trim()){t.lastname="El apellido es requerido"}else{delete t.lastname}break;case"secondLastname":if(!this.secondLastname.trim()){t.secondLastname="El segundo apellido es requerido"}else{delete t.secondLastname}break;case"idType":if(!this.idType){t.idType="Seleccione un tipo de identificación"}else{delete t.idType}break;case"idNumber":if(!this.idNumber.trim()){t.idNumber="El número de identificación es requerido"}else{delete t.idNumber}break;case"expirationDate":if(!this.expirationDate){t.expirationDate="La fecha de vencimiento es requerida"}else{delete t.expirationDate}break;case"phone":if(!this.phone.trim()){t.phone="El teléfono es requerido"}else if(!te.isValidPhone(this.phone)){t.phone="Ingresa un teléfono válido (10 dígitos)"}else{delete t.phone}break;case"businessName":if(!this.businessName.trim()){t.businessName="El nombre del negocio es requerido"}else{delete t.businessName}break;case"position":if(!this.position.trim()){t.position="La posición es requerida"}else{delete t.position}break;case"address":if(!this.address.trim()){t.address="La dirección es requerida"}else{delete t.address}break;case"city":if(!this.city.trim()){t.city="La ciudad es requerida"}else{delete t.city}break;case"zipcode":if(!this.zipcode.trim()){t.zipcode="El código postal es requerido"}else if(!te.validateZipCode(this.zipcode)){t.zipcode="Código postal no válido para Puerto Rico"}else{delete t.zipcode}break;case"email":if(!this.email.trim()){t.email="El correo es requerido"}else if(!te.isValidEmail(this.email)){t.email="Ingresa un correo válido"}else{delete t.email}break;case"existingCustomer":if(!this.existingCustomer){t.existingCustomer="Seleccione una opción"}else{delete t.existingCustomer}break}this.formErrors=t;return Object.keys(t).length===0}validateForm(){this.touched={name:true,lastname:true,secondLastname:true,idType:true,idNumber:true,expirationDate:true,phone:true,businessName:true,position:true,address:true,city:true,zipcode:true,email:true,existingCustomer:true};const e=["name","lastname","secondLastname","idType","idNumber","expirationDate","phone","businessName","position","address","city","zipcode","email","existingCustomer"];e.forEach((e=>this.validateField(e)));return Object.keys(this.formErrors).length===0}handleSubmit=async()=>{if(!this.validateForm()){return}this.isLoading=true;this.error=null;try{const e={name:`${this.name} ${this.secondName} ${this.lastname} ${this.secondLastname}`.replace(/\s+/g," ").trim(),email:this.email,phone:te.cleanPhoneNumber(this.phone),phone2:this.phone2?te.cleanPhoneNumber(this.phone2):undefined,address1:this.address,city:this.city,state:"PR",zip:this.zipcode};const t=await te.createAddress(e);if(t.hasError){this.error=t.message||t.errorDesc||"Error al guardar la dirección";return}console.log("[StepShipping] Address created, shipmentId:",t.response);this.onNext?.()}catch(e){console.error("[StepShipping] Error:",e);this.error="Error de conexión. Intenta nuevamente."}finally{this.isLoading=false}};render(){return o(i,{key:"718b73e1181b51c1b3e711e2e9ad25f78e395697"},o("div",{key:"d8af1a7487a33ab08c01ff7d7f34ab65fa643220",class:"step-shipping"},o("p",{key:"a42d368e574aab14ca81930a72e8684335975d28",class:"info-message"},"Por favor, ingresa la información personal solicitada. Su nombre y apellido deben ser iguales a su identificación de gobierno."),this.error&&o("div",{key:"295254454ef1b074d38b2ca6263baaaacf15d078",class:"error-alert"},o("svg",{key:"b280338dc7160a79e4858f7f23f5e8dbf75ff7fb",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},o("circle",{key:"77d376a7a961b5a568b9f257e8585806ba686eee",cx:"12",cy:"12",r:"10"}),o("line",{key:"36cdf8c8efb858d7d729c2e700fa63bb9e33697f",x1:"12",y1:"8",x2:"12",y2:"12"}),o("line",{key:"347cbb94e4c4d306b7e7cda3654a40e562ee4b92",x1:"12",y1:"16",x2:"12.01",y2:"16"})),o("span",{key:"f6023ef2714d00c89256680aab9e176529146bc0"},this.error)),o("div",{key:"b4b31b93d5e21253a4440f695e471398cadb8c89",class:"form-container"},o("div",{key:"d346ce734ea088b5b03c1f4727943cbbed43415b",class:"form-row"},o("div",{key:"5b0b5e8d8aab86adbfc5d117ef66eb4fae90a64e",class:"form-group"},o("label",{key:"b61b9b1238390515b4cd0e9234f80ebf1c7fb81b",class:"form-label"},o("span",{key:"ac26adeb50bbd5da4b37642d2f945c4b27c6776e",class:"required"},"*"),"Nombre:"),o("input",{key:"401badf6a5f1541130473c910e1b4c2115f9a37b",type:"text",class:{"form-input":true,error:this.touched.name&&!!this.formErrors.name},value:this.name,onInput:this.handleInputChange("name"),placeholder:"Ingresar nombre"}),this.touched.name&&this.formErrors.name&&o("span",{key:"7fc1b8e118bb03d08deabcd56d52148a15b7247e",class:"error-message"},this.formErrors.name)),o("div",{key:"2015a6fd830153e630219d2fac495e89f0218d5d",class:"form-group"},o("label",{key:"cd71a7559583fae6669c7c70337ec9a3e6c5d5f8",class:"form-label"},"Segundo nombre:"),o("input",{key:"709901e72f344cb7a455cfa2c3b3cb0eff385d87",type:"text",class:"form-input",value:this.secondName,onInput:this.handleInputChange("secondName"),placeholder:"Ingresar segundo nombre (Opcional)"}))),o("div",{key:"a3951c5c49dd87283aeb93c081ef3fa401e74a43",class:"form-row"},o("div",{key:"83e3a20ee3c9c9a9d16508c1d9a6e4e9c9a69a27",class:"form-group"},o("label",{key:"7b944aacfd5eee6ce766b7809dad5721600c3cf4",class:"form-label"},o("span",{key:"2ba1aa0d33e0735374809108168a6361349e3de7",class:"required"},"*"),"Apellido:"),o("input",{key:"2059d5d7977ca24732a7f768c63d098e82af05ab",type:"text",class:{"form-input":true,error:this.touched.lastname&&!!this.formErrors.lastname},value:this.lastname,onInput:this.handleInputChange("lastname"),placeholder:"Ingresar apellido"}),this.touched.lastname&&this.formErrors.lastname&&o("span",{key:"cefe8d589f75acefda1832f21923bf49973eb4d2",class:"error-message"},this.formErrors.lastname)),o("div",{key:"cc8d0de7cc17a117281f18cb171f50966807c5b3",class:"form-group"},o("label",{key:"adc722b89df8973c4e192ec606feced3dfff9391",class:"form-label"},o("span",{key:"5b29170455cf28dc3840cea46af49f9a2e7c0110",class:"required"},"*"),"Segundo apellido:"),o("input",{key:"3054aba92319d3dc2a416a868519226ff19ea47a",type:"text",class:{"form-input":true,error:this.touched.secondLastname&&!!this.formErrors.secondLastname},value:this.secondLastname,onInput:this.handleInputChange("secondLastname"),placeholder:"Ingresar segundo apellido"}),this.touched.secondLastname&&this.formErrors.secondLastname&&o("span",{key:"21e64a8ea3c78c9fbd2afb4c36df150ec5caa8b9",class:"error-message"},this.formErrors.secondLastname))),o("div",{key:"610e56a60267625fd26d21b69468deae26129c59",class:"form-row"},o("div",{key:"52930f3d8d998db9758e8c76607a1f49632553db",class:"form-group"},o("label",{key:"e5dd284ae9eb4853d827012ec22e796fecb562b2",class:"form-label"},o("span",{key:"17b14b8204f57d7b5c104d4872d5da94509b3e0a",class:"required"},"*"),"Identificación:"),o("div",{key:"d71bb632960d3125c392da5e508029bc6e1983cd",class:"id-field"},o("div",{key:"99fa7009d036ead87caf5ad2eeaf5573906efc4b",class:"radio-group"},o("label",{key:"e444924399dd8c642f20b329e1843b54723a4368",class:"radio-label"},o("input",{key:"2852138132b113de22bf0b04e51749d0132ecfd6",type:"radio",name:"idType",checked:this.idType==="license",onChange:this.handleRadioChange("idType","license")}),o("span",{key:"fa298c47cbdbe489d7321f39b1455863f42c33b7",class:"radio-custom"}),o("span",{key:"31383ead591fb73f782404ecf6ecb8a667327d9a",class:"radio-text"},"Licencia de conducir")),o("label",{key:"c0811288ed9eba4fb559a162937235cbb4ae255a",class:"radio-label"},o("input",{key:"2c4e87c56913b4029c083998e3bae1df7485f55e",type:"radio",name:"idType",checked:this.idType==="passport",onChange:this.handleRadioChange("idType","passport")}),o("span",{key:"4744848d30ecf31c8ed1e9f04e0574c3da0d2f12",class:"radio-custom"}),o("span",{key:"2646a0c2781c18641f1a8e8a9d8172624acf58ba",class:"radio-text"},"Pasaporte"))),o("input",{key:"1e6bf0f48a23b1e5cd13ec768c009d91bdd02d90",type:"text",class:{"form-input":true,"id-input":true,error:this.touched.idNumber&&!!this.formErrors.idNumber},value:this.idNumber,onInput:this.handleInputChange("idNumber"),placeholder:"Ingresar nro de identificación"})),this.touched.idType&&this.formErrors.idType&&o("span",{key:"0986c281e0fb6984e33d41766b92c108fc5c33c4",class:"error-message"},this.formErrors.idType),this.touched.idNumber&&this.formErrors.idNumber&&o("span",{key:"31ba68eb5a57314b2f4bfec6c78e719b16a8dfa1",class:"error-message"},this.formErrors.idNumber)),o("div",{key:"ae004d8854393bd2aa71f01ec794cba821a052d0",class:"form-group"},o("label",{key:"8f7867816b2ec18d04c34a0a3f3a56894a732b9a",class:"form-label"},o("span",{key:"aad1cd1f664679a91179cd76e75971f471f7ce7a",class:"required"},"*"),"Fecha de vencimiento:"),o("div",{key:"db49c6abe2f340b79d0900cedcdb18213eba3ae0",class:"date-input-wrapper"},o("input",{key:"6335aeb8c9ab02b17da2214f38d2454bf29ef29e",type:"date",class:{"form-input":true,error:this.touched.expirationDate&&!!this.formErrors.expirationDate},value:this.expirationDate,onInput:this.handleInputChange("expirationDate"),placeholder:"Seleccionar"})),this.touched.expirationDate&&this.formErrors.expirationDate&&o("span",{key:"7233da321a6a8cf89c711b2e42bf13d032726315",class:"error-message"},this.formErrors.expirationDate))),o("div",{key:"bd5b7e6fa4da78f2bb4f1432a5e552b4cd6cfc7b",class:"form-row"},o("div",{key:"e925a81118095dc618dedde2e3d6b778e559a3e1",class:"form-group"},o("label",{key:"01b8c67903f8ffa127840607b2f48be8fc1aa32c",class:"form-label"},o("span",{key:"5be19820108b503f3ffdb68a791841c2149480c2",class:"required"},"*"),"Teléfono de contacto 1:"),o("input",{key:"44c862ea19da00540cc7323e866e1a81a0ba4c03",type:"tel",class:{"form-input":true,error:this.touched.phone&&!!this.formErrors.phone},value:this.phone,onInput:this.handleInputChange("phone"),placeholder:"Ingresar nro de teléfono"}),this.touched.phone&&this.formErrors.phone&&o("span",{key:"77c8a486d895cad1be3c5dc3d0fac425671dfa7a",class:"error-message"},this.formErrors.phone)),o("div",{key:"a1118302c9b1cd1842052c23c7b80a8e509cea78",class:"form-group"},o("label",{key:"b9f25472ed8ac5e1ebdb9e9ebabd1b0a0a49f382",class:"form-label"},"Teléfono de contacto 2:"),o("input",{key:"0d702ff4d399eba12c75c7b84ec5efcc9553b16c",type:"tel",class:"form-input",value:this.phone2,onInput:this.handleInputChange("phone2"),placeholder:"Ingresar nro de teléfono"}))),o("div",{key:"bc21071f3b3b517fb7d4e372584118745a3a3e48",class:"form-row"},o("div",{key:"11c673e65a5719b6acc97877324b0f11a31d7dd8",class:"form-group"},o("label",{key:"924fbbb9683775f6822f4a2f3ac52da5d27554ad",class:"form-label"},o("span",{key:"1c5efe973cc04643f75b69e8dde754ffc8636f44",class:"required"},"*"),"Nombre del Negocio:"),o("input",{key:"8cca3452b7d497ac1be3b230e92b0747bf9f389e",type:"text",class:{"form-input":true,error:this.touched.businessName&&!!this.formErrors.businessName},value:this.businessName,onInput:this.handleInputChange("businessName"),placeholder:"Ingresar nombre del negocio"}),this.touched.businessName&&this.formErrors.businessName&&o("span",{key:"2196e90ebb76aa3eb9117e79d0b6f13bed0bfdf1",class:"error-message"},this.formErrors.businessName)),o("div",{key:"e95f64e4859e051a0ef7b604b1b89de74e4e1756",class:"form-group"},o("label",{key:"352c97731b333a9923993c3a7c890225f1d4d59d",class:"form-label"},o("span",{key:"027d75ee2b490367739ebab4828548b11b7ef660",class:"required"},"*"),"Posición en la Empresa:"),o("input",{key:"f27e8ee053c1a737ef057f37c5ff404eeac80df2",type:"text",class:{"form-input":true,error:this.touched.position&&!!this.formErrors.position},value:this.position,onInput:this.handleInputChange("position"),placeholder:"Ingresar posición actual"}),this.touched.position&&this.formErrors.position&&o("span",{key:"430552ea612a2d8ace1048fcbdeeea4350b14375",class:"error-message"},this.formErrors.position))),o("div",{key:"460af8c81d52f7915a60fa595f118aaa329f1dd7",class:"form-row"},o("div",{key:"31dc4d7d955af9fd01728929b5d7e5cd25b942e5",class:"form-group"},o("label",{key:"11b9433805505e55949fc2bcf07fbe1c7646b8c7",class:"form-label"},o("span",{key:"b7e3397f2be9609e0fdce42820b0d3d0cbd19350",class:"required"},"*"),"Dirección:"),o("input",{key:"a5eedc981cd7e1226ba5b20b7519bd3e9c4120d2",type:"text",class:{"form-input":true,error:this.touched.address&&!!this.formErrors.address},value:this.address,onInput:this.handleInputChange("address"),placeholder:"Ingresar dirección"}),this.touched.address&&this.formErrors.address&&o("span",{key:"ea6c9df9ef47f6d65271db7f3df4cc834566924b",class:"error-message"},this.formErrors.address)),o("div",{key:"2764e0bb78417f52f032f3f9df0b9be4a81ba1c9",class:"form-group"},o("label",{key:"91b25e249954af0de46f64a83d6498ee3727dac9",class:"form-label"},o("span",{key:"e91966ffc9dff717b4ebc004afcc9f0af292124a",class:"required"},"*"),"Ciudad:"),o("input",{key:"b747dfd09065cd0cc8381b8cea6a939e11a5a552",type:"text",class:{"form-input":true,error:this.touched.city&&!!this.formErrors.city},value:this.city,onInput:this.handleInputChange("city"),placeholder:"Ingresar ciudad"}),this.touched.city&&this.formErrors.city&&o("span",{key:"5f4f1966d747110bae5bf5612487500fb9fdb495",class:"error-message"},this.formErrors.city))),o("div",{key:"fdfd25752bef60d5ab42cf5dfd637158e261c4b9",class:"form-row"},o("div",{key:"bc173ee964743bc3325ec45a38362ea635047b77",class:"form-group"},o("label",{key:"8bb0f1e94e363a48bb3b0758b78e1557a8b28df3",class:"form-label"},o("span",{key:"87589fb593d56593dc514217336d67e3ed404d05",class:"required"},"*"),"Código postal"),o("input",{key:"89e366675439a561dedbc2a6abb15af36aa853bb",type:"text",class:{"form-input":true,error:this.touched.zipcode&&!!this.formErrors.zipcode},value:this.zipcode,onInput:this.handleInputChange("zipcode"),placeholder:"Ingresar código postal",maxLength:5}),this.touched.zipcode&&this.formErrors.zipcode&&o("span",{key:"d8f07cef2095cb873a5cfda2de6cb2c9be012b09",class:"error-message"},this.formErrors.zipcode)),o("div",{key:"ddb647ea2aaba389684bcf5a703c5f7474e3848e",class:"form-group"},o("label",{key:"1024047287d92d05d7e56e80d5af59466490645b",class:"form-label"},o("span",{key:"9897af04d171afc2478e572b6e2032e91e907a32",class:"required"},"*"),"Correo electrónico:"),o("input",{key:"844260ef342d0847d258e07dfcc25ce4d10c5ad1",type:"email",class:{"form-input":true,error:this.touched.email&&!!this.formErrors.email},value:this.email,onInput:this.handleInputChange("email"),placeholder:"Ingresar Correo electrónico"}),this.touched.email&&this.formErrors.email&&o("span",{key:"5d13f61791d1ed39f1d533ff1e52a2deae7043f3",class:"error-message"},this.formErrors.email))),o("div",{key:"8d00d54fa241546180c3a2dad060603a85a2e8d1",class:"form-group existing-customer"},o("label",{key:"da50fe01eeed25cd83b91d6c94ae2d40d8bff0d9",class:"form-label"},o("span",{key:"c4cbdeeb7e12cc0c59c95ac9d8701ba92db883d6",class:"required"},"*"),"Cliente existente de Claro PR:"),o("div",{key:"3249042dcc98fba664ad4d171d18f81bbd6c601e",class:"radio-group horizontal"},o("label",{key:"0f120999ea298667750ff8cb0f7aaf9ef715544b",class:"radio-label"},o("input",{key:"6248fa3f13e2453b40bb4b0ae74398f8c1d79dd2",type:"radio",name:"existingCustomer",checked:this.existingCustomer==="yes",onChange:this.handleRadioChange("existingCustomer","yes")}),o("span",{key:"eccce11d742e2320ef45d812654e47abca7f7d93",class:"radio-custom"}),o("span",{key:"9f4973483c91c2b6c18fe5f067af379667c4c1c6",class:"radio-text"},"Sí")),o("label",{key:"65651fd1820ac5a613faa9e82efc3832c1ee1f47",class:"radio-label"},o("input",{key:"9e4ddf271171fab4a6a12f4f6a01637cc41465ee",type:"radio",name:"existingCustomer",checked:this.existingCustomer==="no",onChange:this.handleRadioChange("existingCustomer","no")}),o("span",{key:"1af4c6c3b1df86972de0025e63727f3095ae5e1a",class:"radio-custom"}),o("span",{key:"09556a5f9f59e00e8e5f932b036fa4e643fd3a4e",class:"radio-text"},"No"))),this.touched.existingCustomer&&this.formErrors.existingCustomer&&o("span",{key:"eafc255a4736ae3cbf877f86333f9a7337f37a99",class:"error-message"},this.formErrors.existingCustomer)),o("div",{key:"d81651a8d929f37ffc28d981ef8d504fd776c830",class:"btn-container"},o("button",{key:"867d0f14a81d15d48762ba12adc2e6e08fbb1f97",class:{"btn-submit":true,loading:this.isLoading},onClick:this.handleSubmit,disabled:this.isLoading},this.isLoading?o("span",{class:"btn-loading"},o("span",{class:"spinner"}),"Procesando..."):"Continuar")))))}};Xe.style=He();const Ye=()=>`@keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes slideUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}@keyframes spin{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}:host{display:block;width:100%}.ui-carousel{position:relative;width:100%;display:flex;align-items:center}.ui-carousel__viewport{flex:1;overflow:hidden;margin:0 0.5rem}@media (min-width: 768px){.ui-carousel__viewport{margin:0 1rem}}.ui-carousel__track{display:flex;align-items:stretch;transition:transform 0.3s ease-out;will-change:transform}.ui-carousel__track--dragging{transition:none;cursor:grabbing}.ui-carousel__nav{flex-shrink:0;width:40px;height:40px;border-radius:50%;background:#FFFFFF;border:2px solid #DA291C;color:#DA291C;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all 0.2s ease;z-index:2;box-shadow:0 2px 8px rgba(0, 0, 0, 0.1)}.ui-carousel__nav svg{width:20px;height:20px}.ui-carousel__nav:hover:not(:disabled){background:#DA291C;color:#FFFFFF}.ui-carousel__nav:active:not(:disabled){transform:scale(0.95)}.ui-carousel__nav--disabled{opacity:0.3;cursor:not-allowed;pointer-events:none}@media (max-width: 599px){.ui-carousel__nav{width:32px;height:32px}.ui-carousel__nav svg{width:16px;height:16px}}.ui-carousel__pagination{position:absolute;bottom:-2rem;left:50%;transform:translateX(-50%);display:flex;gap:0.5rem;z-index:2}.ui-carousel__dot{width:10px;height:10px;border-radius:50%;border:none;background:#CCCCCC;cursor:pointer;padding:0;transition:all 0.2s ease}.ui-carousel__dot:hover{background:#999999}.ui-carousel__dot--active{background:#DA291C;transform:scale(1.2)}::slotted(*){box-sizing:border-box}`;const We=class{constructor(e){r(this,e)}get el(){return n(this)}totalItems=0;slidesPerView=1;gap=16;showNavigation=true;showPagination=true;loop=false;autoplay=0;breakpoints=[{minWidth:0,slidesPerView:1},{minWidth:600,slidesPerView:2},{minWidth:900,slidesPerView:3},{minWidth:1200,slidesPerView:4}];currentIndex=0;currentSlidesPerView=1;isDragging=false;startX=0;translateX=0;trackEl;autoplayInterval;resizeObserver;handleTotalItemsChange(){this.currentIndex=0;this.updateTranslate()}componentDidLoad(){this.updateSlidesPerView();this.setupResizeObserver();this.startAutoplay()}disconnectedCallback(){this.stopAutoplay();if(this.resizeObserver){this.resizeObserver.disconnect()}}setupResizeObserver(){this.resizeObserver=new ResizeObserver((()=>{this.updateSlidesPerView()}));this.resizeObserver.observe(this.el)}updateSlidesPerView(){const e=this.el.offsetWidth;let t=this.slidesPerView;for(const r of this.breakpoints){if(e>=r.minWidth){t=r.slidesPerView}}this.currentSlidesPerView=t;const r=this.getMaxIndex();if(this.currentIndex>r){this.currentIndex=r}this.updateTranslate()}getMaxIndex(){return Math.max(0,this.totalItems-this.currentSlidesPerView)}goToSlide(e){const t=this.getMaxIndex();if(this.loop){if(e<0){e=t}else if(e>t){e=0}}else{e=Math.max(0,Math.min(e,t))}this.currentIndex=e;this.updateTranslate()}goToPrev=()=>{this.goToSlide(this.currentIndex-1)};goToNext=()=>{this.goToSlide(this.currentIndex+1)};updateTranslate(){if(!this.trackEl)return;const e=100/this.currentSlidesPerView;this.translateX=-(this.currentIndex*e)}startAutoplay(){if(this.autoplay>0){this.autoplayInterval=setInterval((()=>{this.goToNext()}),this.autoplay)}}stopAutoplay(){if(this.autoplayInterval){clearInterval(this.autoplayInterval)}}handleTouchStart=e=>{this.isDragging=true;this.startX=e.touches[0].clientX;this.stopAutoplay()};handleTouchMove=e=>{if(!this.isDragging)return;const t=e.touches[0].clientX;const r=t-this.startX;const a=this.el.offsetWidth/this.currentSlidesPerView;const o=r/a*(100/this.currentSlidesPerView);const i=-(this.currentIndex*(100/this.currentSlidesPerView));this.translateX=i+o};handleTouchEnd=e=>{if(!this.isDragging)return;this.isDragging=false;const t=e.changedTouches[0].clientX;const r=t-this.startX;if(Math.abs(r)>50){if(r>0){this.goToPrev()}else{this.goToNext()}}else{this.updateTranslate()}this.startAutoplay()};getPaginationDots(){const e=Math.ceil(this.totalItems/this.currentSlidesPerView);return Array.from({length:e},((e,t)=>t))}handleDotClick=e=>{this.goToSlide(e*this.currentSlidesPerView)};getCurrentDot(){return Math.floor(this.currentIndex/this.currentSlidesPerView)}render(){const e=this.loop||this.currentIndex>0;const t=this.loop||this.currentIndex<this.getMaxIndex();const r=100/this.currentSlidesPerView;return o(i,{key:"1d71ded8170a2004929ada8d1401d18fbe5dcc0c"},o("div",{key:"01d088bfc7590419709aa83850462f6b1fa6374c",class:"ui-carousel"},this.showNavigation&&o("button",{key:"a820df5e62634206f0d9f46092f84f84a724eb23",class:{"ui-carousel__nav":true,"ui-carousel__nav--prev":true,"ui-carousel__nav--disabled":!e},onClick:this.goToPrev,disabled:!e,"aria-label":"Anterior"},o("svg",{key:"7ee40aa5fa9fd0c8ac38583ebeaf0c15b8b4c49e",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},o("polyline",{key:"882e3d293306f869bd4d8db82a1c0a8720d83d69",points:"15 18 9 12 15 6"}))),o("div",{key:"0bc0eef0e943585d9877ae832a33bac4813c33c1",class:"ui-carousel__viewport"},o("div",{key:"8ce97b79d901f63c3e6da2e750926857d2dddbc9",class:{"ui-carousel__track":true,"ui-carousel__track--dragging":this.isDragging},ref:e=>this.trackEl=e,style:{transform:`translateX(${this.translateX}%)`,gap:`${this.gap}px`},onTouchStart:this.handleTouchStart,onTouchMove:this.handleTouchMove,onTouchEnd:this.handleTouchEnd},o("slot",{key:"bab876ce6a274ce53c476444694cef4e94bf39ad"}))),this.showNavigation&&o("button",{key:"286f8e40d9092b5d837566977e252c36e9fee843",class:{"ui-carousel__nav":true,"ui-carousel__nav--next":true,"ui-carousel__nav--disabled":!t},onClick:this.goToNext,disabled:!t,"aria-label":"Siguiente"},o("svg",{key:"28eabda805720b3bb8c540b4126c000db8ff7433",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},o("polyline",{key:"ad5d5d53067b22fe760c4e6499f027ac61105154",points:"9 18 15 12 9 6"}))),this.showPagination&&this.totalItems>this.currentSlidesPerView&&o("div",{key:"aab818d63c57cea9cfe25a91bb768f8be490cef5",class:"ui-carousel__pagination"},this.getPaginationDots().map((e=>o("button",{class:{"ui-carousel__dot":true,"ui-carousel__dot--active":e===this.getCurrentDot()},onClick:()=>this.handleDotClick(e),"aria-label":`Ir a página ${e+1}`}))))),o("style",{key:"927be72b1c508b1add09174d6402b4dfc5f1aece"},`\n            ::slotted(*) {\n              flex: 0 0 calc(${r}% - ${this.gap*(this.currentSlidesPerView-1)/this.currentSlidesPerView}px);\n              max-width: calc(${r}% - ${this.gap*(this.currentSlidesPerView-1)/this.currentSlidesPerView}px);\n              /* height handled by align-items: stretch on track */\n            }\n          `))}static get watchers(){return{totalItems:["handleTotalItemsChange"]}}};We.style=Ye();const Ze=()=>`:host{display:block;width:100%}.ui-image-carousel{position:relative;width:100%}.ui-image-carousel__main{position:relative;width:100%;aspect-ratio:1;background:#F5F5F5;border-radius:0.75rem;overflow:hidden;display:flex;align-items:center;justify-content:center}.ui-image-carousel__track{display:flex;width:100%;height:100%;transition:transform 0.4s ease-out;will-change:transform}.ui-image-carousel__slide{flex:0 0 100%;width:100%;height:100%;display:flex;align-items:center;justify-content:center;padding:1rem;box-sizing:border-box}.ui-image-carousel__image{max-width:100%;max-height:100%;object-fit:contain;opacity:0;transition:opacity 0.3s ease}.ui-image-carousel__image--loaded{opacity:1}.ui-image-carousel__nav{position:absolute;top:50%;transform:translateY(-50%);z-index:10;width:40px;height:40px;border-radius:50%;background:rgba(255, 255, 255, 0.95);border:1px solid #E5E5E5;color:#808080;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all 0.2s ease;box-shadow:0 2px 8px rgba(0, 0, 0, 0.1)}.ui-image-carousel__nav svg{width:20px;height:20px}.ui-image-carousel__nav:hover:not(:disabled){background:#DA291C;border-color:#DA291C;color:white;box-shadow:0 4px 12px rgba(218, 41, 28, 0.3)}.ui-image-carousel__nav:active:not(:disabled){transform:translateY(-50%) scale(0.95)}.ui-image-carousel__nav--prev{left:0.5rem}.ui-image-carousel__nav--next{right:0.5rem}.ui-image-carousel__nav--disabled{opacity:0.3;cursor:not-allowed;pointer-events:none}@media (max-width: 599px){.ui-image-carousel__nav{width:32px;height:32px}.ui-image-carousel__nav svg{width:16px;height:16px}}.ui-image-carousel__indicators{display:flex;justify-content:center;gap:0.5rem;margin-top:0.75rem}.ui-image-carousel__dot{width:8px;height:8px;border-radius:50%;border:none;background:#CCCCCC;cursor:pointer;padding:0;transition:all 0.2s ease}.ui-image-carousel__dot:hover{background:#999999}.ui-image-carousel__dot--active{background:#DA291C;width:24px;border-radius:4px}.ui-image-carousel__thumbnails{display:flex;justify-content:center;gap:0.5rem;margin-top:0.75rem;padding:0 0.5rem;overflow-x:auto}.ui-image-carousel__thumbnails::-webkit-scrollbar{display:none}.ui-image-carousel__thumbnails{-ms-overflow-style:none;scrollbar-width:none}.ui-image-carousel__thumbnail{flex-shrink:0;width:60px;height:60px;border-radius:0.5rem;border:2px solid #E5E5E5;background:#F5F5F5;cursor:pointer;padding:4px;overflow:hidden;transition:all 0.2s ease}.ui-image-carousel__thumbnail img{width:100%;height:100%;object-fit:contain}.ui-image-carousel__thumbnail:hover{border-color:#0097A9}.ui-image-carousel__thumbnail--active{border-color:#DA291C;box-shadow:0 0 0 2px rgba(218, 41, 28, 0.2)}@media (max-width: 599px){.ui-image-carousel__thumbnail{width:48px;height:48px}}.ui-image-carousel__placeholder{display:flex;flex-direction:column;align-items:center;justify-content:center;width:100%;aspect-ratio:1;background:#F5F5F5;border-radius:0.75rem;color:#999999}.ui-image-carousel__placeholder svg{width:64px;height:64px;margin-bottom:0.5rem}.ui-image-carousel__placeholder span{font-size:0.875rem}`;const Ke=class{constructor(e){r(this,e)}images=[];loop=true;showNavigation=true;showIndicators=true;autoplayInterval=0;fallbackImage="";currentIndex=0;loadedImages=new Set;failedImages=new Set;autoplayTimer;touchStartX=0;touchEndX=0;onImagesChange(){this.currentIndex=0;this.loadedImages=new Set;this.failedImages=new Set;this.restartAutoplay()}componentDidLoad(){this.startAutoplay()}disconnectedCallback(){this.stopAutoplay()}startAutoplay(){if(this.autoplayInterval>0&&this.images.length>1){this.autoplayTimer=setInterval((()=>{this.goToNext()}),this.autoplayInterval)}}stopAutoplay(){if(this.autoplayTimer){clearInterval(this.autoplayTimer);this.autoplayTimer=null}}restartAutoplay(){this.stopAutoplay();this.startAutoplay()}goToSlide=e=>{const t=this.images.length;if(t===0)return;if(this.loop){if(e<0){e=t-1}else if(e>=t){e=0}}else{e=Math.max(0,Math.min(e,t-1))}this.currentIndex=e;this.restartAutoplay()};goToPrev=()=>{this.goToSlide(this.currentIndex-1)};goToNext=()=>{this.goToSlide(this.currentIndex+1)};handleTouchStart=e=>{this.touchStartX=e.touches[0].clientX;this.stopAutoplay()};handleTouchEnd=e=>{this.touchEndX=e.changedTouches[0].clientX;this.handleSwipe();this.startAutoplay()};handleSwipe(){const e=this.touchStartX-this.touchEndX;const t=50;if(Math.abs(e)>t){if(e>0){this.goToNext()}else{this.goToPrev()}}}handleImageLoad=e=>{this.loadedImages=new Set([...this.loadedImages,e])};handleImageError=(e,t)=>{this.failedImages=new Set([...this.failedImages,e]);if(this.fallbackImage){const e=t.target;e.src=this.fallbackImage}};getImageSrc(e){const t=this.images[e];if(!t&&this.fallbackImage){return this.fallbackImage}return t||""}render(){const e=this.images.length;const t=e>1;const r=this.loop||this.currentIndex>0;const a=this.loop||this.currentIndex<e-1;if(e===0){return o(i,null,o("div",{class:"ui-image-carousel"},o("div",{class:"ui-image-carousel__placeholder"},o("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},o("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),o("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),o("polyline",{points:"21 15 16 10 5 21"})),o("span",null,"Sin imagen"))))}return o(i,null,o("div",{class:"ui-image-carousel"},o("div",{class:"ui-image-carousel__main",onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd},this.showNavigation&&t&&o("button",{class:{"ui-image-carousel__nav":true,"ui-image-carousel__nav--prev":true,"ui-image-carousel__nav--disabled":!r},onClick:this.goToPrev,disabled:!r,"aria-label":"Imagen anterior"},o("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},o("polyline",{points:"15 18 9 12 15 6"}))),o("div",{class:"ui-image-carousel__track",style:{transform:`translateX(-${this.currentIndex*100}%)`}},this.images.map(((e,t)=>o("div",{class:"ui-image-carousel__slide"},o("img",{src:this.getImageSrc(t),alt:`Imagen ${t+1}`,class:{"ui-image-carousel__image":true,"ui-image-carousel__image--loaded":this.loadedImages.has(t)},onLoad:()=>this.handleImageLoad(t),onError:e=>this.handleImageError(t,e),loading:t===0?"eager":"lazy"}))))),this.showNavigation&&t&&o("button",{class:{"ui-image-carousel__nav":true,"ui-image-carousel__nav--next":true,"ui-image-carousel__nav--disabled":!a},onClick:this.goToNext,disabled:!a,"aria-label":"Imagen siguiente"},o("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},o("polyline",{points:"9 18 15 12 9 6"})))),this.showIndicators&&t&&o("div",{class:"ui-image-carousel__indicators"},this.images.map(((e,t)=>o("button",{class:{"ui-image-carousel__dot":true,"ui-image-carousel__dot--active":t===this.currentIndex},onClick:()=>this.goToSlide(t),"aria-label":`Ir a imagen ${t+1}`})))),t&&o("div",{class:"ui-image-carousel__thumbnails"},this.images.map(((e,t)=>o("button",{class:{"ui-image-carousel__thumbnail":true,"ui-image-carousel__thumbnail--active":t===this.currentIndex},onClick:()=>this.goToSlide(t)},o("img",{src:e||this.fallbackImage,alt:`Miniatura ${t+1}`,loading:"lazy"})))))))}static get watchers(){return{images:["onImagesChange"]}}};Ke.style=Ze();const Qe=()=>`.ui-stepper{display:flex;align-items:flex-start;justify-content:center;width:100%}.ui-stepper__step{display:flex;flex-direction:column;align-items:flex-start;position:relative}.ui-stepper__indicator{display:flex;align-items:center;position:relative}.ui-stepper__circle{width:32px;height:32px;border-radius:9999px;display:flex;align-items:center;justify-content:center;font-weight:600;font-size:0.875rem;transition:all 250ms ease;flex-shrink:0}.ui-stepper__circle--pending{background-color:#FFFFFF;color:#999999;border:2px solid #CCCCCC}.ui-stepper__circle--active{background-color:#FFFFFF;color:#0097A9;border:2px solid #0097A9}.ui-stepper__circle--completed{background-color:#FFFFFF;color:#0097A9;border:2px solid #0097A9}.ui-stepper__number{line-height:1}.ui-stepper__check{width:16px;height:16px}.ui-stepper__connector{width:220px;height:2px;background-color:#CCCCCC;transition:background-color 250ms ease;margin-left:8px;margin-right:8px}.ui-stepper__connector--completed{background-color:#0097A9}.ui-stepper__label{position:relative;left:calc(32px / 2);transform:translateX(-50%);margin-top:0.5rem;font-size:0.75rem;font-weight:500;text-align:center;transition:color 250ms ease;white-space:nowrap}.ui-stepper__label--pending{color:#808080}.ui-stepper__label--active{color:#0097A9;font-weight:600}.ui-stepper__label--completed{color:#0097A9}.ui-stepper--sm .ui-stepper__circle{width:24px;height:24px;font-size:0.75rem}.ui-stepper--sm .ui-stepper__check{width:12px;height:12px}.ui-stepper--sm .ui-stepper__connector{width:30px}.ui-stepper--sm .ui-stepper__label{font-size:10px;left:calc(24px / 2)}@media (max-width: 576px){.ui-stepper__connector{width:80px}.ui-stepper__label{font-size:11px}}`;const et=class{constructor(e){r(this,e)}steps=[];currentStep=1;size="md";getStepStatus(e){const t=e+1;if(t<this.currentStep){return"completed"}else if(t===this.currentStep){return"active"}return"pending"}render(){const e={"ui-stepper":true,[`ui-stepper--${this.size}`]:true};return o(i,{key:"df6adc9763aed239c6eaf79af2f2d549f48579c6"},o("div",{key:"bfb747939107bdd62106748334c198a2fb50713b",class:e},this.steps.map(((e,t)=>{const r=this.getStepStatus(t);const a=t===this.steps.length-1;return o("div",{class:"ui-stepper__step",key:t},o("div",{class:"ui-stepper__indicator"},o("div",{class:{"ui-stepper__circle":true,[`ui-stepper__circle--${r}`]:true}},r==="completed"?o("svg",{class:"ui-stepper__check",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3"},o("polyline",{points:"20 6 9 17 4 12"})):o("span",{class:"ui-stepper__number"},t+1)),!a&&o("div",{class:{"ui-stepper__connector":true,"ui-stepper__connector--completed":r==="completed"}})),o("span",{class:{"ui-stepper__label":true,[`ui-stepper__label--${r}`]:true}},e.label))}))))}};et.style=Qe();export{le as fixed_service_flow,pe as step_catalogue,he as step_confirmation,xe as step_contract,Me as step_form,Re as step_location,je as step_order_summary,$e as step_payment,Je as step_plans,Ge as step_product_detail,Xe as step_shipping,We as ui_carousel,Ke as ui_image_carousel,et as ui_stepper};
//# sourceMappingURL=p-c410e722.entry.js.map