import{r as e,c as t,h as o,H as i,a}from"./p-CYQeQM-n.js";import{t as n,h as r,f as s,s as c}from"./p-CNBAjIjF.js";import{c as l,p as d}from"./p-CzAFa51q.js";import{c as p}from"./p-Cu1hlKnH.js";import{s as f}from"./p-BmMai6aX.js";import{p as m}from"./p-DkzKzVg0.js";const h=[{typeId:1,type:"Con Contrato",contract:[{contractId:2,deadlines:12,installation:80,activation:0,modem:0},{contractId:3,deadlines:24,installation:0,activation:0,modem:0}]},{typeId:0,type:"Sin Contrato",contract:[{contractId:1,deadlines:0,installation:160,activation:0,modem:0}]}];const u={NO_COVERAGE:"¡Fuera de área! Por el momento no contamos con cobertura en tu zona."};class b{async validateCoverage(e,t){await n.ensureToken();const o=await r.post("api/Catalogue/getInternetPlans",{latitud:String(e),longitud:String(t)});return o}async checkCoverage(e,t,o,i,a){const n=await this.validateCoverage(e,t);if(n.hasError){return{latitude:e,longitude:t,address:o,city:i,zipCode:a,serviceType:"",serviceMessage:u.NO_COVERAGE,isValid:false}}const r=n.priorityService;let s=u.NO_COVERAGE;if(n.attributes&&n.attributes.length>0){const e=n.attributes.find((e=>e.servicE_NAME===r));if(e){s=e.servicE_MESSAGE}}const c=["GPON","VRAD","CLARO HOGAR"];const l=c.includes(r);if(!l){return{latitude:e,longitude:t,address:o,city:i,zipCode:a,serviceType:"",serviceMessage:u.NO_COVERAGE,isValid:false}}console.log("[CoverageService] Returning valid coverage");return{latitude:e,longitude:t,address:o,city:i,zipCode:a,serviceType:r,serviceMessage:s,isValid:true}}getServiceDisplayName(e){const t={GPON:"Fibra Óptica",VRAD:"Internet DSL","CLARO HOGAR":"Internet Inalámbrico"};return t[e]||e}isClaroHogar(e){return e.toLowerCase()==="claro hogar"}}const g=new b;class _{currentCartId=0;async getPlans(e,t=0){await n.ensureToken();let o=e;if(e==="CLARO HOGAR"){o="internet"}console.log("[PlansService] Fetching plans for type:",o,"catalogId:",t);const i=await r.post("api/Plans/getPlansInternet",{catalogID:t,type:o});console.log("[PlansService] Response:",i);if(i.hasError){console.error("[PlansService] API error:",i.message);throw new Error(i.message||"Failed to fetch plans")}console.log("[PlansService] Plans found:",i.planList?.length||0);return i.planList||[]}async addToCart(e,t=0,o=0,i=0,a=""){await n.ensureToken();const s=n.getToken()||"";const c=this.getEffectivePrice(e);const l={token:s,productId:e.planId,notificationDetailID:0,chvSource:"",promoCode:sessionStorage.getItem("discountCoupon")||"",installments:i,decPrice:c,decDeposit:0,decDownPayment:0,decTotalPrice:c,Qty:1,flowId:1,ssoToken:"",userID:"0",parentProductId:o,parentCartId:t,creditClass:a,downgradeAllowed:false,pendingAccelerated:0,acceletartedAmount:0,pastDueAmount:0,delicuency:false};const d=await r.post("api/Card/addToCart",{cartItems:JSON.stringify([l])});if(d.hasError){throw new Error(d.message||"Failed to add plan to cart")}if(d.code){this.currentCartId=d.code}this.storePlanInSession(e);return d}async addToCartCurrentPlan(e,t){await n.ensureToken();const o=new FormData;o.append("productId",String(e));o.append("cartId",String(t));return await r.postFormData("api/Plans/addToCartCurrentPlan",o)}async deleteFromCart(e,t=0){await n.ensureToken();const o=await r.post("api/Card/deleteItem",{cartId:e,productId:t});if(!o.hasError){if(e===this.currentCartId){this.currentCartId=0}}return o}storePlanInSession(e){try{sessionStorage.setItem("plan",JSON.stringify(e));sessionStorage.setItem("planId",String(e.planId));const t=this.getEffectivePrice(e);sessionStorage.setItem("planPrice",String(t));sessionStorage.setItem("planCodeInternet",btoa(e.planSoc||String(e.planId)))}catch(e){console.error("[PlansService] Error storing plan in session:",e)}}getStoredPlan(){try{const e=sessionStorage.getItem("plan");return e?JSON.parse(e):null}catch{return null}}getStoredPlanId(){const e=sessionStorage.getItem("planId");return e?parseInt(e,10):0}getCartId(){return this.currentCartId}setCartId(e){this.currentCartId=e}clearPlan(){this.currentCartId=0;sessionStorage.removeItem("plan");sessionStorage.removeItem("planId");sessionStorage.removeItem("planPrice");sessionStorage.removeItem("planCodeInternet")}formatPrice(e){return`$${e.toFixed(2)}`}parsePlanFeatures(e){if(!e)return[];const t=/<li[^>]*>([^<]+)<\/li>/gi;const o=[];let i;while((i=t.exec(e))!==null){o.push(i[1].trim())}return o}getDiscountPercentage(e,t){if(!t||t>=e)return 0;return Math.round((e-t)/e*100)}hasPromotion(e){return e.bitPromotion||e.decSalePrice&&e.decSalePrice<e.decPrice}getEffectivePrice(e){if(e.decSalePrice&&e.decSalePrice<e.decPrice){return e.decSalePrice}return e.decPrice}sortByPrice(e,t=true){return[...e].sort(((e,o)=>{const i=this.getEffectivePrice(e);const a=this.getEffectivePrice(o);return t?i-a:a-i}))}}const y=new _;class x{async submitRequest(e){await n.ensureToken();const t=new FormData;Object.entries(e).forEach((([e,o])=>{if(o!==undefined&&o!==null){t.append(e,String(o))}}));const o=await r.postFormData("api/Orders/internetServiceRequest",t);return o}async getOrder(e){await n.ensureToken();const t=await r.get(`api/Orders/getOrder?orderId=${encodeURIComponent(e)}`);return t}async sendConfirmation(e,t){await n.ensureToken();const o=new FormData;o.append("orderId",e);o.append("email",t);const i=await r.postFormData("api/Orders/sendConfirmation",o);return i}buildPayload(e,t,o,i){return{type:t.typeId,name:e.personal.firstName,second_name:e.personal.secondName||"",last_name:e.personal.lastName,second_surname:e.personal.secondLastName,date_birth:e.personal.birthDate||"1990-01-01",email:e.personal.email,telephone1:e.personal.phone1,telephone2:e.personal.phone2||"",zipCode:e.address.zipCode,address:e.address.address,city:e.address.city,id_type:e.personal.identificationType==="license"?"1":"2",id:e.personal.identificationNumber,identification_expiration:e.personal.identificationExpiration,frontFlowId:this.generateFlowId(),plan_id:String(o.planId),plan_name:o.planName,deadlines:String(t.deadlines),installation:String(t.installation),activation:String(t.activation),moden:String(t.modem),claro_customer:e.isExistingCustomer,latitud:String(i.latitude),longitud:String(i.longitude),business_name:e.business.businessName,business_position:e.business.position}}generateFlowId(){return`FSF-${Date.now()}-${Math.random().toString(36).substr(2,9)}`}validateSubmissionData(e,t,o,i){const a=[];if(!i){a.push("location")}if(!o){a.push("plan")}if(!t){a.push("contract")}if(!e){a.push("formData")}else{if(!e.personal.firstName)a.push("firstName");if(!e.personal.lastName)a.push("lastName");if(!e.personal.secondLastName)a.push("secondLastName");if(!e.personal.identificationNumber)a.push("identificationNumber");if(!e.personal.identificationExpiration)a.push("identificationExpiration");if(!e.personal.phone1)a.push("phone1");if(!e.personal.email)a.push("email");if(!e.business.businessName)a.push("businessName");if(!e.business.position)a.push("position");if(!e.address.address)a.push("address");if(!e.address.city)a.push("city");if(!e.address.zipCode)a.push("zipCode")}return{isValid:a.length===0,missingFields:a}}}const w=new x;const k={DEFAULT_CENTER:{lat:18.333036,lng:-66.4161211},DEFAULT_ZOOM:17,MAP_ID:"8481b97098c495ab",DEFAULT_MAP_TYPE:"satellite"};const v={NO_COVERAGE:"¡Fuera de área! Por el momento no contamos con cobertura en tu zona.",COVERAGE_ERROR:"Error al verificar la cobertura. Por favor, intenta de nuevo.",REQUEST_ERROR:"¡Lo sentimos, ha ocurrido un error en el proceso de solicitud! En este momento estamos presentando inconvenientes en nuestro sistema. Por favor, inténtalo nuevamente.",GEOLOCATION_DENIED:"Permiso de ubicación denegado. Por favor, permite el acceso a tu ubicación.",GEOLOCATION_UNAVAILABLE:"No se pudo obtener tu ubicación. Por favor, ingresa tu dirección manualmente.",GEOLOCATION_TIMEOUT:"Tiempo de espera agotado al obtener tu ubicación."};const C={REQUEST_SUCCESS:"¡Tu solicitud fue enviada con éxito!",REQUEST_SUCCESS_SUBTITLE:"Pronto nos comunicaremos contigo."};class F{apiKey="";isLoaded=false;loadPromise=null;map=null;marker=null;autocomplete=null;infoWindow=null;setApiKey(e){this.apiKey=e}async loadGoogleMaps(){if(this.isLoaded){return}if(this.loadPromise){return this.loadPromise}if(!this.apiKey){throw new Error("Google Maps API key is required")}this.loadPromise=new Promise(((e,t)=>{if(window.google?.maps){this.isLoaded=true;e();return}const o=document.createElement("script");o.src=`https://maps.googleapis.com/maps/api/js?key=${this.apiKey}&libraries=places,marker&v=weekly`;o.async=true;o.defer=true;o.onload=()=>{this.isLoaded=true;e()};o.onerror=()=>{t(new Error("Failed to load Google Maps API"))};document.head.appendChild(o)}));return this.loadPromise}isGoogleMapsLoaded(){return this.isLoaded&&!!window.google?.maps}async initMap(e,t){await this.loadGoogleMaps();const o={center:k.DEFAULT_CENTER,zoom:k.DEFAULT_ZOOM,mapTypeId:k.DEFAULT_MAP_TYPE,mapId:k.MAP_ID,disableDefaultUI:false,zoomControl:true,mapTypeControl:true,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.HORIZONTAL_BAR,position:google.maps.ControlPosition.LEFT_TOP,mapTypeIds:["roadmap","satellite"]},streetViewControl:false,fullscreenControl:false};this.map=new google.maps.Map(e,{...o,...t});return this.map}getMap(){return this.map}centerMap(e){if(this.map){this.map.setCenter(e)}}setZoom(e){if(this.map){this.map.setZoom(e)}}async setMarker(e){if(!this.map){throw new Error("Map not initialized")}if(this.marker){this.marker.map=null}const{AdvancedMarkerElement:t}=await google.maps.importLibrary("marker");this.marker=new t({map:this.map,position:e,gmpDraggable:true});this.map.setCenter(e)}addMapClickListener(e){if(!this.map){console.warn("Map not initialized");return}this.map.addListener("click",(t=>{if(t.latLng){const o={lat:t.latLng.lat(),lng:t.latLng.lng()};e(o)}}))}clear(){this.removeMarker()}getMarkerPosition(){if(!this.marker?.position){return null}const e=this.marker.position;return{lat:e.lat,lng:e.lng}}removeMarker(){if(this.marker){this.marker.map=null;this.marker=null}}showInfoWindow(e,t){if(!this.map||!this.marker){console.warn("Map or marker not initialized");return}this.closeInfoWindow();const o=`<style>\n      .gm-ui-hover-effect { display: none !important; }\n      .gm-style .gm-style-iw-c { padding: 0px !important; max-width: 400px !important; border-radius: 16px !important; overflow: visible !important; max-height: none !important; }\n      .gm-style .gm-style-iw-d { padding: 0px !important; overflow: visible !important; max-width: 400px !important; max-height: none !important; overflow-y: visible !important; }\n      .gm-style .gm-style-iw-d > div { overflow: visible !important; }\n      .gm-style .gm-style-iw-tc { display: none !important; }\n      .gm-style-iw { max-width: 400px !important; overflow: visible !important; max-height: none !important; }\n      .gm-style-iw-chr { display: none !important; }\n      .gm-style .gm-style-iw-d::-webkit-scrollbar { display: none !important; }\n    </style>`;this.infoWindow=new google.maps.InfoWindow({content:o+e,maxWidth:400});this.infoWindow.open({anchor:this.marker,map:this.map});this.infoWindow.addListener("domready",(()=>{setTimeout((()=>{const e=document.querySelector(".gm-style-iw-c");const t=document.querySelector(".gm-style-iw-d");if(e){e.style.setProperty("max-width","400px","important");e.style.setProperty("padding","0","important");e.style.setProperty("border-radius","16px","important");e.style.setProperty("box-shadow","0 4px 20px rgba(0,0,0,0.15)","important")}if(t){t.style.setProperty("max-width","400px","important");t.style.setProperty("overflow","visible","important")}}),50)}));if(t){window.__infoWindowContinueCallback=t}}closeInfoWindow(){if(this.infoWindow){this.infoWindow.close();this.infoWindow=null}}getInfoWindow(){return this.infoWindow}async initAutocomplete(e,t){await this.loadGoogleMaps();const o={componentRestrictions:{country:"pr"},fields:["address_components","geometry","formatted_address"],types:["address"]};this.autocomplete=new google.maps.places.Autocomplete(e,o);this.autocomplete.addListener("place_changed",(()=>{const e=this.autocomplete?.getPlace();if(!e?.geometry?.location){return}const o=this.parseAddressComponents(e);t(o);if(this.map){this.centerMap(o.coordinates);this.setMarker(o.coordinates)}}))}parseAddressComponents(e){const t=e.address_components||[];let o="";let i="";let a="";let n="";for(const e of t){const t=e.types[0];switch(t){case"street_number":o=e.long_name;break;case"route":i=e.long_name;break;case"locality":case"administrative_area_level_2":a=a||e.long_name;break;case"postal_code":n=e.long_name;break}}const r=[o,i].filter(Boolean).join(" ");const s=e.geometry?.location;return{address:r,city:a,zipCode:n,coordinates:{lat:s?.lat()||0,lng:s?.lng()||0},formattedAddress:e.formatted_address||""}}async geocodeAddress(e){await this.loadGoogleMaps();const t=new google.maps.Geocoder;return new Promise((o=>{t.geocode({address:e,componentRestrictions:{country:"pr"}},((e,t)=>{if(t==="OK"&&e&&e[0]){const t=e[0];const i=this.parseGeocoderResult(t);o(i)}else{o(null)}}))}))}async reverseGeocode(e){await this.loadGoogleMaps();const t=new google.maps.Geocoder;return new Promise((o=>{t.geocode({location:e},((e,t)=>{if(t==="OK"&&e&&e[0]){const t=e[0];const i=this.parseGeocoderResult(t);o(i)}else{o(null)}}))}))}parseGeocoderResult(e){const t=e.address_components||[];let o="";let i="";let a="";let n="";for(const e of t){const t=e.types[0];switch(t){case"street_number":o=e.long_name;break;case"route":i=e.long_name;break;case"locality":case"administrative_area_level_2":a=a||e.long_name;break;case"postal_code":n=e.long_name;break}}const r=[o,i].filter(Boolean).join(" ");const s=e.geometry.location;return{address:r,city:a,zipCode:n,coordinates:{lat:s.lat(),lng:s.lng()},formattedAddress:e.formatted_address}}async getCurrentLocation(){return new Promise(((e,t)=>{if(!navigator.geolocation){t(new Error("Geolocation is not supported by this browser"));return}navigator.geolocation.getCurrentPosition((t=>{e({lat:t.coords.latitude,lng:t.coords.longitude})}),(e=>{let o="Error getting location";switch(e.code){case e.PERMISSION_DENIED:o="Location permission denied";break;case e.POSITION_UNAVAILABLE:o="Location information unavailable";break;case e.TIMEOUT:o="Location request timed out";break}t(new Error(o))}),{enableHighAccuracy:true,timeout:1e4,maximumAge:0})}))}async getCurrentLocationWithAddress(){const e=await this.getCurrentLocation();return this.reverseGeocode(e)}destroy(){this.closeInfoWindow();this.removeMarker();this.autocomplete=null;this.map=null}}const S=new F;const A=()=>`@keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes slideUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}@keyframes spin{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}:host{display:block;width:100%;font-family:"AMX", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, sans-serif;color:#333333;line-height:1.5}.fsf-container{width:100%}.fsf-loading{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:300px;padding:2rem}.fsf-loading__spinner{width:48px;height:48px;border:4px solid #E5E5E5;border-top-color:#0097A9;border-radius:50%;animation:spin 1s linear infinite}.fsf-loading__text{margin-top:1rem;font-size:1rem;font-weight:400;line-height:1.5;color:#666666}.fsf-error{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:300px;padding:2rem;text-align:center}.fsf-error__icon{display:flex;align-items:center;justify-content:center;width:64px;height:64px;font-size:1.75rem;font-weight:700;color:#FFFFFF;background-color:#DA291C;border-radius:50%}.fsf-error__title{margin-top:1rem;font-size:1.5rem;font-weight:600;line-height:1.35;color:#333333}.fsf-error__message{margin-top:0.5rem;font-size:1rem;font-weight:400;line-height:1.5;color:#666666;max-width:400px}.fsf-error__button{display:inline-flex;align-items:center;justify-content:center;gap:0.5rem;padding:0 1.5rem;font-family:"AMX", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, sans-serif;font-size:1rem;font-weight:600;line-height:1;text-decoration:none;border:none;border-radius:9999px;cursor:pointer;transition:all 150ms ease}.fsf-error__button:disabled{opacity:0.5;cursor:not-allowed}.fsf-error__button{height:48px;background-color:#DA291C;color:#FFFFFF}.fsf-error__button:hover:not(:disabled){background-color:rgb(181.843902439, 34.2, 23.356097561)}.fsf-error__button:active:not(:disabled){background-color:rgb(163.7658536585, 30.8, 21.0341463415)}.fsf-error__button{margin-top:1.5rem}.step-placeholder{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:400px;padding:2rem;text-align:center;background:#FFFFFF;border-radius:0.75rem;box-shadow:0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);margin:1rem}.step-placeholder h2{font-size:1.75rem;font-weight:700;line-height:1.2;color:#333333;margin-bottom:1rem}.step-placeholder p{font-size:1rem;font-weight:400;line-height:1.5;color:#666666;margin-bottom:1.5rem}.step-placeholder button{display:inline-flex;align-items:center;justify-content:center;gap:0.5rem;padding:0 1.5rem;font-family:"AMX", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, sans-serif;font-size:1rem;font-weight:600;line-height:1;text-decoration:none;border:none;border-radius:9999px;cursor:pointer;transition:all 150ms ease}.step-placeholder button:disabled{opacity:0.5;cursor:not-allowed}.step-placeholder button{height:48px;background-color:#DA291C;color:#FFFFFF}.step-placeholder button:hover:not(:disabled){background-color:rgb(181.843902439, 34.2, 23.356097561)}.step-placeholder button:active:not(:disabled){background-color:rgb(163.7658536585, 30.8, 21.0341463415)}.step-placeholder button{margin:0.5rem}.step-placeholder button:last-child{display:inline-flex;align-items:center;justify-content:center;gap:0.5rem;padding:0 1.5rem;font-family:"AMX", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, sans-serif;font-size:1rem;font-weight:600;line-height:1;text-decoration:none;border:none;border-radius:9999px;cursor:pointer;transition:all 150ms ease}.step-placeholder button:last-child:disabled{opacity:0.5;cursor:not-allowed}.step-placeholder button:last-child{height:48px;background-color:#0097A9;color:#FFFFFF}.step-placeholder button:last-child:hover:not(:disabled){background-color:rgb(0, 114.5455621302, 128.2)}.step-placeholder button:last-child:active:not(:disabled){background-color:rgb(0, 96.3183431953, 107.8)}@keyframes spin{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}`;const I={LOCATION:1,CATALOGUE:2,PLANS:3,CONTRACT:4,FORM:5,CONFIRMATION:6};const E=5;const z=6;const P=class{constructor(o){e(this,o);this.flowComplete=t(this,"flowComplete");this.flowError=t(this,"flowError");this.flowCancel=t(this,"flowCancel");this.stepChange=t(this,"stepChange")}apiUrl;googleMapsKey;correlationId;initialStep=1;debug=false;currentStep=1;isLoading=true;error=null;isInitialized=false;flowComplete;flowError;flowCancel;stepChange;handleApiUrlChange(e){if(e){r.setBaseUrl(e)}}async componentWillLoad(){if(this.debug){window.__FSF_DEBUG__=true}if(this.apiUrl){r.setBaseUrl(this.apiUrl)}if(this.initialStep){this.currentStep=this.initialStep;s.setStep(this.initialStep)}await this.initializeToken()}componentDidLoad(){this.log("Component loaded")}disconnectedCallback(){this.log("Component disconnected")}async initializeToken(){this.isLoading=true;this.error=null;try{const e=await n.initialize();if(!e){this.error="Error al inicializar la sesión";this.emitError(new Error(this.error),false)}this.isInitialized=true}catch(e){this.error=e.message||"Error de inicialización";this.emitError(e,false)}finally{this.isLoading=false}}handleStepChange=e=>{const t=this.currentStep;const o=this.isClaroHogar()?z:E;let i;if(e==="forward"){i=Math.min(this.currentStep+1,o);s.nextStep()}else{i=Math.max(this.currentStep-1,1);s.prevStep()}this.currentStep=i;s.setStep(i);this.stepChange.emit({from:t,to:i,direction:e});this.log(`Step changed: ${t} -> ${i}`)};_goToStep=e=>{const t=this.currentStep;const o=e>t?"forward":"backward";s.setStep(e);this.currentStep=e;this.stepChange.emit({from:t,to:e,direction:o});this.log(`Step changed: ${t} -> ${e}`)};handleFlowComplete=e=>{this.log("Flow completed",e);this.flowComplete.emit(e)};handleFlowCancel=()=>{this.log("Flow cancelled");s.resetFlow();this.currentStep=1;s.setStep(1);this.flowCancel.emit()};emitError(e,t=true){this.flowError.emit({step:this.currentStep,error:e,recoverable:t})}log(...e){if(this.debug){console.log("[FixedServiceFlow]",...e)}}isClaroHogar(){const e=c.location?.serviceType?.toUpperCase();return e==="CLARO HOGAR"}renderStep(){const e={onNext:()=>this.handleStepChange("forward"),onBack:()=>this.handleStepChange("backward"),onComplete:this.handleFlowComplete,googleMapsKey:this.googleMapsKey};if(this.isClaroHogar()){this.log("CLARO HOGAR flow - step:",this.currentStep);return this.renderClaroHogarStep(e)}return this.renderStandardStep(e)}renderStandardStep(e){switch(this.currentStep){case 1:return o("step-location",{...e});case 2:return o("step-plans",{...e});case 3:return o("step-contract",{...e});case 4:return o("step-form",{...e});case 5:return o("step-confirmation",{...e,onCancel:this.handleFlowCancel});default:return null}}renderClaroHogarStep(e){switch(this.currentStep){case I.LOCATION:return o("step-location",{...e});case I.CATALOGUE:return o("step-catalogue",{...e});case I.PLANS:return o("step-plans",{...e});case I.CONTRACT:return o("step-contract",{...e});case I.FORM:return o("step-form",{...e});case I.CONFIRMATION:return o("step-confirmation",{...e,onCancel:this.handleFlowCancel});default:return null}}renderLoading(){return o("div",{class:"fsf-loading"},o("div",{class:"fsf-loading__spinner"}),o("p",{class:"fsf-loading__text"},"Cargando..."))}renderError(){return o("div",{class:"fsf-error"},o("div",{class:"fsf-error__icon"},"!"),o("h3",{class:"fsf-error__title"},"Error"),o("p",{class:"fsf-error__message"},this.error),o("button",{class:"fsf-error__button",onClick:()=>this.initializeToken()},"Reintentar"))}render(){if(this.isLoading){return o(i,null,this.renderLoading())}if(this.error&&!this.isInitialized){return o(i,null,this.renderError())}return o(i,null,o("div",{class:"fsf-container"},this.renderStep()))}static get watchers(){return{apiUrl:["handleApiUrlChange"]}}};P.style=A();const M=(e,t=true)=>{const o={style:"currency",currency:"USD",minimumFractionDigits:t?2:0,maximumFractionDigits:t?2:0};return new Intl.NumberFormat("en-US",o).format(e)};const N=e=>M(e);const D=e=>{const t=e.replace(/\D/g,"");if(t.length===0)return"";if(t.length<=3)return`(${t}`;if(t.length<=6)return`(${t.slice(0,3)}) ${t.slice(3)}`;return`(${t.slice(0,3)}) ${t.slice(3,6)}-${t.slice(6,10)}`};const L=e=>e.replace(/\D/g,"").slice(0,10);const O=()=>`@keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes slideUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}@keyframes spin{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}:host{display:block}.step-catalogue{width:100%;min-height:100vh;display:flex;flex-direction:column;background:#FFFFFF}.step-catalogue__header{width:100%;background:#FFFFFF;padding:1rem 1.5rem;box-sizing:border-box}@media (max-width: 767px){.step-catalogue__header{padding:0.75rem 1rem}}.step-catalogue__back-link{display:inline-flex;align-items:center;gap:0.25rem;padding:0.5rem 0;background:transparent;border:none;color:#0097A9;font-size:0.875rem;font-weight:600;cursor:pointer;transition:opacity 150ms ease}.step-catalogue__back-link svg{width:20px;height:20px}.step-catalogue__back-link:hover{opacity:0.8}.step-catalogue__title{margin:0.75rem 0 1rem;font-size:24px;font-weight:700;color:#333333;line-height:1.2}@media (max-width: 767px){.step-catalogue__title{font-size:20px;margin:0.5rem 0 0.75rem}}.step-catalogue__divider{height:1px;background:#E5E5E5;margin:0 -1.5rem}@media (max-width: 767px){.step-catalogue__divider{margin:0 -1rem}}.step-catalogue__loading,.step-catalogue__error,.step-catalogue__empty{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:2rem;text-align:center}.step-catalogue__loading p,.step-catalogue__error p,.step-catalogue__empty p{margin-top:1rem;font-size:1rem;color:#666666}.step-catalogue__loading button,.step-catalogue__error button,.step-catalogue__empty button{margin-top:1rem;padding:0.5rem 1.5rem;background:#0097A9;color:#FFFFFF;border:none;border-radius:20px;font-size:0.875rem;font-weight:600;cursor:pointer;transition:background 150ms ease}.step-catalogue__loading button:hover,.step-catalogue__error button:hover,.step-catalogue__empty button:hover{background:rgb(0, 114.5455621302, 128.2)}.step-catalogue__spinner{width:48px;height:48px;border:4px solid #E5E5E5;border-top-color:#0097A9;border-radius:50%;animation:spin 1s linear infinite}.step-catalogue__carousel-container{flex:1;padding:1.5rem;overflow:hidden}@media (max-width: 767px){.step-catalogue__carousel-container{padding:1rem}}.step-catalogue__summary-bar{width:100%;position:sticky;bottom:0;left:0;right:0;background:#FFFFFF;border-top:1px solid #E5E5E5;box-shadow:0 -4px 16px rgba(0, 0, 0, 0.08);padding:1rem 1.5rem;display:flex;align-items:center;justify-content:space-between;gap:1rem;z-index:10;box-sizing:border-box}@media (max-width: 1199px){.step-catalogue__summary-bar{flex-direction:column;gap:1rem}}@media (max-width: 767px){.step-catalogue__summary-bar{padding:0.75rem 1rem}}.step-catalogue__summary-content{display:grid;grid-template-columns:repeat(5, 1fr);gap:1rem;flex:1}@media (max-width: 1199px){.step-catalogue__summary-content{width:100%;grid-template-columns:repeat(3, 1fr)}}@media (max-width: 767px){.step-catalogue__summary-content{grid-template-columns:repeat(2, 1fr);gap:0.5rem}}.step-catalogue__summary-item{display:flex;flex-direction:column;gap:0.25rem}.step-catalogue__summary-item--highlight .step-catalogue__summary-label{color:#333333;font-weight:700}.step-catalogue__summary-label{font-size:0.75rem;font-weight:500;color:#666666;text-transform:uppercase;letter-spacing:0.5px}.step-catalogue__summary-value{font-size:0.875rem;font-weight:600;color:#333333}.step-catalogue__summary-value--red{color:#DA291C;font-weight:700}.step-catalogue__continue-btn{padding:0.75rem 2rem;background:#DA291C;color:#FFFFFF;border:none;border-radius:30px;font-size:1rem;font-weight:700;cursor:pointer;white-space:nowrap;transition:all 150ms ease;min-width:160px}.step-catalogue__continue-btn:hover:not(:disabled){background:rgb(181.843902439, 34.2, 23.356097561)}.step-catalogue__continue-btn:disabled,.step-catalogue__continue-btn--disabled{background:#999999;cursor:not-allowed}@media (max-width: 1199px){.step-catalogue__continue-btn{width:100%;padding:1rem}}.product-card{background:#FFFFFF;border:2px solid #E5E5E5;border-radius:12px;overflow:hidden;cursor:pointer;transition:all 150ms ease;position:relative;height:100%;min-height:220px;display:flex;flex-direction:column}.product-card:hover{border-color:#CCCCCC;box-shadow:0 4px 16px rgba(0, 0, 0, 0.1);transform:translateY(-2px)}.product-card--selected{border-color:#0097A9;box-shadow:0 4px 16px rgba(0, 151, 169, 0.2)}.product-card--selected:hover{border-color:#0097A9}.product-card--loading{opacity:0.7;pointer-events:none}.product-card__content{display:grid;grid-template-columns:120px 1fr;gap:1rem;padding:1rem;flex:1}@media (max-width: 767px){.product-card__content{grid-template-columns:100px 1fr;gap:0.75rem;padding:0.75rem}}.product-card__image{display:flex;align-items:center;justify-content:center;background:#FFFFFF;border-radius:8px;padding:0.5rem}.product-card__image img{max-width:100%;max-height:100px;object-fit:contain}.product-card__info{display:flex;flex-direction:column;gap:0.5rem}.product-card__name{margin:0;font-size:1rem;font-weight:700;color:#333333;line-height:1.3}@media (max-width: 767px){.product-card__name{font-size:0.875rem}}.product-card__financed{display:flex;flex-direction:column;gap:2px}.product-card__financed-label{font-size:0.75rem;font-weight:600;color:#333333}.product-card__financed-price{font-size:1.25rem;font-weight:700;color:#DA291C}.product-card__installments{font-size:0.75rem;color:#666666}.product-card__regular-price{margin:0;font-size:0.75rem;color:#666666}.product-card__description{margin:0.5rem 0 0;font-size:0.75rem;color:#666666;line-height:1.4}@media (max-width: 767px){.product-card__description{display:none}}.product-card__processing{position:absolute;top:0;left:0;right:0;bottom:0;background:rgba(255, 255, 255, 0.8);display:flex;align-items:center;justify-content:center}.product-card__spinner{width:32px;height:32px;border:3px solid #E5E5E5;border-top-color:#0097A9;border-radius:50%;animation:spin 1s linear infinite}.product-card__footer{border-top:1px solid #E5E5E5;padding:0.75rem 1rem;margin-top:auto}.product-card__footer-text{margin:0;font-size:0.75rem;color:#666666;text-align:left;line-height:1.4}.unavailable-modal-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0, 0, 0, 0.5);display:flex;align-items:center;justify-content:center;z-index:1000;padding:1rem;animation:fadeIn 0.2s ease-out}.unavailable-modal{background:#FFFFFF;border-radius:16px;padding:2rem;max-width:400px;width:100%;text-align:center;box-shadow:0 8px 32px rgba(0, 0, 0, 0.2);animation:modalSlideIn 0.3s ease-out}.unavailable-modal__icon{display:flex;align-items:center;justify-content:center;width:64px;height:64px;margin:0 auto 1rem;background:#FFF3CD;border-radius:50%}.unavailable-modal__icon svg{width:32px;height:32px;color:#856404}.unavailable-modal__title{margin:0 0 0.75rem;font-size:20px;font-weight:700;color:#333333}.unavailable-modal__message{margin:0 0 1.5rem;font-size:1rem;color:#666666;line-height:1.5}.unavailable-modal__button{padding:0.75rem 2rem;background:#DA291C;color:#FFFFFF;border:none;border-radius:30px;font-size:1rem;font-weight:700;cursor:pointer;transition:background 150ms ease;min-width:160px}.unavailable-modal__button:hover{background:rgb(181.843902439, 34.2, 23.356097561)}@keyframes spin{to{transform:rotate(360deg)}}@keyframes modalSlideIn{from{opacity:0;transform:translateY(-20px) scale(0.95)}to{opacity:1;transform:translateY(0) scale(1)}}@keyframes fadeIn{from{opacity:0}to{opacity:1}}`;const R=class{constructor(t){e(this,t)}onNext;onBack;products=[];isLoading=true;error=null;productsWithDetails=new Map;loadingDetails=new Set;selectedProduct=null;selectedProductDetail=null;isAddingToCart=false;showUnavailableModal=false;summaryData=null;componentWillLoad(){}componentDidLoad(){this.loadProducts()}async loadProducts(){this.isLoading=true;this.error=null;try{const e=l.FILTER_INTERNET_INALAMBRICO;const t=await l.listCatalogue(e,1,"");this.products=t.products||[];if(this.products.length>0){await this.loadProductsDetails(this.products)}}catch(e){console.error("[StepCatalogue] Error loading products:",e);this.error="Error al cargar el catálogo de productos"}finally{this.isLoading=false}}async loadProductsDetails(e){const t=e.slice(0,6);const o=t.map((async e=>{if(this.productsWithDetails.has(e.productId)){return}this.loadingDetails=new Set([...this.loadingDetails,e.productId]);try{const t=await d.getEquipmentDetail(e.productId);if(!t.hasError&&t.product){const o=new Map(this.productsWithDetails);o.set(e.productId,t.product);this.productsWithDetails=o}}catch(t){console.error(`[StepCatalogue] Error loading details for ${e.productId}:`,t)}finally{const t=new Set(this.loadingDetails);t.delete(e.productId);this.loadingDetails=t}}));await Promise.allSettled(o)}handleSelectProduct=async e=>{if(this.selectedProduct?.productId===e.productId){return}this.isAddingToCart=true;this.error=null;try{let t=this.productsWithDetails.get(e.productId);if(!t){console.log("[StepCatalogue] Loading detail for:",e.productId);const o=await d.getEquipmentDetail(e.productId);if(o.hasError||!o.product){throw new Error("Error al cargar detalles del producto")}t=o.product;const i=new Map(this.productsWithDetails);i.set(e.productId,t);this.productsWithDetails=i}const o=1;if(t.stock===undefined||t.stock<=o){console.log("[StepCatalogue] Product unavailable, stock:",t.stock);this.showUnavailableModal=true;this.isAddingToCart=false;return}this.selectedProduct=e;this.selectedProductDetail=t;this.updateSummaryData(e,t);const i=parseInt(l.FILTER_INTERNET_INALAMBRICO,10);l.storeProductInSession(e);d.storeSelectedProduct(e,i);console.log("[StepCatalogue] Adding to cart:",e.productName);const a=await p.addToCart(t,e.installments||24,1);if(a.hasError){console.error("[StepCatalogue] Cart error:",a.message)}else{console.log("[StepCatalogue] Added to cart, mainId:",a.code)}}catch(e){console.error("[StepCatalogue] Selection error:",e);this.error="Error al seleccionar el producto. Por favor intente de nuevo."}finally{this.isAddingToCart=false}};updateSummaryData(e,t){const o=e.regular_price||t.decDownPayment||0;this.summaryData={productName:e.productName,planPrice:0,svaPrice:0,equipmentPrice:e.update_price||0,payToday:o}}handleContinue=()=>{if(this.selectedProduct&&!this.isAddingToCart){this.onNext?.()}};handleCloseUnavailableModal=()=>{this.showUnavailableModal=false};renderUnavailableModal(){if(!this.showUnavailableModal){return null}return o("div",{class:"unavailable-modal-overlay",onClick:this.handleCloseUnavailableModal},o("div",{class:"unavailable-modal",onClick:e=>e.stopPropagation()},o("div",{class:"unavailable-modal__icon"},o("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},o("circle",{cx:"12",cy:"12",r:"10"}),o("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),o("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"}))),o("h3",{class:"unavailable-modal__title"},"Producto no disponible"),o("p",{class:"unavailable-modal__message"},"Lo sentimos, este producto no está disponible en este momento. Por favor, seleccione otro equipo."),o("button",{class:"unavailable-modal__button",onClick:this.handleCloseUnavailableModal},"Entendido")))}renderProductCard(e){const t=this.selectedProduct?.productId===e.productId;const i=this.loadingDetails.has(e.productId);const a=this.isAddingToCart&&t;return o("div",{class:{"product-card":true,"product-card--selected":t,"product-card--loading":i},onClick:()=>!this.isAddingToCart&&this.handleSelectProduct(e)},o("div",{class:"product-card__content"},o("div",{class:"product-card__image"},o("img",{src:e.imgUrl,alt:e.productName,loading:"lazy"})),o("div",{class:"product-card__info"},o("h3",{class:"product-card__name"},e.productName),e.installments>0&&o("div",{class:"product-card__financed"},o("span",{class:"product-card__financed-label"},"Financiado"),o("span",{class:"product-card__financed-price"},N(e.update_price||0),"/mes"),o("span",{class:"product-card__installments"},e.installments," plazos")),o("p",{class:"product-card__regular-price"},"Precio regular: ",N(e.regular_price||0)))),o("div",{class:"product-card__footer"},o("p",{class:"product-card__footer-text"},"¡Mantente conectado en todo momento!")),a&&o("div",{class:"product-card__processing"},o("div",{class:"product-card__spinner"})))}renderSummaryBar(){const e=this.summaryData?.productName||"-";const t=this.summaryData?.planPrice||0;const i=this.summaryData?.svaPrice||0;const a=this.summaryData?.equipmentPrice||0;const n=this.summaryData?.payToday||0;return o("footer",{class:"step-catalogue__summary-bar"},o("div",{class:"step-catalogue__summary-content"},o("div",{class:"step-catalogue__summary-item"},o("span",{class:"step-catalogue__summary-label"},"PCD"),o("span",{class:"step-catalogue__summary-value"},e)),o("div",{class:"step-catalogue__summary-item"},o("span",{class:"step-catalogue__summary-label"},"Plan"),o("span",{class:"step-catalogue__summary-value"},N(t)," / mes")),o("div",{class:"step-catalogue__summary-item"},o("span",{class:"step-catalogue__summary-label"},"SVA"),o("span",{class:"step-catalogue__summary-value"},N(i)," / mes")),o("div",{class:"step-catalogue__summary-item"},o("span",{class:"step-catalogue__summary-label"},"Equipo / Accesorio"),o("span",{class:"step-catalogue__summary-value"},N(a)," / mes")),o("div",{class:"step-catalogue__summary-item step-catalogue__summary-item--highlight"},o("span",{class:"step-catalogue__summary-label"},"Paga hoy"),o("span",{class:"step-catalogue__summary-value step-catalogue__summary-value--red"},N(n)," + IVU"))),o("button",{class:{"step-catalogue__continue-btn":true,"step-catalogue__continue-btn--disabled":!this.selectedProduct||this.isAddingToCart},onClick:this.handleContinue,disabled:!this.selectedProduct||this.isAddingToCart},this.isAddingToCart?"Procesando...":"Continuar"))}render(){return o(i,{key:"2b2178714bf18ddc2ba4f740f02a497f0fc48cd3"},o("div",{key:"4f0911c50ecf8ca8ddc684bc929b6e060ffee845",class:"step-catalogue"},o("header",{key:"b07d68d064922ec0865b0979bdc6d5089f99a32c",class:"step-catalogue__header"},o("button",{key:"f25d525aad09fc9a035eb392a15b0daf93660933",class:"step-catalogue__back-link",onClick:this.onBack},o("svg",{key:"b70e76e40ad960548eacc463843c74c691c8f83b",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},o("polyline",{key:"9dd0933e00919947e9ff88a3a357b44a9c84df21",points:"15 18 9 12 15 6"})),o("span",{key:"bfbed9c9e07a1af489b32b1f879c72658ea06aa3"},"Regresar")),o("h1",{key:"b34ef77b46519546c79805005bb993d603611f1f",class:"step-catalogue__title"},"Escoger modem para servicio fijo"),o("div",{key:"efa87d6abfee8c5bdf9c9e6939cd780c9e361d9c",class:"step-catalogue__divider"})),this.isLoading&&o("div",{key:"0b1f7eae78137f06b40c9a21963966609228163f",class:"step-catalogue__loading"},o("div",{key:"3ee83aee91e59f653df07a6cf7a6bc4c2204b8bc",class:"step-catalogue__spinner"}),o("p",{key:"c2f831a70c458d6fbbc42f8c3d53e9ca31fa7639"},"Cargando productos...")),this.error&&!this.isLoading&&o("div",{key:"07542ca156af5ff975beeb2442e6e8bf89d4ebeb",class:"step-catalogue__error"},o("p",{key:"0900d3a0bef57fe7a15c7a44eefa9313e72b1d8a"},this.error),o("button",{key:"c4a2fd0a2f495364206eb770d6124a017246abca",onClick:()=>this.loadProducts()},"Reintentar")),!this.isLoading&&!this.error&&this.products.length>0&&o("div",{key:"daddeff0755c68c6770e39e1aeb021d1c453cd2a",class:"step-catalogue__carousel-container"},o("ui-carousel",{key:"4cc8bb014d046c04722ae0d9afb36db54d4a0047",totalItems:this.products.length,gap:24,showNavigation:false,showPagination:true,breakpoints:[{minWidth:0,slidesPerView:1},{minWidth:600,slidesPerView:2},{minWidth:900,slidesPerView:3}]},this.products.map((e=>this.renderProductCard(e))))),!this.isLoading&&!this.error&&this.products.length===0&&o("div",{key:"1c3584c9a7aeb3604e8dfb97aebf4dd76a12db8c",class:"step-catalogue__empty"},o("p",{key:"fe9abd7e12b80df5d3eecf6ab423faca88c01664"},"No hay productos disponibles en este momento.")),this.renderSummaryBar(),this.renderUnavailableModal()))}};R.style=O();const T=()=>`@keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes slideUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}@keyframes spin{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}:host{display:block}.step-confirmation{width:100%}.step-confirmation__header{margin-bottom:1.5rem;padding-bottom:1rem;position:relative}.step-confirmation__header::after{content:"";position:absolute;bottom:0;left:50%;transform:translateX(-50%);width:100vw;height:1px;background:#E5E5E5}.step-confirmation__header-title{font-size:1.75rem;font-weight:700;line-height:1.2;color:#333333}.step-confirmation__content{background-color:#FFFFFF;border:1px solid #E5E5E5;border-radius:0.75rem;box-shadow:0 2px 8px rgba(0, 0, 0, 0.08);transition:box-shadow 150ms ease, border-color 150ms ease;padding:3rem 2rem;text-align:center;min-height:300px;display:flex;flex-direction:column;align-items:center;justify-content:center}.step-confirmation__loading{display:flex;flex-direction:column;align-items:center;justify-content:center}.step-confirmation__loading p{margin-top:1rem;font-size:1rem;font-weight:400;line-height:1.5;color:#666666}.step-confirmation__spinner{width:48px;height:48px;border:4px solid #E5E5E5;border-top-color:#0097A9;border-radius:50%;animation:spin 1s linear infinite}.step-confirmation__result{display:flex;flex-direction:column;align-items:center;justify-content:center;width:100%;max-width:500px}.step-confirmation__icon{display:flex;align-items:center;justify-content:center;margin-bottom:1rem}.step-confirmation__icon img{width:48px;height:48px}.step-confirmation__icon svg{width:40px;height:40px}.step-confirmation__title{font-size:1.5rem;font-weight:600;line-height:1.35;color:#333333;margin-bottom:0.5rem}.step-confirmation__title--success{color:#15A045}.step-confirmation__title--error{color:#E00814}.step-confirmation__message{font-size:1rem;font-weight:400;line-height:1.5;color:#666666;margin-bottom:1.5rem}.step-confirmation__order-id{font-size:0.875rem;font-weight:400;line-height:1.5;color:#666666;margin-bottom:1.5rem;padding:0.5rem 1rem;background:#FAFAFA;border-radius:0.5rem}.step-confirmation__actions{margin-top:1.5rem;text-align:center}.step-confirmation__btn{display:inline-flex;align-items:center;justify-content:center;gap:0.5rem;padding:0 1.5rem;font-family:"AMX", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, sans-serif;font-size:1rem;font-weight:600;line-height:1;text-decoration:none;border:none;border-radius:9999px;cursor:pointer;transition:all 150ms ease}.step-confirmation__btn:disabled{opacity:0.5;cursor:not-allowed}.step-confirmation__btn{height:48px;background-color:transparent;color:#0097A9;border:2px solid #0097A9}.step-confirmation__btn:hover:not(:disabled){background-color:rgba(0, 151, 169, 0.1)}.step-confirmation__btn:active:not(:disabled){background-color:rgba(0, 151, 169, 0.2)}.step-confirmation__btn{min-width:180px}.step-confirmation__btn--error{display:inline-flex;align-items:center;justify-content:center;gap:0.5rem;padding:0 1.5rem;font-family:"AMX", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, sans-serif;font-size:1rem;font-weight:600;line-height:1;text-decoration:none;border:none;border-radius:9999px;cursor:pointer;transition:all 150ms ease}.step-confirmation__btn--error:disabled{opacity:0.5;cursor:not-allowed}.step-confirmation__btn--error{height:48px;background-color:#DA291C;color:#FFFFFF}.step-confirmation__btn--error:hover:not(:disabled){background-color:rgb(181.843902439, 34.2, 23.356097561)}.step-confirmation__btn--error:active:not(:disabled){background-color:rgb(163.7658536585, 30.8, 21.0341463415)}@keyframes spin{to{transform:rotate(360deg)}}`;const U=class{constructor(t){e(this,t)}onComplete;onCancel;onBack;status="loading";orderId=null;orderNumber=null;confirmationSent=false;errorMessage="";async componentWillLoad(){const e=this.isCatalogueFlow();if(e){await this.handleCatalogueFlowConfirmation()}else{await this.submitRequest()}}isCatalogueFlow(){const e=m.getPaymentResult();const t=!!c.selectedContract;const o=!!c.formData;return!!e&&!t&&!o}async handleCatalogueFlowConfirmation(){this.status="loading";try{const e=m.getPaymentResult();if(!e||!e.success){throw new Error("No se encontró información del pago")}const t=m.getOrderBan();this.orderId=t||e.operationId||null;console.log("[StepConfirmation] Catalogue flow - payment success:",{orderId:this.orderId,operationId:e.operationId,authorizationNumber:e.authorizationNumber});this.status="success";s.setOrderResult(this.orderId,null);this.onComplete?.({orderId:this.orderId,plan:c.selectedPlan,contract:null,customer:null,location:c.location})}catch(e){console.error("[StepConfirmation] Catalogue flow error:",e);this.status="error";this.errorMessage=e.message||v.REQUEST_ERROR;s.setOrderResult(null,this.errorMessage)}}async submitRequest(){this.status="loading";try{const{location:e,plan:t,contract:o,formData:i}={location:c.location,plan:c.selectedPlan,contract:c.selectedContract,formData:c.formData};const a=w.validateSubmissionData(i,o,t,e);if(!a.isValid){throw new Error(`Datos incompletos: ${a.missingFields.join(", ")}`)}const n=w.buildPayload(i,o,t,e);const r=await w.submitRequest(n);if(r.hasError){throw new Error(r.errorDisplay||r.message||v.REQUEST_ERROR)}this.orderId=r.orderId||null;if(this.orderId){this.fetchOrderDetails(this.orderId);this.sendConfirmationEmail(this.orderId,i.personal.email)}this.status="success";s.setOrderResult(this.orderId,null);this.onComplete?.({orderId:this.orderId,plan:t,contract:o,customer:i,location:e})}catch(e){console.error("Request submission failed:",e);this.status="error";this.errorMessage=e.message||v.REQUEST_ERROR;s.setOrderResult(null,this.errorMessage)}}async fetchOrderDetails(e){try{const t=await w.getOrder(e);if(!t.hasError&&t.orderNumber){this.orderNumber=t.orderNumber}}catch(e){console.warn("Could not fetch order details:",e)}}async sendConfirmationEmail(e,t){try{const o=await w.sendConfirmation(e,t);if(!o.hasError&&o.sent){this.confirmationSent=true}}catch(e){console.warn("Could not send confirmation email:",e)}}handleRetry=()=>{this.submitRequest()};handleClose=()=>{this.clearSessionStorage();s.resetFlow();this.onCancel?.()};clearSessionStorage(){console.log("[StepConfirmation] Clearing all sessionStorage data");try{p.clearCartSession();d.clearProductSession();f.clearShippingData();m.clearPaymentData();y.clearPlan();s.clearToken()}catch(e){console.warn("[StepConfirmation] Error clearing service data:",e)}const e=["token","correlationId","latitud","longitud","planCodeInternet","plan","planId","planPrice","typeContractId","contractInstallment","contractInstallation","contractActivation","contractModen","cart","cartId","cartTotal","cartProducts","mainId","discountCoupon","selectedProduct","productId","subcatalogId","selectedColor","selectedStorage","childrenId","parentId","deviceType","shipmentId","zipCode","shippingAddress","deliveryMethod","orderBan","paymentResult","serviceLatitude","serviceLongitude","serviceAddress","serviceCity","serviceZipCode","serviceType","serviceMessage","planName","planSoc","planFeatures","customerFirstName","customerSecondName","customerLastName","customerSecondLastName","customerIdType","customerIdNumber","customerIdExpiration","customerPhone1","customerPhone2","customerEmail","customerBirthDate","businessName","businessPosition","isExistingCustomer","shoppingCart"];e.forEach((e=>{sessionStorage.removeItem(e)}));console.log("[StepConfirmation] SessionStorage cleared successfully")}renderLoading(){return o("div",{class:"step-confirmation__loading"},o("div",{class:"step-confirmation__spinner"}),o("p",null,"Procesando tu solicitud..."))}renderSuccess(){const e=this.orderNumber||this.orderId;return o("div",{class:"step-confirmation__result step-confirmation__result--success"},o("div",{class:"step-confirmation__icon step-confirmation__icon--success"},o("svg",{width:"49",height:"48",viewBox:"0 0 49 48",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o("path",{d:"M24.4237 2C12.0492 2 2 11.8441 2 23.9661C2 36.0881 12.0492 45.9322 24.4237 45.9322C36.7983 45.9322 46.8475 36.0881 46.8475 23.9661",stroke:"#0EA651","stroke-width":"4","stroke-miterlimit":"10","stroke-linecap":"round","stroke-linejoin":"round"}),o("path",{d:"M44.5225 4.19666L21.1852 30.8L12.3818 22.2577",stroke:"#0EA651","stroke-width":"4","stroke-miterlimit":"10","stroke-linecap":"round","stroke-linejoin":"round"}))),o("h2",{class:"step-confirmation__title step-confirmation__title--success"},C.REQUEST_SUCCESS),o("p",{class:"step-confirmation__message"},C.REQUEST_SUCCESS_SUBTITLE),e&&o("p",{class:"step-confirmation__order-id"},"Número de orden: ",e),this.confirmationSent&&o("p",{class:"step-confirmation__email-sent"},"Se ha enviado un correo de confirmación a tu email."))}renderError(){return o("div",{class:"step-confirmation__result step-confirmation__result--error"},o("div",{class:"step-confirmation__icon step-confirmation__icon--error"},o("svg",{width:"49",height:"49",viewBox:"0 0 49 49",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o("path",{d:"M24.5 0C38.0096 9.05167e-07 49 10.9899 49 24.5C49 38.0101 38.0096 49 24.5 49C10.9904 49 0 38.0101 0 24.5C0 10.9899 10.99 0 24.5 0ZM24.5 3.78516C13.0775 3.78516 3.78418 13.0774 3.78418 24.5C3.78418 35.9215 13.0774 45.2148 24.5 45.2148C35.9225 45.2148 45.2158 35.922 45.2158 24.5C45.2158 13.078 35.9225 3.78516 24.5 3.78516ZM24.5 31.8809C25.5449 31.8809 26.3915 32.7276 26.3916 33.7725V35.3486C26.3916 36.3936 25.5449 37.2412 24.5 37.2412C23.4551 37.2412 22.6084 36.3936 22.6084 35.3486V33.7725C22.6085 32.7276 23.4551 31.8809 24.5 31.8809ZM24.5 11.7588C25.5449 11.7588 26.3915 12.6055 26.3916 13.6504V27.7725C26.3916 28.8174 25.5449 29.6641 24.5 29.6641C23.4551 29.6641 22.6084 28.8174 22.6084 27.7725V13.6504C22.6085 12.6055 23.4551 11.7588 24.5 11.7588Z",fill:"#B41E13"}))),o("h2",{class:"step-confirmation__title step-confirmation__title--error"},"¡Lo sentimos, ha ocurrido un error en el proceso de solicitud!"),o("p",{class:"step-confirmation__message"},"En este momento estamos presentando inconvenientes en nuestro sistema.",o("br",null),"Por favor, inténtalo nuevamente."))}render(){return o(i,{key:"449778ed0f375ee034a3df3b8b6e8f533f8cb0db"},o("div",{key:"a1bdb548476effe70f6f35b72fe1b6e5b8d1baf3",class:"step-confirmation"},o("header",{key:"45ea030ea6ed2731d6c4b9e6f5da0f6396a77740",class:"step-confirmation__header"},o("h1",{key:"1c79e21c0f27fc6bdd26f107a6f8a40956804b68",class:"step-confirmation__header-title"},"Confirmación de Solicitud")),o("div",{key:"d772325d6bb91350a9004def2044985a9c222ca9",class:"step-confirmation__content"},this.status==="loading"&&this.renderLoading(),this.status==="success"&&this.renderSuccess(),this.status==="error"&&this.renderError()),this.status==="success"&&o("div",{key:"723bb7a27e30753b5b886630094e0bc9524d69fa",class:"step-confirmation__actions"},o("button",{key:"49ddcbb3a848dc86c575bc58f16570fede2dd478",class:"step-confirmation__btn",onClick:this.handleClose},"Cerrar")),this.status==="error"&&o("div",{key:"8660a2a85187276b0b530844bf96d03c3b6e6414",class:"step-confirmation__actions"},o("button",{key:"633987a833750a44047650b84c47168cfbad0a04",class:"step-confirmation__btn step-confirmation__btn--error",onClick:this.handleRetry},"Volver a intentar"))))}};U.style=T();const j=()=>`@keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes slideUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}@keyframes spin{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}:host{display:block}.step-contract{width:100%}.step-contract__header{display:flex;align-items:center;justify-content:space-between;padding-bottom:1rem;margin-bottom:1rem;position:relative}.step-contract__header::after{content:"";position:absolute;bottom:0;left:50%;transform:translateX(-50%);width:100vw;height:1px;background:#E5E5E5}.step-contract__title{font-size:1.75rem;font-weight:700;line-height:1.2;color:#333333}.step-contract__btn-back{display:inline-flex;align-items:center;justify-content:center;gap:0.5rem;padding:0 1.5rem;font-family:"AMX", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, sans-serif;font-size:1rem;font-weight:600;line-height:1;text-decoration:none;border:none;border-radius:9999px;cursor:pointer;transition:all 150ms ease}.step-contract__btn-back:disabled{opacity:0.5;cursor:not-allowed}.step-contract__btn-back{height:48px;background-color:transparent;color:#0097A9;border:2px solid #0097A9}.step-contract__btn-back:hover:not(:disabled){background-color:rgba(0, 151, 169, 0.1)}.step-contract__btn-back:active:not(:disabled){background-color:rgba(0, 151, 169, 0.2)}.step-contract__btn-back{height:40px}.step-contract__tabs{display:flex;margin-bottom:1.5rem;background:#FFFFFF;border-radius:0 0 0.75rem 0.75rem;box-shadow:0 2px 4px rgba(0, 0, 0, 0.08);overflow:hidden}.step-contract__tab{flex:1;padding:1.25rem 1rem;background:transparent;border:none;cursor:pointer;text-align:center;position:relative;transition:all 150ms ease}.step-contract__tab:first-child{border-right:1px solid #E5E5E5}.step-contract__tab::after{content:"";position:absolute;bottom:0;left:0;right:0;height:4px;background:transparent;transition:background-color 150ms ease}.step-contract__tab--active::after{background:#0097A9}.step-contract__tab:hover:not(.step-contract__tab--active){background:#FAFAFA}.step-contract__tab-title{display:block;font-size:1rem;font-weight:700;color:#333333;margin-bottom:0.25rem}.step-contract__tab-subtitle{display:block;font-size:0.875rem;color:#666666;line-height:1.5}.step-contract__options{display:flex;flex-direction:column;gap:1rem;align-items:center}@media (min-width: 768px){.step-contract__options{flex-direction:row;justify-content:center}}.step-contract__options--single{justify-content:center}.step-contract__option{flex:0 0 auto;width:280px;display:flex;align-items:center;padding:1rem 1.25rem;background:#FFFFFF;border:1px solid #CCCCCC;border-radius:0.75rem;cursor:pointer;transition:all 150ms ease;position:relative;overflow:hidden}@media (max-width: 767px){.step-contract__option{width:100%;max-width:320px}}.step-contract__option::before{content:"";position:absolute;left:0;top:0;bottom:0;width:4px;background:#CCCCCC;border-radius:0.75rem 0 0 0.75rem;transition:background-color 150ms ease}.step-contract__option input[type=radio]{width:20px;height:20px;margin-right:0.75rem;accent-color:#0097A9;flex-shrink:0}.step-contract__option:hover{border-color:#999999}.step-contract__option--selected::before{background:#0097A9}.step-contract__option-content{flex:1;display:flex;flex-direction:column;gap:0.25rem}.step-contract__option-title{display:block;font-size:1rem;font-weight:600;color:#333333;line-height:1.35}.step-contract__option-price{display:block;font-size:0.875rem;color:#666666}.step-contract__option-price strong,.step-contract__option-price b{font-weight:600}.step-contract__actions{margin-top:1.5rem;padding-top:1.5rem;border-top:1px solid #E5E5E5;text-align:center}.step-contract__btn-continue{display:inline-flex;align-items:center;justify-content:center;gap:0.5rem;padding:0 1.5rem;font-family:"AMX", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, sans-serif;font-size:1rem;font-weight:600;line-height:1;text-decoration:none;border:none;border-radius:9999px;cursor:pointer;transition:all 150ms ease}.step-contract__btn-continue:disabled{opacity:0.5;cursor:not-allowed}.step-contract__btn-continue{height:48px;background-color:#DA291C;color:#FFFFFF}.step-contract__btn-continue:hover:not(:disabled){background-color:rgb(181.843902439, 34.2, 23.356097561)}.step-contract__btn-continue:active:not(:disabled){background-color:rgb(163.7658536585, 30.8, 21.0341463415)}.step-contract__btn-continue{min-width:280px;height:44px;padding:0 2rem;border-radius:22px;font-size:1rem}.step-contract__btn-continue:disabled{background-color:#999999;border-color:#999999;cursor:not-allowed;opacity:1}.step-contract__btn-continue:disabled:hover{background-color:#999999;border-color:#999999}.step-contract__btn-back-mobile{display:none;width:100%;margin-top:1rem;padding:0.5rem;background:transparent;border:none;color:#0097A9;font-size:1rem;cursor:pointer;text-decoration:none;text-align:center}.step-contract__btn-back-mobile:hover{text-decoration:underline}@media (max-width: 767px){.step-contract{padding:0 1rem}.step-contract__header{flex-direction:column;align-items:flex-start;gap:0.5rem;padding-bottom:0.75rem;margin-bottom:1rem}.step-contract__header .step-contract__title{font-size:1.25rem;line-height:1.35}.step-contract__header .step-contract__btn-back{order:-1;height:auto;padding:0.5rem 0;border:none;background:transparent;color:#0097A9;font-size:0.875rem}.step-contract__header .step-contract__btn-back:hover{background:transparent;text-decoration:underline}.step-contract__tabs{margin-bottom:1rem}.step-contract__tab{padding:0.75rem 0.5rem}.step-contract__tab-title{font-size:0.875rem}.step-contract__tab-subtitle{font-size:0.75rem;line-height:1.35}.step-contract__options{padding:0}.step-contract__option{width:100%;max-width:none}.step-contract__actions{margin-top:1rem;padding-top:1rem}.step-contract__btn-continue{width:100%;min-width:auto}.step-contract__btn-back-mobile{display:block}.step-contract__btn-back{display:none}}`;const V=class{constructor(t){e(this,t)}onNext;onBack;activeTab=1;selectedOption=null;componentWillLoad(){this.restorePreviousSelection()}restorePreviousSelection(){if(c.selectedContract){this.selectedOption=c.selectedContract;this.activeTab=c.selectedContract.typeId;return}const e=sessionStorage.getItem("typeContractId");if(e!==null){const t=parseInt(e);const o=parseInt(sessionStorage.getItem("contractInstallment")||"0");const i=parseInt(sessionStorage.getItem("contractInstallation")||"0");const a=parseInt(sessionStorage.getItem("contractActivation")||"0");const n=parseInt(sessionStorage.getItem("contractModen")||"0");const r=h.find((e=>e.typeId===t));this.selectedOption={typeId:t,typeName:r?.type||"",deadlines:o,installation:i,activation:a,modem:n};this.activeTab=t;s.setContract(this.selectedOption)}}handleTabChange=e=>{this.activeTab=e;if(this.selectedOption?.typeId!==e){this.selectedOption=null}};handleSelectOption=(e,t)=>{const o=h.find((t=>t.typeId===e));this.selectedOption={typeId:e,typeName:o?.type||"",deadlines:t.deadlines,installation:t.installation,activation:t.activation,modem:t.modem};s.setContract(this.selectedOption)};handleContinue=()=>{if(this.selectedOption){this.onNext?.()}};getTotalInstallationCost(e){return e.installation+e.activation+e.modem}formatContractLabel(e){if(e===0)return"Sin contrato";return`${e} Meses de Contrato`}render(){const e=h.find((e=>e.typeId===1));const t=h.find((e=>e.typeId===0));return o(i,{key:"2f9c47b6c246b9276582b054d4acd5b5b93d120b"},o("div",{key:"5b1aeb54cb7a37e15c577c024eac0f55c15304ad",class:"step-contract"},o("header",{key:"8124ea48b7f4b7275506d5eb641fcdce708b6c53",class:"step-contract__header"},o("h1",{key:"3e6716b94aa4d6982f5f006ec4cbacaefe44e4d7",class:"step-contract__title"},"Selecciona un tipo de contrato"),o("button",{key:"8a857e12ddf111e8ec13dcc82eebdc00dbe82749",class:"step-contract__btn-back",onClick:this.onBack},"Regresar")),o("div",{key:"5ca2f0d833ba164ae68ffec105a1ca71932ec3a3",class:"step-contract__tabs"},o("button",{key:"c1825dbde1dc8ce831d17a0cd39e28c28df28560",class:{"step-contract__tab":true,"step-contract__tab--active":this.activeTab===1},onClick:()=>this.handleTabChange(1)},o("span",{key:"50ccd7deb4f256b89da061effffe695e0ec581de",class:"step-contract__tab-title"},"Con contrato"),o("span",{key:"7e843b6d67ac076caf7440699bdc832f9bf490fa",class:"step-contract__tab-subtitle"},"12 y 24 meses de contrato")),o("button",{key:"62315f4009bd88143214c66b2daaa001d81ed921",class:{"step-contract__tab":true,"step-contract__tab--active":this.activeTab===0},onClick:()=>this.handleTabChange(0)},o("span",{key:"ea46ea0c39ac56434943c9b50e6f1d543066a31e",class:"step-contract__tab-title"},"Sin contrato"),o("span",{key:"ad729aa2d84dbfb7b6119a1bc22ff7e67e71e959",class:"step-contract__tab-subtitle"},"Plan mensual con pago por adelantado"))),o("div",{key:"ee383044912670ca01820363ff22ba9f80fff0d3",class:"step-contract__content"},this.activeTab===1&&e&&o("div",{key:"b8cdb6a4896b2f0967c477ce1f14a255b5960255",class:"step-contract__options"},e.contract.map((e=>{const t=this.getTotalInstallationCost(e);return o("label",{class:{"step-contract__option":true,"step-contract__option--selected":this.selectedOption?.deadlines===e.deadlines&&this.selectedOption?.typeId===1}},o("input",{type:"radio",name:"contract",checked:this.selectedOption?.deadlines===e.deadlines&&this.selectedOption?.typeId===1,onChange:()=>this.handleSelectOption(1,e)}),o("div",{class:"step-contract__option-content"},o("span",{class:"step-contract__option-title"},this.formatContractLabel(e.deadlines)),o("span",{class:"step-contract__option-price"},"Instalación: ",t>0?N(t):"$0.00")))}))),this.activeTab===0&&t&&o("div",{key:"35fa055c3a36d4b3146f773f1dd8339d7b5131cf",class:"step-contract__options step-contract__options--single"},t.contract.map((e=>{const t=this.getTotalInstallationCost(e);return o("label",{class:{"step-contract__option":true,"step-contract__option--selected":this.selectedOption?.typeId===0}},o("input",{type:"radio",name:"contract",checked:this.selectedOption?.typeId===0,onChange:()=>this.handleSelectOption(0,e)}),o("div",{class:"step-contract__option-content"},o("span",{class:"step-contract__option-title"},"Sin contrato"),o("span",{class:"step-contract__option-price"},"Instalación: ",N(t))))})))),o("div",{key:"aaebc10f26e262a70f5b59683dffac9a213742ef",class:"step-contract__actions"},o("button",{key:"fa4628928d489765766d08dbe90f6f1bc8a3c87e",class:"step-contract__btn-continue",onClick:this.handleContinue,disabled:!this.selectedOption},"Continuar"),o("button",{key:"8f4ecec2da5c42e53fe78b21326c5417cb3f2d62",type:"button",class:"step-contract__btn-back-mobile",onClick:this.onBack},"Regresar"))))}};V.style=j();const B={required:"Este campo es requerido",minLength:e=>`Debe tener al menos ${e} caracteres`,maxLength:e=>`No puede exceder ${e} caracteres`,email:"Ingrese un correo electrónico válido",phone:"Ingrese un número de teléfono válido (10 dígitos)",zipCode:"Ingrese un código postal válido (5 dígitos)",date:"Ingrese una fecha válida",futureDate:"La fecha debe ser futura",identification:"La identificación debe tener al menos 10 caracteres",numeric:"Solo se permiten números",alphanumeric:"Solo se permiten letras y números"};const $=()=>({isValid:true,message:""});const q=e=>({isValid:false,message:e});const G=e=>{if(!e||e.trim()===""){return q(B.required)}return $()};const W=e=>t=>{if(t&&t.length<e){return q(B.minLength(e))}return $()};const X=e=>{if(!e)return $();const t=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;if(!t.test(e)){return q(B.email)}return $()};const Y=e=>{if(!e)return $();const t=e.replace(/\D/g,"");if(t.length!==10){return q(B.phone)}return $()};const H=e=>{if(!e)return $();const t=/^\d{5}$/;if(!t.test(e)){return q(B.zipCode)}return $()};const K=e=>{if(!e)return $();const t=/^\d{4}-\d{2}-\d{2}$/;if(!t.test(e)){return q(B.date)}const o=new Date(e);if(isNaN(o.getTime())){return q(B.date)}return $()};const Z=e=>{if(!e)return $();const t=K(e);if(!t.isValid)return t;const o=new Date(e);const i=new Date;i.setHours(0,0,0,0);if(o<=i){return q(B.futureDate)}return $()};const Q=e=>{if(!e)return $();if(e.length<10){return q(B.identification)}return $()};const J=(...e)=>t=>{for(const o of e){const e=o(t);if(!e.isValid){return e}}return $()};const ee={firstName:J(G,W(3)),lastName:J(G,W(3)),secondLastName:J(G,W(3)),identificationNumber:J(G,Q),identificationExpiration:J(G,Z),phone1:J(G,Y),phone2:Y,email:J(G,X),businessName:G,position:G,address:G,city:G,zipCode:J(G,H)};const te=()=>`@keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes slideUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}@keyframes spin{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}:host{display:block}.step-form{width:100%;max-width:1100px;margin:0 auto;padding:0 1.5rem}@media (min-width: 768px){.step-form{padding:0 2rem}}.step-form__header{display:flex;align-items:center;justify-content:space-between;margin-bottom:1rem;padding-bottom:1rem;position:relative}.step-form__header::after{content:"";position:absolute;bottom:0;left:50%;transform:translateX(-50%);width:100vw;height:1px;background:#E5E5E5}.step-form__title{font-size:1.75rem;font-weight:700;line-height:1.2;color:#333333}.step-form__btn-back{display:inline-flex;align-items:center;justify-content:center;gap:0.5rem;padding:0 1.5rem;font-family:"AMX", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, sans-serif;font-size:1rem;font-weight:600;line-height:1;text-decoration:none;border:none;border-radius:9999px;cursor:pointer;transition:all 150ms ease}.step-form__btn-back:disabled{opacity:0.5;cursor:not-allowed}.step-form__btn-back{height:48px;background-color:transparent;color:#0097A9;border:2px solid #0097A9}.step-form__btn-back:hover:not(:disabled){background-color:rgba(0, 151, 169, 0.1)}.step-form__btn-back:active:not(:disabled){background-color:rgba(0, 151, 169, 0.2)}.step-form__btn-back{height:40px}.step-form__stepper{display:none;margin-bottom:1.5rem;padding:1rem 0}@media (max-width: 767px){.step-form__stepper{display:block}}.step-form form{border:1px solid #E5E5E5;border-radius:0.75rem;padding:1.5rem;background:white}@media (min-width: 768px){.step-form form{padding:2rem 2.5rem}}.step-form__instructions{font-size:0.875rem;font-weight:400;line-height:1.5;color:#666666;margin-bottom:1.5rem;padding:0;background:transparent}.step-form__section{margin-bottom:1.5rem;padding-bottom:0.5rem}.step-form__row{display:grid;grid-template-columns:1fr;gap:1rem;margin-bottom:1rem}@media (min-width: 768px){.step-form__row{grid-template-columns:1fr 1fr;gap:1.5rem;margin-bottom:1.25rem}}.step-form__row:last-child{margin-bottom:0}.step-form__field{display:flex;flex-direction:column}@media (min-width: 768px){.step-form__field--id{grid-column:span 1}}.step-form__label{display:block;margin-bottom:0.5rem;font-size:0.875rem;font-weight:500;color:#333333}.step-form__label .required{color:#DA291C}.step-form__required{color:#333333;margin-right:0.25rem}.step-form__input{width:100%;height:44px;padding:0 1rem;font-family:"AMX", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, sans-serif;font-size:1rem;color:#333333;background-color:#FFFFFF;border:1px solid #CCCCCC;border-radius:0.5rem;transition:border-color 150ms ease, box-shadow 150ms ease}.step-form__input::placeholder{color:#999999}.step-form__input:focus{outline:none;border-color:#0097A9;box-shadow:0 0 0 3px rgba(0, 151, 169, 0.15)}.step-form__input:disabled{background-color:#F5F5F5;cursor:not-allowed}.step-form__input.error{border-color:#DA291C}.step-form__input.error:focus{box-shadow:0 0 0 3px rgba(218, 41, 28, 0.15)}.step-form__input--error{border-color:#DA291C}.step-form__input--error:focus{box-shadow:0 0 0 3px rgba(218, 41, 28, 0.15)}.step-form__error{margin-top:0.25rem;font-size:0.75rem;color:#DA291C}.step-form__id-row{display:flex;flex-direction:column;gap:0.5rem}@media (min-width: 768px){.step-form__id-row{flex-direction:row;align-items:flex-start}.step-form__id-row input[type=text].step-form__input{flex:1}}.step-form__id-row input[type=text].step-form__input{margin-top:4px;width:100%;height:44px;min-height:44px;padding:0 1rem;font-family:"AMX", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, sans-serif;font-size:1rem;color:#333333;background-color:#FFFFFF;border:1px solid #CCCCCC;border-radius:0.5rem;box-sizing:border-box;appearance:none;-webkit-appearance:none}.step-form__id-row input[type=text].step-form__input::placeholder{color:#999999}.step-form__id-row input[type=text].step-form__input:focus{outline:none;border-color:#0097A9;box-shadow:0 0 0 3px rgba(0, 151, 169, 0.15)}.step-form__radio-group{display:flex;flex-direction:row;align-items:flex-start;gap:1rem}.step-form__radio-group--horizontal{flex-direction:row;gap:1rem}.step-form__radio{display:flex;align-items:flex-start;gap:0.25rem;font-size:0.875rem;font-weight:400;line-height:1.5;color:#333333;cursor:pointer;max-width:90px;line-height:1.2;margin-top:14px}.step-form__radio input[type=radio]{accent-color:#0097A9;margin-top:2px;flex-shrink:0}.step-form__actions{margin-top:1.5rem;padding-top:1.5rem;border-top:1px solid #E5E5E5;text-align:center}.step-form__btn-submit{display:inline-flex;align-items:center;justify-content:center;gap:0.5rem;padding:0 1.5rem;font-family:"AMX", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, sans-serif;font-size:1rem;font-weight:600;line-height:1;text-decoration:none;border:none;border-radius:9999px;cursor:pointer;transition:all 150ms ease}.step-form__btn-submit:disabled{opacity:0.5;cursor:not-allowed}.step-form__btn-submit{height:48px;background-color:#DA291C;color:#FFFFFF}.step-form__btn-submit:hover:not(:disabled){background-color:rgb(181.843902439, 34.2, 23.356097561)}.step-form__btn-submit:active:not(:disabled){background-color:rgb(163.7658536585, 30.8, 21.0341463415)}.step-form__btn-submit{min-width:280px;height:44px;padding:0 2rem;border-radius:22px;font-size:1rem}.step-form__btn-submit:disabled{background-color:#999999;border-color:#999999;cursor:not-allowed;opacity:1}.step-form__btn-submit:disabled:hover{background-color:#999999;border-color:#999999}@media (max-width: 767px){.step-form__btn-submit{width:100%;min-width:auto}}.step-form__btn-back-mobile{display:none;width:100%;margin-top:1rem;padding:0.5rem;background:transparent;border:none;color:#0097A9;font-size:1rem;cursor:pointer;text-decoration:none;text-align:center}.step-form__btn-back-mobile:hover{text-decoration:underline}@media (max-width: 767px){.step-form__header{flex-direction:column;align-items:flex-start;gap:0.75rem}.step-form__header .step-form__title{font-size:1.25rem;order:1}.step-form__header .step-form__btn-back{order:2;align-self:flex-start;height:auto;padding:0.5rem 0;border:none;background:transparent;color:#0097A9;font-size:0.875rem}.step-form__header .step-form__btn-back:hover{background:transparent;text-decoration:underline}.step-form form{padding:1rem}.step-form__instructions{font-size:0.875rem}.step-form__row{grid-template-columns:1fr}.step-form__id-row{flex-direction:column;gap:0.75rem}.step-form__id-row .step-form__input{width:100%;margin-top:0}.step-form__actions{padding-top:1rem;margin-top:1rem}.step-form__btn-back-mobile{display:block}.step-form__btn-back{display:none}}`;const oe=768;const ie=[{label:"Identificación"},{label:"Contacto"}];const ae=class{constructor(t){e(this,t)}onNext;onBack;formData={personal:{firstName:"",secondName:"",lastName:"",secondLastName:"",identificationType:"license",identificationNumber:"",identificationExpiration:"",phone1:"",phone2:"",email:""},business:{businessName:"",position:""},address:{address:c.location?.address||"",city:c.location?.city||"",zipCode:c.location?.zipCode||""},isExistingCustomer:false};errors={};touched={};currentSection="identification";isMobile=false;componentWillLoad(){this.checkMobile();window.addEventListener("resize",this.handleResize)}disconnectedCallback(){window.removeEventListener("resize",this.handleResize)}handleResize=()=>{this.checkMobile()};checkMobile(){this.isMobile=window.innerWidth<oe}getCurrentStepNumber(){return this.currentSection==="identification"?1:2}getIdentificationFields(){return[{field:"firstName",value:this.formData.personal.firstName},{field:"lastName",value:this.formData.personal.lastName},{field:"secondLastName",value:this.formData.personal.secondLastName},{field:"identificationNumber",value:this.formData.personal.identificationNumber},{field:"identificationExpiration",value:this.formData.personal.identificationExpiration}]}getContactFields(){return[{field:"phone1",value:this.formData.personal.phone1},{field:"email",value:this.formData.personal.email},{field:"businessName",value:this.formData.business.businessName},{field:"position",value:this.formData.business.position},{field:"address",value:this.formData.address.address},{field:"city",value:this.formData.address.city},{field:"zipCode",value:this.formData.address.zipCode}]}isIdentificationValid(){for(const{field:e,value:t}of this.getIdentificationFields()){const o=ee[e];if(o){const e=o(t);if(!e.isValid){return false}}}return true}isContactValid(){for(const{field:e,value:t}of this.getContactFields()){const o=ee[e];if(o){const e=o(t);if(!e.isValid){return false}}}return true}validateIdentificationSection(){const e=this.getIdentificationFields();let t=true;const o={...this.touched};const i={...this.errors};for(const{field:a,value:n}of e){o[a]=true;const e=ee[a];if(e){const o=e(n);if(!o.isValid){t=false;i[a]=o.message}else{delete i[a]}}}this.touched=o;this.errors=i;return t}handleInput=(e,t)=>o=>{const i=o.target;let a=i.value;if(t==="phone1"||t==="phone2"){a=L(a)}this.formData={...this.formData,[e]:{...this.formData[e],[t]:a}};this.touched={...this.touched,[t]:true};this.validateField(t,a)};handleRadioChange=(e,t)=>{if(e==="identificationType"){this.formData={...this.formData,personal:{...this.formData.personal,identificationType:t}}}else if(e==="isExistingCustomer"){this.formData={...this.formData,isExistingCustomer:t}}};validateField(e,t){const o=ee[e];if(!o)return{isValid:true,message:""};const i=o(t);if(!i.isValid){this.errors={...this.errors,[e]:i.message}}else{const{[e]:t,...o}=this.errors;this.errors=o}return i}getFieldsToValidate(){return[{field:"firstName",value:this.formData.personal.firstName},{field:"lastName",value:this.formData.personal.lastName},{field:"secondLastName",value:this.formData.personal.secondLastName},{field:"identificationNumber",value:this.formData.personal.identificationNumber},{field:"identificationExpiration",value:this.formData.personal.identificationExpiration},{field:"phone1",value:this.formData.personal.phone1},{field:"email",value:this.formData.personal.email},{field:"businessName",value:this.formData.business.businessName},{field:"position",value:this.formData.business.position},{field:"address",value:this.formData.address.address},{field:"city",value:this.formData.address.city},{field:"zipCode",value:this.formData.address.zipCode}]}isFormValid(){for(const{field:e,value:t}of this.getFieldsToValidate()){const o=ee[e];if(o){const e=o(t);if(!e.isValid){return false}}}return true}isCurrentSectionValid(){if(!this.isMobile){return this.isFormValid()}if(this.currentSection==="identification"){return this.isIdentificationValid()}else{return this.isContactValid()}}validateForm(){const e=this.getFieldsToValidate();let t=true;const o={};for(const{field:i,value:a}of e){const e=this.validateField(i,a);if(!e.isValid){t=false;o[i]=e.message}}this.errors=o;return t}handleSubmit=e=>{e.preventDefault();if(this.isMobile){if(this.currentSection==="identification"){if(this.validateIdentificationSection()){this.currentSection="contact"}return}}this.touched={firstName:true,lastName:true,secondLastName:true,identificationNumber:true,identificationExpiration:true,phone1:true,email:true,businessName:true,position:true,address:true,city:true,zipCode:true};if(this.validateForm()){s.setFormData(this.formData);this.onNext?.()}};handleBack=()=>{if(this.isMobile&&this.currentSection==="contact"){this.currentSection="identification";return}this.onBack?.()};renderInput(e,t,i,a,n={}){const{type:r="text",placeholder:s="",required:c=false,disabled:l=false}=n;const d=this.touched[t]&&this.errors[t];const p=t==="phone1"||t==="phone2"?D(a):a;return o("div",{class:"step-form__field"},o("label",{class:"step-form__label"},c&&o("span",{class:"step-form__required"},"*"),e,":"),o("input",{type:r,class:{"step-form__input":true,"step-form__input--error":!!d},value:p,placeholder:s,disabled:l,onInput:this.handleInput(i,t)}),d&&o("span",{class:"step-form__error"},this.errors[t]))}renderIdentificationSection(){return o("div",{class:"step-form__section"},o("div",{class:"step-form__row"},this.renderInput("Nombre","firstName","personal",this.formData.personal.firstName,{placeholder:"Ingrese nombre",required:true}),this.renderInput("Segundo nombre","secondName","personal",this.formData.personal.secondName||"",{placeholder:"Ingrese segundo nombre (Opcional)"})),o("div",{class:"step-form__row"},this.renderInput("Apellido","lastName","personal",this.formData.personal.lastName,{placeholder:"Ingrese apellido",required:true}),this.renderInput("Segundo apellido","secondLastName","personal",this.formData.personal.secondLastName,{placeholder:"Ingrese segundo apellido",required:true})),o("div",{class:"step-form__row"},o("div",{class:"step-form__field step-form__field--id"},o("label",{class:"step-form__label"},o("span",{class:"step-form__required"},"*"),"Identificación:"),o("div",{class:"step-form__id-row"},o("div",{class:"step-form__radio-group"},o("label",{class:"step-form__radio"},o("input",{type:"radio",name:"idType",checked:this.formData.personal.identificationType==="license",onChange:()=>this.handleRadioChange("identificationType","license")}),"Licencia de conducir"),o("label",{class:"step-form__radio"},o("input",{type:"radio",name:"idType",checked:this.formData.personal.identificationType==="passport",onChange:()=>this.handleRadioChange("identificationType","passport")}),"Pasaporte")),o("input",{type:"text",class:{"step-form__input":true,"step-form__input--error":!!(this.touched["identificationNumber"]&&this.errors["identificationNumber"])},value:this.formData.personal.identificationNumber,placeholder:"Ingrese nro de identificación",onInput:this.handleInput("personal","identificationNumber")})),this.touched["identificationNumber"]&&this.errors["identificationNumber"]&&o("span",{class:"step-form__error"},this.errors["identificationNumber"])),this.renderInput("Fecha de vencimiento","identificationExpiration","personal",this.formData.personal.identificationExpiration,{type:"date",required:true})))}renderContactSection(){return[o("div",{class:"step-form__section"},o("div",{class:"step-form__row"},this.renderInput("Teléfono de contacto 1","phone1","personal",this.formData.personal.phone1,{type:"tel",placeholder:"Ingrese nro de teléfono",required:true}),this.renderInput("Teléfono de contacto 2","phone2","personal",this.formData.personal.phone2||"",{type:"tel",placeholder:"Ingrese nro de teléfono"}))),o("div",{class:"step-form__section"},o("div",{class:"step-form__row"},this.renderInput("Nombre legal de Empresa (según IRS)","businessName","business",this.formData.business.businessName,{placeholder:"Ingresar nombre legal de empresa",required:true}),this.renderInput("Posición en la Empresa","position","business",this.formData.business.position,{placeholder:"Ingrese posición actual",required:true}))),o("div",{class:"step-form__section"},o("div",{class:"step-form__row"},this.renderInput("Dirección","address","address",this.formData.address.address,{placeholder:"Ingrese dirección",required:true}),this.renderInput("Ciudad","city","address",this.formData.address.city,{placeholder:"Ingrese ciudad",required:true})),o("div",{class:"step-form__row"},this.renderInput("Código postal","zipCode","address",this.formData.address.zipCode,{placeholder:"Ingrese código postal",required:true}),this.renderInput("Correo electrónico","email","personal",this.formData.personal.email,{type:"email",placeholder:"Ingrese correo electrónico",required:true}))),o("div",{class:"step-form__section"},o("div",{class:"step-form__field"},o("label",{class:"step-form__label"},o("span",{class:"step-form__required"},"*"),"Cliente existente de Claro PR:"),o("div",{class:"step-form__radio-group step-form__radio-group--horizontal"},o("label",{class:"step-form__radio"},o("input",{type:"radio",name:"existingCustomer",checked:this.formData.isExistingCustomer===true,onChange:()=>this.handleRadioChange("isExistingCustomer",true)}),"Sí"),o("label",{class:"step-form__radio"},o("input",{type:"radio",name:"existingCustomer",checked:this.formData.isExistingCustomer===false,onChange:()=>this.handleRadioChange("isExistingCustomer",false)}),"No"))))]}render(){const e=this.getCurrentStepNumber();return o(i,{key:"2fa4a0352177c811fb5afc47e4ad07f24166f4ab"},o("div",{key:"88d7652756cb1e5d5009b06e81535cd98ff432d8",class:"step-form"},o("header",{key:"2b0a19cb32480eee44a3e0b33cf054464920a159",class:"step-form__header"},o("h1",{key:"afed1e19359a5b05f4b868d4d424df7e2825f7ad",class:"step-form__title"},"Formulario de solicitud de servicio fijo"),o("button",{key:"df02c419da69c9817f5af3e42c520be6b9878012",type:"button",class:"step-form__btn-back",onClick:this.handleBack},"Regresar")),this.isMobile&&o("div",{key:"b9424e82af8c80fbeab8689d8d36595114710daa",class:"step-form__stepper"},o("ui-stepper",{key:"1806f334bdb2c3eecab309f2b6b862531c28e58e",steps:ie,currentStep:e})),o("form",{key:"a071baff2c9ea83e0c500aeb5a3193e5a95c3eb7",onSubmit:this.handleSubmit},o("p",{key:"a5b037e74a6523f1008e7f8b447a586b94e9af28",class:"step-form__instructions"},"Por favor, ingresa la información personal solicitada. Su nombre y apellido deben ser iguales a su identificación de gobierno."),!this.isMobile&&[this.renderIdentificationSection(),...this.renderContactSection()],this.isMobile&&this.currentSection==="identification"&&this.renderIdentificationSection(),this.isMobile&&this.currentSection==="contact"&&this.renderContactSection(),o("div",{key:"cef96813a085fceb80023f35f14093b13197940f",class:"step-form__actions"},o("button",{key:"cb4e112737a3651603851fa7470a0d8f6396f628",type:"submit",class:"step-form__btn-submit",disabled:!this.isCurrentSectionValid()},"Continuar"),o("button",{key:"1e43e11844b4e4e8abc90d3ffdeac3de191d8401",type:"button",class:"step-form__btn-back-mobile",onClick:this.handleBack},"Regresar")))))}};ae.style=te();const ne=()=>`@keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes slideUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}@keyframes spin{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}:host{display:block}.step-location{width:100%;position:relative}.step-location__validating-overlay{position:absolute;top:0;left:0;right:0;bottom:0;background:rgba(255, 255, 255, 0.9);display:flex;align-items:center;justify-content:center;z-index:1000;animation:fadeIn 0.2s ease-out}.step-location__validating-content{display:flex;flex-direction:column;align-items:center;gap:1rem;padding:1.5rem;background:#FFFFFF;border-radius:16px;box-shadow:0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)}.step-location__validating-spinner{width:48px;height:48px;border:4px solid #E5E5E5;border-top-color:#DA291C;border-radius:50%;animation:spin 1s linear infinite}.step-location__validating-text{margin:0;font-size:18px;font-weight:600;color:#333333}.step-location__header{text-align:center;margin-bottom:1rem}.step-location__title{font-size:1.5rem;font-weight:600;line-height:1.35;color:#333333;font-weight:400}.step-location__title--highlight{color:#DA291C;font-weight:700}.step-location__map-container{position:relative;border-radius:0.75rem;overflow:hidden;box-shadow:0 2px 8px rgba(0, 0, 0, 0.08)}.step-location__controls{position:absolute;top:3.5rem;left:0.75rem;right:0.75rem;z-index:1;display:flex;flex-direction:column;gap:0}@media (min-width: 576px){.step-location__controls{left:120px;right:50px}}@media (min-width: 768px){.step-location__controls{top:3.5rem;left:130px;right:60px}}.step-location__input-group{display:flex;align-items:center;background:#FFFFFF;border-radius:10px 10px 0 0;overflow:hidden;border:1px solid #E5E5E5;border-bottom:none}.step-location__location-container{background:#FFFFFF;border-radius:0 0 10px 10px;box-shadow:0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);padding:0.2rem 0.75rem;border:1px solid #E5E5E5;border-top:1px solid #E5E5E5}.step-location__input-icon{display:flex;align-items:center;justify-content:center;padding-left:0.75rem;color:#999999}.step-location__input-icon svg{width:20px;height:20px}.step-location__input{flex:1;padding:0.75rem 0.75rem;border:none;font-size:0.875rem;outline:none;background:transparent;min-width:0}.step-location__input::placeholder{color:#999999}.step-location__btn-validate{padding:0.75rem 1.25rem;background:#DA291C;color:#FFFFFF;border:none;font-size:0.875rem;font-weight:600;cursor:pointer;transition:background-color 150ms ease;white-space:nowrap;min-width:100px}.step-location__btn-validate:hover:not(:disabled){background:rgb(181.843902439, 34.2, 23.356097561)}.step-location__btn-validate:disabled{opacity:0.6;cursor:not-allowed}.step-location__btn-validate--loading{pointer-events:none}.step-location__btn-validate-content{display:inline-flex;align-items:center;gap:0.5rem}.step-location__btn-spinner{display:inline-block;width:14px;height:14px;border:2px solid rgba(255, 255, 255, 0.3);border-top-color:#FFFFFF;border-radius:50%;animation:btn-spin 0.8s linear infinite}@keyframes btn-spin{to{transform:rotate(360deg)}}.step-location__btn-location{display:inline-flex;align-items:center;gap:0.25rem;padding:0.25rem 0;background:transparent;color:#0097A9;border:none;border-radius:0;font-size:0.75rem;font-weight:500;cursor:pointer;box-shadow:none;transition:opacity 150ms ease;white-space:nowrap;align-self:flex-start}.step-location__btn-location:hover:not(:disabled){opacity:0.8}.step-location__btn-location:disabled{opacity:0.5;cursor:not-allowed}.step-location__btn-location-icon{width:14px;height:14px}.step-location__map{position:relative;width:100%;height:400px;background:#E5E5E5}@media (min-width: 768px){.step-location__map{height:500px}}.step-location__map-canvas{width:100%;height:100%}.step-location__map-loading{display:flex;flex-direction:column;align-items:center;justify-content:center;position:absolute;top:0;left:0;right:0;bottom:0;background:#F5F5F5;color:#666666;z-index:5}.step-location__map-loading p{font-size:1rem;font-weight:400;line-height:1.5;margin-top:1rem}.step-location__map-error{display:flex;flex-direction:column;align-items:center;justify-content:center;position:absolute;top:0;left:0;right:0;bottom:0;background:#F5F5F5;color:#666666;z-index:5;padding:1rem;text-align:center}.step-location__map-error p{font-size:1rem;font-weight:400;line-height:1.5;color:#DA291C}.step-location__map-error small{margin-top:0.5rem;font-size:0.75rem}.step-location__spinner{width:40px;height:40px;border:3px solid #CCCCCC;border-top-color:#0097A9;border-radius:50%;animation:spin 1s linear infinite}.step-location__map-placeholder{display:flex;flex-direction:column;align-items:center;justify-content:center;width:100%;height:100%;color:#666666}.step-location__map-placeholder p{font-size:1rem;font-weight:400;line-height:1.5}.step-location__map-placeholder small{margin-top:0.5rem;font-size:0.75rem}.step-location__modal-backdrop{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0, 0, 0, 0.5);z-index:400;display:flex;align-items:center;justify-content:center}.step-location__modal{position:relative;width:90%;max-width:400px;background:#FFFFFF;border-radius:0.75rem;padding:2rem 1.5rem;text-align:center;box-shadow:0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)}.step-location__modal--error .step-location__modal-error-bar{display:block}.step-location__modal-close{position:absolute;top:0.75rem;right:0.75rem;width:32px;height:32px;background:transparent;border:none;font-size:1.5rem;color:#666666;cursor:pointer;line-height:1}.step-location__modal-close:hover{color:#333333}.step-location__modal-error-bar{display:none;background:#DA291C;color:#FFFFFF;padding:0.5rem 1rem;margin:-2rem -1.5rem 1rem;font-weight:600}.step-location__modal-success-icon{width:60px;height:60px;margin:0 auto 1rem;color:#44AF69}.step-location__modal-success-icon svg{width:100%;height:100%}.step-location__modal-message{font-size:1rem;font-weight:400;line-height:1.5;color:#333333;margin-bottom:1.5rem}.step-location__modal-btn{display:inline-flex;align-items:center;justify-content:center;gap:0.5rem;padding:0 1.5rem;font-family:"AMX", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, sans-serif;font-size:1rem;font-weight:600;line-height:1;text-decoration:none;border:none;border-radius:9999px;cursor:pointer;transition:all 150ms ease}.step-location__modal-btn:disabled{opacity:0.5;cursor:not-allowed}.step-location__modal-btn{height:48px;background-color:#0097A9;color:#FFFFFF}.step-location__modal-btn:hover:not(:disabled){background-color:rgb(0, 114.5455621302, 128.2)}.step-location__modal-btn:active:not(:disabled){background-color:rgb(0, 96.3183431953, 107.8)}.step-location__modal-btn{min-width:150px}`;const re=class{constructor(t){e(this,t)}get el(){return a(this)}googleMapsKey;onNext;onBack;address="";isValidating=false;isLoadingMap=true;isGettingLocation=false;locationData=null;mapError=null;currentCoordinates=null;geocodeResult=null;showErrorModal=false;errorMessage="";mapContainer;addressInput;async componentDidLoad(){await this.initializeMap()}disconnectedCallback(){S.destroy()}async initializeMap(){if(!this.googleMapsKey){this.mapError="Google Maps API key no configurada";this.isLoadingMap=false;return}try{S.setApiKey(this.googleMapsKey);await S.initMap(this.mapContainer);if(this.addressInput){await S.initAutocomplete(this.addressInput,(e=>{this.handlePlaceSelected(e)}))}S.addMapClickListener((async e=>{await this.handleMapClick(e)}));this.isLoadingMap=false}catch(e){console.error("Error initializing map:",e);this.mapError="Error al cargar Google Maps";this.isLoadingMap=false}}handleAddressChange=e=>{this.address=e.target.value};handleKeyPress=e=>{if(e.key==="Enter"||e.code==="Enter"||e.code==="NumpadEnter"){e.preventDefault();this.handleValidate()}};handleMapClick=async e=>{S.clear();const t=await S.reverseGeocode(e);if(t){this.geocodeResult=t;this.address=t.formattedAddress||t.address;this.currentCoordinates=t.coordinates;S.setMarker(t.coordinates)}else{this.currentCoordinates=e;S.setMarker(e)}await this.handleValidate()};handlePlaceSelected=e=>{this.geocodeResult=e;this.address=e.formattedAddress||e.address;this.currentCoordinates=e.coordinates;S.setMarker(e.coordinates);S.centerMap(e.coordinates)};handleValidate=async()=>{if(!this.currentCoordinates&&!this.address.trim()){return}this.isValidating=true;try{let e=this.currentCoordinates;let t=this.geocodeResult?.city||"";let o=this.geocodeResult?.zipCode||"";if(!e&&this.address.trim()){const i=await S.geocodeAddress(this.address);if(i){e=i.coordinates;t=i.city;o=i.zipCode;this.currentCoordinates=e;this.geocodeResult=i;S.setMarker(e);S.centerMap(e)}else{this.errorMessage="No se pudo encontrar la dirección. Por favor, intenta con otra dirección.";this.showErrorModal=true;this.isValidating=false;return}}if(!e){this.errorMessage="Por favor, ingresa una dirección válida.";this.showErrorModal=true;this.isValidating=false;return}const i=await g.checkCoverage(e.lat,e.lng,this.address||this.geocodeResult?.address||"",t,o);this.locationData=i;if(i.isValid){this.showCoverageInfoWindow(i.serviceMessage,true)}else{this.showCoverageInfoWindow(v.NO_COVERAGE,false)}}catch(e){console.error("Coverage validation error:",e);this.errorMessage=v.COVERAGE_ERROR;this.showErrorModal=true}finally{this.isValidating=false}};showCoverageInfoWindow(e,t){const o=!t;const i=t?e:"Escoge entre nuestra selección de modems.";const a=t?"¡Lo quiero!":"Ver opciones";const n=`<svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg">\n      <path d="M4.58325 19.5815L10.9873 4.5376" stroke="black" stroke-width="0.956522" stroke-linecap="round"/>\n      <path d="M17.875 19.582L11.4707 4.53809" stroke="black" stroke-width="0.956522" stroke-linecap="round"/>\n      <path d="M7.06067 14.8589L16.9086 18.3631" stroke="black" stroke-width="0.956522" stroke-linecap="round"/>\n      <path d="M15.3981 14.8547L5.55017 18.3589" stroke="black" stroke-width="0.956522" stroke-linecap="round"/>\n      <path d="M8.31006 11.8936L15.1257 14.3188" stroke="black" stroke-width="0.956522" stroke-linecap="round"/>\n      <path d="M9.56519 8.60864L13.8695 11.4782" stroke="black" stroke-width="0.956522" stroke-linecap="round"/>\n      <path d="M14.0804 11.8904L7.26477 14.3156" stroke="black" stroke-width="0.956522" stroke-linecap="round"/>\n      <path d="M12.913 8.60864L8.60864 11.4782" stroke="black" stroke-width="0.956522" stroke-linecap="round"/>\n      <path d="M11.2291 4.67082C11.8228 4.67082 12.3041 4.18951 12.3041 3.59579C12.3041 3.00206 11.8228 2.52075 11.2291 2.52075C10.6354 2.52075 10.1541 3.00206 10.1541 3.59579C10.1541 4.18951 10.6354 4.67082 11.2291 4.67082Z" fill="#FC4646" stroke="black" stroke-width="0.956522"/>\n      <path d="M15.5457 5.24186C16.2939 4.22535 16.2939 2.70912 15.5457 1.69263" stroke="#FC4646" stroke-width="0.840492" stroke-linecap="round"/>\n      <path d="M17.1342 6.11041C18.2923 4.62825 18.2923 2.32834 17.1342 0.846191" stroke="#FC4646" stroke-width="0.840492" stroke-linecap="round"/>\n      <path d="M13.9615 4.3841C14.3 3.84461 14.3 3.10638 13.9615 2.56689" stroke="#FC4646" stroke-width="0.840492" stroke-linecap="round"/>\n      <path d="M6.68811 5.24186C5.93984 4.22535 5.93984 2.70912 6.68811 1.69263" stroke="#FC4646" stroke-width="0.840492" stroke-linecap="round"/>\n      <path d="M5.09949 6.11041C3.94132 4.62825 3.94132 2.32834 5.09949 0.846191" stroke="#FC4646" stroke-width="0.840492" stroke-linecap="round"/>\n      <path d="M8.27209 4.3841C7.93361 3.84461 7.93361 3.10638 8.27209 2.56689" stroke="#FC4646" stroke-width="0.840492" stroke-linecap="round"/>\n    </svg>`;const r=t?`<span style="flex-shrink: 0; margin-top: 2px;">${n}</span>\n         <span>¡Tu área posee nuestro servicio!</span>`:`<span><span style="color: #DA291C; font-weight: 700;">Fuera de área</span> <span style="font-weight: 400;">¡Pero tienes opciones!</span></span>`;const s=`\n      <div style="\n        font-family: 'Open Sans', Arial, sans-serif;\n        width: 100%;\n        min-width: 340px;\n        box-sizing: border-box;\n        background: #ffffff;\n        padding: 16px 20px 20px 20px;\n        text-align: center;\n        position: relative;\n        border-radius: 16px;\n      ">\n        \x3c!-- Close button --\x3e\n        <button\n          onclick="if(window.__infoWindowCloseCallback) window.__infoWindowCloseCallback();"\n          style="\n            position: absolute;\n            top: 10px;\n            right: 10px;\n            width: 24px;\n            height: 24px;\n            background: transparent;\n            border: none;\n            font-size: 18px;\n            color: #666;\n            cursor: pointer;\n            line-height: 1;\n            padding: 0;\n          "\n        >×</button>\n\n        \x3c!-- Title: with icon for success, without icon for no coverage --\x3e\n        <div style="\n          margin: 0 0 10px 0;\n          padding-right: 20px;\n          font-size: 15px;\n          font-weight: 700;\n          color: #333;\n          line-height: 1.4;\n          display: flex;\n          align-items: flex-start;\n          justify-content: center;\n          gap: 6px;\n        ">\n          ${r}\n        </div>\n\n        \x3c!-- Message --\x3e\n        <p style="\n          margin: 0 0 16px 0;\n          font-size: 13px;\n          color: #666;\n          line-height: 1.4;\n        ">${i}</p>\n\n        \x3c!-- Action button with pill style --\x3e\n        <button\n          onclick="if(window.__infoWindowContinueCallback) window.__infoWindowContinueCallback();"\n          style="\n            background: #DA291C;\n            color: #ffffff;\n            border: none;\n            padding: 12px 36px;\n            font-size: 14px;\n            font-weight: 600;\n            border-radius: 50px;\n            cursor: pointer;\n            min-width: 150px;\n          "\n        >${a}</button>\n      </div>\n    `;window.__infoWindowCloseCallback=()=>{S.closeInfoWindow()};S.showInfoWindow(s,(()=>{if(t&&this.locationData&&this.locationData.isValid){this.handleInfoWindowContinue()}else if(o){this.handleNoConverageWithOptions()}else{S.closeInfoWindow()}}))}handleNoConverageWithOptions=()=>{S.closeInfoWindow();if(this.currentCoordinates){const e={latitude:this.currentCoordinates.lat,longitude:this.currentCoordinates.lng,address:this.address||this.geocodeResult?.address||"",city:this.geocodeResult?.city||"",zipCode:this.geocodeResult?.zipCode||"",serviceType:"CLARO HOGAR",serviceMessage:"Tenemos un poderoso servicio de internet inalámbrico en tu área que tú mismo instalas.",isValid:true};this.storeLocationInSession(e);s.setLocation(e);this.onNext?.()}};handleInfoWindowContinue=()=>{if(this.locationData&&this.locationData.isValid){S.closeInfoWindow();this.storeLocationInSession(this.locationData);s.setLocation(this.locationData);this.onNext?.()}};storeLocationInSession(e){try{sessionStorage.setItem("latitud",btoa(String(e.latitude)));sessionStorage.setItem("longitud",btoa(String(e.longitude)));if(e.serviceType.toUpperCase()==="CLARO HOGAR"){sessionStorage.removeItem("planCodeInternet");console.log("[StepLocation] CLARO HOGAR detected - planCodeInternet removed")}else{sessionStorage.setItem("planCodeInternet",btoa(e.serviceType));console.log("[StepLocation] Service type stored:",e.serviceType)}sessionStorage.setItem("plan",JSON.stringify({serviceType:e.serviceType,serviceMessage:e.serviceMessage,address:e.address,city:e.city,zipCode:e.zipCode}));console.log("[StepLocation] Location data stored in sessionStorage")}catch(e){console.error("[StepLocation] Error storing location in sessionStorage:",e)}}handleUseCurrentLocation=async()=>{this.isGettingLocation=true;try{const e=await S.getCurrentLocationWithAddress();if(e){this.geocodeResult=e;this.address=e.formattedAddress||e.address;this.currentCoordinates=e.coordinates;S.setMarker(e.coordinates);S.centerMap(e.coordinates);S.setZoom(17)}else{const e=await S.getCurrentLocation();this.currentCoordinates=e;S.setMarker(e);S.centerMap(e);S.setZoom(17)}}catch(e){console.error("Geolocation error:",e);if(e.message.includes("denied")){this.errorMessage=v.GEOLOCATION_DENIED}else if(e.message.includes("unavailable")){this.errorMessage=v.GEOLOCATION_UNAVAILABLE}else{this.errorMessage=v.GEOLOCATION_TIMEOUT}this.showErrorModal=true}finally{this.isGettingLocation=false}};render(){return o(i,{key:"a0fdfad7a80905bc3141ce6302af7256365a18da"},o("div",{key:"6b74fcce9383db47460bb4f7f130f857b4738bf4",class:"step-location"},this.isValidating&&o("div",{key:"df9d5d8ad2f5c75579c9585684831a4bf98d4825",class:"step-location__validating-overlay"},o("div",{key:"3b4a202ce7f1c87679ccc2c56ca5873b230c1056",class:"step-location__validating-content"},o("div",{key:"42f54fee8387c2ef51a2dea1163c46632e150e66",class:"step-location__validating-spinner"}),o("p",{key:"72430e87f565c5acc19434a6c8355a1f7036091c",class:"step-location__validating-text"},"Validando cobertura..."))),o("header",{key:"c69038b1231461cb213fdf0fdfa1c8c384214025",class:"step-location__header"},o("h1",{key:"61fd8665ccbe62bab912208cdc0f8398d0600567",class:"step-location__title"},o("span",{key:"a7de8d8ebc2d29801563450c909f7779e662e61c",class:"step-location__title--highlight"},"Servicio fijo empresarial")," ","en tu área")),o("div",{key:"d06f446f759ab7a242cb72c7a939de6ba22aa7e4",class:"step-location__map-container"},o("div",{key:"177368ec4c2f2b3c051e8db95f1b2d8971c228db",class:"step-location__controls"},o("div",{key:"ccfc60346af14245e4d206fb7b9637ebd5d93017",class:"step-location__input-group"},o("span",{key:"a131e0801ae2a5c211a960348b79018868bef126",class:"step-location__input-icon"},o("svg",{key:"1f3992c346f3508e2917c0e43f14b890b1b5a973",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},o("path",{key:"10b96b5a2d113b8b663b00be61302687ecc6d53f",d:"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"}),o("circle",{key:"a294b8189754fc5dc4e825e37e84f2fb535e03b9",cx:"12",cy:"10",r:"3"}))),o("input",{key:"3bf292ddee316f4b413e3d0f8b45cc392f1eea8a",type:"text",class:"step-location__input",placeholder:"Ingrese su dirección",value:this.address,onInput:this.handleAddressChange,onKeyPress:this.handleKeyPress,ref:e=>this.addressInput=e}),o("button",{key:"bad47c7f3307d9d81278b30b53d6491b1854c4af",class:{"step-location__btn-validate":true,"step-location__btn-validate--loading":this.isValidating},onClick:this.handleValidate,disabled:this.isValidating||!this.address.trim()&&!this.currentCoordinates},this.isValidating?o("span",{class:"step-location__btn-validate-content"},o("span",{class:"step-location__btn-spinner"}),"Validando..."):"Validar")),o("div",{key:"a502425053a83561ee44061dadf13f09ccf8d199",class:"step-location__location-container"},o("button",{key:"6bf0ef16f7318d7a8fd0b4debd11fe9b60bb76c2",class:"step-location__btn-location",onClick:this.handleUseCurrentLocation,disabled:this.isGettingLocation||this.isLoadingMap},o("svg",{key:"f6de87717c9e21457a237d64238971f247ce5166",class:"step-location__btn-location-icon",viewBox:"0 0 24 24",fill:"currentColor",stroke:"none"},o("path",{key:"f984f44eca6955577daea1e2be42b1f02171470f",d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"})),this.isGettingLocation?"Obteniendo ubicación...":"Utilizar Ubicación Actual"))),o("div",{key:"d6cf5a98c1fb5afc2fd069b2d3c0150b824158d8",class:"step-location__map"},this.isLoadingMap&&!this.mapError&&o("div",{key:"55608fde515440a7f43f7f8258b6d26abee6f160",class:"step-location__map-loading"},o("div",{key:"41cd04d0eb061ab9ebaec6a04f0b989bc8b843ae",class:"step-location__spinner"}),o("p",{key:"c084625896cec00e76f1276403c06c47bbaf92ff"},"Cargando mapa...")),this.mapError&&o("div",{key:"08a2a87133de69b9aa5bffd3471f74417898ef2a",class:"step-location__map-error"},o("p",{key:"837216b8693265ce2d0ab6e64fe3e06332e6211c"},this.mapError),!this.googleMapsKey&&o("small",{key:"839af12d94b96e2d3173bfaacfa3ddcf8ac9ec65"},"Configura la prop google-maps-key en el componente")),o("div",{key:"f3d4e74af751b703fbde4c711a7916bc2b5403a4",class:"step-location__map-canvas",ref:e=>this.mapContainer=e,style:{display:this.mapError?"none":"block"}}))),this.showErrorModal&&o("div",{key:"742b0c5d5bde185c75d85559e7b034cc99cb542b",class:"step-location__modal-backdrop"},o("div",{key:"63f4d5c22000f78ae0f36a398963c887a8436c36",class:"step-location__modal step-location__modal--error"},o("button",{key:"eac5df4ad471cc1dd140450925da89eb7976f618",class:"step-location__modal-close",onClick:()=>this.showErrorModal=false},"×"),o("div",{key:"d822289c60d275817eabf7f62ca4462ade3c65a5",class:"step-location__modal-error-bar"},"Error"),o("p",{key:"ba7d2f9c9aa46e573282ad7a3dc2a8c823dbcfb6",class:"step-location__modal-message"},this.errorMessage),o("button",{key:"9070d8dfdda3359c33b1f64ae26f07f5f863823b",class:"step-location__modal-btn",onClick:()=>this.showErrorModal=false},"Cerrar")))))}};re.style=ne();const se=()=>`@keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes slideUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}@keyframes spin{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}:host{display:block}.step-plans{width:100%;min-height:100vh;padding:1.5rem;padding-bottom:180px}@media (min-width: 768px){.step-plans{padding:2rem;padding-bottom:140px}}.step-plans__header{display:flex;align-items:center;justify-content:space-between;padding-bottom:1rem;margin-bottom:1.5rem;position:relative}.step-plans__header::after{content:"";position:absolute;bottom:0;left:50%;transform:translateX(-50%);width:100vw;height:1px;background:#E5E5E5}.step-plans__title{font-size:1.5rem;font-weight:700;color:#333333;margin:0}@media (min-width: 768px){.step-plans__title{font-size:1.75rem}}.step-plans__btn-back{background:#FFFFFF;border:2px solid #0097A9;color:#0097A9;padding:0.5rem 1.5rem;border-radius:9999px;font-size:0.875rem;font-weight:600;cursor:pointer;transition:all 0.2s ease}.step-plans__btn-back:hover{background:#0097A9;color:#FFFFFF}.step-plans__loading{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:3rem;color:#666666}.step-plans__spinner{width:40px;height:40px;border:3px solid #E5E5E5;border-top-color:#0097A9;border-radius:50%;animation:spin 1s linear infinite;margin-bottom:1rem}.step-plans__error{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:2rem;text-align:center;color:#DA291C}.step-plans__error button{display:inline-flex;align-items:center;justify-content:center;gap:0.5rem;padding:0 1.5rem;font-family:"AMX", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, sans-serif;font-size:1rem;font-weight:600;line-height:1;text-decoration:none;border:none;border-radius:9999px;cursor:pointer;transition:all 150ms ease}.step-plans__error button:disabled{opacity:0.5;cursor:not-allowed}.step-plans__error button{height:48px;background-color:transparent;color:#0097A9;border:2px solid #0097A9}.step-plans__error button:hover:not(:disabled){background-color:rgba(0, 151, 169, 0.1)}.step-plans__error button:active:not(:disabled){background-color:rgba(0, 151, 169, 0.2)}.step-plans__error button{margin-top:1rem}.step-plans__carousel-container{padding:1rem 0 3rem}.step-plans__empty{display:flex;align-items:center;justify-content:center;padding:3rem;color:#666666}.step-plans__footer{position:fixed;bottom:0;left:0;right:0;background:#FFFFFF;border-top:1px solid #E5E5E5;padding:0.75rem 1.5rem;z-index:200;box-shadow:0 -4px 12px rgba(0, 0, 0, 0.1);display:flex;align-items:center;justify-content:space-between}@media (max-width: 767px){.step-plans__footer{flex-direction:column;gap:0.75rem;padding:1rem}}.step-plans__footer-left{display:flex;flex-direction:column}@media (max-width: 767px){.step-plans__footer-left{width:100%}}.step-plans__footer-info{display:flex;gap:1.5rem}.step-plans__footer-item{display:flex;flex-direction:column}.step-plans__footer-item--separator{padding-left:1.5rem;border-left:1px solid #E5E5E5}.step-plans__footer-label{font-size:0.75rem;color:#666666}.step-plans__footer-value{font-size:1.25rem;font-weight:700;color:#333333}.step-plans__footer-value--highlight{color:#DA291C}.step-plans__footer-note{font-size:0.75rem;color:#808080;margin:0.25rem 0 0}.step-plans__footer-btn{display:inline-flex;align-items:center;justify-content:center;gap:0.5rem;padding:0 1.5rem;font-family:"AMX", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, sans-serif;font-size:1rem;font-weight:600;line-height:1;text-decoration:none;border:none;border-radius:9999px;cursor:pointer;transition:all 150ms ease}.step-plans__footer-btn:disabled{opacity:0.5;cursor:not-allowed}.step-plans__footer-btn{height:48px;background-color:#DA291C;color:#FFFFFF}.step-plans__footer-btn:hover:not(:disabled){background-color:rgb(181.843902439, 34.2, 23.356097561)}.step-plans__footer-btn:active:not(:disabled){background-color:rgb(163.7658536585, 30.8, 21.0341463415)}.step-plans__footer-btn{min-width:160px}@media (max-width: 767px){.step-plans__footer-btn{width:100%}}.plan-card{background:#FFFFFF;border-radius:16px;border:2px solid #0097A9;box-shadow:0 2px 12px rgba(0, 0, 0, 0.1);overflow:hidden;cursor:pointer;transition:all 0.2s ease;display:flex;flex-direction:column;min-height:340px}.plan-card:hover{box-shadow:0 6px 20px rgba(0, 151, 169, 0.25);transform:translateY(-2px)}.plan-card--selected{border-color:#0097A9;box-shadow:0 6px 24px rgba(0, 151, 169, 0.3)}.plan-card--processing{pointer-events:none;opacity:0.8}.plan-card__header{display:flex;justify-content:center;padding-top:0}.plan-card__name{background:#1a1a1a;color:#FFFFFF;font-size:0.875rem;font-weight:700;text-transform:uppercase;letter-spacing:0.5px;line-height:1.3;padding:0.75rem 1rem;width:70%;text-align:center;border-radius:0 0 12px 12px}.plan-card__body{flex:1;padding:1.25rem 1rem;text-align:center;display:flex;flex-direction:column}.plan-card__includes-label{font-size:1rem;color:#666666;margin:0 0 0.75rem;font-weight:500}.plan-card__features{list-style:none;padding:0;margin:0 0 1rem;text-align:center;flex:1}.plan-card__feature{margin-bottom:0.5rem;font-size:0.875rem;color:#333333;font-weight:600}.plan-card__feature:last-child{margin-bottom:0}.plan-card__price{font-size:1.75rem;font-weight:700;color:#0097A9;margin:1rem 0 0}.plan-card__footer{padding:1rem}.plan-card__btn{width:100%;padding:0.75rem 1rem;border-radius:25px;font-size:1rem;font-weight:600;cursor:pointer;transition:all 0.2s ease;background:#FFFFFF;color:#0097A9;border:2px solid #0097A9}.plan-card__btn:hover{background:rgba(0, 151, 169, 0.1)}.plan-card__btn--selected{background:#0097A9;color:#FFFFFF;border-color:#0097A9}.plan-card__btn--selected:hover{background:rgb(0, 114.5455621302, 128.2)}.plan-card__btn--loading{cursor:wait;opacity:0.8}.plan-card__btn:disabled{cursor:not-allowed;opacity:0.6}.plan-card__btn-loading{display:inline-flex;align-items:center;gap:0.5rem}.plan-card__btn-spinner{width:14px;height:14px;border:2px solid rgba(255, 255, 255, 0.3);border-top-color:#FFFFFF;border-radius:50%;animation:spin 0.8s linear infinite}@keyframes spin{to{transform:rotate(360deg)}}`;const ce=class{constructor(t){e(this,t)}onNext;onBack;plans=[];selectedPlan=null;isLoading=true;error=null;isAddingToCart=false;async componentWillLoad(){await this.loadPlans();const e=y.getStoredPlanId();if(e>0){const t=this.plans.find((t=>t.planId===e));if(t){this.selectedPlan=t;s.selectPlan(t)}}}async loadPlans(){this.isLoading=true;this.error=null;try{const e=c.location?.serviceType||"GPON";let t=0;if(e==="CLARO HOGAR"){t=d.getSubcatalogId();console.log("[StepPlans] CLARO HOGAR - using subcatalogId:",t)}this.plans=await y.getPlans(e,t);this.plans=y.sortByPrice(this.plans)}catch(e){this.error="Error al cargar los planes";console.error(e)}finally{this.isLoading=false}}handleSelectPlan=async e=>{if(this.selectedPlan?.planId===e.planId){return}this.isAddingToCart=true;this.error=null;try{const t=y.getStoredPlanId();const o=y.getCartId();if(t>0&&t!==e.planId&&o>0){console.log("[StepPlans] Removing previous plan from cart:",t);await y.deleteFromCart(o)}console.log("[StepPlans] Adding plan to cart:",e.planId,e.planName);await y.addToCart(e);this.selectedPlan=e;s.selectPlan(e);console.log("[StepPlans] Plan added successfully")}catch(t){console.error("[StepPlans] Error adding plan to cart:",t);this.error="Error al agregar el plan. Por favor intente de nuevo.";this.selectedPlan=e;s.selectPlan(e)}finally{this.isAddingToCart=false}};handleContinue=()=>{if(this.selectedPlan&&!this.isAddingToCart){this.onNext?.()}};renderPlanCard(e){const t=this.selectedPlan?.planId===e.planId;const i=this.isAddingToCart&&t;const a=y.parsePlanFeatures(e.planDesc||"");const n=a.length>0?a:["Internet fibra 1","Internet 2","Internet 3"];return o("div",{class:{"plan-card":true,"plan-card--selected":t,"plan-card--processing":i},onClick:()=>!this.isAddingToCart&&this.handleSelectPlan(e)},o("div",{class:"plan-card__header"},o("span",{class:"plan-card__name"},e.planName)),o("div",{class:"plan-card__body"},o("p",{class:"plan-card__includes-label"},"Plan incluye"),o("ul",{class:"plan-card__features"},n.slice(0,4).map((e=>o("li",{class:"plan-card__feature"},e)))),o("p",{class:"plan-card__price"},N(e.decPrice))),o("div",{class:"plan-card__footer"},o("button",{class:{"plan-card__btn":true,"plan-card__btn--selected":t,"plan-card__btn--loading":i},disabled:this.isAddingToCart},i?o("span",{class:"plan-card__btn-loading"},o("span",{class:"plan-card__btn-spinner"}),"Agregando..."):t?"Plan seleccionado":"Solicitar plan")))}render(){const e=this.selectedPlan?this.selectedPlan.decPrice:0;const t=0;return o(i,{key:"ce4bdd1822f0418bbe4cd6403cecfc60a81499fd"},o("div",{key:"38976660d6e3896bcb92f42c2f10d7b021180fb1",class:"step-plans"},o("header",{key:"0d683bb4162744cd85ed4860dfd711b0ed8b46d9",class:"step-plans__header"},o("h1",{key:"4f66e42bf7d39fd9cbef543b7bdee009457198b9",class:"step-plans__title"},"Elige tu plan"),o("button",{key:"6e0d378f423df0195f6a8005ce3dabdfda0aeaa0",class:"step-plans__btn-back",onClick:this.onBack},"Regresar")),this.isLoading&&o("div",{key:"f34a8fd65581325f2c8e43962d28c62ddcc7d53c",class:"step-plans__loading"},o("div",{key:"66507730218129cce81e7eafc74bb1d8019f2d38",class:"step-plans__spinner"}),o("p",{key:"d4434bdf2778ab37665e9e23441a73974c1137ef"},"Cargando planes...")),this.error&&o("div",{key:"3a58571b1d567de14059f24bbb47c6ed235df90f",class:"step-plans__error"},o("p",{key:"77aa040bbe6b3893d008d996e76ff821b5da4c4e"},this.error),o("button",{key:"2ffaa904005874041feb12dda1ea7fc27586725f",onClick:()=>this.loadPlans()},"Reintentar")),!this.isLoading&&!this.error&&this.plans.length>0&&o("div",{key:"44215a7aebba82416cd8f5dc965d9b77d184b69e",class:"step-plans__carousel-container"},o("ui-carousel",{key:"163f4d7469975cc1f0434cecb27c9be84cd6add9",totalItems:this.plans.length,gap:24,showNavigation:false,showPagination:true,breakpoints:[{minWidth:0,slidesPerView:1},{minWidth:500,slidesPerView:2},{minWidth:800,slidesPerView:3},{minWidth:1100,slidesPerView:4}]},this.plans.map((e=>this.renderPlanCard(e))))),!this.isLoading&&!this.error&&this.plans.length===0&&o("div",{key:"5357ee725145edfed49e9e014e52386465ed33c6",class:"step-plans__empty"},o("p",{key:"21cba0327cc39f3f81aa81fea3c162bea5d21569"},"No hay planes disponibles para tu área.")),o("footer",{key:"6f6b93e7fb3f6cb8a9b739d839439169de7be3dd",class:"step-plans__footer"},o("div",{key:"95d9c33f6f82b9e2750264ee710dc276262df131",class:"step-plans__footer-left"},o("div",{key:"af5ef8dc173fb0bcbf4acaf2852dbb4cf8266229",class:"step-plans__footer-info"},o("div",{key:"57bc69a6b30f13223a5984298ad1377a7550a90f",class:"step-plans__footer-item"},o("span",{key:"94c0f380a7c660092d5631b0d6658603b18451bf",class:"step-plans__footer-label"},"Pago mensual"),o("span",{key:"6c925764bfc5b8ffce889e8de23ef4916eeed71b",class:"step-plans__footer-value"},N(e))),o("div",{key:"f064724dee792e20e747ada032e14b2c1351a55f",class:"step-plans__footer-item step-plans__footer-item--separator"},o("span",{key:"a7c8bba8b4fa48d947851cbc87cea3f0221162ff",class:"step-plans__footer-label"},"Paga hoy"),o("span",{key:"d9d4050c7d0ee7e9c81505e88bf8440fa7bda1d6",class:"step-plans__footer-value step-plans__footer-value--highlight"},N(t)))),o("p",{key:"717963632f536afdabeca705acf9d5f21992614f",class:"step-plans__footer-note"},"Renta mensual aproximada no incluye cargos estatales, federales, ni otros impuestos.")),o("button",{key:"690c687202551a680b6835f5407260f2a042069d",class:"step-plans__footer-btn",onClick:this.handleContinue,disabled:!this.selectedPlan||this.isAddingToCart},this.isAddingToCart?"Procesando...":"Continuar"))))}};ce.style=se();const le=()=>`@keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes slideUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}@keyframes spin{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}:host{display:block;width:100%}.ui-carousel{position:relative;width:100%;display:flex;align-items:center}.ui-carousel__viewport{flex:1;overflow:hidden;margin:0 0.5rem}@media (min-width: 768px){.ui-carousel__viewport{margin:0 1rem}}.ui-carousel__track{display:flex;align-items:stretch;transition:transform 0.3s ease-out;will-change:transform}.ui-carousel__track--dragging{transition:none;cursor:grabbing}.ui-carousel__nav{flex-shrink:0;width:40px;height:40px;border-radius:50%;background:#FFFFFF;border:2px solid #DA291C;color:#DA291C;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all 0.2s ease;z-index:2;box-shadow:0 2px 8px rgba(0, 0, 0, 0.1)}.ui-carousel__nav svg{width:20px;height:20px}.ui-carousel__nav:hover:not(:disabled){background:#DA291C;color:#FFFFFF}.ui-carousel__nav:active:not(:disabled){transform:scale(0.95)}.ui-carousel__nav--disabled{opacity:0.3;cursor:not-allowed;pointer-events:none}@media (max-width: 599px){.ui-carousel__nav{width:32px;height:32px}.ui-carousel__nav svg{width:16px;height:16px}}.ui-carousel__pagination{position:absolute;bottom:-2rem;left:50%;transform:translateX(-50%);display:flex;gap:0.5rem;z-index:2}.ui-carousel__dot{width:10px;height:10px;border-radius:50%;border:none;background:#CCCCCC;cursor:pointer;padding:0;transition:all 0.2s ease}.ui-carousel__dot:hover{background:#999999}.ui-carousel__dot--active{background:#DA291C;transform:scale(1.2)}::slotted(*){box-sizing:border-box}`;const de=class{constructor(t){e(this,t)}get el(){return a(this)}totalItems=0;slidesPerView=1;gap=16;showNavigation=true;showPagination=true;loop=false;autoplay=0;breakpoints=[{minWidth:0,slidesPerView:1},{minWidth:600,slidesPerView:2},{minWidth:900,slidesPerView:3},{minWidth:1200,slidesPerView:4}];currentIndex=0;currentSlidesPerView=1;isDragging=false;startX=0;translateX=0;trackEl;autoplayInterval;resizeObserver;handleTotalItemsChange(){this.currentIndex=0;this.updateTranslate()}componentDidLoad(){this.updateSlidesPerView();this.setupResizeObserver();this.startAutoplay()}disconnectedCallback(){this.stopAutoplay();if(this.resizeObserver){this.resizeObserver.disconnect()}}setupResizeObserver(){this.resizeObserver=new ResizeObserver((()=>{this.updateSlidesPerView()}));this.resizeObserver.observe(this.el)}updateSlidesPerView(){const e=this.el.offsetWidth;let t=this.slidesPerView;for(const o of this.breakpoints){if(e>=o.minWidth){t=o.slidesPerView}}this.currentSlidesPerView=t;const o=this.getMaxIndex();if(this.currentIndex>o){this.currentIndex=o}this.updateTranslate()}getMaxIndex(){return Math.max(0,this.totalItems-this.currentSlidesPerView)}goToSlide(e){const t=this.getMaxIndex();if(this.loop){if(e<0){e=t}else if(e>t){e=0}}else{e=Math.max(0,Math.min(e,t))}this.currentIndex=e;this.updateTranslate()}goToPrev=()=>{this.goToSlide(this.currentIndex-1)};goToNext=()=>{this.goToSlide(this.currentIndex+1)};updateTranslate(){if(!this.trackEl)return;const e=100/this.currentSlidesPerView;this.translateX=-(this.currentIndex*e)}startAutoplay(){if(this.autoplay>0){this.autoplayInterval=setInterval((()=>{this.goToNext()}),this.autoplay)}}stopAutoplay(){if(this.autoplayInterval){clearInterval(this.autoplayInterval)}}handleTouchStart=e=>{this.isDragging=true;this.startX=e.touches[0].clientX;this.stopAutoplay()};handleTouchMove=e=>{if(!this.isDragging)return;const t=e.touches[0].clientX;const o=t-this.startX;const i=this.el.offsetWidth/this.currentSlidesPerView;const a=o/i*(100/this.currentSlidesPerView);const n=-(this.currentIndex*(100/this.currentSlidesPerView));this.translateX=n+a};handleTouchEnd=e=>{if(!this.isDragging)return;this.isDragging=false;const t=e.changedTouches[0].clientX;const o=t-this.startX;if(Math.abs(o)>50){if(o>0){this.goToPrev()}else{this.goToNext()}}else{this.updateTranslate()}this.startAutoplay()};getPaginationDots(){const e=Math.ceil(this.totalItems/this.currentSlidesPerView);return Array.from({length:e},((e,t)=>t))}handleDotClick=e=>{this.goToSlide(e*this.currentSlidesPerView)};getCurrentDot(){return Math.floor(this.currentIndex/this.currentSlidesPerView)}render(){const e=this.loop||this.currentIndex>0;const t=this.loop||this.currentIndex<this.getMaxIndex();const a=100/this.currentSlidesPerView;return o(i,{key:"1d71ded8170a2004929ada8d1401d18fbe5dcc0c"},o("div",{key:"01d088bfc7590419709aa83850462f6b1fa6374c",class:"ui-carousel"},this.showNavigation&&o("button",{key:"a820df5e62634206f0d9f46092f84f84a724eb23",class:{"ui-carousel__nav":true,"ui-carousel__nav--prev":true,"ui-carousel__nav--disabled":!e},onClick:this.goToPrev,disabled:!e,"aria-label":"Anterior"},o("svg",{key:"7ee40aa5fa9fd0c8ac38583ebeaf0c15b8b4c49e",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},o("polyline",{key:"882e3d293306f869bd4d8db82a1c0a8720d83d69",points:"15 18 9 12 15 6"}))),o("div",{key:"0bc0eef0e943585d9877ae832a33bac4813c33c1",class:"ui-carousel__viewport"},o("div",{key:"8ce97b79d901f63c3e6da2e750926857d2dddbc9",class:{"ui-carousel__track":true,"ui-carousel__track--dragging":this.isDragging},ref:e=>this.trackEl=e,style:{transform:`translateX(${this.translateX}%)`,gap:`${this.gap}px`},onTouchStart:this.handleTouchStart,onTouchMove:this.handleTouchMove,onTouchEnd:this.handleTouchEnd},o("slot",{key:"bab876ce6a274ce53c476444694cef4e94bf39ad"}))),this.showNavigation&&o("button",{key:"286f8e40d9092b5d837566977e252c36e9fee843",class:{"ui-carousel__nav":true,"ui-carousel__nav--next":true,"ui-carousel__nav--disabled":!t},onClick:this.goToNext,disabled:!t,"aria-label":"Siguiente"},o("svg",{key:"28eabda805720b3bb8c540b4126c000db8ff7433",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},o("polyline",{key:"ad5d5d53067b22fe760c4e6499f027ac61105154",points:"9 18 15 12 9 6"}))),this.showPagination&&this.totalItems>this.currentSlidesPerView&&o("div",{key:"aab818d63c57cea9cfe25a91bb768f8be490cef5",class:"ui-carousel__pagination"},this.getPaginationDots().map((e=>o("button",{class:{"ui-carousel__dot":true,"ui-carousel__dot--active":e===this.getCurrentDot()},onClick:()=>this.handleDotClick(e),"aria-label":`Ir a página ${e+1}`}))))),o("style",{key:"927be72b1c508b1add09174d6402b4dfc5f1aece"},`\n            ::slotted(*) {\n              flex: 0 0 calc(${a}% - ${this.gap*(this.currentSlidesPerView-1)/this.currentSlidesPerView}px);\n              max-width: calc(${a}% - ${this.gap*(this.currentSlidesPerView-1)/this.currentSlidesPerView}px);\n              /* height handled by align-items: stretch on track */\n            }\n          `))}static get watchers(){return{totalItems:["handleTotalItemsChange"]}}};de.style=le();const pe=()=>`.ui-stepper{display:flex;align-items:flex-start;justify-content:center;width:100%}.ui-stepper__step{display:flex;flex-direction:column;align-items:flex-start;position:relative}.ui-stepper__indicator{display:flex;align-items:center;position:relative}.ui-stepper__circle{width:32px;height:32px;border-radius:9999px;display:flex;align-items:center;justify-content:center;font-weight:600;font-size:0.875rem;transition:all 250ms ease;flex-shrink:0}.ui-stepper__circle--pending{background-color:#FFFFFF;color:#999999;border:2px solid #CCCCCC}.ui-stepper__circle--active{background-color:#FFFFFF;color:#0097A9;border:2px solid #0097A9}.ui-stepper__circle--completed{background-color:#FFFFFF;color:#0097A9;border:2px solid #0097A9}.ui-stepper__number{line-height:1}.ui-stepper__check{width:16px;height:16px}.ui-stepper__connector{width:220px;height:2px;background-color:#CCCCCC;transition:background-color 250ms ease;margin-left:8px;margin-right:8px}.ui-stepper__connector--completed{background-color:#0097A9}.ui-stepper__label{position:relative;left:calc(32px / 2);transform:translateX(-50%);margin-top:0.5rem;font-size:0.75rem;font-weight:500;text-align:center;transition:color 250ms ease;white-space:nowrap}.ui-stepper__label--pending{color:#808080}.ui-stepper__label--active{color:#0097A9;font-weight:600}.ui-stepper__label--completed{color:#0097A9}.ui-stepper--sm .ui-stepper__circle{width:24px;height:24px;font-size:0.75rem}.ui-stepper--sm .ui-stepper__check{width:12px;height:12px}.ui-stepper--sm .ui-stepper__connector{width:30px}.ui-stepper--sm .ui-stepper__label{font-size:10px;left:calc(24px / 2)}@media (max-width: 576px){.ui-stepper__connector{width:80px}.ui-stepper__label{font-size:11px}}`;const fe=class{constructor(t){e(this,t)}steps=[];currentStep=1;size="md";getStepStatus(e){const t=e+1;if(t<this.currentStep){return"completed"}else if(t===this.currentStep){return"active"}return"pending"}render(){const e={"ui-stepper":true,[`ui-stepper--${this.size}`]:true};return o(i,{key:"df6adc9763aed239c6eaf79af2f2d549f48579c6"},o("div",{key:"bfb747939107bdd62106748334c198a2fb50713b",class:e},this.steps.map(((e,t)=>{const i=this.getStepStatus(t);const a=t===this.steps.length-1;return o("div",{class:"ui-stepper__step",key:t},o("div",{class:"ui-stepper__indicator"},o("div",{class:{"ui-stepper__circle":true,[`ui-stepper__circle--${i}`]:true}},i==="completed"?o("svg",{class:"ui-stepper__check",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3"},o("polyline",{points:"20 6 9 17 4 12"})):o("span",{class:"ui-stepper__number"},t+1)),!a&&o("div",{class:{"ui-stepper__connector":true,"ui-stepper__connector--completed":i==="completed"}})),o("span",{class:{"ui-stepper__label":true,[`ui-stepper__label--${i}`]:true}},e.label))}))))}};fe.style=pe();export{P as fixed_service_flow,R as step_catalogue,U as step_confirmation,V as step_contract,ae as step_form,re as step_location,ce as step_plans,de as ui_carousel,fe as ui_stepper};
//# sourceMappingURL=p-ac05dd7a.entry.js.map