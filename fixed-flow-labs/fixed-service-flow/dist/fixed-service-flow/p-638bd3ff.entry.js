import{a as e,f as t,r as a,c as r,h as o,H as i,d as n}from"./p-X-V47bix.js";const s=(e,t,a)=>{const r=e.get(t);if(!r){e.set(t,[a])}else if(!r.includes(a)){r.push(a)}};const c=(e,t)=>{let a;return(...r)=>{if(a){clearTimeout(a)}a=setTimeout((()=>{a=0;e(...r)}),t)}};const l=e=>!("isConnected"in e)||e.isConnected;const d=c((e=>{for(let t of e.keys()){e.set(t,e.get(t).filter(l))}}),2e3);const p=()=>{if(typeof e!=="function"){return{}}const a=new Map;return{dispose:()=>a.clear(),get:t=>{const r=e();if(r){s(a,t,r)}},set:e=>{const r=a.get(e);if(r){a.set(e,r.filter(t))}d(a)},reset:()=>{a.forEach((e=>e.forEach(t)));d(a)}}};const u=e=>typeof e==="function"?e():e;const f=(e,t=(e,t)=>e!==t)=>{const a=u(e);let r=new Map(Object.entries(a??{}));const o={dispose:[],get:[],set:[],reset:[]};const i=new Map;const n=()=>{r=new Map(Object.entries(u(e)??{}));o.reset.forEach((e=>e()))};const s=()=>{o.dispose.forEach((e=>e()));n()};const c=e=>{o.get.forEach((t=>t(e)));return r.get(e)};const l=(e,a)=>{const i=r.get(e);if(t(a,i,e)){r.set(e,a);o.set.forEach((t=>t(e,a,i)))}};const d=typeof Proxy==="undefined"?{}:new Proxy(a,{get(e,t){return c(t)},ownKeys(e){return Array.from(r.keys())},getOwnPropertyDescriptor(){return{enumerable:true,configurable:true}},has(e,t){return r.has(t)},set(e,t,a){l(t,a);return true}});const p=(e,t)=>{o[e].push(t);return()=>{h(o[e],t)}};const f=(t,a)=>{const r=(e,r)=>{if(e===t){a(r)}};const o=()=>a(u(e)[t]);const n=p("set",r);const s=p("reset",o);i.set(a,{setHandler:r,resetHandler:o,propName:t});return()=>{n();s();i.delete(a)}};const m=(...e)=>{const t=e.reduce(((e,t)=>{if(t.set){e.push(p("set",t.set))}if(t.get){e.push(p("get",t.get))}if(t.reset){e.push(p("reset",t.reset))}if(t.dispose){e.push(p("dispose",t.dispose))}return e}),[]);return()=>t.forEach((e=>e()))};const b=e=>{const t=r.get(e);o.set.forEach((a=>a(e,t,t)))};const g=(e,t)=>{const a=i.get(t);if(a&&a.propName===e){h(o.set,a.setHandler);h(o.reset,a.resetHandler);i.delete(t)}};return{state:d,get:c,set:l,on:p,onChange:f,use:m,dispose:s,reset:n,forceUpdate:b,removeListener:g}};const h=(e,t)=>{const a=e.indexOf(t);if(a>=0){e[a]=e[e.length-1];e.length--}};const m=(e,t)=>{const a=f(e,t);a.use(p());return a};const b={currentStep:1,token:null,correlationId:null,location:null,availablePlans:[],selectedPlan:null,selectedContract:null,formData:null,orderId:null,requestError:null,isLoading:false,error:null};const{state:g,onChange:y,reset:x}=m(b);const _={setToken:(e,t)=>{g.token=e;g.correlationId=t;sessionStorage.setItem("token",e);sessionStorage.setItem("correlationId",t)},getStoredToken:()=>({token:sessionStorage.getItem("token"),correlationId:sessionStorage.getItem("correlationId")}),hasToken:()=>!!g.token||!!sessionStorage.getItem("token"),clearToken:()=>{g.token=null;g.correlationId=null;sessionStorage.removeItem("token");sessionStorage.removeItem("correlationId")},setStep:e=>{g.currentStep=e},nextStep:()=>{if(g.currentStep<5){g.currentStep=g.currentStep+1}},prevStep:()=>{if(g.currentStep>1){g.currentStep=g.currentStep-1}},setLocation:e=>{g.location=e;sessionStorage.setItem("latitud",btoa(String(e.latitude)));sessionStorage.setItem("longitud",btoa(String(e.longitude)));sessionStorage.setItem("planCodeInternet",btoa(e.serviceType))},setAvailablePlans:e=>{g.availablePlans=e},selectPlan:e=>{g.selectedPlan=e;sessionStorage.setItem("planId",String(e.planId));sessionStorage.setItem("planPrice",String(e.decPrice));sessionStorage.setItem("plan",JSON.stringify(e))},setContract:e=>{g.selectedContract=e;sessionStorage.setItem("typeContractId",String(e.typeId));sessionStorage.setItem("contractInstallment",String(e.deadlines));sessionStorage.setItem("contractInstallation",String(e.installation));sessionStorage.setItem("contractActivation",String(e.activation));sessionStorage.setItem("contractModen",String(e.modem))},setFormData:e=>{g.formData=e},setOrderResult:(e,t)=>{g.orderId=e;g.requestError=t},setLoading:e=>{g.isLoading=e},setError:e=>{g.error=e},clearError:()=>{g.error=null},resetFlow:()=>{const e=["planCodeInternet","latitud","longitud","planId","planPrice","plan","typeContractId","contractInstallment","contractInstallation","contractActivation","contractModen"];e.forEach((e=>sessionStorage.removeItem(e)));x()},getSubmissionData:()=>({location:g.location,plan:g.selectedPlan,contract:g.selectedContract,formData:g.formData})};if(typeof window!=="undefined"&&window.__FSF_DEBUG__){y("currentStep",(e=>{console.log("[FSF Store] Step changed:",e)}));y("isLoading",(e=>{console.log("[FSF Store] Loading:",e)}));y("error",(e=>{if(e){console.error("[FSF Store] Error:",e)}}))}class v extends Error{status;response;constructor(e,t,a){super(e);this.status=t;this.response=a;this.name="HttpError"}}class k{baseUrl="";defaultTimeout=6e4;setBaseUrl(e){this.baseUrl=e.replace(/\/$/,"")}getBaseUrl(){return this.baseUrl}setTimeout(e){this.defaultTimeout=e}getHeaders(e,t){const a=new Headers;if(!t){a.set("Content-Type","application/json")}const r=g.token||sessionStorage.getItem("token");const o=g.correlationId||sessionStorage.getItem("correlationId");if(r){a.set("Authorization",`Bearer ${r}`)}if(o){a.set("X-Correlation-ID",o)}a.set("App","shop");a.set("Platform","web");if(e){Object.entries(e).forEach((([e,t])=>{a.set(e,t)}))}return a}async request(e){const{method:t,endpoint:a,body:r,headers:o,timeout:i,isFormData:n}=e;const s=a.startsWith("/")?a:`/${a}`;const c=`${this.baseUrl}${s}`;const l=new AbortController;const d=setTimeout((()=>l.abort()),i||this.defaultTimeout);try{const e={method:t,headers:this.getHeaders(o,n),signal:l.signal};if(r&&t!=="GET"){if(n&&r instanceof FormData){e.body=r}else{e.body=JSON.stringify(r)}}const a=await fetch(c,e);clearTimeout(d);let i;const s=a.headers.get("content-type");const p=await a.text();if(p&&(p.startsWith("{")||p.startsWith("["))){try{i=JSON.parse(p)}catch{i=p}}else if(s&&s.includes("application/json")){try{i=JSON.parse(p)}catch{i=p}}else{i=p}if(!a.ok){throw new v(`HTTP Error: ${a.status} ${a.statusText}`,a.status,i)}return{data:i,status:a.status,ok:a.ok}}catch(e){clearTimeout(d);if(e instanceof v){throw e}if(e.name==="AbortError"){throw new v("Request timeout",408)}throw new v(e.message||"Network error",0)}}async get(e,t){const a=await this.request({method:"GET",endpoint:e,headers:t});return a.data}async post(e,t,a){const r=await this.request({method:"POST",endpoint:e,body:t,headers:a});return r.data}async postFormData(e,t,a){const r=await this.request({method:"POST",endpoint:e,body:t,headers:a,isFormData:true});return r.data}async put(e,t,a){const r=await this.request({method:"PUT",endpoint:e,body:t,headers:a});return r.data}async delete(e,t){const a=await this.request({method:"DELETE",endpoint:e,headers:t});return a.data}}const w=new k;class C{isInitializing=false;initPromise=null;async fetchToken(){const e=await w.post("api/Token/getToken",{agentName:""});if(e.hasError){throw new Error(e.message||"Failed to obtain token")}return e}async initialize(){if(this.isInitializing&&this.initPromise){return this.initPromise}this.isInitializing=true;this.initPromise=(async()=>{try{const e=_.getStoredToken();if(e.token&&e.correlationId){_.setToken(e.token,e.correlationId);console.log("[TokenService] Using existing token from sessionStorage");return true}console.log("[TokenService] Fetching new token...");const t=await this.fetchToken();_.setToken(t.token,t.correlationId);console.log("[TokenService] Token obtained and stored successfully");return true}catch(e){console.error("[TokenService] Failed to initialize token:",e);_.setError("Error al obtener el token de autenticación");return false}finally{this.isInitializing=false}})();return this.initPromise}hasToken(){return _.hasToken()}getToken(){const e=_.getStoredToken();return e.token}getCorrelationId(){const e=_.getStoredToken();return e.correlationId}clearToken(){_.clearToken();console.log("[TokenService] Token cleared")}async refreshToken(){this.clearToken();return this.initialize()}async ensureToken(){if(!this.hasToken()){const e=await this.initialize();if(!e){throw new Error("Failed to obtain authentication token")}}}}const S=new C;const A=[{typeId:1,type:"Con Contrato",contract:[{contractId:3,deadlines:24,installation:0,activation:0,modem:0},{contractId:2,deadlines:12,installation:25,activation:20,modem:0}]},{typeId:0,type:"Sin Contrato",contract:[{contractId:1,deadlines:0,installation:50,activation:40,modem:40}]}];const I={NO_COVERAGE:"¡Fuera de área! Por el momento no contamos con cobertura en tu zona."};class F{async validateCoverage(e,t){await S.ensureToken();const a=await w.post("api/Catalogue/getInternetPlans",{latitud:String(e),longitud:String(t)});return a}async checkCoverage(e,t,a,r,o){const i=await this.validateCoverage(e,t);if(i.hasError){return{latitude:e,longitude:t,address:a,city:r,zipCode:o,serviceType:"",serviceMessage:I.NO_COVERAGE,isValid:false}}const n=i.priorityService;let s=I.NO_COVERAGE;if(i.attributes&&i.attributes.length>0){const e=i.attributes.find((e=>e.servicE_NAME===n));if(e){s=e.servicE_MESSAGE}}const c=["GPON","VRAD","CLARO HOGAR"];const l=c.includes(n);if(!l){return{latitude:e,longitude:t,address:a,city:r,zipCode:o,serviceType:"",serviceMessage:I.NO_COVERAGE,isValid:false}}console.log("[CoverageService] Returning valid coverage");return{latitude:e,longitude:t,address:a,city:r,zipCode:o,serviceType:n,serviceMessage:s,isValid:true}}getServiceDisplayName(e){const t={GPON:"Fibra Óptica",VRAD:"Internet DSL","CLARO HOGAR":"Internet Inalámbrico"};return t[e]||e}isClaroHogar(e){return e.toLowerCase()==="claro hogar"}}const E=new F;class P{currentCartId=0;async getPlans(e,t=0){await S.ensureToken();let a=e;if(e==="CLARO HOGAR"){a="internet"}console.log("[PlansService] Fetching plans for type:",a,"catalogId:",t);const r=await w.post("api/Plans/getPlansInternet",{catalogID:t,type:a});console.log("[PlansService] Response:",r);if(r.hasError){console.error("[PlansService] API error:",r.message);throw new Error(r.message||"Failed to fetch plans")}console.log("[PlansService] Plans found:",r.planList?.length||0);return r.planList||[]}async addToCart(e,t=0,a=0,r=0,o=""){await S.ensureToken();const i=S.getToken()||"";const n=this.getEffectivePrice(e);const s={token:i,productId:e.planId,notificationDetailID:0,chvSource:"",promoCode:sessionStorage.getItem("discountCoupon")||"",installments:r,decPrice:n,decDeposit:0,decDownPayment:0,decTotalPrice:n,Qty:1,flowId:1,ssoToken:"",userID:"0",parentProductId:a,parentCartId:t,creditClass:o,downgradeAllowed:false,pendingAccelerated:0,acceletartedAmount:0,pastDueAmount:0,delicuency:false};const c=await w.post("api/Card/addToCart",{cartItems:JSON.stringify([s])});if(c.hasError){throw new Error(c.message||"Failed to add plan to cart")}if(c.code){this.currentCartId=c.code}this.storePlanInSession(e);return c}async addToCartCurrentPlan(e,t){await S.ensureToken();const a=new FormData;a.append("productId",String(e));a.append("cartId",String(t));return await w.postFormData("api/Plans/addToCartCurrentPlan",a)}async deleteFromCart(e,t=0){await S.ensureToken();const a=await w.post("api/Card/deleteItem",{cartId:e,productId:t});if(!a.hasError){if(e===this.currentCartId){this.currentCartId=0}}return a}storePlanInSession(e){try{sessionStorage.setItem("plan",JSON.stringify(e));sessionStorage.setItem("planId",String(e.planId));const t=this.getEffectivePrice(e);sessionStorage.setItem("planPrice",String(t));sessionStorage.setItem("planCodeInternet",btoa(e.planSoc||String(e.planId)))}catch(e){console.error("[PlansService] Error storing plan in session:",e)}}getStoredPlan(){try{const e=sessionStorage.getItem("plan");return e?JSON.parse(e):null}catch{return null}}getStoredPlanId(){const e=sessionStorage.getItem("planId");return e?parseInt(e,10):0}getCartId(){return this.currentCartId}setCartId(e){this.currentCartId=e}clearPlan(){this.currentCartId=0;sessionStorage.removeItem("plan");sessionStorage.removeItem("planId");sessionStorage.removeItem("planPrice");sessionStorage.removeItem("planCodeInternet")}formatPrice(e){return`$${e.toFixed(2)}`}parsePlanFeatures(e){if(!e)return[];const t=/<li[^>]*>([^<]+)<\/li>/gi;const a=[];let r;while((r=t.exec(e))!==null){a.push(r[1].trim())}return a}getDiscountPercentage(e,t){if(!t||t>=e)return 0;return Math.round((e-t)/e*100)}hasPromotion(e){return e.bitPromotion||e.decSalePrice&&e.decSalePrice<e.decPrice}getEffectivePrice(e){if(e.decSalePrice&&e.decSalePrice<e.decPrice){return e.decSalePrice}return e.decPrice}sortByPrice(e,t=true){return[...e].sort(((e,a)=>{const r=this.getEffectivePrice(e);const o=this.getEffectivePrice(a);return t?r-o:o-r}))}}const D=new P;class z{async submitRequest(e){await S.ensureToken();const t=new FormData;Object.entries(e).forEach((([e,a])=>{if(a!==undefined&&a!==null){t.append(e,String(a))}}));const a=await w.postFormData("api/Orders/internetServiceRequest",t);return a}async getOrder(e){await S.ensureToken();const t=await w.get(`api/Orders/getOrder?orderId=${encodeURIComponent(e)}`);return t}async sendConfirmation(e,t){await S.ensureToken();const a=new FormData;a.append("orderId",e);a.append("email",t);const r=await w.postFormData("api/Orders/sendConfirmation",a);return r}buildPayload(e,t,a,r){return{type:t.typeId,name:e.personal.firstName,second_name:e.personal.secondName||"",last_name:e.personal.lastName,second_surname:e.personal.secondLastName,date_birth:e.personal.birthDate||"1990-01-01",email:e.personal.email,telephone1:e.personal.phone1,telephone2:e.personal.phone2||"",zipCode:e.address.zipCode,address:e.address.address,city:e.address.city,id_type:e.personal.identificationType==="license"?"1":"2",id:e.personal.identificationNumber,identification_expiration:e.personal.identificationExpiration,frontFlowId:this.generateFlowId(),plan_id:String(a.planId),plan_name:a.planName,deadlines:String(t.deadlines),installation:String(t.installation),activation:String(t.activation),moden:String(t.modem),claro_customer:e.isExistingCustomer,latitud:String(r.latitude),longitud:String(r.longitude),business_name:e.business.businessName,business_position:e.business.position}}generateFlowId(){return`FSF-${Date.now()}-${Math.random().toString(36).substr(2,9)}`}validateSubmissionData(e,t,a,r){const o=[];if(!r){o.push("location")}if(!a){o.push("plan")}if(!t){o.push("contract")}if(!e){o.push("formData")}else{if(!e.personal.firstName)o.push("firstName");if(!e.personal.lastName)o.push("lastName");if(!e.personal.secondLastName)o.push("secondLastName");if(!e.personal.identificationNumber)o.push("identificationNumber");if(!e.personal.identificationExpiration)o.push("identificationExpiration");if(!e.personal.phone1)o.push("phone1");if(!e.personal.email)o.push("email");if(!e.business.businessName)o.push("businessName");if(!e.business.position)o.push("position");if(!e.address.address)o.push("address");if(!e.address.city)o.push("city");if(!e.address.zipCode)o.push("zipCode")}return{isValid:o.length===0,missingFields:o}}}const N=new z;const T={DEFAULT_CENTER:{lat:18.333036,lng:-66.4161211},DEFAULT_ZOOM:17,MAP_ID:"8481b97098c495ab",DEFAULT_MAP_TYPE:"satellite"};const O={NO_COVERAGE:"¡Fuera de área! Por el momento no contamos con cobertura en tu zona.",COVERAGE_ERROR:"Error al verificar la cobertura. Por favor, intenta de nuevo.",REQUEST_ERROR:"¡Lo sentimos, ha ocurrido un error en el proceso de solicitud! En este momento estamos presentando inconvenientes en nuestro sistema. Por favor, inténtalo nuevamente.",GEOLOCATION_DENIED:"Permiso de ubicación denegado. Por favor, permite el acceso a tu ubicación.",GEOLOCATION_UNAVAILABLE:"No se pudo obtener tu ubicación. Por favor, ingresa tu dirección manualmente.",GEOLOCATION_TIMEOUT:"Tiempo de espera agotado al obtener tu ubicación."};const M={REQUEST_SUCCESS:"¡Tu solicitud fue enviada con éxito!",REQUEST_SUCCESS_SUBTITLE:"Pronto nos comunicaremos contigo."};class L{apiKey="";isLoaded=false;loadPromise=null;map=null;marker=null;autocomplete=null;infoWindow=null;setApiKey(e){this.apiKey=e}async loadGoogleMaps(){if(this.isLoaded){return}if(this.loadPromise){return this.loadPromise}if(!this.apiKey){throw new Error("Google Maps API key is required")}this.loadPromise=new Promise(((e,t)=>{if(window.google?.maps){this.isLoaded=true;e();return}const a=document.createElement("script");a.src=`https://maps.googleapis.com/maps/api/js?key=${this.apiKey}&libraries=places,marker&v=weekly`;a.async=true;a.defer=true;a.onload=()=>{this.isLoaded=true;e()};a.onerror=()=>{t(new Error("Failed to load Google Maps API"))};document.head.appendChild(a)}));return this.loadPromise}isGoogleMapsLoaded(){return this.isLoaded&&!!window.google?.maps}async initMap(e,t){await this.loadGoogleMaps();const a={center:T.DEFAULT_CENTER,zoom:T.DEFAULT_ZOOM,mapTypeId:T.DEFAULT_MAP_TYPE,mapId:T.MAP_ID,disableDefaultUI:false,zoomControl:true,mapTypeControl:true,mapTypeControlOptions:{style:google.maps.MapTypeControlStyle.HORIZONTAL_BAR,position:google.maps.ControlPosition.LEFT_TOP,mapTypeIds:["roadmap","satellite"]},streetViewControl:false,fullscreenControl:false};this.map=new google.maps.Map(e,{...a,...t});return this.map}getMap(){return this.map}centerMap(e){if(this.map){this.map.setCenter(e)}}setZoom(e){if(this.map){this.map.setZoom(e)}}async setMarker(e){if(!this.map){throw new Error("Map not initialized")}if(this.marker){this.marker.map=null}const{AdvancedMarkerElement:t}=await google.maps.importLibrary("marker");this.marker=new t({map:this.map,position:e,gmpDraggable:true});this.map.setCenter(e)}addMapClickListener(e){if(!this.map){console.warn("Map not initialized");return}this.map.addListener("click",(t=>{if(t.latLng){const a={lat:t.latLng.lat(),lng:t.latLng.lng()};e(a)}}))}clear(){this.removeMarker()}getMarkerPosition(){if(!this.marker?.position){return null}const e=this.marker.position;return{lat:e.lat,lng:e.lng}}removeMarker(){if(this.marker){this.marker.map=null;this.marker=null}}showInfoWindow(e,t){if(!this.map||!this.marker){console.warn("Map or marker not initialized");return}this.closeInfoWindow();const a=`<style>\n      .gm-ui-hover-effect { display: none !important; }\n      .gm-style .gm-style-iw-c { padding: 0px !important; width: 600px !important; max-width: none !important; }\n      .gm-style .gm-style-iw-d { padding: 0px !important; overflow: unset !important; width: 100% !important; max-width: none !important; }\n      .gm-style .gm-style-iw-tc { display: none !important; }\n      .gm-style-iw { width: 600px !important; max-width: none !important; }\n    </style>`;this.infoWindow=new google.maps.InfoWindow({content:a+e,maxWidth:600});this.infoWindow.open({anchor:this.marker,map:this.map});this.infoWindow.addListener("domready",(()=>{setTimeout((()=>{const e=document.querySelector(".gm-style-iw-c");const t=document.querySelector(".gm-style-iw-d");if(e){e.style.setProperty("width","600px","important");e.style.setProperty("max-width","none","important");e.style.setProperty("padding","0","important")}if(t){t.style.setProperty("width","100%","important");t.style.setProperty("max-width","none","important");t.style.setProperty("overflow","visible","important")}const a=document.querySelector(".gm-style-iw");if(a){a.style.setProperty("width","600px","important");a.style.setProperty("max-width","none","important")}}),50)}));if(t){window.__infoWindowContinueCallback=t}}closeInfoWindow(){if(this.infoWindow){this.infoWindow.close();this.infoWindow=null}}getInfoWindow(){return this.infoWindow}async initAutocomplete(e,t){await this.loadGoogleMaps();const a={componentRestrictions:{country:"pr"},fields:["address_components","geometry","formatted_address"],types:["address"]};this.autocomplete=new google.maps.places.Autocomplete(e,a);this.autocomplete.addListener("place_changed",(()=>{const e=this.autocomplete?.getPlace();if(!e?.geometry?.location){return}const a=this.parseAddressComponents(e);t(a);if(this.map){this.centerMap(a.coordinates);this.setMarker(a.coordinates)}}))}parseAddressComponents(e){const t=e.address_components||[];let a="";let r="";let o="";let i="";for(const e of t){const t=e.types[0];switch(t){case"street_number":a=e.long_name;break;case"route":r=e.long_name;break;case"locality":case"administrative_area_level_2":o=o||e.long_name;break;case"postal_code":i=e.long_name;break}}const n=[a,r].filter(Boolean).join(" ");const s=e.geometry?.location;return{address:n,city:o,zipCode:i,coordinates:{lat:s?.lat()||0,lng:s?.lng()||0},formattedAddress:e.formatted_address||""}}async geocodeAddress(e){await this.loadGoogleMaps();const t=new google.maps.Geocoder;return new Promise((a=>{t.geocode({address:e,componentRestrictions:{country:"pr"}},((e,t)=>{if(t==="OK"&&e&&e[0]){const t=e[0];const r=this.parseGeocoderResult(t);a(r)}else{a(null)}}))}))}async reverseGeocode(e){await this.loadGoogleMaps();const t=new google.maps.Geocoder;return new Promise((a=>{t.geocode({location:e},((e,t)=>{if(t==="OK"&&e&&e[0]){const t=e[0];const r=this.parseGeocoderResult(t);a(r)}else{a(null)}}))}))}parseGeocoderResult(e){const t=e.address_components||[];let a="";let r="";let o="";let i="";for(const e of t){const t=e.types[0];switch(t){case"street_number":a=e.long_name;break;case"route":r=e.long_name;break;case"locality":case"administrative_area_level_2":o=o||e.long_name;break;case"postal_code":i=e.long_name;break}}const n=[a,r].filter(Boolean).join(" ");const s=e.geometry.location;return{address:n,city:o,zipCode:i,coordinates:{lat:s.lat(),lng:s.lng()},formattedAddress:e.formatted_address}}async getCurrentLocation(){return new Promise(((e,t)=>{if(!navigator.geolocation){t(new Error("Geolocation is not supported by this browser"));return}navigator.geolocation.getCurrentPosition((t=>{e({lat:t.coords.latitude,lng:t.coords.longitude})}),(e=>{let a="Error getting location";switch(e.code){case e.PERMISSION_DENIED:a="Location permission denied";break;case e.POSITION_UNAVAILABLE:a="Location information unavailable";break;case e.TIMEOUT:a="Location request timed out";break}t(new Error(a))}),{enableHighAccuracy:true,timeout:1e4,maximumAge:0})}))}async getCurrentLocationWithAddress(){const e=await this.getCurrentLocation();return this.reverseGeocode(e)}destroy(){this.closeInfoWindow();this.removeMarker();this.autocomplete=null;this.map=null}}const R=new L;class B{HOGAR_CATALOGUE_ID=6;DEFAULT_PAGE_ITEMS=300;FILTER_INTERNET_TELEFONIA="39";FILTER_INTERNET_INALAMBRICO="23";async listCatalogue(e=this.FILTER_INTERNET_INALAMBRICO,t=1,a="",r="",o=""){await S.ensureToken();const i={catalogId:this.HOGAR_CATALOGUE_ID,pageNo:t,pageItems:this.DEFAULT_PAGE_ITEMS,creditClass:"C",orderBy:7,news:0,offers:"0",categoryID:"0",brand:r,filter:a,price:o,labels:[]};console.log("[CatalogueService] Request:",JSON.stringify(i));const n=await w.post("api/Catalogue/listCatalogue",i);console.log("[CatalogueService] API Response keys:",Object.keys(n||{}));if(n.hasError){throw new Error(n.message||"Failed to fetch catalogue")}const s=parseInt(e,10);const c=this.extractProductsFromSubcatalog(n,this.HOGAR_CATALOGUE_ID,s);console.log("[CatalogueService] Extracted products:",c.length);return{hasError:false,products:c,totalItems:c.length}}extractProductsFromSubcatalog(e,t,a){if(!e.catalogs||!Array.isArray(e.catalogs)){console.log("[CatalogueService] No catalogs in response");return[]}const r=e.catalogs.find((e=>e.catalogId===t));if(!r){console.log("[CatalogueService] Parent catalog not found:",t);for(const t of e.catalogs){if(t.catalog){const e=t.catalog.find((e=>e.catalogId===a));if(e){console.log("[CatalogueService] Found subcatalog in:",t.catalogId);return e.products||[]}}}return[]}console.log("[CatalogueService] Found parent catalog:",r.catalogId,r.catalogName);if(!r.catalog||!Array.isArray(r.catalog)){console.log("[CatalogueService] No subcatalogs in parent");return r.products||[]}const o=r.catalog.find((e=>e.catalogId===a));if(!o){console.log("[CatalogueService] Subcatalog not found:",a);console.log("[CatalogueService] Available subcatalogs:",r.catalog.map((e=>({id:e.catalogId,name:e.catalogName}))));return r.catalog[0]?.products||[]}console.log("[CatalogueService] Found subcatalog:",o.catalogId,o.catalogName);return o.products||[]}_findCatalogById(e,t){const a=[...e];while(a.length>0){const e=a.shift();if(e.catalogId===t){return e}if(e.catalog&&e.catalog.length>0){a.push(...e.catalog)}}return null}getProductTypeFilters(){return[{value:this.FILTER_INTERNET_TELEFONIA,label:"Internet + Telefonía"},{value:this.FILTER_INTERNET_INALAMBRICO,label:"Internet Inalámbrico"}]}formatInstallmentPrice(e){return`$${e.toFixed(2)}/mes`}formatRegularPrice(e){return`$${e.toFixed(2)}`}calculateInstallment(e,t){if(t<=0)return e;return Number((e/t).toFixed(2))}cleanDescription(e){if(!e)return"";return e.replace(/<[^>]*>/g,"").trim()}truncateText(e,t=80){if(!e||e.length<=t)return e;return e.substring(0,t).trim()+"..."}parseColors(e){if(!e||!Array.isArray(e))return[];return e.map((e=>e.webColor)).filter(Boolean)}storeProductInSession(e){try{sessionStorage.setItem("selectedProduct",JSON.stringify(e));sessionStorage.setItem("productId",String(e.productId))}catch(e){console.error("[CatalogueService] Error storing product in session:",e)}}getStoredProduct(){try{const e=sessionStorage.getItem("selectedProduct");return e?JSON.parse(e):null}catch{return null}}clearProduct(){sessionStorage.removeItem("selectedProduct");sessionStorage.removeItem("productId")}}const j=new B;const U={CART:"cart",CART_ID:"cartId",MAIN_ID:"mainId",DISCOUNT_COUPON:"discountCoupon",CART_TOTAL:"cartTotal",CART_PRODUCTS:"cartProducts"};const q={HOME:6};const $="C";class J{async getCart(e=""){try{await S.ensureToken();const t=e||this.getDiscountCoupon()||"";const a={promoCode:t};console.log("[CartService] Getting cart with promo:",t||"none");const r=await w.post("api/Card/getCart",a);if(r.hasError){console.error("[CartService] API error:",r.message);return{hasError:true,message:r.message||"Error al obtener el carrito",errorDisplay:r.errorDisplay}}this.storeCartInSession(r);return r}catch(e){console.error("[CartService] Exception:",e);return{hasError:true,message:"Error de conexión al obtener el carrito"}}}async addToCart(e,t,a=1,r,o){try{await S.ensureToken();const i=S.getToken()||"";const n={token:i,productId:String(e.productId),notificationDetailID:0,chvSource:"",promoCode:"",installments:t,decPrice:e.update_price||0,decDeposit:0,decDownPayment:e.decDownPayment||0,decTotalPrice:e.regular_price||0,Qty:a,flowId:q.HOME,ssoToken:"",userID:"0",parentProductId:o||0,parentCartId:r||0,creditClass:$,downgradeAllowed:false,pendingAccelerated:0,acceletartedAmount:0,pastDueAmount:0,delicuency:false};const s=JSON.stringify([n]);const c={cartItems:s};console.log("[CartService] Adding to cart:",e.productName);console.log("[CartService] Request payload:",c);const l=await w.post("api/Card/addToCart",c);if(l.hasError){console.error("[CartService] Add to cart error:",l.message);return{code:0,hasError:true,message:l.message||"Error al agregar al carrito",errorDisplay:l.errorDisplay}}if(l.code){this.storeMainId(l.code)}console.log("[CartService] Added to cart, mainId:",l.code);return l}catch(e){console.error("[CartService] Exception:",e);return{code:0,hasError:true,message:"Error de conexión al agregar al carrito"}}}async addPlanToCart(e,t,a){try{await S.ensureToken();const r=S.getToken()||"";const o={token:r,productId:String(e.planId),notificationDetailID:0,chvSource:"",promoCode:"",installments:1,decPrice:e.decSalePrice||e.decPrice,decDeposit:0,decDownPayment:0,decTotalPrice:e.decPrice,Qty:1,flowId:q.HOME,ssoToken:"",userID:"0",parentProductId:a,parentCartId:t,creditClass:$,downgradeAllowed:false,pendingAccelerated:0,acceletartedAmount:0,pastDueAmount:0,delicuency:false};const i=JSON.stringify([o]);const n={cartItems:i};console.log("[CartService] Adding plan to cart:",e.planName);const s=await w.post("api/Card/addToCart",n);if(s.hasError){console.error("[CartService] Add plan error:",s.message);return{code:0,hasError:true,message:s.message||"Error al agregar el plan",errorDisplay:s.errorDisplay}}console.log("[CartService] Plan added to cart");return s}catch(e){console.error("[CartService] Exception:",e);return{code:0,hasError:true,message:"Error de conexión al agregar el plan"}}}async deleteItem(e,t){try{await S.ensureToken();const a={cartId:e,productId:t};console.log("[CartService] Deleting item:",e,t);const r=await w.post("api/Card/deleteItem",a);if(r.hasError){console.error("[CartService] Delete error:",r.message);return{hasError:true,message:r.message||"Error al eliminar del carrito"}}console.log("[CartService] Item deleted successfully");return{hasError:false}}catch(e){console.error("[CartService] Exception:",e);return{hasError:true,message:"Error de conexión al eliminar del carrito"}}}async clearCart(){try{const e=await this.getCart();if(e.hasError||!e.products?.length){return{hasError:false}}for(const t of e.products){const e=await this.deleteItem(t.cartId,t.productId);if(e.hasError){return e}}this.clearCartSession();return{hasError:false}}catch(e){console.error("[CartService] Clear cart error:",e);return{hasError:true,message:"Error al limpiar el carrito"}}}storeCartInSession(e){try{sessionStorage.setItem(U.CART,JSON.stringify(e));if(e.totalPrice!==undefined){sessionStorage.setItem(U.CART_TOTAL,String(e.totalPrice))}if(e.products){sessionStorage.setItem(U.CART_PRODUCTS,JSON.stringify(e.products))}}catch(e){console.error("[CartService] Error storing cart:",e)}}getCachedCart(){try{const e=sessionStorage.getItem(U.CART);return e?JSON.parse(e):null}catch{return null}}storeMainId(e){try{sessionStorage.setItem(U.MAIN_ID,String(e))}catch(e){console.error("[CartService] Error storing mainId:",e)}}getMainId(){try{const e=sessionStorage.getItem(U.MAIN_ID);return e?parseInt(e,10):null}catch{return null}}storeDiscountCoupon(e){try{sessionStorage.setItem(U.DISCOUNT_COUPON,e)}catch(e){console.error("[CartService] Error storing coupon:",e)}}getDiscountCoupon(){try{return sessionStorage.getItem(U.DISCOUNT_COUPON)}catch{return null}}clearDiscountCoupon(){try{sessionStorage.removeItem(U.DISCOUNT_COUPON)}catch(e){console.error("[CartService] Error clearing coupon:",e)}}clearCartSession(){try{Object.values(U).forEach((e=>{sessionStorage.removeItem(e)}));console.log("[CartService] Cleared cart session")}catch(e){console.error("[CartService] Error clearing session:",e)}}calculateTotals(e){let t=0;let a=0;e.forEach((e=>{t+=(e.decPrice||0)*e.qty;a+=(e.decTotalPerMonth||e.decPrice||0)*e.qty}));const r=.115;const o=t*r;const i=t+o;return{subtotal:Number(t.toFixed(2)),tax:Number(o.toFixed(2)),total:Number(i.toFixed(2)),monthlyPayment:Number(a.toFixed(2))}}getEquipmentItems(e){return e.filter((e=>e.equipment===true||e.home===true))}getPlanItems(e){return e.filter((e=>e.plan===true))}hasEquipment(e){return e.some((e=>e.equipment===true||e.home===true))}hasPlan(e){return e.some((e=>e.plan===true))}getItemCount(e){return e.reduce(((e,t)=>e+t.qty),0)}formatPrice(e){return`$${e.toFixed(2)}`}}const G=new J;const V={SELECTED_PRODUCT:"selectedProduct",PRODUCT_ID:"productId",MAIN_ID:"mainId",CHILDREN_ID:"childrenId",PARENT_ID:"parentId",DEVICE_TYPE:"deviceType",SELECTED_COLOR:"selectedColor",SELECTED_STORAGE:"selectedStorage",SUBCATALOG_ID:"subcatalogId"};const H=1;class Y{extractStockAndImagesFromColors(e){const t=[];let a=undefined;let r=undefined;let o=false;if(!e||e.length===0){console.log("[ProductService] No colors array in response, stock will be undefined");return{stock:a,images:t,childrenId:r}}for(let i=0;i<e.length;i++){const n=e[i];if(!n.storages||n.storages.length===0)continue;for(let e=0;e<n.storages.length;e++){const i=n.storages[e];if(!i.products||i.products.length===0)continue;const s=i.products[0];if(n.defaultColor&&i.defaultStorage){if(s.stock!==undefined&&s.stock>H){a=s.stock;r=s.productId;o=true;if(s.imgUrl)t.push(s.imgUrl);if(s.side_image)t.push(s.side_image);if(s.back_image)t.push(s.back_image);console.log("[ProductService] Found default with stock:",a,"childrenId:",r);break}}}if(o)break}if(!o){for(let i=0;i<e.length;i++){const n=e[i];if(!n.storages||n.storages.length===0)continue;for(let e=0;e<n.storages.length;e++){const i=n.storages[e];if(!i.products||i.products.length===0)continue;const s=i.products[0];if(s.stock!==undefined&&s.stock>H){a=s.stock;r=s.productId;o=true;if(s.imgUrl)t.push(s.imgUrl);if(s.side_image)t.push(s.side_image);if(s.back_image)t.push(s.back_image);console.log("[ProductService] Found any with stock:",a,"childrenId:",r);break}}if(o)break}}if(a===undefined&&e.length>0){const o=e[0];if(o.storages&&o.storages.length>0){const e=o.storages[0];if(e.products&&e.products.length>0){const o=e.products[0];a=o.stock;r=o.productId;if(o.imgUrl)t.push(o.imgUrl);if(o.side_image)t.push(o.side_image);if(o.back_image)t.push(o.back_image);console.log("[ProductService] Using first product stock:",a,"childrenId:",r)}}}return{stock:a,images:t,childrenId:r}}async getEquipmentDetail(e){try{await S.ensureToken();const t=S.getToken()||"";const a={productId:e,userID:0,token:t};console.log("[ProductService] Fetching equipment detail:",e);const r=await w.post("api/Catalogue/equipmentDetail",a);if(r.hasError){console.error("[ProductService] API error:",r.message);return{hasError:true,message:r.message||"Error al cargar el detalle del producto",errorDisplay:r.errorDisplay}}const{stock:o,images:i,childrenId:n}=this.extractStockAndImagesFromColors(r.colors);const s=[];if(r.imgUrl)s.push(r.imgUrl);if(r.detailImage&&r.detailImage!==r.imgUrl){s.push(r.detailImage)}i.forEach((e=>{if(e&&!s.includes(e)){s.push(e)}}));if(r.images?.length){r.images.forEach((e=>{if(e&&!s.includes(e)){s.push(e)}}))}const c=o!==undefined?o:r.stock;const l={productId:r.productId||e,productName:r.productName||"",brandName:r.brandName,imgUrl:r.imgUrl||"",detailImage:r.detailImage,images:s.length>0?s:undefined,shortDescription:r.shortDescription,longDescription:r.longDescription,regular_price:r.regular_price||0,update_price:r.update_price||0,installments:r.installments||0,decDownPayment:r.decDownPayment,decDeposit:r.decDeposit,creditClass:r.creditClass,colors:r.colors,storages:r.storages,specifications:r.specifications,features:r.features,catalogId:r.catalogId,home:r.home,stock:c};console.log("[ProductService] Product stock from nested structure:",o,"root:",r.stock,"final:",c);if(n){this.storeChildrenId(n);console.log("[ProductService] Stored childrenId from colors:",n)}this.storeMainId(e);return{hasError:false,product:l}}catch(e){console.error("[ProductService] Exception:",e);return{hasError:true,message:"Error de conexión al cargar el detalle del producto"}}}storeMainId(e){try{sessionStorage.setItem(V.MAIN_ID,String(e));console.log("[ProductService] Stored mainId:",e)}catch(e){console.error("[ProductService] Error storing mainId:",e)}}getMainId(){try{const e=sessionStorage.getItem(V.MAIN_ID);return e?parseInt(e,10):null}catch{return null}}storeSelectedProduct(e,t){try{sessionStorage.setItem(V.SELECTED_PRODUCT,JSON.stringify(e));sessionStorage.setItem(V.PRODUCT_ID,String(e.productId));if(t){sessionStorage.setItem(V.SUBCATALOG_ID,String(t));console.log("[ProductService] Stored subcatalogId:",t)}console.log("[ProductService] Stored selected product:",e.productName)}catch(e){console.error("[ProductService] Error storing product:",e)}}storeSubcatalogId(e){try{sessionStorage.setItem(V.SUBCATALOG_ID,String(e));console.log("[ProductService] Stored subcatalogId:",e)}catch(e){console.error("[ProductService] Error storing subcatalogId:",e)}}getSubcatalogId(){try{const e=sessionStorage.getItem(V.SUBCATALOG_ID);return e?parseInt(e,10):0}catch{return 0}}getSelectedProduct(){try{const e=sessionStorage.getItem(V.SELECTED_PRODUCT);return e?JSON.parse(e):null}catch{return null}}getProductId(){try{const e=sessionStorage.getItem(V.PRODUCT_ID);return e?parseInt(e,10):null}catch{return null}}storeSelectedColor(e,t,a){try{const r={colorId:e,colorName:t,webColor:a};sessionStorage.setItem(V.SELECTED_COLOR,JSON.stringify(r))}catch(e){console.error("[ProductService] Error storing color:",e)}}getSelectedColor(){try{const e=sessionStorage.getItem(V.SELECTED_COLOR);return e?JSON.parse(e):null}catch{return null}}storeSelectedStorage(e,t){try{const a={storageId:e,storageName:t};sessionStorage.setItem(V.SELECTED_STORAGE,JSON.stringify(a))}catch(e){console.error("[ProductService] Error storing storage:",e)}}getSelectedStorage(){try{const e=sessionStorage.getItem(V.SELECTED_STORAGE);return e?JSON.parse(e):null}catch{return null}}storeChildrenId(e){try{sessionStorage.setItem(V.CHILDREN_ID,String(e))}catch(e){console.error("[ProductService] Error storing childrenId:",e)}}getChildrenId(){try{const e=sessionStorage.getItem(V.CHILDREN_ID);return e?parseInt(e,10):null}catch{return null}}storeParentId(e){try{sessionStorage.setItem(V.PARENT_ID,String(e))}catch(e){console.error("[ProductService] Error storing parentId:",e)}}getParentId(){try{const e=sessionStorage.getItem(V.PARENT_ID);return e?parseInt(e,10):null}catch{return null}}storeDeviceType(e){try{sessionStorage.setItem(V.DEVICE_TYPE,e)}catch(e){console.error("[ProductService] Error storing deviceType:",e)}}getDeviceType(){try{return sessionStorage.getItem(V.DEVICE_TYPE)}catch{return null}}clearProductSession(){try{Object.values(V).forEach((e=>{sessionStorage.removeItem(e)}));console.log("[ProductService] Cleared product session")}catch(e){console.error("[ProductService] Error clearing session:",e)}}formatPrice(e){return`$${e.toFixed(2)}`}formatInstallmentPrice(e){return`$${e.toFixed(2)}/mes`}calculateInstallment(e,t){if(t<=0)return e;return Number((e/t).toFixed(2))}cleanDescription(e){if(!e)return"";return e.replace(/<[^>]*>/g,"").trim()}isHomeProduct(e){return e.home===true||e.catalogId===6}}const W=new Y;const X={get(e){try{const t=sessionStorage.getItem(e);return t}catch{return null}},set(e,t){try{sessionStorage.setItem(e,t)}catch(e){console.error("[StorageUtils] Error setting value:",e)}},getJSON(e){try{const t=sessionStorage.getItem(e);if(!t)return null;return JSON.parse(t)}catch{return null}},setJSON(e,t){try{sessionStorage.setItem(e,JSON.stringify(t))}catch(e){console.error("[StorageUtils] Error setting JSON value:",e)}},remove(e){try{sessionStorage.removeItem(e)}catch(e){console.error("[StorageUtils] Error removing value:",e)}},clear(){try{sessionStorage.clear()}catch(e){console.error("[StorageUtils] Error clearing storage:",e)}},getEncoded(e){try{const t=sessionStorage.getItem(e);if(!t)return null;return atob(t)}catch{return null}},setEncoded(e,t){try{sessionStorage.setItem(e,btoa(t))}catch(e){console.error("[StorageUtils] Error setting encoded value:",e)}},getEncodedJSON(e){try{const t=sessionStorage.getItem(e);if(!t)return null;const a=atob(t);return JSON.parse(a)}catch{return null}},setEncodedJSON(e,t){try{const a=JSON.stringify(t);sessionStorage.setItem(e,btoa(a))}catch(e){console.error("[StorageUtils] Error setting encoded JSON value:",e)}}};const K=[{label:"Adjuntas",value:"00601"},{label:"Adjuntas",value:"00631"},{label:"Aguada",value:"00602"},{label:"Aguadilla",value:"00603"},{label:"Aguadilla",value:"00604"},{label:"Aguadilla",value:"00605"},{label:"Aguadilla",value:"00690"},{label:"Aguas Buenas",value:"00703"},{label:"Aibonito",value:"00705"},{label:"La Plata",value:"00786"},{label:"Añasco",value:"00610"},{label:"Angeles",value:"00611"},{label:"Arecibo",value:"00612"},{label:"Arecibo",value:"00613"},{label:"Arecibo",value:"00614"},{label:"Arecibo",value:"00616"},{label:"Arecibo",value:"00652"},{label:"Arecibo",value:"00688"},{label:"Arroyo",value:"00714"},{label:"Barceloneta",value:"00617"},{label:"Barranquitas",value:"00794"},{label:"Bayamón",value:"00956"},{label:"Bayamón",value:"00957"},{label:"Bayamón",value:"00959"},{label:"Bayamón",value:"00961"},{label:"Bayamón",value:"00958"},{label:"Cabo Rojo",value:"00623"},{label:"Boquerón",value:"00622"},{label:"Caguas",value:"00725"},{label:"Caguas",value:"00727"},{label:"Caguas",value:"00726"},{label:"Camuy",value:"00627"},{label:"Canóvanas",value:"00729"},{label:"Canóvanas",value:"00745"},{label:"Carolina",value:"00979"},{label:"Carolina",value:"00982"},{label:"Carolina",value:"00983"},{label:"Carolina",value:"00985"},{label:"Carolina",value:"00987"},{label:"Carolina",value:"00981"},{label:"Carolina",value:"00984"},{label:"Carolina",value:"00986"},{label:"Carolina",value:"00988"},{label:"Cataño",value:"00962"},{label:"Cataño",value:"00963"},{label:"Cayey",value:"00736"},{label:"Cayey",value:"00737"},{label:"Ceiba",value:"00735"},{label:"Ceiba",value:"00742"},{label:"Ciales",value:"00638"},{label:"Cidra",value:"00739"},{label:"Coamo",value:"00769"},{label:"Comerio",value:"00782"},{label:"Corozal",value:"00783"},{label:"Culebra",value:"00775"},{label:"Dorado",value:"00646"},{label:"Fajardo",value:"00738"},{label:"Fajardo",value:"00740"},{label:"Florida",value:"00650"},{label:"Guánica",value:"00653"},{label:"Guánica",value:"00647"},{label:"Guayama",value:"00784"},{label:"Guayama",value:"00704"},{label:"Guayama",value:"00785"},{label:"Guayanilla",value:"00656"},{label:"Guaynabo",value:"00965"},{label:"Guaynabo",value:"00966"},{label:"Guaynabo",value:"00968"},{label:"Guaynabo",value:"00971"},{label:"Guaynabo",value:"00970"},{label:"Guaynabo",value:"00969"},{label:"Gurabo",value:"00778"},{label:"Hatillo",value:"00659"},{label:"Hormigueros",value:"00660"},{label:"Humacao",value:"00791"},{label:"Humacao",value:"00792"},{label:"Humacao",value:"00741"},{label:"Isabela",value:"00662"},{label:"Jayuya",value:"00664"},{label:"Juana Díaz",value:"00795"},{label:"Juncos",value:"00777"},{label:"Lajas",value:"00667"},{label:"Lares",value:"00669"},{label:"Las Marías",value:"00670"},{label:"Las Piedras",value:"00771"},{label:"Loíza",value:"00772"},{label:"Luquillo",value:"00773"},{label:"Manatí",value:"00674"},{label:"Maricao",value:"00606"},{label:"Maunabo",value:"00707"},{label:"Mayaguez",value:"00680"},{label:"Mayaguez",value:"00682"},{label:"Mayaguez",value:"00681"},{label:"Moca",value:"00676"},{label:"Morovis",value:"00687"},{label:"Naguabo",value:"00718"},{label:"Rio Blanco",value:"00744"},{label:"Naranjito",value:"00719"},{label:"Orocovis",value:"00720"},{label:"Patillas",value:"00723"},{label:"Peñuelas",value:"00624"},{label:"Ponce",value:"00716"},{label:"Ponce",value:"00717"},{label:"Ponce",value:"00728"},{label:"Ponce",value:"00730"},{label:"Ponce",value:"00731"},{label:"Ponce",value:"00733"},{label:"Ponce",value:"00780"},{label:"Ponce",value:"00715"},{label:"Ponce",value:"00732"},{label:"Ponce",value:"00734"},{label:"Quebradillas",value:"00678"},{label:"Rincón",value:"00677"},{label:"Río Grande",value:"00721"},{label:"Río Grande",value:"00745"},{label:"Sabana Grande",value:"00637"},{label:"Salinas",value:"00751"},{label:"San Germán",value:"00683"},{label:"San Germán",value:"00636"},{label:"San Juan",value:"00921"},{label:"San Juan",value:"00923"},{label:"San Juan",value:"00924"},{label:"San Juan",value:"00929"},{label:"San Juan",value:"00915"},{label:"San Juan",value:"00916"},{label:"San Juan",value:"00920"},{label:"San Juan",value:"00909"},{label:"San Juan",value:"00910"},{label:"Fort Buchanan",value:"00934"},{label:"San Juan",value:"00936"},{label:"San Juan",value:"00917"},{label:"San Juan",value:"00919"},{label:"San Juan",value:"00911"},{label:"San Juan",value:"00912"},{label:"San Juan",value:"00913"},{label:"San Juan",value:"00914"},{label:"San Juan",value:"00940"},{label:"San Juan",value:"00901"},{label:"San Juan",value:"00902"},{label:"San Juan",value:"00906"},{label:"San Juan",value:"00925"},{label:"San Juan",value:"00926"},{label:"San Juan",value:"00927"},{label:"San Juan",value:"00928"},{label:"San Juan",value:"00930"},{label:"San Juan",value:"00907"},{label:"San Juan",value:"00908"},{label:"San Juan",value:"00931"},{label:"San Juan",value:"00933"},{label:"San Lorenzo",value:"00754"},{label:"San Sebastián",value:"00685"},{label:"Santa Isabel",value:"00757"},{label:"Toa Alta",value:"00953"},{label:"Toa Alta",value:"00954"},{label:"Toa Baja",value:"00949"},{label:"Toa Baja",value:"00950"},{label:"Toa Baja",value:"00951"},{label:"Toa Baja",value:"00952"},{label:"Trujillo Alto",value:"00976"},{label:"Trujillo Alto",value:"00977"},{label:"Saint Just",value:"00978"},{label:"Utuado",value:"00641"},{label:"Utuado",value:"00611"},{label:"Vega Alta",value:"00692"},{label:"Vega Baja",value:"00693"},{label:"Vega Baja",value:"00694"},{label:"Vieques",value:"00765"},{label:"Villalba",value:"00766"},{label:"Yabucoa",value:"00767"},{label:"Yauco",value:"00698"}];const Z=["PO BOX","P.O. BOX","P O BOX","HC ","RR ","APARTADO"];const Q={SHIPMENT_ID:"shipmentId",ZIP_CODE:"zipCode",SHIPPING_ADDRESS:"shippingAddress",DELIVERY_METHOD:"deliveryMethodInfo"};class ee{http;constructor(){this.http=w}async createAddress(e,t="6"){const a=X.get("wBCUserID")||"0";const r=S.getToken();const o=new FormData;o.append("token",r);o.append("flowId",t);o.append("userId",a);o.append("name",e.name);o.append("email",e.email);o.append("phone",this.cleanPhoneNumber(e.phone));o.append("phone2",this.cleanPhoneNumber(e.phone2||""));o.append("address1",e.address1);o.append("address2",e.address2||"");o.append("city",e.city);o.append("zip",e.zip+"-0000");o.append("state",e.state);o.append("town",e.city);o.append("notes",e.notes||"");o.append("chvAuthorizerName",e.authorizerName||"");o.append("chvAuthorizerPhone",this.cleanPhoneNumber(e.authorizerPhone||""));try{const t=await this.http.postFormData("api/Address/create",o);if(!t.hasError&&t.response){this.setShipmentId(t.response);this.setZipCode(e.zip);this.storeShippingAddress(e)}return t}catch(e){console.error("[ShippingService] Create address error:",e);return{hasError:true,message:"Error al crear la dirección de envío"}}}async getDeliveryMethods(){const e=S.getToken();const t=new FormData;t.append("token",e);try{const e=await this.http.postFormData("api/Address/getDeliveryMethods",t);return e}catch(e){console.error("[ShippingService] Get delivery methods error:",e);return{hasError:true,errorDesc:"Error al obtener métodos de entrega"}}}getShipmentId(){const e=X.get(Q.SHIPMENT_ID);return e?parseInt(e,10):0}setShipmentId(e){X.set(Q.SHIPMENT_ID,e.toString())}getZipCode(){return X.get(Q.ZIP_CODE)||""}setZipCode(e){X.set(Q.ZIP_CODE,e)}storeShippingAddress(e){X.setJSON(Q.SHIPPING_ADDRESS,e)}getStoredShippingAddress(){return X.getJSON(Q.SHIPPING_ADDRESS)}storeDeliveryMethod(e){X.setJSON(Q.DELIVERY_METHOD,e)}getStoredDeliveryMethod(){return X.getJSON(Q.DELIVERY_METHOD)}clearShippingData(){X.remove(Q.SHIPMENT_ID);X.remove(Q.ZIP_CODE);X.remove(Q.SHIPPING_ADDRESS);X.remove(Q.DELIVERY_METHOD)}validateZipCode(e){const t=K.find((t=>t.value===e));return t?t.label:null}getMunicipalityByZip(e){return this.validateZipCode(e)||""}getAllZipCodes(){return K}isValidPhysicalAddress(e){const t=e.toUpperCase();return!Z.some((e=>t.includes(e)))}isValidEmail(e){const t=/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/;return t.test(e)}isValidPhone(e){const t=this.cleanPhoneNumber(e);return t.length===10}cleanPhoneNumber(e){return e.replace(/\(|\)|-|\s/g,"")}formatPhoneNumber(e){const t=this.cleanPhoneNumber(e);if(t.length!==10)return e;return`(${t.slice(0,3)}) ${t.slice(3,6)}-${t.slice(6)}`}}const te=new ee;const ae={ORDER_BAN:"orderBan",PAYMENT_RESULT:"paymentResult"};class re{paymentIframeUrl="";setPaymentIframeUrl(e){this.paymentIframeUrl=e}getPaymentIframeUrl(){return this.paymentIframeUrl}async createOrder(e){const t=S.getToken();const a=new FormData;a.append("token",t);a.append("flowId",e.flowId);a.append("frontFlowId",e.frontFlowId);a.append("frontFlowName",e.frontFlowName);a.append("banExisting",e.banExisting||"");a.append("subscriberExisting",e.subscriberExisting||"");a.append("amount",e.amount);a.append("email",e.email);a.append("zipCode",e.zipCode);a.append("deposit",e.deposit);a.append("pastDueAmount",e.pastDueAmount||"0");try{const e=await w.postFormData("api/Orders/creationOfOrder",a);if(!e.hasError&&e.ban){this.storeOrderBan(e.ban)}return e}catch(e){console.error("[PaymentService] Create order error:",e);return{hasError:true,errorDisplay:"Error al crear la orden"}}}async recordPayment(e){const t=S.getToken();const a=new FormData;a.append("token",t);a.append("ban",e.ban);a.append("cardNumber",e.cardNumber);a.append("cardType",e.cardType);a.append("authorizationNumber",e.authorizationNumber);a.append("referenceNumber",e.referenceNumber);a.append("description",e.description);a.append("operationId",e.operationId);a.append("amount",e.amount);a.append("deposit",e.deposit);try{const e=await w.postFormData("api/Payment/record",a);return e}catch(e){console.error("[PaymentService] Record payment error:",e);return{hasError:true,errorDisplay:"Error al registrar el pago"}}}async recordPaymentError(e,t,a,r,o,i,n,s){const c=S.getToken();const l=new FormData;l.append("token",c);l.append("ban",e);l.append("subscriber",t);l.append("description",a);l.append("operationId",r);l.append("deposit",o);l.append("cardType",i);l.append("cardNumber",n);l.append("amount",s);try{return await w.postFormData("api/Payment/error",l)}catch(e){console.error("[PaymentService] Record error error:",e);return{hasError:true}}}async getPaymentIframe(e){try{const t=await w.post("api/Payment/getPaymentIframe",e);return t}catch(e){console.error("[PaymentService] Get iframe error:",e);return{errorInfo:{hasError:true,errorDisplay:"Error al obtener el iframe de pago"}}}}storeOrderBan(e){X.set(ae.ORDER_BAN,e)}getOrderBan(){return X.get(ae.ORDER_BAN)||""}storePaymentResult(e){X.setJSON(ae.PAYMENT_RESULT,e)}getPaymentResult(){return X.getJSON(ae.PAYMENT_RESULT)}clearPaymentData(){X.remove(ae.ORDER_BAN);X.remove(ae.PAYMENT_RESULT)}buildPaymentItems(e){const t=[];if(e.depositAmount&&e.depositAmount>0){t.push({paymentType:"DEPOSIT",amount:e.depositAmount})}if(e.totalDownPayment&&e.totalDownPayment>0){t.push({paymentType:"DOWNPAYMENT",amount:e.totalDownPayment})}if(e.totalTax&&e.totalTax>0){const a=(e.totalPrice||0)-(e.depositAmount||0)-(e.totalDownPayment||0)-(e.installmentAmount||0);if(a>0){t.push({paymentType:"TAXES",amount:Number(a.toFixed(2))})}}if(e.cartUpdateResponse?.acceletartedAmount){t.push({paymentType:"INSTALLMENT",amount:e.cartUpdateResponse.acceletartedAmount})}return t}calculateTotalAmount(e){return e.reduce(((e,t)=>e+t.amount),0)}}const oe=new re;const ie=()=>`@keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes slideUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}@keyframes spin{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}:host{display:block;width:100%;font-family:"AMX", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, sans-serif;color:#333333;line-height:1.5}.fsf-container{width:100%;max-width:1200px;margin:0 auto;padding:1rem}@media (min-width: 768px){.fsf-container{padding:1.5rem}}.fsf-loading{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:300px;padding:2rem}.fsf-loading__spinner{width:48px;height:48px;border:4px solid #E5E5E5;border-top-color:#0097A9;border-radius:50%;animation:spin 1s linear infinite}.fsf-loading__text{margin-top:1rem;font-size:1rem;font-weight:400;line-height:1.5;color:#666666}.fsf-error{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:300px;padding:2rem;text-align:center}.fsf-error__icon{display:flex;align-items:center;justify-content:center;width:64px;height:64px;font-size:1.75rem;font-weight:700;color:#FFFFFF;background-color:#DA291C;border-radius:50%}.fsf-error__title{margin-top:1rem;font-size:1.5rem;font-weight:600;line-height:1.35;color:#333333}.fsf-error__message{margin-top:0.5rem;font-size:1rem;font-weight:400;line-height:1.5;color:#666666;max-width:400px}.fsf-error__button{display:inline-flex;align-items:center;justify-content:center;gap:0.5rem;padding:0 1.5rem;font-family:"AMX", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, sans-serif;font-size:1rem;font-weight:600;line-height:1;text-decoration:none;border:none;border-radius:9999px;cursor:pointer;transition:all 150ms ease}.fsf-error__button:disabled{opacity:0.5;cursor:not-allowed}.fsf-error__button{height:48px;background-color:#DA291C;color:#FFFFFF}.fsf-error__button:hover:not(:disabled){background-color:rgb(181.843902439, 34.2, 23.356097561)}.fsf-error__button:active:not(:disabled){background-color:rgb(163.7658536585, 30.8, 21.0341463415)}.fsf-error__button{margin-top:1.5rem}.step-placeholder{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:400px;padding:2rem;text-align:center;background:#FFFFFF;border-radius:0.75rem;box-shadow:0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);margin:1rem}.step-placeholder h2{font-size:1.75rem;font-weight:700;line-height:1.2;color:#333333;margin-bottom:1rem}.step-placeholder p{font-size:1rem;font-weight:400;line-height:1.5;color:#666666;margin-bottom:1.5rem}.step-placeholder button{display:inline-flex;align-items:center;justify-content:center;gap:0.5rem;padding:0 1.5rem;font-family:"AMX", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, sans-serif;font-size:1rem;font-weight:600;line-height:1;text-decoration:none;border:none;border-radius:9999px;cursor:pointer;transition:all 150ms ease}.step-placeholder button:disabled{opacity:0.5;cursor:not-allowed}.step-placeholder button{height:48px;background-color:#DA291C;color:#FFFFFF}.step-placeholder button:hover:not(:disabled){background-color:rgb(181.843902439, 34.2, 23.356097561)}.step-placeholder button:active:not(:disabled){background-color:rgb(163.7658536585, 30.8, 21.0341463415)}.step-placeholder button{margin:0.5rem}.step-placeholder button:last-child{display:inline-flex;align-items:center;justify-content:center;gap:0.5rem;padding:0 1.5rem;font-family:"AMX", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, sans-serif;font-size:1rem;font-weight:600;line-height:1;text-decoration:none;border:none;border-radius:9999px;cursor:pointer;transition:all 150ms ease}.step-placeholder button:last-child:disabled{opacity:0.5;cursor:not-allowed}.step-placeholder button:last-child{height:48px;background-color:#0097A9;color:#FFFFFF}.step-placeholder button:last-child:hover:not(:disabled){background-color:rgb(0, 114.5455621302, 128.2)}.step-placeholder button:last-child:active:not(:disabled){background-color:rgb(0, 96.3183431953, 107.8)}@keyframes spin{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}`;const ne={LOCATION:1,CATALOGUE:2,PRODUCT_DETAIL:3,PLANS:4,ORDER_SUMMARY:5,SHIPPING:6,PAYMENT:7,CONFIRMATION:8};const se=5;const ce=8;const le=class{constructor(e){a(this,e);this.flowComplete=r(this,"flowComplete");this.flowError=r(this,"flowError");this.flowCancel=r(this,"flowCancel");this.stepChange=r(this,"stepChange")}apiUrl;googleMapsKey;correlationId;initialStep=1;debug=false;currentStep=1;isLoading=true;error=null;isInitialized=false;flowComplete;flowError;flowCancel;stepChange;handleApiUrlChange(e){if(e){w.setBaseUrl(e)}}async componentWillLoad(){if(this.debug){window.__FSF_DEBUG__=true}if(this.apiUrl){w.setBaseUrl(this.apiUrl)}if(this.initialStep){this.currentStep=this.initialStep;_.setStep(this.initialStep)}await this.initializeToken()}componentDidLoad(){this.log("Component loaded")}disconnectedCallback(){this.log("Component disconnected")}async initializeToken(){this.isLoading=true;this.error=null;try{const e=await S.initialize();if(!e){this.error="Error al inicializar la sesión";this.emitError(new Error(this.error),false)}this.isInitialized=true}catch(e){this.error=e.message||"Error de inicialización";this.emitError(e,false)}finally{this.isLoading=false}}handleStepChange=e=>{const t=this.currentStep;const a=this.isClaroHogar()?ce:se;let r;if(e==="forward"){r=Math.min(this.currentStep+1,a);_.nextStep()}else{r=Math.max(this.currentStep-1,1);_.prevStep()}this.currentStep=r;_.setStep(r);this.stepChange.emit({from:t,to:r,direction:e});this.log(`Step changed: ${t} -> ${r}`)};_goToStep=e=>{const t=this.currentStep;const a=e>t?"forward":"backward";_.setStep(e);this.currentStep=e;this.stepChange.emit({from:t,to:e,direction:a});this.log(`Step changed: ${t} -> ${e}`)};handleFlowComplete=e=>{this.log("Flow completed",e);this.flowComplete.emit(e)};handleFlowCancel=()=>{this.log("Flow cancelled");_.resetFlow();this.currentStep=1;_.setStep(1);this.flowCancel.emit()};emitError(e,t=true){this.flowError.emit({step:this.currentStep,error:e,recoverable:t})}log(...e){if(this.debug){console.log("[FixedServiceFlow]",...e)}}isClaroHogar(){const e=g.location?.serviceType?.toUpperCase();return e==="CLARO HOGAR"}renderStep(){const e={onNext:()=>this.handleStepChange("forward"),onBack:()=>this.handleStepChange("backward"),onComplete:this.handleFlowComplete,googleMapsKey:this.googleMapsKey};if(this.isClaroHogar()){this.log("CLARO HOGAR flow - step:",this.currentStep);return this.renderClaroHogarStep(e)}return this.renderStandardStep(e)}renderStandardStep(e){switch(this.currentStep){case 1:return o("step-location",{...e});case 2:return o("step-plans",{...e});case 3:return o("step-contract",{...e});case 4:return o("step-form",{...e});case 5:return o("step-confirmation",{...e,onCancel:this.handleFlowCancel});default:return null}}renderClaroHogarStep(e){switch(this.currentStep){case ne.LOCATION:return o("step-location",{...e});case ne.CATALOGUE:return o("step-catalogue",{...e});case ne.PRODUCT_DETAIL:return o("step-product-detail",{...e});case ne.PLANS:return o("step-plans",{...e});case ne.ORDER_SUMMARY:return o("step-order-summary",{...e});case ne.SHIPPING:return o("step-shipping",{...e});case ne.PAYMENT:return o("step-payment",{...e});case ne.CONFIRMATION:return o("step-confirmation",{...e,onCancel:this.handleFlowCancel});default:return null}}renderLoading(){return o("div",{class:"fsf-loading"},o("div",{class:"fsf-loading__spinner"}),o("p",{class:"fsf-loading__text"},"Cargando..."))}renderError(){return o("div",{class:"fsf-error"},o("div",{class:"fsf-error__icon"},"!"),o("h3",{class:"fsf-error__title"},"Error"),o("p",{class:"fsf-error__message"},this.error),o("button",{class:"fsf-error__button",onClick:()=>this.initializeToken()},"Reintentar"))}render(){if(this.isLoading){return o(i,null,this.renderLoading())}if(this.error&&!this.isInitialized){return o(i,null,this.renderError())}return o(i,null,o("div",{class:"fsf-container"},this.renderStep()))}static get watchers(){return{apiUrl:["handleApiUrlChange"]}}};le.style=ie();const de=()=>`@keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes slideUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}@keyframes spin{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}:host{display:block}.step-catalogue{width:100%;padding:0 1rem}.container-filter{display:grid;grid-gap:10px;padding:20px 0;align-items:center;justify-content:space-between;border-bottom:1px solid #DBDBDB;grid-template-columns:auto 1fr auto}@media (max-width: 991px){.container-filter{grid-template-columns:1fr;gap:15px}}.filter-title-main{margin:0;font-size:24px;font-weight:700;color:#333333}@media (max-width: 991px){.filter-title-main{font-size:20px}}.filter-content{display:flex;gap:10px;align-items:center;justify-content:flex-end}@media (max-width: 991px){.filter-content{width:100%}}.input-filter-wrapper{position:relative;display:flex;align-items:center;width:300px}@media (max-width: 991px){.input-filter-wrapper{flex:1;width:auto}}.search-icon{position:absolute;left:12px;width:20px;height:20px;color:#999999}.input-filter{width:100%;height:40px;padding:8px 12px 8px 40px;font-size:16px;border:1px solid #DBDBDB;border-radius:12px;outline:none;transition:border-color 0.2s}.input-filter:focus{border-color:#DA291C}.input-filter::placeholder{color:#999999}.btn-search{height:40px;padding:0 24px;background:#DA291C;color:#FFFFFF;border:none;border-radius:22px;font-size:16px;font-weight:700;cursor:pointer;white-space:nowrap;transition:background-color 0.2s}.btn-search:hover{background:rgb(181.843902439, 34.2, 23.356097561)}@media (max-width: 767px){.btn-search{padding:0 16px;font-size:14px}}.btn-hidden-filter{display:flex;align-items:center;gap:8px;height:40px;padding:0 16px;background:transparent;color:#0097A9;border:1px solid #0097A9;border-radius:22px;font-size:14px;font-weight:600;cursor:pointer;transition:all 0.2s}.btn-hidden-filter:hover{background:rgba(0, 151, 169, 0.1)}.btn-hidden-filter .filter-icon{width:16px;height:16px}@media (max-width: 991px){.btn-hidden-filter{display:none}}.catalogue-content{display:grid;grid-template-columns:280px 1fr;gap:24px;padding:20px 0}@media (max-width: 1199px){.catalogue-content{grid-template-columns:240px 1fr}}@media (max-width: 991px){.catalogue-content{grid-template-columns:1fr}}.filter-container{border-radius:12px;border:1px solid #DBDBDB;background:#FFFFFF;height:fit-content}@media (max-width: 991px){.filter-container{display:none !important}}.filter-header{padding:20px;display:flex;align-items:baseline;justify-content:space-between;border-bottom:1px solid #DBDBDB}.filter-title{margin:0;font-size:24px;font-weight:700;color:#333333}.reset-filter{margin:0;color:#0097A9;cursor:pointer;font-size:14px;font-weight:700;text-decoration:none}.reset-filter:hover{text-decoration:underline}.filter-result{padding:20px;border-bottom:1px solid #DBDBDB}.filter-result .result{margin:0;font-size:14px;font-weight:700;color:#666666}.filter-type-product{border-bottom:1px solid #DBDBDB}.filter-type-product:last-child{border-bottom:none}.filter-type-title{display:flex;padding:20px;cursor:pointer;align-items:center;justify-content:space-between}.filter-title-section{margin:0;font-size:16px;font-weight:700;color:#333333}.chevron-icon{width:20px;height:20px;color:#666666}.slot-radio{padding:0 20px 20px}.radio-group{display:flex;flex-direction:column;gap:12px}.radio-button{display:flex;align-items:center;gap:10px;cursor:pointer}.radio-button input[type=radio]{width:18px;height:18px;accent-color:#0097A9;cursor:pointer}.radio-button .radio-label{font-size:14px;color:#333333}.products-section{min-height:400px}.loading-container{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:400px;padding:2rem;background:rgba(255, 255, 255, 0.95);border-radius:16px}.loading-container p{margin-top:1rem;font-size:18px;font-weight:600;color:#333333}.error-container,.empty-container{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:300px;color:#666666}.error-container p,.empty-container p{margin-top:1rem;font-size:16px}.error-container button,.empty-container button{margin-top:1rem;padding:8px 24px;background:#0097A9;color:#FFFFFF;border:none;border-radius:20px;cursor:pointer}.spinner{width:48px;height:48px;border:4px solid #E5E5E5;border-top-color:#DA291C;border-radius:50%;animation:spin 1s linear infinite}@keyframes spin{to{transform:rotate(360deg)}}.container-product{display:grid;grid-gap:1.5rem;align-items:stretch;grid-template-columns:1fr 1fr 1fr}@media (max-width: 1399px){.container-product{grid-template-columns:1fr 1fr}}@media (max-width: 767px){.container-product{grid-template-columns:1fr}}.container-product-filter-off{grid-template-columns:1fr 1fr 1fr 1fr}@media (max-width: 1399px){.container-product-filter-off{grid-template-columns:1fr 1fr 1fr}}@media (max-width: 1199px){.container-product-filter-off{grid-template-columns:1fr 1fr}}@media (max-width: 767px){.container-product-filter-off{grid-template-columns:1fr}}.new-product-item{width:100%;height:100%;overflow:hidden;position:relative;border-radius:12px;border:solid 1px #dbdbdb;background:#FFFFFF;box-shadow:2px 3px 27px -3px rgb(211, 211, 211);transition:transform 0.2s, box-shadow 0.2s;display:flex;flex-direction:column}.new-product-item:hover{transform:translateY(-2px);box-shadow:2px 6px 32px -3px rgb(180, 180, 180)}.new-product-item__top{display:grid;margin-top:20px;position:relative;grid-column-gap:16px;padding:16px 16px 8px;grid-template-columns:1fr 2fr}@media (max-width: 1199px){.new-product-item__top{display:flex;flex-direction:column}}.new-product-item__img{display:flex;align-items:center;justify-content:center}.new-product-item__img img{max-width:100%;max-height:120px;object-fit:contain}@media (max-width: 1199px){.new-product-item__img{width:100px;margin:0 auto 16px}}.new-product-item__info .title{margin-top:10px;color:#3c3c3c;font-size:18px;font-weight:700;line-height:24px;margin-bottom:16px;font-family:Roboto, sans-serif}@media (max-width: 1199px){.new-product-item__info .title{margin-top:0;font-size:16px;min-height:48px}}.new-product-item__info .financed-price .financed-price-text{margin-top:4px;color:#3c3c3c;font-size:16px;font-weight:700;line-height:16px}.new-product-item__info .financed-price .financed-price__value{color:#DA291C;font-size:18px;font-weight:700;line-height:24px}.new-product-item__info .financed-price .installments-text{color:#3c3c3c;font-size:14px;font-weight:700;line-height:16px}.new-product-item__info .regular-price{color:#6c6c6c;font-size:14px;font-weight:400;margin-top:10px;line-height:16px}.container-colors{display:flex;gap:8px;padding:10px 25px 15px;flex-wrap:wrap}.color-dot{width:14px;height:14px;border-radius:50%;border:1px solid #3c3c3c;cursor:pointer}.color-dot:active{transform:scale(0.95)}.new-product-item__middle{padding:15px;color:#3c3c3c;min-height:65px;font-size:14px;line-height:1.4;border-top:2px solid #dbdbdb;border-bottom:2px solid #dbdbdb;flex-grow:1}.new-product-item__middle .description-text{display:block}.new-product-item__middle .see-detail{display:inline-block;margin-top:8px;font-size:14px;color:#0097A9;cursor:pointer;text-decoration:underline}.new-product-item__bottom{padding:1rem;display:flex;justify-content:center;align-items:center}.action-button{color:#DA291C;text-align:center;font-size:16px;font-weight:700;line-height:16px;border:solid 1px #DA291C;border-radius:30px;padding:0.5rem 2.5rem;background:transparent;cursor:pointer;transition:all 0.2s}.action-button:hover{background-color:#DA291C;color:#FFFFFF}.back-button-container{display:flex;justify-content:center;padding:24px 0 40px}.btn-back{padding:12px 32px;background:transparent;color:#0097A9;border:2px solid #0097A9;border-radius:30px;font-size:16px;font-weight:600;cursor:pointer;transition:all 0.2s}.btn-back:hover{background:#0097A9;color:#FFFFFF}.modal-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0, 0, 0, 0.5);display:flex;align-items:center;justify-content:center;z-index:1000;padding:20px}.modal-content{position:relative;background:#FFFFFF;border-radius:12px;max-width:500px;width:100%;max-height:80vh;overflow:hidden;box-shadow:0 4px 20px rgba(0, 0, 0, 0.15);animation:modalFadeIn 0.2s ease-out}@keyframes modalFadeIn{from{opacity:0;transform:scale(0.95)}to{opacity:1;transform:scale(1)}}.modal-close{position:absolute;top:12px;right:12px;width:32px;height:32px;background:transparent;border:none;border-radius:50%;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:background 0.2s}.modal-close svg{width:20px;height:20px;color:#3c3c3c}.modal-close:hover{background:#f0f0f0}.modal-title{padding:20px;padding-right:50px;border-bottom:1px solid #dbdbdb;color:#3c3c3c;font-size:20px;font-weight:700;line-height:1.3}.modal-title .modal-subtitle{font-size:14px;font-weight:500;color:#6c6c6c;margin-bottom:8px}@media (max-width: 767px){.modal-title{font-size:18px;padding:16px;padding-right:45px}}.modal-body{padding:20px;max-height:300px;overflow-y:auto;scrollbar-width:thin;scrollbar-color:#ccc transparent}.modal-body::-webkit-scrollbar{width:6px}.modal-body::-webkit-scrollbar-track{background:transparent}.modal-body::-webkit-scrollbar-thumb{background:#ccc;border-radius:3px}.modal-text{margin:0;color:#3c3c3c;font-size:16px;font-weight:400;line-height:1.5;text-align:justify}@media (max-width: 767px){.modal-text{font-size:14px}}`;const pe=class{constructor(e){a(this,e)}onNext;onBack;products=[];filteredProducts=[];isLoading=true;error=null;searchText="";selectedFilter="";showFilters=true;filterOptions=[];showDetailModal=false;modalTitle="";modalContent="";componentWillLoad(){this.filterOptions=j.getProductTypeFilters();this.selectedFilter=j.FILTER_INTERNET_INALAMBRICO}componentDidLoad(){this.loadProducts()}async loadProducts(){this.isLoading=true;this.error=null;try{const e=await j.listCatalogue(this.selectedFilter,1,this.searchText);this.products=e.products||[];this.filteredProducts=this.products}catch(e){console.error("[StepCatalogue] Error loading products:",e);this.error="Error al cargar el catálogo de productos"}finally{this.isLoading=false}}handleFilterChange=async e=>{this.selectedFilter=e;await this.loadProducts()};handleSearchInput=e=>{this.searchText=e.target.value};handleSearch=async()=>{await this.loadProducts()};handleKeyPress=e=>{if(e.key==="Enter"){this.handleSearch()}};_toggleFilters=()=>{this.showFilters=!this.showFilters};clearFilters=()=>{this.selectedFilter=j.FILTER_INTERNET_INALAMBRICO;this.searchText="";this.loadProducts()};handleViewMore=e=>{const t=parseInt(this.selectedFilter,10);j.storeProductInSession(e);W.storeSelectedProduct(e,t);console.log("[StepCatalogue] Product selected:",e.productName,"subcatalogId:",t);this.onNext?.()};cleanHTML(e){return j.cleanDescription(e)}getSelectedFilterCount(){return this.selectedFilter?1:0}handleSeeDetail=e=>{const t=this.cleanHTML(e.shortDescription||"");this.modalTitle=e.productName;this.modalContent=t;this.showDetailModal=true};closeDetailModal=()=>{this.showDetailModal=false;this.modalTitle="";this.modalContent=""};renderFilterSidebar(){const e=this.getSelectedFilterCount();return o("aside",{class:"filter-container",style:{display:this.showFilters?"block":"none"}},o("div",{class:"filter-header"},o("span",{class:"filter-title"},"Filtrar por:"),o("a",{class:"reset-filter",onClick:this.clearFilters},"Limpiar filtros")),o("div",{class:"filter-result"},o("p",{class:"result"},e>0?`filtros seleccionados (${e})`:"Ningún filtro seleccionado")),o("div",{class:"filter-type-product"},o("div",{class:"filter-type-title"},o("h4",{class:"filter-title-section"},"Tipo de producto"),o("svg",{class:"chevron-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},o("polyline",{points:"6 9 12 15 18 9"}))),o("div",{class:"slot-radio"},o("div",{class:"radio-group"},this.filterOptions.map((e=>o("label",{class:"radio-button"},o("input",{type:"radio",name:"productType",value:e.value,checked:this.selectedFilter===e.value,onChange:()=>this.handleFilterChange(e.value)}),o("span",{class:"radio-label"},e.label))))))))}renderProductCard(e){const t=this.cleanHTML(e.shortDescription||"");const a=j.truncateText(t,80);return o("div",{class:"new-product-item"},o("div",{class:"new-product-item__top"},o("div",{class:"new-product-item__img"},o("img",{src:e.imgUrl,alt:e.productName,loading:"lazy"})),o("div",{class:"new-product-item__info"},o("div",{class:"title"},e.productName),e.installments>0&&o("div",{class:"financed-price"},o("div",{class:"financed-price-text"},"Financiado"),o("div",{class:"financed-price__value"},"$",e.update_price?.toFixed(2)||"0.00","/mes"),o("div",{class:"installments-text"},e.installments," Plazos")),o("div",{class:"regular-price"},"Precio regular: $",e.regular_price?.toFixed(2)||"0.00"))),e.colors&&e.colors.length>0&&o("div",{class:"container-colors"},e.colors.map((e=>o("div",{class:"color-dot",style:{backgroundColor:e.webColor}})))),o("div",{class:"new-product-item__middle"},t?o("span",{class:"description-text"},a,t.length>80&&o("a",{class:"see-detail",onClick:t=>{t.stopPropagation();this.handleSeeDetail(e)}},"Ver detalle")):o("span",{class:"description-text"}," ")),o("div",{class:"new-product-item__bottom"},o("button",{class:"action-button",onClick:()=>this.handleViewMore(e)},"Ver más")))}render(){const e=this.selectedFilter===j.FILTER_INTERNET_INALAMBRICO?"Internet Inalámbrico":"Internet + Telefonía";return o(i,{key:"633cab4f89f3e79907cb5db33eb2897e114ecf97"},o("div",{key:"9390e25d97abc32a1ad7c303b1460f310f6f05ab",class:"step-catalogue"},o("div",{key:"02e7d0c13069e26f9a07ea6e0c307f5bb699954c",class:"container-filter"},o("h1",{key:"ccded62f26e8b1cb8719a5e85965cbb87a793689",class:"filter-title-main"},e),o("div",{key:"2e8b8d5966728504b0c9a35953d2734cfc9d2166",class:"filter-content"},o("div",{key:"c7b44c9803036ea915e916276935c123e1ae6394",class:"input-filter-wrapper"},o("svg",{key:"fc68b3c733ac05a3d72f3242281495b1a4d195dd",class:"search-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},o("circle",{key:"465cf04a8bac926218930455360383f4ce76d4d2",cx:"11",cy:"11",r:"8"}),o("path",{key:"94880ba619fba184c09735fb5dee50a2dc9e2638",d:"m21 21-4.35-4.35"})),o("input",{key:"96e070ad2f6913c5dac4f32a0331f9c8452c5ca4",type:"text",class:"input-filter",placeholder:"Buscar articulo",value:this.searchText,onInput:this.handleSearchInput,onKeyPress:this.handleKeyPress})),o("button",{key:"3ed9a4be367b1daded8e20f9d04876a5cceaddf4",class:"btn-search",onClick:this.handleSearch},"Buscar"))),o("div",{key:"31dedbc72907c038675e86e69610d656dfb1933c",class:"catalogue-content"},this.renderFilterSidebar(),o("div",{key:"5fc3589a28fc81d2fa105d2ab68a8645c3e16d3c",class:"products-section"},this.isLoading&&o("div",{key:"292cb80c0714438e041805d2250be61c4db7a0e1",class:"loading-container"},o("div",{key:"e58b5e87f3092109d7ebb87f9ad4827d17e9527a",class:"spinner"}),o("p",{key:"d8ea4899e95713de1acb4d5c9e1df3d0da6f00bc"},"Cargando productos...")),this.error&&!this.isLoading&&o("div",{key:"d12da3b185d76e74f3b195a7bc95115502d50801",class:"error-container"},o("p",{key:"bd2d3bbdd3a22d41d90760af4103fcd413858551"},this.error),o("button",{key:"aecf413d4416c536d035453741ccf0b10f07ddc5",onClick:()=>this.loadProducts()},"Reintentar")),!this.isLoading&&!this.error&&o("div",{key:"ab42f43d608c13216bee78a5f6979bb883908434",class:{"container-product":true,"container-product-filter-off":!this.showFilters}},this.filteredProducts.map((e=>this.renderProductCard(e)))),!this.isLoading&&!this.error&&this.filteredProducts.length===0&&o("div",{key:"fe07cc32a053431c0f5624669646ed95d52b2014",class:"empty-container"},o("p",{key:"354f47fce91aa5d8e7d09127119fcfcad12c6a49"},"No hay productos disponibles para esta categoría")))),o("div",{key:"9edaae5bf982ec881e74353e952ae4158ce9e87c",class:"back-button-container"},o("button",{key:"ccb3b1dcafbf7a0f4938e5192874a4c59087a6d1",class:"btn-back",onClick:this.onBack},"Regresar"))),this.showDetailModal&&o("div",{key:"3c3d144571de958f77d47a1d2077e6914f758ec2",class:"modal-overlay",onClick:this.closeDetailModal},o("div",{key:"6e0ea7baa3b102322a025c316276f50468ec1e5f",class:"modal-content",onClick:e=>e.stopPropagation()},o("button",{key:"3f9017ff359a09a6f56ab2b998b64f12f408712d",class:"modal-close",onClick:this.closeDetailModal},o("svg",{key:"8b5debf990dfba49121bc00557ff8787b98766b0",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},o("line",{key:"73e21236ccdc9be42e65ada13b224dfeed689247",x1:"18",y1:"6",x2:"6",y2:"18"}),o("line",{key:"e54bf79a62b785719755ee4e0e906e8540dc2001",x1:"6",y1:"6",x2:"18",y2:"18"}))),o("div",{key:"af62534c7dbdbe94508f0f177200e3362828b595",class:"modal-title"},o("div",{key:"2e867881616c387d65681cf3cc0e9d097e64568a",class:"modal-subtitle"},"Descripción completa"),this.modalTitle),o("div",{key:"5361636aec7839c921dc8d48d2bb5432aff0a876",class:"modal-body"},o("p",{key:"51f2c1a26f1ada39a8e3543dd2b0c4006f566773",class:"modal-text"},this.modalContent)))))}};pe.style=de();const ue=()=>`@keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes slideUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}@keyframes spin{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}:host{display:block}.step-confirmation{width:100%}.step-confirmation__header{margin-bottom:1.5rem;padding-bottom:1rem;border-bottom:1px solid #E5E5E5}.step-confirmation__header-title{font-size:1.75rem;font-weight:700;line-height:1.2;color:#333333}.step-confirmation__content{background-color:#FFFFFF;border:1px solid #E5E5E5;border-radius:0.75rem;box-shadow:0 2px 8px rgba(0, 0, 0, 0.08);transition:box-shadow 150ms ease, border-color 150ms ease;padding:3rem 2rem;text-align:center;min-height:300px;display:flex;flex-direction:column;align-items:center;justify-content:center}.step-confirmation__loading{display:flex;flex-direction:column;align-items:center;justify-content:center}.step-confirmation__loading p{margin-top:1rem;font-size:1rem;font-weight:400;line-height:1.5;color:#666666}.step-confirmation__spinner{width:48px;height:48px;border:4px solid #E5E5E5;border-top-color:#0097A9;border-radius:50%;animation:spin 1s linear infinite}.step-confirmation__result{display:flex;flex-direction:column;align-items:center;justify-content:center;width:100%;max-width:500px}.step-confirmation__icon{display:flex;align-items:center;justify-content:center;margin-bottom:1rem}.step-confirmation__icon img{width:48px;height:48px}.step-confirmation__icon svg{width:40px;height:40px}.step-confirmation__title{font-size:1.5rem;font-weight:600;line-height:1.35;color:#333333;margin-bottom:0.5rem}.step-confirmation__title--success{color:#15A045}.step-confirmation__title--error{color:#E00814}.step-confirmation__message{font-size:1rem;font-weight:400;line-height:1.5;color:#666666;margin-bottom:1.5rem}.step-confirmation__order-id{font-size:0.875rem;font-weight:400;line-height:1.5;color:#666666;margin-bottom:1.5rem;padding:0.5rem 1rem;background:#FAFAFA;border-radius:0.5rem}.step-confirmation__actions{margin-top:1.5rem;text-align:center}.step-confirmation__btn{display:inline-flex;align-items:center;justify-content:center;gap:0.5rem;padding:0 1.5rem;font-family:"AMX", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, sans-serif;font-size:1rem;font-weight:600;line-height:1;text-decoration:none;border:none;border-radius:9999px;cursor:pointer;transition:all 150ms ease}.step-confirmation__btn:disabled{opacity:0.5;cursor:not-allowed}.step-confirmation__btn{height:48px;background-color:transparent;color:#0097A9;border:2px solid #0097A9}.step-confirmation__btn:hover:not(:disabled){background-color:rgba(0, 151, 169, 0.1)}.step-confirmation__btn:active:not(:disabled){background-color:rgba(0, 151, 169, 0.2)}.step-confirmation__btn{min-width:180px}.step-confirmation__btn--error{display:inline-flex;align-items:center;justify-content:center;gap:0.5rem;padding:0 1.5rem;font-family:"AMX", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, sans-serif;font-size:1rem;font-weight:600;line-height:1;text-decoration:none;border:none;border-radius:9999px;cursor:pointer;transition:all 150ms ease}.step-confirmation__btn--error:disabled{opacity:0.5;cursor:not-allowed}.step-confirmation__btn--error{height:48px;background-color:#DA291C;color:#FFFFFF}.step-confirmation__btn--error:hover:not(:disabled){background-color:rgb(181.843902439, 34.2, 23.356097561)}.step-confirmation__btn--error:active:not(:disabled){background-color:rgb(163.7658536585, 30.8, 21.0341463415)}@keyframes spin{to{transform:rotate(360deg)}}`;const fe=class{constructor(e){a(this,e)}onComplete;onCancel;onBack;status="loading";orderId=null;orderNumber=null;confirmationSent=false;errorMessage="";async componentWillLoad(){const e=this.isCatalogueFlow();if(e){await this.handleCatalogueFlowConfirmation()}else{await this.submitRequest()}}isCatalogueFlow(){const e=oe.getPaymentResult();const t=!!g.selectedContract;const a=!!g.formData;return!!e&&!t&&!a}async handleCatalogueFlowConfirmation(){this.status="loading";try{const e=oe.getPaymentResult();if(!e||!e.success){throw new Error("No se encontró información del pago")}const t=oe.getOrderBan();this.orderId=t||e.operationId||null;console.log("[StepConfirmation] Catalogue flow - payment success:",{orderId:this.orderId,operationId:e.operationId,authorizationNumber:e.authorizationNumber});this.status="success";_.setOrderResult(this.orderId,null);this.onComplete?.({orderId:this.orderId,plan:g.selectedPlan,contract:null,customer:null,location:g.location})}catch(e){console.error("[StepConfirmation] Catalogue flow error:",e);this.status="error";this.errorMessage=e.message||O.REQUEST_ERROR;_.setOrderResult(null,this.errorMessage)}}async submitRequest(){this.status="loading";try{const{location:e,plan:t,contract:a,formData:r}={location:g.location,plan:g.selectedPlan,contract:g.selectedContract,formData:g.formData};const o=N.validateSubmissionData(r,a,t,e);if(!o.isValid){throw new Error(`Datos incompletos: ${o.missingFields.join(", ")}`)}const i=N.buildPayload(r,a,t,e);const n=await N.submitRequest(i);if(n.hasError){throw new Error(n.errorDisplay||n.message||O.REQUEST_ERROR)}this.orderId=n.orderId||null;if(this.orderId){this.fetchOrderDetails(this.orderId);this.sendConfirmationEmail(this.orderId,r.personal.email)}this.status="success";_.setOrderResult(this.orderId,null);this.onComplete?.({orderId:this.orderId,plan:t,contract:a,customer:r,location:e})}catch(e){console.error("Request submission failed:",e);this.status="error";this.errorMessage=e.message||O.REQUEST_ERROR;_.setOrderResult(null,this.errorMessage)}}async fetchOrderDetails(e){try{const t=await N.getOrder(e);if(!t.hasError&&t.orderNumber){this.orderNumber=t.orderNumber}}catch(e){console.warn("Could not fetch order details:",e)}}async sendConfirmationEmail(e,t){try{const a=await N.sendConfirmation(e,t);if(!a.hasError&&a.sent){this.confirmationSent=true}}catch(e){console.warn("Could not send confirmation email:",e)}}handleRetry=()=>{this.submitRequest()};handleClose=()=>{this.clearSessionStorage();_.resetFlow();this.onCancel?.()};clearSessionStorage(){console.log("[StepConfirmation] Clearing all sessionStorage data");try{G.clearCartSession();W.clearProductSession();te.clearShippingData();oe.clearPaymentData();D.clearPlan();_.clearToken()}catch(e){console.warn("[StepConfirmation] Error clearing service data:",e)}const e=["token","correlationId","latitud","longitud","planCodeInternet","plan","planId","planPrice","typeContractId","contractInstallment","contractInstallation","contractActivation","contractModen","cart","cartId","cartTotal","cartProducts","mainId","discountCoupon","selectedProduct","productId","subcatalogId","selectedColor","selectedStorage","childrenId","parentId","deviceType","shipmentId","zipCode","shippingAddress","deliveryMethod","orderBan","paymentResult","serviceLatitude","serviceLongitude","serviceAddress","serviceCity","serviceZipCode","serviceType","serviceMessage","planName","planSoc","planFeatures","customerFirstName","customerSecondName","customerLastName","customerSecondLastName","customerIdType","customerIdNumber","customerIdExpiration","customerPhone1","customerPhone2","customerEmail","customerBirthDate","businessName","businessPosition","isExistingCustomer","shoppingCart"];e.forEach((e=>{sessionStorage.removeItem(e)}));console.log("[StepConfirmation] SessionStorage cleared successfully")}renderLoading(){return o("div",{class:"step-confirmation__loading"},o("div",{class:"step-confirmation__spinner"}),o("p",null,"Procesando tu solicitud..."))}renderSuccess(){const e=this.orderNumber||this.orderId;return o("div",{class:"step-confirmation__result step-confirmation__result--success"},o("div",{class:"step-confirmation__icon step-confirmation__icon--success"},o("img",{src:"/assets/images/ok-check.svg",alt:"Éxito"})),o("h2",{class:"step-confirmation__title step-confirmation__title--success"},M.REQUEST_SUCCESS),o("p",{class:"step-confirmation__message"},M.REQUEST_SUCCESS_SUBTITLE),e&&o("p",{class:"step-confirmation__order-id"},"Número de orden: ",e),this.confirmationSent&&o("p",{class:"step-confirmation__email-sent"},"Se ha enviado un correo de confirmación a tu email."))}renderError(){return o("div",{class:"step-confirmation__result step-confirmation__result--error"},o("div",{class:"step-confirmation__icon step-confirmation__icon--error"},o("img",{src:"/assets/images/error-check.svg",alt:"Error"})),o("h2",{class:"step-confirmation__title step-confirmation__title--error"},"¡Lo sentimos, ha ocurrido un error en el proceso de solicitud!"),o("p",{class:"step-confirmation__message"},"En este momento estamos presentando inconvenientes en nuestro sistema.",o("br",null),"Por favor, inténtalo nuevamente."))}render(){return o(i,{key:"5215f0878f1df6b712acc38537e948ce3425b759"},o("div",{key:"9e12c496833250df2608be2b17d6281df49b4a81",class:"step-confirmation"},o("header",{key:"59751a8125cfa08dbffe6ede377909dee0dc36b9",class:"step-confirmation__header"},o("h1",{key:"e3dcbfa01d585cb8a927e5f65d3f3c3be7882e5e",class:"step-confirmation__header-title"},"Confirmación de Solicitud")),o("div",{key:"8c19786bfe36d066a46185738e4d23ca2ffc205b",class:"step-confirmation__content"},this.status==="loading"&&this.renderLoading(),this.status==="success"&&this.renderSuccess(),this.status==="error"&&this.renderError()),this.status==="success"&&o("div",{key:"82a95ae0d94faf62ce1274059cc34bd0343e299c",class:"step-confirmation__actions"},o("button",{key:"1a3e1d2a74e0ad18f5934ab9a872c1d8975708ed",class:"step-confirmation__btn",onClick:this.handleClose},"Cerrar")),this.status==="error"&&o("div",{key:"32cbebb3bbd7de33beb7ab6f956032e77232443d",class:"step-confirmation__actions"},o("button",{key:"1e2a9b4e0919322310e234db3222a023eb46a3c4",class:"step-confirmation__btn step-confirmation__btn--error",onClick:this.handleRetry},"Volver a intentar"))))}};fe.style=ue();const he=(e,t=true)=>{const a={style:"currency",currency:"USD",minimumFractionDigits:t?2:0,maximumFractionDigits:t?2:0};return new Intl.NumberFormat("en-US",a).format(e)};const me=e=>he(e);const be=e=>{const t=e.replace(/\D/g,"");if(t.length===0)return"";if(t.length<=3)return`(${t}`;if(t.length<=6)return`(${t.slice(0,3)}) ${t.slice(3)}`;return`(${t.slice(0,3)}) ${t.slice(3,6)}-${t.slice(6,10)}`};const ge=e=>e.replace(/\D/g,"").slice(0,10);const ye=e=>{if(e===0)return"Sin plazo fijo";if(e===1)return"1 mes";if(e===12)return"1 año";if(e===24)return"2 años";return`${e} meses`};const xe=()=>`@keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes slideUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}@keyframes spin{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}:host{display:block}.step-contract{width:100%}.step-contract__header{display:flex;align-items:center;justify-content:space-between;margin-bottom:1.5rem}.step-contract__title{font-size:1.75rem;font-weight:700;line-height:1.2;color:#333333}.step-contract__btn-back{display:inline-flex;align-items:center;justify-content:center;gap:0.5rem;padding:0 1.5rem;font-family:"AMX", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, sans-serif;font-size:1rem;font-weight:600;line-height:1;text-decoration:none;border:none;border-radius:9999px;cursor:pointer;transition:all 150ms ease}.step-contract__btn-back:disabled{opacity:0.5;cursor:not-allowed}.step-contract__btn-back{height:48px;background-color:transparent;color:#0097A9;border:2px solid #0097A9}.step-contract__btn-back:hover:not(:disabled){background-color:rgba(0, 151, 169, 0.1)}.step-contract__btn-back:active:not(:disabled){background-color:rgba(0, 151, 169, 0.2)}.step-contract__btn-back{height:40px}.step-contract__tabs{display:flex;border-bottom:none;margin-bottom:1.5rem;background:#FFFFFF;border-radius:0 0 0.75rem 0.75rem;box-shadow:0 2px 4px rgba(0, 0, 0, 0.08);overflow:hidden}.step-contract__tab{flex:1;padding:1rem;background:transparent;border:none;cursor:pointer;text-align:center;position:relative;transition:all 150ms ease}.step-contract__tab:first-child{border-right:1px solid #E5E5E5}.step-contract__tab::after{content:"";position:absolute;bottom:0;left:1.5rem;right:1.5rem;height:3px;background:transparent;transition:background-color 150ms ease}.step-contract__tab--active::after{background:#0097A9}.step-contract__tab:hover:not(.step-contract__tab--active){background:#FAFAFA}.step-contract__tab-title{display:block;font-size:1.25rem;font-weight:600;line-height:1.35;font-weight:700;color:#333333;margin-bottom:0.25rem}.step-contract__tab-subtitle{display:block;font-size:0.75rem;font-weight:400;line-height:1.5;color:#666666}.step-contract__options{display:flex;flex-direction:column;gap:1rem;align-items:center}@media (min-width: 768px){.step-contract__options{flex-direction:row;justify-content:center}}.step-contract__option{flex:0 0 auto;width:280px;display:flex;align-items:flex-start;padding:1rem;border:1px solid #CCCCCC;border-radius:0.75rem;cursor:pointer;transition:all 150ms ease;position:relative;overflow:hidden}@media (max-width: 767px){.step-contract__option{width:100%;max-width:320px}}.step-contract__option::before{content:"";position:absolute;left:0;top:0;bottom:0;width:4px;background:#CCCCCC;border-radius:0.75rem 0 0 0.75rem;transition:background-color 150ms ease}.step-contract__option input[type=radio]{margin-right:0.75rem;margin-top:0.25rem;accent-color:#0097A9}.step-contract__option:hover{border-color:#999999}.step-contract__option--selected{border-color:#CCCCCC}.step-contract__option--selected::before{background:#0097A9}.step-contract__option-content{flex:1}.step-contract__option-title{display:block;font-size:1.25rem;font-weight:600;line-height:1.35;color:#333333;margin-bottom:0.5rem}.step-contract__option-details{display:flex;flex-direction:column;gap:0.25rem}.step-contract__option-details span{font-size:0.875rem;font-weight:400;line-height:1.5;color:#666666}.step-contract__actions{margin-top:1.5rem;padding-top:1.5rem;border-top:1px solid #E5E5E5;text-align:center}.step-contract__btn-continue{display:inline-flex;align-items:center;justify-content:center;gap:0.5rem;padding:0 1.5rem;font-family:"AMX", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, sans-serif;font-size:1rem;font-weight:600;line-height:1;text-decoration:none;border:none;border-radius:9999px;cursor:pointer;transition:all 150ms ease}.step-contract__btn-continue:disabled{opacity:0.5;cursor:not-allowed}.step-contract__btn-continue{height:48px;background-color:#DA291C;color:#FFFFFF}.step-contract__btn-continue:hover:not(:disabled){background-color:rgb(181.843902439, 34.2, 23.356097561)}.step-contract__btn-continue:active:not(:disabled){background-color:rgb(163.7658536585, 30.8, 21.0341463415)}.step-contract__btn-continue{min-width:200px}`;const _e=class{constructor(e){a(this,e)}onNext;onBack;activeTab=1;selectedOption=null;componentWillLoad(){this.restorePreviousSelection()}restorePreviousSelection(){if(g.selectedContract){this.selectedOption=g.selectedContract;this.activeTab=g.selectedContract.typeId;return}const e=sessionStorage.getItem("typeContractId");if(e!==null){const t=parseInt(e);const a=parseInt(sessionStorage.getItem("contractInstallment")||"0");const r=parseInt(sessionStorage.getItem("contractInstallation")||"0");const o=parseInt(sessionStorage.getItem("contractActivation")||"0");const i=parseInt(sessionStorage.getItem("contractModen")||"0");const n=A.find((e=>e.typeId===t));this.selectedOption={typeId:t,typeName:n?.type||"",deadlines:a,installation:r,activation:o,modem:i};this.activeTab=t;_.setContract(this.selectedOption)}}handleTabChange=e=>{this.activeTab=e;if(this.selectedOption?.typeId!==e){this.selectedOption=null}};handleSelectOption=(e,t)=>{const a=A.find((t=>t.typeId===e));this.selectedOption={typeId:e,typeName:a?.type||"",deadlines:t.deadlines,installation:t.installation,activation:t.activation,modem:t.modem};_.setContract(this.selectedOption)};handleContinue=()=>{if(this.selectedOption){this.onNext?.()}};render(){const e=A.find((e=>e.typeId===1));const t=A.find((e=>e.typeId===0));return o(i,{key:"f1905e6b70dc6122709e028226af1a20f4c968f0"},o("div",{key:"c08690c9d77c82e1b38bde06f53a4cf8fe57959c",class:"step-contract"},o("header",{key:"4a2d90242969243120d78af3f6cf009b8ff9db57",class:"step-contract__header"},o("h1",{key:"47c0a78c53271fd222de19dc91d55baa80f74c0d",class:"step-contract__title"},"Selecciona un tipo de contrato"),o("button",{key:"33159923e314ff5bf6185ac5e0ed818f30af1c10",class:"step-contract__btn-back",onClick:this.onBack},"Regresar")),o("div",{key:"0b1c67f46bfce90276b503d217340b7c196ff12d",class:"step-contract__tabs"},o("button",{key:"646a2264e8069b0000bb891b7f3aaddd64d9bcf8",class:{"step-contract__tab":true,"step-contract__tab--active":this.activeTab===1},onClick:()=>this.handleTabChange(1)},o("span",{key:"352c1520f14c686bcc190ccc916ce4d3d30f9616",class:"step-contract__tab-title"},"Con contrato"),o("span",{key:"014665509e201e6d6d90c93a90ffc0d6bd5da668",class:"step-contract__tab-subtitle"},"12 y 24 meses de contrato")),o("button",{key:"bdabf0e35ef436bd3137301c734f0a17dadf9f3b",class:{"step-contract__tab":true,"step-contract__tab--active":this.activeTab===0},onClick:()=>this.handleTabChange(0)},o("span",{key:"8963df3a459b259a9ac841d0ddd428c2f52f63bf",class:"step-contract__tab-title"},"Sin contrato"),o("span",{key:"f2337aa7d97707a5e46c966d4b7f00243bdfa6b2",class:"step-contract__tab-subtitle"},"Sin verificación de crédito",o("br",{key:"f8bf274567bc524d85864f92db61f48f7daed407"}),"1 mes de plan por adelantado"))),o("div",{key:"1a08c254123f8312f938139a328ee34650d1fc22",class:"step-contract__content"},this.activeTab===1&&e&&o("div",{key:"9686ff7cf25586051b19c1becc9d2aca89c92263",class:"step-contract__options"},e.contract.map((e=>o("label",{class:{"step-contract__option":true,"step-contract__option--selected":this.selectedOption?.deadlines===e.deadlines&&this.selectedOption?.typeId===1}},o("input",{type:"radio",name:"contract",checked:this.selectedOption?.deadlines===e.deadlines&&this.selectedOption?.typeId===1,onChange:()=>this.handleSelectOption(1,e)}),o("div",{class:"step-contract__option-content"},o("span",{class:"step-contract__option-title"},ye(e.deadlines)),o("div",{class:"step-contract__option-details"},o("span",null,"Instalación: ",e.installation>0?me(e.installation):"Sin Costo"),o("span",null,"Activación: ",e.activation>0?me(e.activation):"Sin Costo"),o("span",null,"Modem: ",e.modem>0?me(e.modem):"Sin Costo"))))))),this.activeTab===0&&t&&o("div",{key:"8a9c1a251df633a2eb37f5055a4efebe925b3c39",class:"step-contract__options"},t.contract.map((e=>o("label",{class:{"step-contract__option":true,"step-contract__option--selected":this.selectedOption?.typeId===0}},o("input",{type:"radio",name:"contract",checked:this.selectedOption?.typeId===0,onChange:()=>this.handleSelectOption(0,e)}),o("div",{class:"step-contract__option-content"},o("span",{class:"step-contract__option-title"},"Sin contrato"),o("div",{class:"step-contract__option-details"},o("span",null,"Activación: ",e.activation>0?me(e.activation):"Sin Costo"),o("span",null,"Modem: ",me(e.modem)),o("span",null,"Instalación: ",me(e.installation))))))))),o("div",{key:"56a8e1df201c55a6686afed6678e04420d1f6000",class:"step-contract__actions"},o("button",{key:"856440da906e26ccd05a915e4b3d45cf17f945d3",class:"step-contract__btn-continue",onClick:this.handleContinue,disabled:!this.selectedOption},"Continuar"))))}};_e.style=xe();const ve={required:"Este campo es requerido",minLength:e=>`Debe tener al menos ${e} caracteres`,maxLength:e=>`No puede exceder ${e} caracteres`,email:"Ingrese un correo electrónico válido",phone:"Ingrese un número de teléfono válido (10 dígitos)",zipCode:"Ingrese un código postal válido (5 dígitos)",date:"Ingrese una fecha válida",futureDate:"La fecha debe ser futura",identification:"La identificación debe tener al menos 10 caracteres",numeric:"Solo se permiten números",alphanumeric:"Solo se permiten letras y números"};const ke=()=>({isValid:true,message:""});const we=e=>({isValid:false,message:e});const Ce=e=>{if(!e||e.trim()===""){return we(ve.required)}return ke()};const Se=e=>t=>{if(t&&t.length<e){return we(ve.minLength(e))}return ke()};const Ae=e=>{if(!e)return ke();const t=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;if(!t.test(e)){return we(ve.email)}return ke()};const Ie=e=>{if(!e)return ke();const t=e.replace(/\D/g,"");if(t.length!==10){return we(ve.phone)}return ke()};const Fe=e=>{if(!e)return ke();const t=/^\d{5}$/;if(!t.test(e)){return we(ve.zipCode)}return ke()};const Ee=e=>{if(!e)return ke();const t=/^\d{4}-\d{2}-\d{2}$/;if(!t.test(e)){return we(ve.date)}const a=new Date(e);if(isNaN(a.getTime())){return we(ve.date)}return ke()};const Pe=e=>{if(!e)return ke();const t=Ee(e);if(!t.isValid)return t;const a=new Date(e);const r=new Date;r.setHours(0,0,0,0);if(a<=r){return we(ve.futureDate)}return ke()};const De=e=>{if(!e)return ke();if(e.length<10){return we(ve.identification)}return ke()};const ze=(...e)=>t=>{for(const a of e){const e=a(t);if(!e.isValid){return e}}return ke()};const Ne={firstName:ze(Ce,Se(3)),lastName:ze(Ce,Se(3)),secondLastName:ze(Ce,Se(3)),identificationNumber:ze(Ce,De),identificationExpiration:ze(Ce,Pe),phone1:ze(Ce,Ie),phone2:Ie,email:ze(Ce,Ae),businessName:Ce,position:Ce,address:Ce,city:Ce,zipCode:ze(Ce,Fe)};const Te=()=>`@keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes slideUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}@keyframes spin{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}:host{display:block}.step-form{width:100%;max-width:800px;margin:0 auto}.step-form__header{display:flex;align-items:center;justify-content:space-between;margin-bottom:1rem;padding-bottom:1rem;border-bottom:1px solid #E5E5E5}.step-form__title{font-size:1.75rem;font-weight:700;line-height:1.2;color:#333333}.step-form__btn-back{display:inline-flex;align-items:center;justify-content:center;gap:0.5rem;padding:0 1.5rem;font-family:"AMX", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, sans-serif;font-size:1rem;font-weight:600;line-height:1;text-decoration:none;border:none;border-radius:9999px;cursor:pointer;transition:all 150ms ease}.step-form__btn-back:disabled{opacity:0.5;cursor:not-allowed}.step-form__btn-back{height:48px;background-color:transparent;color:#0097A9;border:2px solid #0097A9}.step-form__btn-back:hover:not(:disabled){background-color:rgba(0, 151, 169, 0.1)}.step-form__btn-back:active:not(:disabled){background-color:rgba(0, 151, 169, 0.2)}.step-form__btn-back{height:40px}.step-form form{border:1px solid #E5E5E5;border-radius:0.75rem;padding:1.5rem;background:white}.step-form__instructions{font-size:0.875rem;font-weight:400;line-height:1.5;color:#666666;margin-bottom:1.5rem;padding:0;background:transparent}.step-form__section{margin-bottom:1.5rem;padding-bottom:0.5rem}.step-form__row{display:grid;grid-template-columns:1fr;gap:1rem;margin-bottom:1rem}@media (min-width: 768px){.step-form__row{grid-template-columns:1fr 1fr}}.step-form__row:last-child{margin-bottom:0}.step-form__field{display:flex;flex-direction:column}@media (min-width: 768px){.step-form__field--id{grid-column:span 1}}.step-form__label{display:block;margin-bottom:0.5rem;font-size:0.875rem;font-weight:500;color:#333333}.step-form__label .required{color:#DA291C}.step-form__required{color:#DA291C;margin-left:0.25rem}.step-form__input{width:100%;height:44px;padding:0 1rem;font-family:"AMX", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, sans-serif;font-size:1rem;color:#333333;background-color:#FFFFFF;border:1px solid #CCCCCC;border-radius:0.5rem;transition:border-color 150ms ease, box-shadow 150ms ease}.step-form__input::placeholder{color:#999999}.step-form__input:focus{outline:none;border-color:#0097A9;box-shadow:0 0 0 3px rgba(0, 151, 169, 0.15)}.step-form__input:disabled{background-color:#F5F5F5;cursor:not-allowed}.step-form__input.error{border-color:#DA291C}.step-form__input.error:focus{box-shadow:0 0 0 3px rgba(218, 41, 28, 0.15)}.step-form__input--error{border-color:#DA291C}.step-form__input--error:focus{box-shadow:0 0 0 3px rgba(218, 41, 28, 0.15)}.step-form__error{margin-top:0.25rem;font-size:0.75rem;color:#DA291C}.step-form__id-row{display:flex;flex-direction:column;gap:0.5rem}@media (min-width: 768px){.step-form__id-row{flex-direction:row;align-items:flex-start}}.step-form__id-row .step-form__input{flex:1;margin-top:4px}.step-form__radio-group{display:flex;flex-direction:row;align-items:flex-start;gap:1rem}.step-form__radio-group--horizontal{flex-direction:row;gap:1rem}.step-form__radio{display:flex;align-items:flex-start;gap:0.25rem;font-size:0.875rem;font-weight:400;line-height:1.5;color:#333333;cursor:pointer;max-width:90px;line-height:1.2;margin-top:14px}.step-form__radio input[type=radio]{accent-color:#0097A9;margin-top:2px;flex-shrink:0}.step-form__actions{margin-top:1.5rem;padding-top:1.5rem;border-top:1px solid #E5E5E5;text-align:center}.step-form__btn-submit{display:inline-flex;align-items:center;justify-content:center;gap:0.5rem;padding:0 1.5rem;font-family:"AMX", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, sans-serif;font-size:1rem;font-weight:600;line-height:1;text-decoration:none;border:none;border-radius:9999px;cursor:pointer;transition:all 150ms ease}.step-form__btn-submit:disabled{opacity:0.5;cursor:not-allowed}.step-form__btn-submit{height:48px;background-color:#DA291C;color:#FFFFFF}.step-form__btn-submit:hover:not(:disabled){background-color:rgb(181.843902439, 34.2, 23.356097561)}.step-form__btn-submit:active:not(:disabled){background-color:rgb(163.7658536585, 30.8, 21.0341463415)}.step-form__btn-submit{min-width:200px}`;const Oe=class{constructor(e){a(this,e)}onNext;onBack;formData={personal:{firstName:"",secondName:"",lastName:"",secondLastName:"",identificationType:"license",identificationNumber:"",identificationExpiration:"",phone1:"",phone2:"",email:""},business:{businessName:"",position:""},address:{address:g.location?.address||"",city:g.location?.city||"",zipCode:g.location?.zipCode||""},isExistingCustomer:false};errors={};touched={};handleInput=(e,t)=>a=>{const r=a.target;let o=r.value;if(t==="phone1"||t==="phone2"){o=ge(o)}this.formData={...this.formData,[e]:{...this.formData[e],[t]:o}};this.touched={...this.touched,[t]:true};this.validateField(t,o)};handleRadioChange=(e,t)=>{if(e==="identificationType"){this.formData={...this.formData,personal:{...this.formData.personal,identificationType:t}}}else if(e==="isExistingCustomer"){this.formData={...this.formData,isExistingCustomer:t}}};validateField(e,t){const a=Ne[e];if(!a)return{isValid:true,message:""};const r=a(t);if(!r.isValid){this.errors={...this.errors,[e]:r.message}}else{const{[e]:t,...a}=this.errors;this.errors=a}return r}validateForm(){const e=[{field:"firstName",value:this.formData.personal.firstName},{field:"lastName",value:this.formData.personal.lastName},{field:"secondLastName",value:this.formData.personal.secondLastName},{field:"identificationNumber",value:this.formData.personal.identificationNumber},{field:"identificationExpiration",value:this.formData.personal.identificationExpiration},{field:"phone1",value:this.formData.personal.phone1},{field:"email",value:this.formData.personal.email},{field:"businessName",value:this.formData.business.businessName},{field:"position",value:this.formData.business.position},{field:"address",value:this.formData.address.address},{field:"city",value:this.formData.address.city},{field:"zipCode",value:this.formData.address.zipCode}];let t=true;const a={};for(const{field:r,value:o}of e){const e=this.validateField(r,o);if(!e.isValid){t=false;a[r]=e.message}}this.errors=a;return t}handleSubmit=e=>{e.preventDefault();this.touched={firstName:true,lastName:true,secondLastName:true,identificationNumber:true,identificationExpiration:true,phone1:true,email:true,businessName:true,position:true,address:true,city:true,zipCode:true};if(this.validateForm()){_.setFormData(this.formData);this.onNext?.()}};renderInput(e,t,a,r,i={}){const{type:n="text",placeholder:s="",required:c=false,disabled:l=false}=i;const d=this.touched[t]&&this.errors[t];const p=t==="phone1"||t==="phone2"?be(r):r;return o("div",{class:"step-form__field"},o("label",{class:"step-form__label"},e,c&&o("span",{class:"step-form__required"},"*")),o("input",{type:n,class:{"step-form__input":true,"step-form__input--error":!!d},value:p,placeholder:s,disabled:l,onInput:this.handleInput(a,t)}),d&&o("span",{class:"step-form__error"},this.errors[t]))}render(){return o(i,{key:"c481713f5117e41c0e66218f0622861aa0768f79"},o("div",{key:"5a841d19a81206b88033bd3be24655af80df0736",class:"step-form"},o("header",{key:"0f5ae19659d3ca868400a2309c48bb67f60634b6",class:"step-form__header"},o("h1",{key:"5fcd2bd13efe8a7e4323026461fb8181bc123ec5",class:"step-form__title"},"Formulario de solicitud de servicio fijo"),o("button",{key:"3cc16cf0a596ffb7dbe32470f997c59666cd501c",class:"step-form__btn-back",onClick:this.onBack},"Regresar")),o("form",{key:"ba16ab5360e054f0a59251bd8d983fd06f669291",onSubmit:this.handleSubmit},o("p",{key:"3017b8bceec5c2dfa9faba7cb32bf2443fa60560",class:"step-form__instructions"},"Por favor, ingresa la información personal solicitada. Su nombre y apellido deben ser iguales a su identificación de gobierno."),o("div",{key:"6b15392974cdd563184b014e7a9bf520fc797d9b",class:"step-form__section"},o("div",{key:"1f300e12e8f24a7e6ae101c8e1fa129c8ef39cf9",class:"step-form__row"},this.renderInput("Nombre","firstName","personal",this.formData.personal.firstName,{placeholder:"Ingrese nombre",required:true}),this.renderInput("Segundo nombre","secondName","personal",this.formData.personal.secondName||"",{placeholder:"Ingrese segundo nombre (Opcional)"})),o("div",{key:"41e11ee93af952e5f56ca5d701ef203124a3a31c",class:"step-form__row"},this.renderInput("Apellido","lastName","personal",this.formData.personal.lastName,{placeholder:"Ingrese apellido",required:true}),this.renderInput("Segundo apellido","secondLastName","personal",this.formData.personal.secondLastName,{placeholder:"Ingrese segundo apellido",required:true})),o("div",{key:"0e48c1ca2e08a196c22bf98f9143803b4b5767c9",class:"step-form__row"},o("div",{key:"1291f02f66593b9e7941534bd7c692d22e18d18f",class:"step-form__field step-form__field--id"},o("label",{key:"d0c40f3ab735276355394cc6fcca3edc25651dc9",class:"step-form__label"},"Identificación",o("span",{key:"116025fc57c98d50b4dcd5f788443717263dd1ae",class:"step-form__required"},"*")),o("div",{key:"26410addf965b2a13a4e6861d3e6aa930fb8f307",class:"step-form__id-row"},o("div",{key:"3741dd30d2cdded7699a46147e804b87d3a6f4be",class:"step-form__radio-group"},o("label",{key:"16b7fe472ae0c03762f3c81deb27d0191c6c6dc7",class:"step-form__radio"},o("input",{key:"3e5eddae5e960abc387ab5add8353a4dd265ddb6",type:"radio",name:"idType",checked:this.formData.personal.identificationType==="license",onChange:()=>this.handleRadioChange("identificationType","license")}),"Licencia de conducir"),o("label",{key:"12d1e3594613178153f90b3b9239a9188254366b",class:"step-form__radio"},o("input",{key:"e13b28e7686054edeb3068bc1861c911bbfe318f",type:"radio",name:"idType",checked:this.formData.personal.identificationType==="passport",onChange:()=>this.handleRadioChange("identificationType","passport")}),"Pasaporte")),o("input",{key:"3ed6acf3d4638279f914e5da15fef7cb7767cac0",type:"text",class:{"step-form__input":true,"step-form__input--error":!!(this.touched["identificationNumber"]&&this.errors["identificationNumber"])},value:this.formData.personal.identificationNumber,placeholder:"Ingrese nro de identificación",onInput:this.handleInput("personal","identificationNumber")})),this.touched["identificationNumber"]&&this.errors["identificationNumber"]&&o("span",{key:"75d67c2f616e6d5970a2b1aa362f5304c6c70823",class:"step-form__error"},this.errors["identificationNumber"])),this.renderInput("Fecha de vencimiento","identificationExpiration","personal",this.formData.personal.identificationExpiration,{type:"date",required:true})),o("div",{key:"f03be9d11723497799ab378c87d1a6bdcd47413c",class:"step-form__row"},this.renderInput("Teléfono de contacto 1","phone1","personal",this.formData.personal.phone1,{type:"tel",placeholder:"Ingrese nro de teléfono",required:true}),this.renderInput("Teléfono de contacto 2","phone2","personal",this.formData.personal.phone2||"",{type:"tel",placeholder:"Ingrese nro de teléfono"}))),o("div",{key:"87a9b0398ba9c4224856d200a197226d57255918",class:"step-form__section"},o("div",{key:"9770d7ad710c57d18f263c4b695dbc3fa63be6a4",class:"step-form__row"},this.renderInput("Nombre del Negocio","businessName","business",this.formData.business.businessName,{placeholder:"Ingrese nombre del negocio",required:true}),this.renderInput("Posición en la Empresa","position","business",this.formData.business.position,{placeholder:"Ingrese posición actual",required:true}))),o("div",{key:"fc2fbe5af446bb0a79d740d07ff5b79603067858",class:"step-form__section"},o("div",{key:"ae3a915ead0593648b439210e3a326afef56b168",class:"step-form__row"},this.renderInput("Dirección","address","address",this.formData.address.address,{placeholder:"Ingrese dirección",required:true}),this.renderInput("Ciudad","city","address",this.formData.address.city,{placeholder:"Ingrese ciudad",required:true})),o("div",{key:"acc57c7ac68cd4e8438c3ae2b86588b1047e63cc",class:"step-form__row"},this.renderInput("Código postal","zipCode","address",this.formData.address.zipCode,{placeholder:"Ingrese código postal",required:true}),this.renderInput("Correo electrónico","email","personal",this.formData.personal.email,{type:"email",placeholder:"Ingrese correo electrónico",required:true}))),o("div",{key:"901019bc2449e39fb8b4a628389f35b6b8d7707d",class:"step-form__section"},o("div",{key:"58f88109a6cd3999dafe39e7af0f04fe4f9465a8",class:"step-form__field"},o("label",{key:"7b8f2e23aeaf997ff117149de0da52cd938c381e",class:"step-form__label"},"Cliente existente de Claro PR",o("span",{key:"066a2fc74bf8697fb142e7d73df4b21ba9a987dc",class:"step-form__required"},"*")),o("div",{key:"563375d345281e8b6779e919712fec0de91bcd95",class:"step-form__radio-group step-form__radio-group--horizontal"},o("label",{key:"5f30d44ac24d69df8897c24ebe5312470a1176bd",class:"step-form__radio"},o("input",{key:"0ddf22b09292105c8774a388dac629379158e631",type:"radio",name:"existingCustomer",checked:this.formData.isExistingCustomer===true,onChange:()=>this.handleRadioChange("isExistingCustomer",true)}),"Sí"),o("label",{key:"ee75c13d17cc3332a5638838f03dd7fa7f02062c",class:"step-form__radio"},o("input",{key:"769e0760bcd14b7efef849d150c49025b4bbcfa9",type:"radio",name:"existingCustomer",checked:this.formData.isExistingCustomer===false,onChange:()=>this.handleRadioChange("isExistingCustomer",false)}),"No")))),o("div",{key:"b1bf9791c0839db0a3bcab0ed9487d51b36ec9af",class:"step-form__actions"},o("button",{key:"4521a008fca97e087aadd8d7a00a4454ce4aeb04",type:"submit",class:"step-form__btn-submit"},"Continuar")))))}};Oe.style=Te();const Me=()=>`@keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes slideUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}@keyframes spin{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}:host{display:block}.step-location{width:100%;position:relative}.step-location__validating-overlay{position:absolute;top:0;left:0;right:0;bottom:0;background:rgba(255, 255, 255, 0.9);display:flex;align-items:center;justify-content:center;z-index:1000;animation:fadeIn 0.2s ease-out}.step-location__validating-content{display:flex;flex-direction:column;align-items:center;gap:1rem;padding:1.5rem;background:#FFFFFF;border-radius:16px;box-shadow:0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)}.step-location__validating-spinner{width:48px;height:48px;border:4px solid #E5E5E5;border-top-color:#DA291C;border-radius:50%;animation:spin 1s linear infinite}.step-location__validating-text{margin:0;font-size:18px;font-weight:600;color:#333333}.step-location__header{text-align:center;margin-bottom:1rem}.step-location__title{font-size:1.5rem;font-weight:600;line-height:1.35;color:#333333;font-weight:400}.step-location__title--highlight{color:#DA291C;font-weight:700}.step-location__map-container{position:relative;border-radius:0.75rem;overflow:hidden;box-shadow:0 2px 8px rgba(0, 0, 0, 0.08)}.step-location__controls{position:absolute;top:3.5rem;left:120px;right:50px;z-index:1;display:flex;flex-direction:column;gap:0.5rem}@media (min-width: 768px){.step-location__controls{top:3.5rem;left:130px;right:60px}}.step-location__input-group{display:flex;align-items:center;background:#FFFFFF;border-radius:0.25rem;box-shadow:0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);overflow:hidden;border:1px solid #E5E5E5}.step-location__input-icon{display:flex;align-items:center;justify-content:center;padding-left:0.75rem;color:#999999}.step-location__input-icon svg{width:20px;height:20px}.step-location__input{flex:1;padding:0.75rem 0.75rem;border:none;font-size:0.875rem;outline:none;background:transparent;min-width:0}.step-location__input::placeholder{color:#999999}.step-location__btn-validate{padding:0.75rem 1.25rem;background:#DA291C;color:#FFFFFF;border:none;font-size:0.875rem;font-weight:600;cursor:pointer;transition:background-color 150ms ease;white-space:nowrap;min-width:100px}.step-location__btn-validate:hover:not(:disabled){background:rgb(181.843902439, 34.2, 23.356097561)}.step-location__btn-validate:disabled{opacity:0.6;cursor:not-allowed}.step-location__btn-validate--loading{pointer-events:none}.step-location__btn-validate-content{display:inline-flex;align-items:center;gap:0.5rem}.step-location__btn-spinner{display:inline-block;width:14px;height:14px;border:2px solid rgba(255, 255, 255, 0.3);border-top-color:#FFFFFF;border-radius:50%;animation:btn-spin 0.8s linear infinite}@keyframes btn-spin{to{transform:rotate(360deg)}}.step-location__btn-location{display:inline-flex;align-items:center;gap:0.5rem;padding:0.5rem 0.75rem;background:#0097A9;color:#FFFFFF;border:none;border-radius:0.25rem;font-size:0.75rem;font-weight:500;cursor:pointer;box-shadow:0 1px 2px 0 rgba(0, 0, 0, 0.05);transition:background-color 150ms ease;white-space:nowrap;align-self:flex-start}.step-location__btn-location:hover:not(:disabled){background:rgb(0, 114.5455621302, 128.2)}.step-location__btn-location:disabled{opacity:0.6;cursor:not-allowed}.step-location__btn-location-icon{width:16px;height:16px}.step-location__map{position:relative;width:100%;height:400px;background:#E5E5E5}@media (min-width: 768px){.step-location__map{height:500px}}.step-location__map-canvas{width:100%;height:100%}.step-location__map-loading{display:flex;flex-direction:column;align-items:center;justify-content:center;position:absolute;top:0;left:0;right:0;bottom:0;background:#F5F5F5;color:#666666;z-index:5}.step-location__map-loading p{font-size:1rem;font-weight:400;line-height:1.5;margin-top:1rem}.step-location__map-error{display:flex;flex-direction:column;align-items:center;justify-content:center;position:absolute;top:0;left:0;right:0;bottom:0;background:#F5F5F5;color:#666666;z-index:5;padding:1rem;text-align:center}.step-location__map-error p{font-size:1rem;font-weight:400;line-height:1.5;color:#DA291C}.step-location__map-error small{margin-top:0.5rem;font-size:0.75rem}.step-location__spinner{width:40px;height:40px;border:3px solid #CCCCCC;border-top-color:#0097A9;border-radius:50%;animation:spin 1s linear infinite}.step-location__map-placeholder{display:flex;flex-direction:column;align-items:center;justify-content:center;width:100%;height:100%;color:#666666}.step-location__map-placeholder p{font-size:1rem;font-weight:400;line-height:1.5}.step-location__map-placeholder small{margin-top:0.5rem;font-size:0.75rem}.step-location__modal-backdrop{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0, 0, 0, 0.5);z-index:400;display:flex;align-items:center;justify-content:center}.step-location__modal{position:relative;width:90%;max-width:400px;background:#FFFFFF;border-radius:0.75rem;padding:2rem 1.5rem;text-align:center;box-shadow:0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)}.step-location__modal--error .step-location__modal-error-bar{display:block}.step-location__modal-close{position:absolute;top:0.75rem;right:0.75rem;width:32px;height:32px;background:transparent;border:none;font-size:1.5rem;color:#666666;cursor:pointer;line-height:1}.step-location__modal-close:hover{color:#333333}.step-location__modal-error-bar{display:none;background:#DA291C;color:#FFFFFF;padding:0.5rem 1rem;margin:-2rem -1.5rem 1rem;font-weight:600}.step-location__modal-success-icon{width:60px;height:60px;margin:0 auto 1rem;color:#44AF69}.step-location__modal-success-icon svg{width:100%;height:100%}.step-location__modal-message{font-size:1rem;font-weight:400;line-height:1.5;color:#333333;margin-bottom:1.5rem}.step-location__modal-btn{display:inline-flex;align-items:center;justify-content:center;gap:0.5rem;padding:0 1.5rem;font-family:"AMX", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, sans-serif;font-size:1rem;font-weight:600;line-height:1;text-decoration:none;border:none;border-radius:9999px;cursor:pointer;transition:all 150ms ease}.step-location__modal-btn:disabled{opacity:0.5;cursor:not-allowed}.step-location__modal-btn{height:48px;background-color:#0097A9;color:#FFFFFF}.step-location__modal-btn:hover:not(:disabled){background-color:rgb(0, 114.5455621302, 128.2)}.step-location__modal-btn:active:not(:disabled){background-color:rgb(0, 96.3183431953, 107.8)}.step-location__modal-btn{min-width:150px}`;const Le=class{constructor(e){a(this,e)}get el(){return n(this)}googleMapsKey;onNext;onBack;address="";isValidating=false;isLoadingMap=true;isGettingLocation=false;locationData=null;mapError=null;currentCoordinates=null;geocodeResult=null;showErrorModal=false;errorMessage="";mapContainer;addressInput;async componentDidLoad(){await this.initializeMap()}disconnectedCallback(){R.destroy()}async initializeMap(){if(!this.googleMapsKey){this.mapError="Google Maps API key no configurada";this.isLoadingMap=false;return}try{R.setApiKey(this.googleMapsKey);await R.initMap(this.mapContainer);if(this.addressInput){await R.initAutocomplete(this.addressInput,(e=>{this.handlePlaceSelected(e)}))}R.addMapClickListener((async e=>{await this.handleMapClick(e)}));this.isLoadingMap=false}catch(e){console.error("Error initializing map:",e);this.mapError="Error al cargar Google Maps";this.isLoadingMap=false}}handleAddressChange=e=>{this.address=e.target.value};handleKeyPress=e=>{if(e.key==="Enter"||e.code==="Enter"||e.code==="NumpadEnter"){e.preventDefault();this.handleValidate()}};handleMapClick=async e=>{R.clear();const t=await R.reverseGeocode(e);if(t){this.geocodeResult=t;this.address=t.formattedAddress||t.address;this.currentCoordinates=t.coordinates;R.setMarker(t.coordinates)}else{this.currentCoordinates=e;R.setMarker(e)}await this.handleValidate()};handlePlaceSelected=e=>{this.geocodeResult=e;this.address=e.formattedAddress||e.address;this.currentCoordinates=e.coordinates;R.setMarker(e.coordinates);R.centerMap(e.coordinates)};handleValidate=async()=>{if(!this.currentCoordinates&&!this.address.trim()){return}this.isValidating=true;try{let e=this.currentCoordinates;let t=this.geocodeResult?.city||"";let a=this.geocodeResult?.zipCode||"";if(!e&&this.address.trim()){const r=await R.geocodeAddress(this.address);if(r){e=r.coordinates;t=r.city;a=r.zipCode;this.currentCoordinates=e;this.geocodeResult=r;R.setMarker(e);R.centerMap(e)}else{this.errorMessage="No se pudo encontrar la dirección. Por favor, intenta con otra dirección.";this.showErrorModal=true;this.isValidating=false;return}}if(!e){this.errorMessage="Por favor, ingresa una dirección válida.";this.showErrorModal=true;this.isValidating=false;return}const r=await E.checkCoverage(e.lat,e.lng,this.address||this.geocodeResult?.address||"",t,a);this.locationData=r;if(r.isValid){this.showCoverageInfoWindow(r.serviceMessage,true)}else{this.showCoverageInfoWindow(O.NO_COVERAGE,false)}}catch(e){console.error("Coverage validation error:",e);this.errorMessage=O.COVERAGE_ERROR;this.showErrorModal=true}finally{this.isValidating=false}};showCoverageInfoWindow(e,t){const a=`\n      <div class="general-container" style="font-family: 'Open Sans', Arial, sans-serif; width: 100%; box-sizing: border-box;">\n        <div class="info ${t?"infoOn":"infoOff"}" style="\n          padding: ${t?"20px":"15px 20px"};\n          width: 100%;\n          height: auto;\n          box-sizing: border-box;\n          background: ${t?"#1F97AF":"#EE122C"};\n          color: #ffffff;\n          font-size: 14px;\n          line-height: 1.5;\n          white-space: normal;\n        ">\n          ${e}\n        </div>\n        <div class="continue-map" style="\n          width: 100%;\n          height: auto;\n          padding: 20px;\n          font-size: 16px;\n          text-align: center;\n          background: #ffffff;\n          color: #1F97AF;\n          cursor: pointer;\n          box-sizing: border-box;\n        ">\n          ${!t?`\n            <div style="color: #333; margin-bottom: 8px;">\n              Actualmente usted se encuentra fuera del rango de cobertura.\n            </div>\n          `:""}\n          <div\n            id="infowindow-continue-btn"\n            class="no-link continue-button"\n            onclick="if(window.__infoWindowContinueCallback) window.__infoWindowContinueCallback();"\n            style="\n              text-decoration: none;\n              color: #1F97AF;\n              font-size: 16px;\n              cursor: pointer;\n              font-weight: 600;\n            "\n          >\n            ${t?"Continuar":"Cerrar"}\n          </div>\n        </div>\n      </div>\n    `;R.showInfoWindow(a,(()=>{if(t&&this.locationData&&this.locationData.isValid){this.handleInfoWindowContinue()}else{R.closeInfoWindow()}}))}handleInfoWindowContinue=()=>{if(this.locationData&&this.locationData.isValid){R.closeInfoWindow();this.storeLocationInSession(this.locationData);_.setLocation(this.locationData);this.onNext?.()}};storeLocationInSession(e){try{sessionStorage.setItem("latitud",btoa(String(e.latitude)));sessionStorage.setItem("longitud",btoa(String(e.longitude)));if(e.serviceType.toUpperCase()==="CLARO HOGAR"){sessionStorage.removeItem("planCodeInternet");console.log("[StepLocation] CLARO HOGAR detected - planCodeInternet removed")}else{sessionStorage.setItem("planCodeInternet",btoa(e.serviceType));console.log("[StepLocation] Service type stored:",e.serviceType)}sessionStorage.setItem("plan",JSON.stringify({serviceType:e.serviceType,serviceMessage:e.serviceMessage,address:e.address,city:e.city,zipCode:e.zipCode}));console.log("[StepLocation] Location data stored in sessionStorage")}catch(e){console.error("[StepLocation] Error storing location in sessionStorage:",e)}}handleUseCurrentLocation=async()=>{this.isGettingLocation=true;try{const e=await R.getCurrentLocationWithAddress();if(e){this.geocodeResult=e;this.address=e.formattedAddress||e.address;this.currentCoordinates=e.coordinates;R.setMarker(e.coordinates);R.centerMap(e.coordinates);R.setZoom(17)}else{const e=await R.getCurrentLocation();this.currentCoordinates=e;R.setMarker(e);R.centerMap(e);R.setZoom(17)}}catch(e){console.error("Geolocation error:",e);if(e.message.includes("denied")){this.errorMessage=O.GEOLOCATION_DENIED}else if(e.message.includes("unavailable")){this.errorMessage=O.GEOLOCATION_UNAVAILABLE}else{this.errorMessage=O.GEOLOCATION_TIMEOUT}this.showErrorModal=true}finally{this.isGettingLocation=false}};render(){return o(i,{key:"4437f94dba31f3726dc5b809692a66178ffa6837"},o("div",{key:"1b415cac1c65c3edeab788c316961bbc9fb8c9d0",class:"step-location"},this.isValidating&&o("div",{key:"6023f4b3a277824ca60a0542181925493e611890",class:"step-location__validating-overlay"},o("div",{key:"7df3fc32f8c4a43c7630b6ef4f1bbf6a0f4979fa",class:"step-location__validating-content"},o("div",{key:"d7904f1815c99e8ae4d38fbc8c4b5de54e268370",class:"step-location__validating-spinner"}),o("p",{key:"91a291b13095cd2fbb0ff253c2ff485c6c4e53e4",class:"step-location__validating-text"},"Validando cobertura..."))),o("header",{key:"c0d3df9929d16e92855bf89969d97990ecfed900",class:"step-location__header"},o("h1",{key:"957fb9b4916bf255b765354000e3910084363a2f",class:"step-location__title"},o("span",{key:"0794aecd47078c706467e8ae7b0f5011da133237",class:"step-location__title--highlight"},"Servicio fijo empresarial")," ","en tu área")),o("div",{key:"6464a3b447edb7b49d2a3415405f31c1eb374e17",class:"step-location__map-container"},o("div",{key:"206a993ad029a57d86a84f948125595171f52bb6",class:"step-location__controls"},o("div",{key:"21e3c7617bc6df7b6ec35f15839a151e6e2bd24f",class:"step-location__input-group"},o("span",{key:"dfba0e93ace9823d72011030802b335d92eb14bc",class:"step-location__input-icon"},o("svg",{key:"85a2571ba6b9dd8201b3b6ae00a16382c1369640",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},o("path",{key:"e2ed4110193aa7ae16063ff45e0f75e5ab5be752",d:"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"}),o("circle",{key:"a68bed46a5ab7c3ba41a7ba028f489266a98fe62",cx:"12",cy:"10",r:"3"}))),o("input",{key:"44f7f009b03f85dbef77e8aca256ab3dc4524df4",type:"text",class:"step-location__input",placeholder:"Ingrese su dirección",value:this.address,onInput:this.handleAddressChange,onKeyPress:this.handleKeyPress,ref:e=>this.addressInput=e}),o("button",{key:"dc96224cf6479bcce55e08371f98899b8648f6e3",class:{"step-location__btn-validate":true,"step-location__btn-validate--loading":this.isValidating},onClick:this.handleValidate,disabled:this.isValidating||!this.address.trim()&&!this.currentCoordinates},this.isValidating?o("span",{class:"step-location__btn-validate-content"},o("span",{class:"step-location__btn-spinner"}),"Validando..."):"Validar")),o("button",{key:"8095e3157fdd2de9565436a87d3af0be428496bb",class:"step-location__btn-location",onClick:this.handleUseCurrentLocation,disabled:this.isGettingLocation||this.isLoadingMap},o("svg",{key:"048fb61f55e6e91ecc9b738e514e43e15e87c05d",class:"step-location__btn-location-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},o("circle",{key:"f3ae5c0478f4c2fd66428f11140033340c010ee0",cx:"12",cy:"12",r:"10"}),o("circle",{key:"611a78c56df944d5f51bd51c649a1870b21add90",cx:"12",cy:"12",r:"3"}),o("line",{key:"b54f19e0dafdf2eb40dfae9a15df109e89a64b06",x1:"12",y1:"2",x2:"12",y2:"6"}),o("line",{key:"37024a78191541aff3879f1453a92598c818bc90",x1:"12",y1:"18",x2:"12",y2:"22"}),o("line",{key:"d15f3ec70193772335b4a7311d431f2d7d890c40",x1:"2",y1:"12",x2:"6",y2:"12"}),o("line",{key:"fe8b6191ec2150805cd02148ffe889dd227ca6c1",x1:"18",y1:"12",x2:"22",y2:"12"})),this.isGettingLocation?"Obteniendo ubicación...":"Utilizar Ubicación Actual")),o("div",{key:"a6f431074f4606e7f72b928f7500a16e1d931588",class:"step-location__map"},this.isLoadingMap&&!this.mapError&&o("div",{key:"2fa47417bf593b7b0106aae9fb06b57e38f69d36",class:"step-location__map-loading"},o("div",{key:"2f686dcd318cf61d73fe552ecf9a54485c2de1bc",class:"step-location__spinner"}),o("p",{key:"9cb586fc653a2781218f966c4cb031dfe3268674"},"Cargando mapa...")),this.mapError&&o("div",{key:"fd8410023faed497a2345412540b5dd088822aba",class:"step-location__map-error"},o("p",{key:"f1e4f1185e8cfe56fda5ed9d1db9c68c3d61d092"},this.mapError),!this.googleMapsKey&&o("small",{key:"1bd24b7cd0f4a29b7d74ae487e38885e0ec5fb0f"},"Configura la prop google-maps-key en el componente")),o("div",{key:"742ff1891115c9cc099071d2adeed4daf34413e3",class:"step-location__map-canvas",ref:e=>this.mapContainer=e,style:{display:this.mapError?"none":"block"}}))),this.showErrorModal&&o("div",{key:"10ebf6fde06bed19e3dcdbed0e855f4e285cb306",class:"step-location__modal-backdrop"},o("div",{key:"23576e8c1f327e521ba8f4ca0aae25bcc295e425",class:"step-location__modal step-location__modal--error"},o("button",{key:"6e3680f37a66739601695d3c1117aed68876cc1c",class:"step-location__modal-close",onClick:()=>this.showErrorModal=false},"×"),o("div",{key:"07f616666d8507474881ae79b19ec77fe12f61d9",class:"step-location__modal-error-bar"},"Error"),o("p",{key:"0ca7463877338b6c2acb878e26dbcb47ca84327c",class:"step-location__modal-message"},this.errorMessage),o("button",{key:"c69b0713cc76eb0d73fb3eed45601d896513e3a1",class:"step-location__modal-btn",onClick:()=>this.showErrorModal=false},"Cerrar")))))}};Le.style=Me();const Re=()=>`:host{display:block;width:100%;min-height:100%;background-color:#FAFAFA}.step-order-summary{width:100%;max-width:1200px;margin:0 auto;padding:1.5rem}.header{display:flex;align-items:center;gap:1rem;margin-bottom:1.5rem;flex-wrap:wrap}.header .btn-back{display:flex;align-items:center;gap:0.25rem;background:none;border:none;color:#0097A9;font-size:0.875rem;cursor:pointer;padding:0.25rem;transition:color 0.2s}.header .btn-back svg{width:20px;height:20px}.header .btn-back:hover{color:rgb(0, 105.4319526627, 118);text-decoration:underline}.header__title-group{display:flex;align-items:center;gap:1rem;flex:1}.header .title{font-size:1.75rem;font-weight:700;color:#1A1A1A;margin:0}.header .item-count{font-size:0.875rem;color:#666666;background:#E5E5E5;padding:0.25rem 0.5rem;border-radius:9999px;font-weight:500}.state-container{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:400px;text-align:center;background:white;border-radius:0.75rem;padding:2rem;box-shadow:0 1px 2px 0 rgba(0, 0, 0, 0.05)}.state-container .state-icon{width:80px;height:80px;color:#999999;margin-bottom:1rem}.state-container h3{font-size:1.5rem;color:#4D4D4D;margin:0 0 0.5rem 0}.state-container p{color:#808080;margin:0 0 1.5rem 0}.state-container--error .state-icon{color:#DA291C}.state-container--error p{color:#DA291C}.state-container--empty .state-icon{color:#CCCCCC}.spinner{width:48px;height:48px;border:4px solid #E5E5E5;border-top-color:#DA291C;border-radius:50%;animation:spin 1s linear infinite;margin-bottom:1rem}.spinner-small{display:inline-block;width:16px;height:16px;border:2px solid rgba(255, 255, 255, 0.3);border-top-color:currentColor;border-radius:50%;animation:spin 0.8s linear infinite}@keyframes spin{to{transform:rotate(360deg)}}.btn-retry,.btn-back-catalog{background:#DA291C;color:white;border:none;padding:0.5rem 1.5rem;border-radius:9999px;cursor:pointer;font-weight:600;transition:background 0.2s}.btn-retry:hover,.btn-back-catalog:hover{background:rgb(172.8048780488, 32.5, 22.1951219512)}.btn-back-catalog{background:#0097A9}.btn-back-catalog:hover{background:rgb(0, 105.4319526627, 118)}.content-layout{display:grid;grid-template-columns:1fr 380px;gap:1.5rem}@media (max-width: 992px){.content-layout{grid-template-columns:1fr}}.products-column{display:flex;flex-direction:column;gap:1rem}.summary-column{display:flex;flex-direction:column;gap:1rem}@media (max-width: 992px){.summary-column{order:-1}}.product-card{background:white;border-radius:0.75rem;box-shadow:0 1px 2px 0 rgba(0, 0, 0, 0.05);overflow:hidden}.product-card__badge{display:flex;gap:0.25rem;padding:0.5rem 1rem;background:#FAFAFA;border-bottom:1px solid #F5F5F5}.product-card__main{display:grid;grid-template-columns:100px 1fr auto auto;gap:1rem;padding:1rem;align-items:center}@media (max-width: 768px){.product-card__main{grid-template-columns:80px 1fr auto;grid-template-rows:auto auto}}.product-card__main--plan{grid-template-columns:60px 1fr auto auto}@media (max-width: 768px){.product-card__main--plan{grid-template-columns:60px 1fr auto}}.product-card__image{width:100px;height:100px;background:#FAFAFA;border-radius:0.5rem;display:flex;align-items:center;justify-content:center;overflow:hidden}@media (max-width: 768px){.product-card__image{width:80px;height:80px}}.product-card__image img{max-width:90%;max-height:90%;object-fit:contain}.product-card__image--plan{width:60px;height:60px;background:linear-gradient(135deg, #DA291C 0%, rgb(150.2073170732, 28.25, 19.2926829268) 100%);border-radius:0.5rem}.product-card__image--plan img{filter:brightness(0) invert(1);width:40px;height:40px}.product-card__details{display:flex;flex-direction:column;gap:0.25rem}.product-card__pricing{display:flex;flex-direction:column;align-items:flex-end;gap:0.25rem}@media (max-width: 768px){.product-card__pricing{grid-column:2/-1;flex-direction:row;justify-content:space-between;align-items:center;width:100%}}.product-card__actions{display:flex;align-items:center}.product-card--plan .product-card__main{grid-template-columns:60px 1fr auto auto}.section-header{display:flex;align-items:center;gap:0.5rem;padding:1rem 1.5rem;border-bottom:1px solid #F5F5F5}.section-header__icon{width:36px;height:36px;border-radius:0.5rem;display:flex;align-items:center;justify-content:center}.section-header__icon svg{width:20px;height:20px}.section-header__text{display:flex;align-items:center;gap:0.5rem;flex:1}.section-header__label{font-size:0.875rem;font-weight:700;letter-spacing:0.5px}.section-header__badge{font-size:0.75rem;font-weight:600;padding:2px 0.5rem;border-radius:9999px;text-transform:uppercase;letter-spacing:0.5px}.section-header--equipment{background:linear-gradient(135deg, rgba(0, 151, 169, 0.08) 0%, rgba(0, 151, 169, 0.02) 100%);border-left:4px solid #0097A9}.section-header--equipment .section-header__icon{background:#0097A9;color:white}.section-header--equipment .section-header__label{color:#0097A9}.section-header--equipment .section-header__badge{background:rgba(218, 41, 28, 0.15);color:#DA291C}.section-header--plan{background:linear-gradient(135deg, rgba(218, 41, 28, 0.08) 0%, rgba(218, 41, 28, 0.02) 100%);border-left:4px solid #DA291C}.section-header--plan .section-header__icon{background:#DA291C;color:white}.section-header--plan .section-header__label{color:#DA291C}.badge{display:inline-flex;align-items:center;padding:2px 0.5rem;border-radius:9999px;font-size:0.75rem;font-weight:600;text-transform:uppercase;letter-spacing:0.5px}.badge--equipment{background:rgba(0, 151, 169, 0.15);color:#0097A9}.badge--main{background:rgba(218, 41, 28, 0.15);color:#DA291C}.badge--plan{background:rgba(68, 175, 105, 0.15);color:#44AF69}.product-name{font-size:1rem;font-weight:600;color:#1A1A1A;margin:0;line-height:1.3}.product-specs{display:flex;flex-wrap:wrap;gap:0.5rem;align-items:center}.spec-item{display:flex;align-items:center;gap:4px}.spec-label{font-size:0.875rem;color:#666666}.plan-type{font-size:0.875rem;color:#808080}.financing-info{display:flex;flex-direction:column;gap:2px;margin-top:0.25rem;padding-top:0.25rem;border-top:1px dashed #E5E5E5}.financing-label{font-size:0.75rem;font-weight:600;color:#4D4D4D}.financing-detail{font-size:0.75rem;color:#808080}.color-circle{display:inline-block;width:16px;height:16px;border-radius:50%;border:2px solid #E5E5E5;box-shadow:inset 0 0 0 1px rgba(0, 0, 0, 0.1)}.storage-badge{display:inline-flex;align-items:center;padding:2px 0.25rem;background:#F5F5F5;border-radius:0.25rem;font-size:0.75rem;font-weight:600;color:#4D4D4D}.qty-label{font-size:0.875rem;color:#808080}.price-financing,.price-single{text-align:right}@media (max-width: 768px){.price-financing,.price-single{text-align:left}}.price-monthly{font-size:1.25rem;font-weight:700;color:#DA291C}.price-period{font-size:0.875rem;color:#808080}.price-installments{display:block;font-size:0.75rem;color:#808080;margin-top:2px}.price-total{font-size:1.25rem;font-weight:700;color:#1A1A1A}.price-full{display:flex;gap:0.25rem;font-size:0.875rem}.price-full .label{color:#808080}.price-full .value{font-weight:600;color:#4D4D4D}.btn-action{background:none;border:none;cursor:pointer;padding:0.25rem;transition:all 0.2s;display:flex;align-items:center;justify-content:center}.btn-action svg{width:20px;height:20px}.btn-action--delete{color:#999999;border-radius:0.5rem}.btn-action--delete:hover:not(:disabled){color:#DA291C;background:rgba(218, 41, 28, 0.1)}.btn-action--delete:disabled{opacity:0.5;cursor:not-allowed}.btn-action--delete-small{color:#999999}.btn-action--delete-small svg{width:16px;height:16px}.btn-action--delete-small:hover:not(:disabled){color:#DA291C}.btn-action--delete-small:disabled{opacity:0.5;cursor:not-allowed}.plan-section{border-top:none}.plan-section .section-header--plan{margin:0;border-radius:0;border-left-width:0;padding-left:calc(1.5rem + 4px);border-top:1px dashed #E5E5E5}.plan-section__content{display:flex;align-items:center;gap:1rem;padding:1rem 1.5rem;background:linear-gradient(to right, rgba(218, 41, 28, 0.03), white)}.plan-section .plan-label{font-size:0.75rem;color:#808080;text-transform:uppercase;letter-spacing:0.5px;font-weight:600}.plan-section .plan-info{flex:1;display:flex;flex-direction:column;gap:2px}.plan-section .plan-name{font-size:0.875rem;font-weight:600;color:#333333}.plan-section .plan-type{font-size:0.75rem;color:#808080}.plan-section .plan-price{display:flex;align-items:baseline;gap:2px}.plan-section .plan-price .price{font-size:1.25rem;font-weight:700;color:#DA291C}.plan-section .plan-price .period{font-size:0.875rem;color:#808080}.summary-card{background:white;border-radius:0.75rem;padding:1.5rem;box-shadow:0 1px 2px 0 rgba(0, 0, 0, 0.05)}.summary-card__title{display:flex;align-items:center;gap:0.5rem;font-size:0.875rem;font-weight:600;color:#4D4D4D;margin:0 0 1rem 0;text-transform:uppercase;letter-spacing:0.5px}.summary-card__title svg{width:18px;height:18px;color:#999999}.promo-section .promo-input-group{display:flex;gap:0.5rem}.promo-section .promo-input{flex:1;height:44px;border:1px solid #CCCCCC;border-radius:0.5rem;padding:0 1rem;font-size:0.875rem;transition:border-color 0.2s}.promo-section .promo-input:focus{outline:none;border-color:#0097A9}.promo-section .promo-input.error{border-color:#DA291C}.promo-section .promo-input.success{border-color:#44AF69}.promo-section .promo-input:disabled{background:#F5F5F5;cursor:not-allowed}.promo-section .promo-button{height:44px;padding:0 1.5rem;background:#E5E5E5;color:#4D4D4D;border:none;border-radius:0.5rem;font-weight:600;cursor:pointer;transition:all 0.2s;white-space:nowrap;min-width:90px;display:flex;align-items:center;justify-content:center}.promo-section .promo-button:hover:not(:disabled){background:#CCCCCC}.promo-section .promo-button:disabled{opacity:0.5;cursor:not-allowed}.promo-section .promo-message{display:flex;align-items:center;gap:0.25rem;font-size:0.875rem;margin-top:0.5rem}.promo-section .promo-message svg{width:14px;height:14px;flex-shrink:0}.promo-section .promo-message.error{color:#DA291C}.promo-section .promo-message.success{color:#44AF69}.payment-summary{padding:0;overflow:hidden}.rent-section{background:linear-gradient(135deg, #DA291C 0%, rgb(172.8048780488, 32.5, 22.1951219512) 100%);padding:1.5rem;color:white}.rent-section .rent-row{display:flex;justify-content:space-between;align-items:center}.rent-section .rent-label{font-size:1rem;font-weight:500}.rent-section .rent-value{font-size:1.75rem;font-weight:700}.rent-section .rent-note{font-size:0.75rem;opacity:0.8;margin:0.25rem 0 0 0}.payment-breakdown{padding:1.5rem}.payment-breakdown .detail-rows{margin-bottom:1rem}.detail-row{display:flex;justify-content:space-between;align-items:center;padding:0.5rem 0;border-bottom:1px solid #F5F5F5}.detail-row:last-child{border-bottom:none}.detail-row .label{font-size:0.875rem;color:#666666}.detail-row .value{font-size:0.875rem;font-weight:500;color:#1A1A1A}.detail-row .value--free{color:#44AF69;font-weight:700;font-size:0.75rem;text-transform:uppercase;letter-spacing:0.5px}.detail-row--discount .label{color:#44AF69}.detail-row--discount .value{color:#44AF69;font-weight:600}.detail-row--shipping{background:rgba(68, 175, 105, 0.05);margin:0 -1.5rem;padding:0.5rem 1.5rem;border-bottom:none}.total-section{background:#FAFAFA;margin:0 -1.5rem -1.5rem;padding:1.5rem;border-top:2px solid #E5E5E5}.total-row{display:flex;justify-content:space-between;align-items:center}.total-label{font-size:1rem;font-weight:600;color:#1A1A1A}.total-value{font-size:1.75rem;font-weight:700;color:#DA291C}.terms-section{background:white;border-radius:0.75rem;padding:1rem 1.5rem;box-shadow:0 1px 2px 0 rgba(0, 0, 0, 0.05)}.terms-checkbox{display:flex;align-items:flex-start;gap:0.5rem;cursor:pointer}.terms-checkbox input[type=checkbox]{display:none}.terms-checkbox .checkmark{width:22px;height:22px;border:2px solid #CCCCCC;border-radius:0.25rem;flex-shrink:0;display:flex;align-items:center;justify-content:center;transition:all 0.2s;background:white}.terms-checkbox .checkmark svg{width:14px;height:14px;stroke:white;opacity:0;transition:opacity 0.2s}.terms-checkbox input[type=checkbox]:checked+.checkmark{background:#0097A9;border-color:#0097A9}.terms-checkbox input[type=checkbox]:checked+.checkmark svg{opacity:1}.terms-checkbox .terms-text{font-size:0.875rem;color:#666666;line-height:1.5}.terms-checkbox .terms-text a{color:#0097A9;text-decoration:none;font-weight:500}.terms-checkbox .terms-text a:hover{text-decoration:underline}.btn-proceed{display:flex;align-items:center;justify-content:center;gap:0.5rem;width:100%;height:56px;background:#DA291C;color:white;border:none;border-radius:9999px;font-size:1rem;font-weight:600;cursor:pointer;transition:all 0.2s;box-shadow:0 4px 12px rgba(218, 41, 28, 0.3)}.btn-proceed svg{width:20px;height:20px;transition:transform 0.2s}.btn-proceed:hover:not(:disabled){background:rgb(172.8048780488, 32.5, 22.1951219512);box-shadow:0 6px 16px rgba(218, 41, 28, 0.4)}.btn-proceed:hover:not(:disabled) svg{transform:translateX(4px)}.btn-proceed:disabled,.btn-proceed.disabled{background:#CCCCCC;box-shadow:none;cursor:not-allowed}.btn-proceed:disabled svg,.btn-proceed.disabled svg{transform:none}`;const Be=class{constructor(e){a(this,e)}onNext;onBack;cart=null;isLoading=true;error=null;promoCode="";isApplyingPromo=false;promoError=null;promoSuccess=false;termsAccepted=false;deletingItemId=null;componentWillLoad(){this.loadCart()}async loadCart(){this.isLoading=true;this.error=null;try{const e=await G.getCart();if(e.hasError){this.error=e.message||"Error al cargar el carrito";return}this.cart=e;console.log("[StepOrderSummary] Cart loaded:",this.cart);console.log("[StepOrderSummary] Products:",this.cart.products?.map((e=>({cartId:e.cartId,name:e.productName,equipment:e.equipment,home:e.home,plan:e.plan,parentCartId:e.parentCartId,installments:e.installments,price:e.decPrice}))))}catch(e){console.error("[StepOrderSummary] Error:",e);this.error="Error de conexión al cargar el carrito"}finally{this.isLoading=false}}handlePromoCodeChange=e=>{this.promoCode=e.target.value.toUpperCase();this.promoError=null;this.promoSuccess=false};handleApplyPromo=async()=>{if(!this.promoCode.trim()){this.promoError="Ingresa un código promocional";return}this.isApplyingPromo=true;this.promoError=null;this.promoSuccess=false;try{G.storeDiscountCoupon(this.promoCode);const e=await G.getCart(this.promoCode);if(e.hasError){this.promoError="Código promocional inválido";G.clearDiscountCoupon();return}this.cart=e;this.promoSuccess=true;console.log("[StepOrderSummary] Promo applied successfully")}catch(e){console.error("[StepOrderSummary] Promo error:",e);this.promoError="Error al aplicar el código";G.clearDiscountCoupon()}finally{this.isApplyingPromo=false}};handleRemoveItem=async e=>{this.deletingItemId=e.cartId;try{const t=await G.deleteItem(e.cartId,e.productId);if(t.hasError){console.error("[StepOrderSummary] Delete error:",t.message);return}await this.loadCart()}catch(e){console.error("[StepOrderSummary] Error removing item:",e)}finally{this.deletingItemId=null}};handleTermsChange=e=>{this.termsAccepted=e.target.checked};handleProceed=()=>{if(!this.termsAccepted){return}this.onNext?.()};formatPrice(e){return`$${(e||0).toFixed(2)}`}getItemCount(){return this.cart?.products?.reduce(((e,t)=>e+t.qty),0)||0}getEquipmentItems(){if(!this.cart?.products)return[];console.log("[StepOrderSummary] Classifying products...");return this.cart.products.filter((e=>{console.log("[StepOrderSummary] Item:",e.productName,{catalogName:e.catalogName,equipment:e.equipment,home:e.home,plan:e.plan,parentCartId:e.parentCartId,installments:e.installments});if(e.catalogName==="Catalogo de Planes Fijos"){console.log("[StepOrderSummary] -> PLAN (catalogName: Catalogo de Planes Fijos)");return false}if(e.plan){console.log("[StepOrderSummary] -> PLAN (explicit plan flag)");return false}if(e.parentCartId&&e.parentCartId>0){console.log("[StepOrderSummary] -> PLAN (has parentCartId)");return false}if(e.home&&e.internet){console.log("[StepOrderSummary] -> PLAN (home + internet flags)");return false}if(e.home&&e.installments>0){console.log("[StepOrderSummary] -> EQUIPMENT (home with installments)");return true}if(e.home&&(!e.installments||e.installments===0)){console.log("[StepOrderSummary] -> PLAN (home without installments = monthly plan)");return false}if(e.equipment||e.accesory){console.log("[StepOrderSummary] -> EQUIPMENT");return true}console.log("[StepOrderSummary] -> UNKNOWN (not classified)");return false}))}getPlanItems(){if(!this.cart?.products)return[];return this.cart.products.filter((e=>{if(e.catalogName==="Catalogo de Planes Fijos")return true;if(e.plan)return true;if(e.parentCartId&&e.parentCartId>0)return true;if(e.home&&e.internet)return true;if(e.home&&(!e.installments||e.installments===0))return true;return false}))}renderEquipmentItem(e,t){const a=this.deletingItemId===e.cartId;const r=this.getPlanItems().find((t=>t.parentCartId===e.cartId));return o("div",{class:"product-card",key:`equip-${e.cartId}`},o("div",{class:"section-header section-header--equipment"},o("div",{class:"section-header__icon"},o("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},o("rect",{x:"5",y:"2",width:"14",height:"20",rx:"2",ry:"2"}),o("line",{x1:"12",y1:"18",x2:"12.01",y2:"18"}))),o("div",{class:"section-header__text"},o("span",{class:"section-header__label"},"EQUIPO"),t===0&&o("span",{class:"section-header__badge"},"Principal"))),o("div",{class:"product-card__main"},o("div",{class:"product-card__image"},o("img",{src:e.imgUrl||e.detailImage||"/assets/placeholder.png",alt:e.productName,onError:e=>e.target.src="/assets/placeholder.png"})),o("div",{class:"product-card__details"},o("h3",{class:"product-name"},e.productName),o("div",{class:"product-specs"},e.colorName&&o("div",{class:"spec-item"},o("span",{class:"color-circle",style:{backgroundColor:e.webColor||"#ccc"}}),o("span",{class:"spec-label"},e.colorName)),e.storageName&&e.storage&&o("div",{class:"spec-item"},o("span",{class:"storage-badge"},e.storage,"GB")),o("div",{class:"spec-item"},o("span",{class:"qty-label"},"Cant: ",e.qty))),e.installments>1&&o("div",{class:"financing-info"},o("span",{class:"financing-label"},"Financiamiento de Equipo:"),o("span",{class:"financing-detail"},"Término de pago (",e.installments," meses)"))),o("div",{class:"product-card__pricing"},e.installments>1?o("div",{class:"price-financing"},o("span",{class:"price-monthly"},this.formatPrice(e.decTotalPerMonth||e.decPrice)),o("span",{class:"price-period"},"/mes")):o("div",{class:"price-single"},o("span",{class:"price-total"},this.formatPrice(e.decTotalPrice||e.decPrice)))),o("div",{class:"product-card__actions"},o("button",{class:"btn-action btn-action--delete",onClick:()=>this.handleRemoveItem(e),disabled:a,title:"Eliminar"},a?o("span",{class:"spinner-small"}):o("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},o("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"}),o("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),o("line",{x1:"14",y1:"11",x2:"14",y2:"17"}))))),r&&this.renderAssociatedPlan(r))}renderAssociatedPlan(e){const t=this.deletingItemId===e.cartId;return o("div",{class:"plan-section"},o("div",{class:"section-header section-header--plan"},o("div",{class:"section-header__icon"},o("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},o("path",{d:"M22 12h-4l-3 9L9 3l-3 9H2"}))),o("div",{class:"section-header__text"},o("span",{class:"section-header__label"},"TU PLAN"))),o("div",{class:"plan-section__content"},o("div",{class:"plan-info"},o("span",{class:"plan-name"},e.productName),o("span",{class:"plan-type"},"Plan de Internet")),o("div",{class:"plan-price"},o("span",{class:"price"},this.formatPrice(e.decPrice||e.decTotalPerMonth)),o("span",{class:"period"},"/mes")),o("button",{class:"btn-action btn-action--delete-small",onClick:()=>this.handleRemoveItem(e),disabled:t,title:"Eliminar plan"},t?o("span",{class:"spinner-small"}):o("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},o("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"})))))}renderStandalonePlan(e){const t=this.deletingItemId===e.cartId;return o("div",{class:"product-card product-card--plan",key:`plan-${e.cartId}`},o("div",{class:"section-header section-header--plan"},o("div",{class:"section-header__icon"},o("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},o("path",{d:"M22 12h-4l-3 9L9 3l-3 9H2"}))),o("div",{class:"section-header__text"},o("span",{class:"section-header__label"},"PLAN DE INTERNET"))),o("div",{class:"product-card__main product-card__main--plan"},o("div",{class:"product-card__image product-card__image--plan"},o("img",{src:e.imgUrl||e.detailImage||"/assets/placeholder.png",alt:e.productName,onError:e=>e.target.src="/assets/placeholder.png"})),o("div",{class:"product-card__details"},o("h3",{class:"product-name"},e.productName),o("span",{class:"plan-type"},"Renta mensual")),o("div",{class:"product-card__pricing"},o("div",{class:"price-financing"},o("span",{class:"price-monthly"},this.formatPrice(e.decPrice||e.decTotalPerMonth)),o("span",{class:"price-period"},"/mes"))),o("div",{class:"product-card__actions"},o("button",{class:"btn-action btn-action--delete",onClick:()=>this.handleRemoveItem(e),disabled:t,title:"Eliminar"},t?o("span",{class:"spinner-small"}):o("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},o("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"}))))))}renderPromoCode(){return o("div",{class:"summary-card promo-section"},o("h4",{class:"summary-card__title"},o("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},o("path",{d:"M20.59 13.41l-7.17 7.17a2 2 0 01-2.83 0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"}),o("line",{x1:"7",y1:"7",x2:"7.01",y2:"7"})),"Cupón de descuento"),o("div",{class:"promo-input-group"},o("input",{type:"text",class:{"promo-input":true,error:!!this.promoError,success:this.promoSuccess},placeholder:"Ingresa tu código",value:this.promoCode,onInput:this.handlePromoCodeChange,disabled:this.isApplyingPromo}),o("button",{class:"promo-button",onClick:this.handleApplyPromo,disabled:this.isApplyingPromo||!this.promoCode.trim()},this.isApplyingPromo?o("span",{class:"spinner-small"}):"Aplicar")),this.promoError&&o("span",{class:"promo-message error"},o("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"14",height:"14"},o("circle",{cx:"12",cy:"12",r:"10"}),o("line",{x1:"12",y1:"8",x2:"12",y2:"12",stroke:"white","stroke-width":"2"}),o("line",{x1:"12",y1:"16",x2:"12.01",y2:"16",stroke:"white","stroke-width":"2"})),this.promoError),this.promoSuccess&&o("span",{class:"promo-message success"},o("svg",{viewBox:"0 0 24 24",fill:"currentColor",width:"14",height:"14"},o("circle",{cx:"12",cy:"12",r:"10"}),o("polyline",{points:"9 12 11 14 15 10",fill:"none",stroke:"white","stroke-width":"2"})),"¡Cupón aplicado!"))}renderPaymentSummary(){if(!this.cart)return null;const e=this.cart.subTotalPerMonth||0;const t=this.cart.subTotalPrice||0;const a=this.cart.totalTax||0;const r=this.cart.totalPrice||0;const i=this.cart.totalDownPayment||0;const n=0;return o("div",{class:"summary-card payment-summary"},e>0&&o("div",{class:"rent-section"},o("div",{class:"rent-row"},o("span",{class:"rent-label"},"Renta mensual"),o("span",{class:"rent-value"},this.formatPrice(e))),o("p",{class:"rent-note"},"*No incluye cargos estatales y federales")),o("div",{class:"payment-breakdown"},o("h4",{class:"summary-card__title"},o("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},o("rect",{x:"1",y:"4",width:"22",height:"16",rx:"2",ry:"2"}),o("line",{x1:"1",y1:"10",x2:"23",y2:"10"})),"Detalle del pago"),o("div",{class:"detail-rows"},t>0&&o("div",{class:"detail-row"},o("span",{class:"label"},"Subtotal equipos"),o("span",{class:"value"},this.formatPrice(t))),i>0&&o("div",{class:"detail-row"},o("span",{class:"label"},"Pago inicial"),o("span",{class:"value"},this.formatPrice(i))),n>0,o("div",{class:"detail-row"},o("span",{class:"label"},"Cargos estatales y federales"),o("span",{class:"value"},this.formatPrice(a))),o("div",{class:"detail-row detail-row--shipping"},o("span",{class:"label"},"Costo de envío"),o("span",{class:"value value--free"},"GRATIS"))),o("div",{class:"total-section"},o("div",{class:"total-row"},o("span",{class:"total-label"},"Paga hoy"),o("span",{class:"total-value"},this.formatPrice(r))))))}renderTermsCheckbox(){return o("div",{class:"terms-section"},o("label",{class:"terms-checkbox"},o("input",{type:"checkbox",checked:this.termsAccepted,onChange:this.handleTermsChange}),o("span",{class:"checkmark"},o("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3"},o("polyline",{points:"20 6 9 17 4 12"}))),o("span",{class:"terms-text"},"Acepto los ",o("a",{href:"#",onClick:e=>e.preventDefault()},"términos y condiciones")," de Claro Puerto Rico")))}render(){const e=this.getItemCount();const t=e>0;const a=t&&this.termsAccepted;const r=this.getEquipmentItems();const n=this.getPlanItems().filter((e=>!e.parentCartId));return o(i,{key:"b2ec1785f21c9c35b36fa6d31fbdeb11b464e65e"},o("div",{key:"cb552177b74f1d602fa93bc610a13ce6af52805c",class:"step-order-summary"},o("header",{key:"b5a697e1f6808e66f3760e9299f84f2801430d78",class:"header"},o("button",{key:"e84200d29c18faa843ff384f221109d64bbc060c",class:"btn-back",onClick:this.onBack},o("svg",{key:"2e28625d7070d769288d746b61b97a2e17cb7ec0",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},o("path",{key:"1968e8385d820f5df38b704fc2abab5a01e96aff",d:"M19 12H5M12 19l-7-7 7-7"})),o("span",{key:"fedeeef4a8b1b5b6927204312fa8625a239aafe1"},"Regresar")),o("div",{key:"2917ed4718750946ff43203dadfd9961cf5b1a4a",class:"header__title-group"},o("h1",{key:"93acee9959cb3b1a7bd946f33652cbaed97443b6",class:"title"},"Resumen de tu orden"),t&&o("span",{key:"de58f045d7e22dc3502a648ebb6ca656c87e7140",class:"item-count"},e," ",e===1?"artículo":"artículos"))),this.isLoading&&o("div",{key:"b9d96c48dd5107970a60042eff947178972e5934",class:"state-container"},o("div",{key:"1438994b11f2b9c7713d73919fc989fd676eece0",class:"spinner"}),o("p",{key:"37d9e18591aa01629b3786a3ebd1d78f2f81e844"},"Cargando tu carrito...")),this.error&&!this.isLoading&&o("div",{key:"d221c3774f1b8cc8481234e54121204ef7f6adfc",class:"state-container state-container--error"},o("svg",{key:"bbd743f12e5598ab679be1b627cea45c4c03e005",class:"state-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},o("circle",{key:"51afad1d3b42c205b80682c33f03e177ccf09e5d",cx:"12",cy:"12",r:"10"}),o("line",{key:"70d5483837636b118c28a3b6256cf0bd53ea6b88",x1:"12",y1:"8",x2:"12",y2:"12"}),o("line",{key:"c8c297af492a18cc059ef5c52b20afb40c3db396",x1:"12",y1:"16",x2:"12.01",y2:"16"})),o("p",{key:"11e2a19b976f00746334045d6dd079cb92d97361"},this.error),o("button",{key:"84d00069547fc6f0e1c772258d857a8a70c0a5e3",class:"btn-retry",onClick:()=>this.loadCart()},"Reintentar")),!this.isLoading&&!this.error&&!t&&o("div",{key:"bb41c96c5d54c70e0f1c92523bef00850623a2e5",class:"state-container state-container--empty"},o("svg",{key:"25aa0769197935f67437e699d9144813cb58bbd3",class:"state-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},o("circle",{key:"786409612f5171f0cd305e024b489cf9bbb2b3ec",cx:"9",cy:"21",r:"1"}),o("circle",{key:"be250ebcd4c603e36e0e3cc239442447dccc9261",cx:"20",cy:"21",r:"1"}),o("path",{key:"258da867de0fb9195c37c68a7a0ea626560e68a9",d:"M1 1h4l2.68 13.39a2 2 0 002 1.61h9.72a2 2 0 002-1.61L23 6H6"})),o("h3",{key:"17d340458d0ed2a1de566a9fe82096c989d61724"},"Tu carrito está vacío"),o("p",{key:"fa0891a2a328e4b6454369c4117028a7f69ef6b5"},"Agrega productos para continuar con tu compra"),o("button",{key:"50e70ea224a3fbb8b7ea69ce724f32de3409652c",class:"btn-back-catalog",onClick:this.onBack},"Ir al catálogo")),!this.isLoading&&!this.error&&t&&o("div",{key:"32a5153e90bfab74638ff32a0eeea5a13d156245",class:"content-layout"},o("div",{key:"b32b4be6317516469e68afeb2a9cd9c988c8dd23",class:"products-column"},r.map(((e,t)=>this.renderEquipmentItem(e,t))),n.map((e=>this.renderStandalonePlan(e)))),o("div",{key:"5a008f064bf26b937d616d2e33c612f75c91a953",class:"summary-column"},this.renderPromoCode(),this.renderPaymentSummary(),this.renderTermsCheckbox(),o("button",{key:"1c95698ad466dd20c8099bd8e300716be4210266",class:{"btn-proceed":true,disabled:!a},onClick:this.handleProceed,disabled:!a},o("span",{key:"07865808884448a3309c11e038fe73e8db8bd800"},"Procesar orden"),o("svg",{key:"0b892573558db7582e4892774feefce1ac757cd5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},o("path",{key:"753d264532f2ceecc53707e40a1c5edd9c72f08e",d:"M5 12h14M12 5l7 7-7 7"})))))))}};Be.style=Re();const je=()=>`:host{display:block;width:100%;min-height:100%;background-color:#FAFAFA}.step-payment{width:100%;max-width:800px;margin:0 auto;padding:1.5rem;min-height:100vh}.header{display:flex;align-items:center;gap:1rem;margin-bottom:1.5rem;flex-wrap:wrap}.header .btn-back-nav{display:flex;align-items:center;gap:0.25rem;background:none;border:none;color:#0097A9;font-size:0.875rem;cursor:pointer;padding:0.25rem}.header .btn-back-nav svg{width:20px;height:20px}.header .btn-back-nav:hover{text-decoration:underline}.header .title{font-size:1.75rem;font-weight:700;color:#1A1A1A;margin:0;flex:1}.content{background:white;border-radius:0.75rem;padding:1.5rem;box-shadow:0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);min-height:400px}.loading-container{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:300px;text-align:center;padding:2rem}.loading-container h3{font-size:1.5rem;color:#1A1A1A;margin:1rem 0 0.5rem 0}.loading-container p{color:#666666;margin:0 0 0.5rem 0}.loading-container .warning{color:#DA291C;font-weight:500;font-size:0.875rem}.spinner{width:48px;height:48px;border:4px solid #E5E5E5;border-top-color:#DA291C;border-radius:50%;animation:spin 1s linear infinite}@keyframes spin{to{transform:rotate(360deg)}}.payment-container{display:flex;flex-direction:column;gap:1.5rem}.payment-summary{background:#FAFAFA;border-radius:0.5rem;padding:1rem}.payment-summary h3{font-size:1rem;font-weight:600;color:#1A1A1A;margin:0 0 1rem 0}.amount-display{display:flex;justify-content:space-between;align-items:center;padding:0.5rem 0;border-bottom:1px solid #E5E5E5}.amount-display .label{font-size:1rem;color:#666666}.amount-display .value{font-size:1.5rem;font-weight:700;color:#DA291C}.payment-items{margin-top:1rem}.payment-items .payment-item{display:flex;justify-content:space-between;align-items:center;padding:0.25rem 0;font-size:0.875rem}.payment-items .payment-item .item-type{color:#666666}.payment-items .payment-item .item-amount{color:#1A1A1A;font-weight:500}.iframe-container{border:1px solid #E5E5E5;border-radius:0.5rem;overflow:hidden;min-height:400px}.iframe-container iframe{display:block;border:none;width:100%}.iframe-placeholder{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:300px;background:#FAFAFA}.iframe-placeholder p{color:#666666;margin-top:1rem}.success-container{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:300px;text-align:center;padding:2rem}.success-container .success-icon{width:80px;height:80px;background:rgb(209.6296296296, 237.3703703704, 219.2222222222);border-radius:50%;display:flex;align-items:center;justify-content:center;margin-bottom:1rem}.success-container .success-icon svg{width:48px;height:48px;color:#44AF69}.success-container h3{font-size:1.5rem;color:#44AF69;margin:0 0 0.5rem 0}.success-container p{color:#666666;margin:0 0 0.5rem 0}.success-container .redirect-note{font-size:0.875rem;color:#808080}.error-container{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:300px;text-align:center;padding:2rem}.error-container .error-icon{width:80px;height:80px;background:rgb(245.2682926829, 183.75, 179.2317073171);border-radius:50%;display:flex;align-items:center;justify-content:center;margin-bottom:1rem}.error-container .error-icon svg{width:48px;height:48px;color:#DA291C}.error-container h3{font-size:1.5rem;color:#DA291C;margin:0 0 0.5rem 0}.error-container p{color:#666666;margin:0 0 1.5rem 0;max-width:400px}.error-actions{display:flex;gap:1rem;flex-wrap:wrap;justify-content:center}.btn-retry{height:44px;padding:0 1.5rem;background:#DA291C;color:white;border:none;border-radius:9999px;font-size:1rem;font-weight:600;cursor:pointer;transition:background 0.2s}.btn-retry:hover{background:rgb(172.8048780488, 32.5, 22.1951219512)}.btn-back{height:44px;padding:0 1.5rem;background:white;color:#4D4D4D;border:1px solid #CCCCCC;border-radius:9999px;font-size:1rem;font-weight:600;cursor:pointer;transition:all 0.2s}.btn-back:hover{background:#FAFAFA;border-color:#999999}.btn-cancel{align-self:center;height:44px;padding:0 1.5rem;background:white;color:#666666;border:1px solid #CCCCCC;border-radius:9999px;font-size:0.875rem;cursor:pointer;transition:all 0.2s}.btn-cancel:hover{background:#FAFAFA;border-color:#999999}`;const Ue=class{constructor(e){a(this,e)}get el(){return n(this)}onNext;onBack;paymentIframeUrl;screen="loading";error=null;cart=null;orderBan="";totalAmount=0;paymentItems=[];iframeUrl="";iframeHeight="500px";paymentResult=null;userName="";userLastName="";userEmail="";componentWillLoad(){this.loadCartAndPreparePayment()}componentDidLoad(){window.addEventListener("message",this.handleIframeMessage)}disconnectedCallback(){window.removeEventListener("message",this.handleIframeMessage)}async loadCartAndPreparePayment(){this.screen="loading";this.error=null;try{const e=await G.getCart();if(e.hasError){this.error=e.message||"Error al cargar el carrito";this.screen="error";return}if(!e.products||e.products.length===0){this.error="El carrito está vacío";this.screen="error";return}this.cart=e;this.paymentItems=oe.buildPaymentItems({depositAmount:e.depositAmount,totalDownPayment:e.totalDownPayment,totalTax:e.totalTax,totalPrice:e.totalPrice,installmentAmount:e.installmentAmount,cartUpdateResponse:e.cartUpdateResponse});this.totalAmount=this.paymentItems.length>0?oe.calculateTotalAmount(this.paymentItems):e.totalPrice||0;const t=te.getStoredShippingAddress();if(t){const e=t.name.split(" ");this.userName=e[0]||"";this.userLastName=e.slice(1).join(" ")||"";this.userEmail=t.email}await this.createOrder()}catch(e){console.error("[StepPayment] Error:",e);this.error="Error de conexión";this.screen="error"}}async createOrder(){this.screen="creating-order";try{const e=te.getZipCode();const t=await oe.createOrder({flowId:"5",frontFlowId:"1",frontFlowName:"CLARO HOGAR Purchase",amount:this.totalAmount.toString(),email:this.userEmail,zipCode:e,deposit:(this.cart?.totalDownPayment||0).toString()});if(t.hasError){this.error=t.errorDisplay||t.message||"Error al crear la orden";this.screen="error";return}this.orderBan=t.ban||"";await this.initializePaymentIframe()}catch(e){console.error("[StepPayment] Create order error:",e);this.error="Error al crear la orden";this.screen="error"}}async initializePaymentIframe(){if(this.totalAmount<=0){await this.handleFreePayment();return}try{const e={firstName:this.userName,lastName:this.userLastName,email:this.userEmail,amount:this.totalAmount,transactionType:this.paymentItems.length>0?"MULTIPLE":"payment",selectBan:this.orderBan,permissions:{provision:true,displayConfirmation:true,emailNotification:true,showInstrument:true,stroeInstrument:true,useBanZipCode:true},paymentItems:this.paymentItems.length>0?this.paymentItems:undefined};const t=await oe.getPaymentIframe(e);if(t.errorInfo?.hasError||!t.url){this.error=t.errorInfo?.errorDisplay||"Error al inicializar el pago";this.screen="error";return}this.iframeUrl=t.url;this.screen="payment"}catch(e){console.error("[StepPayment] Init iframe error:",e);this.error="Error al inicializar el formulario de pago";this.screen="error"}}handleIframeMessage=e=>{if(typeof e.data!=="string")return;try{const t=JSON.parse(atob(e.data));if(t.state==="dimensions"){this.iframeHeight=t.data.height}if(t.state==="canceled"){this.handlePaymentCancel()}if(t.state==="paymentResult"){if(t.data){const e=t.data;const a=JSON.parse(e).paymentResult;const r=JSON.parse(atob(a));if(r.success){this.handlePaymentSuccess(r)}else{this.handlePaymentError(r)}}}}catch{}};async handlePaymentSuccess(e){this.screen="processing";this.paymentResult=e;try{const t=await oe.recordPayment({ban:this.orderBan,cardNumber:e.paymentCard||"",cardType:e.paymentMethod||"",authorizationNumber:e.authorizationNumber||"",referenceNumber:e.provisioning?.referenceNumber||"",description:e.description||"",operationId:e.operationId||"",amount:this.totalAmount.toString(),deposit:(this.cart?.totalDownPayment||0).toString()});if(t.hasError){this.error=t.errorDisplay||"Error al registrar el pago";this.screen="error";return}oe.storePaymentResult(e);this.screen="success";setTimeout((()=>{this.onNext?.()}),2e3)}catch(e){console.error("[StepPayment] Record payment error:",e);this.error="Error al registrar el pago";this.screen="error"}}async handlePaymentError(e){await oe.recordPaymentError(this.orderBan,"",e.description||"Payment failed",e.operationId||"",(this.cart?.totalDownPayment||0).toString(),e.paymentMethod||"",e.paymentCard||"",this.totalAmount.toString());this.error=e.description||"El pago no pudo ser procesado";this.screen="error"}handlePaymentCancel(){this.onBack?.()}async handleFreePayment(){this.screen="processing";try{const e=Math.floor(Math.random()*9e5+1e5).toString();const t=await oe.recordPayment({ban:this.orderBan,cardNumber:"1111",cardType:"V",authorizationNumber:"FREEPR",referenceNumber:"FREEPROMO",description:"Free promotion",operationId:e,amount:"0",deposit:"0"});if(t.hasError){this.error=t.errorDisplay||"Error al procesar";this.screen="error";return}this.screen="success";setTimeout((()=>{this.onNext?.()}),2e3)}catch(e){console.error("[StepPayment] Free payment error:",e);this.error="Error al procesar";this.screen="error"}}handleRetry=()=>{this.loadCartAndPreparePayment()};formatPrice(e){return`$${(e||0).toFixed(2)}`}renderLoading(){return o("div",{class:"loading-container"},o("div",{class:"spinner"}),o("p",null,"Cargando información del pago..."))}renderCreatingOrder(){return o("div",{class:"loading-container"},o("div",{class:"spinner"}),o("h3",null,"Preparando tu orden"),o("p",null,"Por favor espera mientras procesamos tu solicitud..."),o("p",{class:"warning"},"No cierres esta ventana ni navegues a otra página."))}renderPaymentForm(){return o("div",{class:"payment-container"},o("div",{class:"payment-summary"},o("h3",null,"Resumen del pago"),o("div",{class:"amount-display"},o("span",{class:"label"},"Total a pagar:"),o("span",{class:"value"},this.formatPrice(this.totalAmount))),this.paymentItems.length>0&&o("div",{class:"payment-items"},this.paymentItems.map((e=>o("div",{class:"payment-item"},o("span",{class:"item-type"},this.getPaymentTypeLabel(e.paymentType)),o("span",{class:"item-amount"},this.formatPrice(e.amount))))))),o("div",{class:"iframe-container"},this.iframeUrl?o("iframe",{src:this.iframeUrl,width:"100%",height:this.iframeHeight,frameBorder:"0",title:"Payment Form"}):o("div",{class:"iframe-placeholder"},o("div",{class:"spinner"}),o("p",null,"Cargando formulario de pago..."))),o("button",{class:"btn-cancel",onClick:()=>this.handlePaymentCancel()},"Cancelar"))}renderProcessing(){return o("div",{class:"loading-container"},o("div",{class:"spinner"}),o("h3",null,"Procesando pago"),o("p",null,"Por favor espera mientras confirmamos tu pago..."))}renderSuccess(){return o("div",{class:"success-container"},o("div",{class:"success-icon"},o("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},o("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),o("polyline",{points:"22 4 12 14.01 9 11.01"}))),o("h3",null,"Pago exitoso"),o("p",null,"Tu pago ha sido procesado correctamente."),o("p",{class:"redirect-note"},"Redirigiendo a la confirmación..."))}renderError(){return o("div",{class:"error-container"},o("div",{class:"error-icon"},o("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},o("circle",{cx:"12",cy:"12",r:"10"}),o("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),o("line",{x1:"9",y1:"9",x2:"15",y2:"15"}))),o("h3",null,"Error en el pago"),o("p",null,this.error),o("div",{class:"error-actions"},o("button",{class:"btn-retry",onClick:this.handleRetry},"Intentar nuevamente"),o("button",{class:"btn-back",onClick:()=>this.onBack?.()},"Volver")))}getPaymentTypeLabel(e){const t={DEPOSIT:"Depósito",DOWNPAYMENT:"Pago inicial",TAXES:"Impuestos",INSTALLMENT:"Cuotas",PASTDUEONLY:"Balance pendiente"};return t[e]||e}render(){return o(i,{key:"44154235d6e0c51f68086e9c8a954f779d7068e4"},o("div",{key:"da809c7b605455a5dd7efc2b28728c1767d5e48e",class:"step-payment"},o("div",{key:"cc23c00669a5f05e6c8486ab3920918cceab0c87",class:"header"},this.screen!=="processing"&&this.screen!=="success"&&o("button",{key:"a73cf3b08d251a0bcbfdc55a8d83fbf5bad93dc1",class:"btn-back-nav",onClick:()=>this.onBack?.()},o("svg",{key:"6f194f901fdad89e39a8ad7c23381953ac937a37",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},o("path",{key:"e6187e8babfbcbcab83522c07f7cdffdfc9f8ebc",d:"M19 12H5M12 19l-7-7 7-7"})),"Regresar"),o("h1",{key:"e72c0f65e18954f3af18d46f13fe2e85464206b4",class:"title"},"Pago")),o("div",{key:"67ce4b79e0a0e7f7029e5cd3271592be219ea0dc",class:"content"},this.screen==="loading"&&this.renderLoading(),this.screen==="creating-order"&&this.renderCreatingOrder(),this.screen==="payment"&&this.renderPaymentForm(),this.screen==="processing"&&this.renderProcessing(),this.screen==="success"&&this.renderSuccess(),this.screen==="error"&&this.renderError())))}};Ue.style=je();const qe=()=>`@keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes slideUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}@keyframes spin{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}:host{display:block}.step-plans{width:100%;min-height:100vh;padding:1.5rem;padding-bottom:180px}@media (min-width: 768px){.step-plans{padding:2rem;padding-bottom:140px}}.step-plans__header{display:flex;align-items:center;justify-content:space-between;margin-bottom:2rem}.step-plans__title{font-size:1.5rem;font-weight:700;color:#333333;margin:0}@media (min-width: 768px){.step-plans__title{font-size:1.75rem}}.step-plans__btn-back{background:#FFFFFF;border:2px solid #0097A9;color:#0097A9;padding:0.5rem 1.5rem;border-radius:9999px;font-size:0.875rem;font-weight:600;cursor:pointer;transition:all 0.2s ease}.step-plans__btn-back:hover{background:#0097A9;color:#FFFFFF}.step-plans__loading{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:3rem;color:#666666}.step-plans__spinner{width:40px;height:40px;border:3px solid #E5E5E5;border-top-color:#0097A9;border-radius:50%;animation:spin 1s linear infinite;margin-bottom:1rem}.step-plans__error{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:2rem;text-align:center;color:#DA291C}.step-plans__error button{display:inline-flex;align-items:center;justify-content:center;gap:0.5rem;padding:0 1.5rem;font-family:"AMX", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, sans-serif;font-size:1rem;font-weight:600;line-height:1;text-decoration:none;border:none;border-radius:9999px;cursor:pointer;transition:all 150ms ease}.step-plans__error button:disabled{opacity:0.5;cursor:not-allowed}.step-plans__error button{height:48px;background-color:transparent;color:#0097A9;border:2px solid #0097A9}.step-plans__error button:hover:not(:disabled){background-color:rgba(0, 151, 169, 0.1)}.step-plans__error button:active:not(:disabled){background-color:rgba(0, 151, 169, 0.2)}.step-plans__error button{margin-top:1rem}.step-plans__carousel-container{padding:1rem 0 3rem}.step-plans__empty{display:flex;align-items:center;justify-content:center;padding:3rem;color:#666666}.step-plans__footer{position:fixed;bottom:0;left:0;right:0;background:#FFFFFF;border-top:1px solid #E5E5E5;padding:0.75rem 1.5rem;z-index:200;box-shadow:0 -4px 12px rgba(0, 0, 0, 0.1);display:flex;align-items:center;justify-content:space-between}@media (max-width: 767px){.step-plans__footer{flex-direction:column;gap:0.75rem;padding:1rem}}.step-plans__footer-left{display:flex;flex-direction:column}@media (max-width: 767px){.step-plans__footer-left{width:100%}}.step-plans__footer-info{display:flex;gap:1.5rem}.step-plans__footer-item{display:flex;flex-direction:column}.step-plans__footer-item--separator{padding-left:1.5rem;border-left:1px solid #E5E5E5}.step-plans__footer-label{font-size:0.75rem;color:#666666}.step-plans__footer-value{font-size:1.25rem;font-weight:700;color:#333333}.step-plans__footer-value--highlight{color:#DA291C}.step-plans__footer-note{font-size:0.75rem;color:#808080;margin:0.25rem 0 0}.step-plans__footer-btn{display:inline-flex;align-items:center;justify-content:center;gap:0.5rem;padding:0 1.5rem;font-family:"AMX", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, sans-serif;font-size:1rem;font-weight:600;line-height:1;text-decoration:none;border:none;border-radius:9999px;cursor:pointer;transition:all 150ms ease}.step-plans__footer-btn:disabled{opacity:0.5;cursor:not-allowed}.step-plans__footer-btn{height:48px;background-color:#DA291C;color:#FFFFFF}.step-plans__footer-btn:hover:not(:disabled){background-color:rgb(181.843902439, 34.2, 23.356097561)}.step-plans__footer-btn:active:not(:disabled){background-color:rgb(163.7658536585, 30.8, 21.0341463415)}.step-plans__footer-btn{min-width:160px}@media (max-width: 767px){.step-plans__footer-btn{width:100%}}.plan-card{background:#FFFFFF;border-radius:16px;border:2px solid #0097A9;box-shadow:0 2px 12px rgba(0, 0, 0, 0.1);overflow:hidden;cursor:pointer;transition:all 0.2s ease;display:flex;flex-direction:column;height:100%;min-height:340px}.plan-card:hover{box-shadow:0 6px 20px rgba(0, 151, 169, 0.25);transform:translateY(-2px)}.plan-card--selected{border-color:#0097A9;box-shadow:0 6px 24px rgba(0, 151, 169, 0.3)}.plan-card--processing{pointer-events:none;opacity:0.8}.plan-card__header{display:flex;justify-content:center;padding-top:0}.plan-card__name{background:#1a1a1a;color:#FFFFFF;font-size:0.875rem;font-weight:700;text-transform:uppercase;letter-spacing:0.5px;line-height:1.3;padding:0.75rem 1rem;width:70%;text-align:center;border-radius:0 0 12px 12px}.plan-card__body{flex:1;padding:1.25rem 1rem;text-align:center;display:flex;flex-direction:column}.plan-card__includes-label{font-size:1rem;color:#666666;margin:0 0 0.75rem;font-weight:500}.plan-card__features{list-style:none;padding:0;margin:0 0 1rem;text-align:center;flex:1}.plan-card__feature{margin-bottom:0.5rem;font-size:0.875rem;color:#333333;font-weight:600}.plan-card__feature:last-child{margin-bottom:0}.plan-card__price{font-size:1.75rem;font-weight:700;color:#0097A9;margin:1rem 0 0}.plan-card__footer{padding:1rem}.plan-card__btn{width:100%;padding:0.75rem 1rem;border-radius:25px;font-size:1rem;font-weight:600;cursor:pointer;transition:all 0.2s ease;background:#0097A9;color:#FFFFFF;border:2px solid #0097A9}.plan-card__btn:hover{background:rgb(0, 114.5455621302, 128.2)}.plan-card__btn--selected{background:#0097A9;color:#FFFFFF;border-color:#0097A9}.plan-card__btn--selected:hover{background:rgb(0, 114.5455621302, 128.2)}.plan-card__btn--loading{cursor:wait;opacity:0.8}.plan-card__btn:disabled{cursor:not-allowed;opacity:0.6}.plan-card__btn-loading{display:inline-flex;align-items:center;gap:0.5rem}.plan-card__btn-spinner{width:14px;height:14px;border:2px solid rgba(255, 255, 255, 0.3);border-top-color:#FFFFFF;border-radius:50%;animation:spin 0.8s linear infinite}@keyframes spin{to{transform:rotate(360deg)}}`;const $e=class{constructor(e){a(this,e)}onNext;onBack;plans=[];selectedPlan=null;isLoading=true;error=null;isAddingToCart=false;async componentWillLoad(){await this.loadPlans();const e=D.getStoredPlanId();if(e>0){const t=this.plans.find((t=>t.planId===e));if(t){this.selectedPlan=t;_.selectPlan(t)}}}async loadPlans(){this.isLoading=true;this.error=null;try{const e=g.location?.serviceType||"GPON";let t=0;if(e==="CLARO HOGAR"){t=W.getSubcatalogId();console.log("[StepPlans] CLARO HOGAR - using subcatalogId:",t)}this.plans=await D.getPlans(e,t);this.plans=D.sortByPrice(this.plans)}catch(e){this.error="Error al cargar los planes";console.error(e)}finally{this.isLoading=false}}handleSelectPlan=async e=>{if(this.selectedPlan?.planId===e.planId){return}this.isAddingToCart=true;this.error=null;try{const t=D.getStoredPlanId();const a=D.getCartId();if(t>0&&t!==e.planId&&a>0){console.log("[StepPlans] Removing previous plan from cart:",t);await D.deleteFromCart(a)}console.log("[StepPlans] Adding plan to cart:",e.planId,e.planName);await D.addToCart(e);this.selectedPlan=e;_.selectPlan(e);console.log("[StepPlans] Plan added successfully")}catch(t){console.error("[StepPlans] Error adding plan to cart:",t);this.error="Error al agregar el plan. Por favor intente de nuevo.";this.selectedPlan=e;_.selectPlan(e)}finally{this.isAddingToCart=false}};handleContinue=()=>{if(this.selectedPlan&&!this.isAddingToCart){this.onNext?.()}};renderPlanCard(e){const t=this.selectedPlan?.planId===e.planId;const a=this.isAddingToCart&&t;const r=D.parsePlanFeatures(e.planDesc||"");const i=r.length>0?r:["Internet fibra 1","Internet 2","Internet 3"];return o("div",{class:{"plan-card":true,"plan-card--selected":t,"plan-card--processing":a},onClick:()=>!this.isAddingToCart&&this.handleSelectPlan(e)},o("div",{class:"plan-card__header"},o("span",{class:"plan-card__name"},e.planName)),o("div",{class:"plan-card__body"},o("p",{class:"plan-card__includes-label"},"Plan incluye"),o("ul",{class:"plan-card__features"},i.slice(0,4).map((e=>o("li",{class:"plan-card__feature"},e)))),o("p",{class:"plan-card__price"},me(e.decPrice))),o("div",{class:"plan-card__footer"},o("button",{class:{"plan-card__btn":true,"plan-card__btn--selected":t,"plan-card__btn--loading":a},disabled:this.isAddingToCart},a?o("span",{class:"plan-card__btn-loading"},o("span",{class:"plan-card__btn-spinner"}),"Agregando..."):t?"Plan seleccionado":"Solicitar plan")))}render(){const e=this.selectedPlan?this.selectedPlan.decPrice:0;const t=0;return o(i,{key:"f90e6ba5821a28e4e5f983615adc5a3218868956"},o("div",{key:"79a0c14ab238617c59f1ff5436dc6af44f3f0683",class:"step-plans"},o("header",{key:"b71d68973c440c41cd4592513d5d1bd6dae9c41b",class:"step-plans__header"},o("h1",{key:"4770b64ac2afb94ca2b7b21337c55cd86bf6be7f",class:"step-plans__title"},"Elige tu plan"),o("button",{key:"0ba38403d199f066c0944b6af089c2c51d42309e",class:"step-plans__btn-back",onClick:this.onBack},"Regresar")),this.isLoading&&o("div",{key:"5d7e90e2419441027e3d4f0fa03cc2793c79730a",class:"step-plans__loading"},o("div",{key:"e48d4c41ee85dece546dd6740e639070bec33753",class:"step-plans__spinner"}),o("p",{key:"a94f566bbdade38082f07ad8e2be62b22c09935f"},"Cargando planes...")),this.error&&o("div",{key:"1e4324ae465f14197fdfad41df685bb5eb12e457",class:"step-plans__error"},o("p",{key:"b5f8f80c34c2e79ed39c306c47b768ce5620a1d3"},this.error),o("button",{key:"64dc9be6815138ce73bdb7b3b0f7cdc4191e48e2",onClick:()=>this.loadPlans()},"Reintentar")),!this.isLoading&&!this.error&&this.plans.length>0&&o("div",{key:"934396bfe8daaf91fd8058b091c7213deadbfca4",class:"step-plans__carousel-container"},o("ui-carousel",{key:"4efad9d0371be107f6e4cc53a606b3302385746e",totalItems:this.plans.length,gap:24,showNavigation:true,showPagination:true,breakpoints:[{minWidth:0,slidesPerView:1},{minWidth:500,slidesPerView:2},{minWidth:800,slidesPerView:3},{minWidth:1100,slidesPerView:4}]},this.plans.map((e=>this.renderPlanCard(e))))),!this.isLoading&&!this.error&&this.plans.length===0&&o("div",{key:"ef83deed8110a1e7813e3519f4be6c3e71503dd7",class:"step-plans__empty"},o("p",{key:"5e59e9a93fc9183924c55562bec1a82cf470f627"},"No hay planes disponibles para tu área.")),o("footer",{key:"bb02536a909fbc93b517289a0081b4c58eb04e77",class:"step-plans__footer"},o("div",{key:"f07704ad52b838b02dd1aad4bd4c49790c5037ff",class:"step-plans__footer-left"},o("div",{key:"14c7fda022c35e387cf64a7d4e9929d61c32a780",class:"step-plans__footer-info"},o("div",{key:"dc512c9cb011ea940939b18574ca9e7c127595be",class:"step-plans__footer-item"},o("span",{key:"052b07f383750d4702c8afad52c261a95e2834ad",class:"step-plans__footer-label"},"Pago mensual"),o("span",{key:"a423f3beb6240da1231f0655cf5a292ea5a94a77",class:"step-plans__footer-value"},me(e))),o("div",{key:"492dbd86cb3bb898b6de245a8ceb432577b14693",class:"step-plans__footer-item step-plans__footer-item--separator"},o("span",{key:"24e67f197823f76b8c5e63b406597c52fb3c3ef3",class:"step-plans__footer-label"},"Paga hoy"),o("span",{key:"d24c732928300a3171b5aec04aa8918c6c15d13f",class:"step-plans__footer-value step-plans__footer-value--highlight"},me(t)))),o("p",{key:"c15325575b62b2019afcbe8d3725668e8cf7cf40",class:"step-plans__footer-note"},"Renta mensual aproximada no incluye cargos estatales, federales, ni otros impuestos.")),o("button",{key:"c448e3ec1492120118234e259513a92b981d49e0",class:"step-plans__footer-btn",onClick:this.handleContinue,disabled:!this.selectedPlan||this.isAddingToCart},this.isAddingToCart?"Procesando...":"Continuar"))))}};$e.style=qe();const Je=()=>`:host{display:block;width:100%;min-height:100%;background-color:#FAFAFA}.step-product-detail{width:100%;max-width:1200px;margin:0 auto;padding:1.5rem}.loading-container,.error-container{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:400px;text-align:center;padding:2rem}.spinner{width:48px;height:48px;border:4px solid #E5E5E5;border-top-color:#DA291C;border-radius:50%;animation:spin 1s linear infinite;margin-bottom:1rem}.spinner-small{display:inline-block;width:16px;height:16px;border:2px solid rgba(255, 255, 255, 0.3);border-top-color:white;border-radius:50%;animation:spin 0.8s linear infinite;margin-right:0.25rem;vertical-align:middle}@keyframes spin{to{transform:rotate(360deg)}}.error-container p{color:#DA291C;margin-bottom:1rem;font-size:1.25rem}.error-container button{margin:0.25rem}.btn-retry{background:#DA291C;color:white;border:none;padding:0.5rem 1.5rem;border-radius:9999px;cursor:pointer;font-weight:600}.btn-retry:hover{background:rgb(172.8048780488, 32.5, 22.1951219512)}.breadcrumb{display:flex;align-items:center;gap:0.5rem;margin-bottom:1.5rem;font-size:0.875rem;color:#666666}.breadcrumb-item{cursor:pointer;transition:color 0.2s}.breadcrumb-item:hover{color:#0097A9}.breadcrumb-item.active{color:#1A1A1A;font-weight:500;cursor:default}.breadcrumb-item.active:hover{color:#1A1A1A}.breadcrumb-separator{color:#999999}.product-container{background:white;border-radius:0.75rem;box-shadow:0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);padding:2rem}.product-grid{display:grid;grid-template-columns:1fr 1fr;gap:2rem}@media (max-width: 768px){.product-grid{grid-template-columns:1fr}}.product-image-section{display:flex;align-items:flex-start;justify-content:center;width:100%;max-width:450px;margin:0 auto}.product-image-section ui-image-carousel{width:100%}.image-container{width:100%;max-width:400px;aspect-ratio:1;display:flex;align-items:center;justify-content:center;background:#FAFAFA;border-radius:0.5rem;padding:1rem}.product-image{max-width:100%;max-height:100%;object-fit:contain}.product-details-section{display:flex;flex-direction:column;gap:1rem}.brand-name{font-size:0.875rem;color:#808080;text-transform:uppercase;letter-spacing:0.5px}.product-name{font-size:1.75rem;font-weight:700;color:#1A1A1A;margin:0;line-height:1.2}.product-description{font-size:1rem;color:#666666;line-height:1.6;margin:0}.selector-section{padding:1rem 0;border-top:1px solid #F5F5F5}.selector-section:first-of-type{border-top:none}.selector-title{font-size:0.875rem;font-weight:600;color:#4D4D4D;margin:0 0 0.5rem 0;text-transform:uppercase;letter-spacing:0.5px}.color-options{display:flex;gap:0.5rem;flex-wrap:wrap;margin-bottom:0.25rem}.color-circle{width:40px;height:40px;border-radius:50%;border:2px solid transparent;cursor:pointer;transition:all 0.2s;display:flex;align-items:center;justify-content:center;padding:0}.color-circle:hover{transform:scale(1.1)}.color-circle.selected{border-color:#0097A9;box-shadow:0 0 0 2px white, 0 0 0 4px #0097A9}.color-circle .check-icon{width:18px;height:18px}.selected-label{font-size:0.875rem;color:#666666}.storage-options{display:flex;gap:0.5rem;flex-wrap:wrap}.storage-button{padding:0.5rem 1rem;border:2px solid #E5E5E5;border-radius:0.5rem;background:white;cursor:pointer;font-size:0.875rem;font-weight:500;color:#4D4D4D;transition:all 0.2s}.storage-button:hover{border-color:#0097A9;color:#0097A9}.storage-button.selected{border-color:#0097A9;background:rgba(0, 151, 169, 0.1);color:#0097A9}.installment-options{display:flex;gap:0.5rem;flex-wrap:wrap}.installment-button{display:flex;flex-direction:column;align-items:center;padding:0.5rem 1rem;border:2px solid #E5E5E5;border-radius:0.5rem;background:white;cursor:pointer;transition:all 0.2s;min-width:100px}.installment-button:hover{border-color:#0097A9}.installment-button.selected{border-color:#0097A9;background:rgba(0, 151, 169, 0.1)}.installment-button.selected .months,.installment-button.selected .price{color:#0097A9}.installment-button .months{font-size:0.875rem;font-weight:600;color:#4D4D4D}.installment-button .price{font-size:0.75rem;color:#808080;margin-top:2px}.quantity-selector{display:flex;align-items:center;gap:1rem}.qty-button{width:36px;height:36px;border:2px solid #CCCCCC;border-radius:0.5rem;background:white;cursor:pointer;font-size:1.25rem;font-weight:600;color:#4D4D4D;display:flex;align-items:center;justify-content:center;transition:all 0.2s}.qty-button:hover:not(:disabled){border-color:#0097A9;color:#0097A9}.qty-button:disabled{opacity:0.4;cursor:not-allowed}.qty-value{font-size:1.25rem;font-weight:600;color:#1A1A1A;min-width:30px;text-align:center}.price-section{background:#FAFAFA;border-radius:0.5rem;padding:1rem;margin-top:0.5rem}.price-row{display:flex;justify-content:space-between;align-items:center;padding:0.25rem 0}.price-row.monthly .value{font-size:1.5rem;font-weight:700;color:#DA291C}.price-row.total{border-top:1px solid #E5E5E5;padding-top:0.5rem;margin-top:0.25rem}.price-row.total .value{font-weight:600}.price-row .label{font-size:0.875rem;color:#666666}.price-row .value{font-size:1rem;color:#1A1A1A}.btn-add-to-cart{width:100%;padding:1rem;background:#DA291C;color:white;border:none;border-radius:9999px;font-size:1rem;font-weight:600;cursor:pointer;transition:all 0.2s;margin-top:1rem}.btn-add-to-cart:hover:not(:disabled){background:rgb(172.8048780488, 32.5, 22.1951219512)}.btn-add-to-cart:disabled{opacity:0.7;cursor:not-allowed}.btn-add-to-cart.loading{background:#808080}.btn-add-to-cart .loading-text{display:flex;align-items:center;justify-content:center}.btn-back-link{background:none;border:none;color:#0097A9;font-size:0.875rem;cursor:pointer;padding:0.5rem;margin-top:0.25rem;transition:color 0.2s}.btn-back-link:hover{color:rgb(0, 105.4319526627, 118);text-decoration:underline}.btn-back{background:#E5E5E5;color:#4D4D4D;border:none;padding:0.5rem 1.5rem;border-radius:9999px;cursor:pointer;font-weight:500}.btn-back:hover{background:#CCCCCC}.features-section{margin-top:2rem;padding-top:2rem;border-top:1px solid #E5E5E5}.features-title,.specs-title{font-size:1.25rem;font-weight:600;color:#1A1A1A;margin:0 0 1rem 0}.features-list{margin:0;padding:0 0 0 1.5rem}.features-list .feature-item{padding:0.25rem 0;color:#4D4D4D;line-height:1.5}.specs-section{margin-top:2rem;padding-top:2rem;border-top:1px solid #E5E5E5}.specs-grid{display:grid;grid-template-columns:repeat(2, 1fr);gap:0.5rem}@media (max-width: 576px){.specs-grid{grid-template-columns:1fr}}.spec-item{display:flex;justify-content:space-between;padding:0.5rem;background:#FAFAFA;border-radius:0.25rem}.spec-item .spec-label{font-size:0.875rem;color:#666666}.spec-item .spec-value{font-size:0.875rem;font-weight:500;color:#1A1A1A}.availability-status{display:flex;align-items:center;gap:0.25rem;padding:0.5rem 0}.availability-status--available{display:flex;align-items:center;gap:0.25rem;color:#44AF69;font-weight:500;font-size:0.875rem}.availability-status--unavailable{display:flex;align-items:center;gap:0.25rem;color:#DA291C;font-weight:500;font-size:0.875rem}.availability-icon{width:18px;height:18px}.unavailable-alert-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0, 0, 0, 0.6);display:flex;align-items:center;justify-content:center;z-index:1000;padding:1rem}.unavailable-alert{background:white;border-radius:0.75rem;padding:2rem;max-width:400px;width:100%;text-align:center;box-shadow:0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);animation:alertSlideIn 0.3s ease-out}.unavailable-alert__icon{width:64px;height:64px;margin:0 auto 1rem;background:rgba(218, 41, 28, 0.1);border-radius:50%;display:flex;align-items:center;justify-content:center}.unavailable-alert__icon svg{width:32px;height:32px;color:#DA291C}.unavailable-alert__title{font-size:1.5rem;font-weight:700;color:#1A1A1A;margin:0 0 0.5rem 0}.unavailable-alert__message{font-size:1rem;color:#666666;line-height:1.6;margin:0 0 1.5rem 0}.unavailable-alert__btn{width:100%;padding:1rem;background:#DA291C;color:white;border:none;border-radius:9999px;font-size:1rem;font-weight:600;cursor:pointer;transition:background 0.2s}.unavailable-alert__btn:hover{background:rgb(172.8048780488, 32.5, 22.1951219512)}@keyframes alertSlideIn{from{opacity:0;transform:translateY(-20px) scale(0.95)}to{opacity:1;transform:translateY(0) scale(1)}}.btn-add-to-cart.disabled{background:#999999;cursor:not-allowed}.btn-add-to-cart.disabled:hover{background:#999999}`;const Ge=class{constructor(e){a(this,e)}onNext;onBack;product=null;catalogueProduct=null;isLoading=true;error=null;isAddingToCart=false;selectedColorIndex=0;selectedStorageIndex=0;selectedInstallments=36;quantity=1;isAvailable=true;showUnavailableAlert=false;colorOptions=[];storageOptions=[];installmentOptions=[];productImages=[];ENTRY_BARRIER=1;componentWillLoad(){this.loadProductDetail()}async loadProductDetail(){this.isLoading=true;this.error=null;try{const e=j.getStoredProduct();if(!e){this.error="No se encontró el producto seleccionado";this.isLoading=false;return}this.catalogueProduct=e;const t=await W.getEquipmentDetail(e.productId);if(t.hasError||!t.product){console.warn("[StepProductDetail] API failed, using catalogue data");this.product=this.mapCatalogueToDetail(e)}else{this.product=t.product}this.parseColorOptions();this.parseStorageOptions();this.parseInstallmentOptions();this.buildProductImages();this.checkAvailability();W.storeSelectedProduct(this.product);W.storeDeviceType("home")}catch(e){console.error("[StepProductDetail] Error:",e);this.error="Error al cargar el detalle del producto"}finally{this.isLoading=false}}mapCatalogueToDetail(e){return{productId:e.productId,productName:e.productName,imgUrl:e.imgUrl,regular_price:e.regular_price,update_price:e.update_price,installments:e.installments,shortDescription:e.shortDescription,colors:e.colors?.map(((e,t)=>({colorId:t,colorName:`Color ${t+1}`,webColor:e.webColor}))),home:true,catalogId:6}}parseColorOptions(){if(!this.product?.colors||this.product.colors.length===0){this.colorOptions=[{colorId:0,colorName:"Default",webColor:"#333333"}];return}this.colorOptions=this.product.colors.map(((e,t)=>({colorId:e.colorId||t,colorName:e.colorName||`Color ${t+1}`,webColor:e.webColor||"#333333",productId:e.productId,imgUrl:e.imgUrl})))}parseStorageOptions(){if(!this.product?.storages||this.product.storages.length===0){this.storageOptions=[];return}this.storageOptions=this.product.storages.map(((e,t)=>({storageId:e.storageId||t,storageName:e.storageName||e.name||`${e.size}GB`,productId:e.productId,price:e.price})))}parseInstallmentOptions(){const e=this.product?.regular_price||0;const t=this.product?.installments||36;const a=[12,24,36];this.installmentOptions=a.map((t=>({months:t,monthlyPrice:Number((e/t).toFixed(2)),totalPrice:e})));this.selectedInstallments=t}buildProductImages(){if(!this.product){this.productImages=[];return}const e=[];if(this.product.images?.length){e.push(...this.product.images)}else if(this.product.imgUrl){e.push(this.product.imgUrl)}if(this.colorOptions?.length>0){this.colorOptions.forEach((t=>{if(t.imgUrl&&!e.includes(t.imgUrl)){e.push(t.imgUrl)}}))}this.productImages=e;console.log("[StepProductDetail] Product images:",this.productImages.length)}checkAvailability(){if(!this.product){this.isAvailable=false;this.showUnavailableAlert=true;return}if(this.product.stock===undefined||this.product.stock===null){this.isAvailable=true;console.log("[StepProductDetail] Availability check - stock undefined (no colors structure), assuming available")}else{this.isAvailable=this.product.stock>this.ENTRY_BARRIER;console.log("[StepProductDetail] Availability check (TEL pattern) - stock:",this.product.stock,"> entryBarrier:",this.ENTRY_BARRIER,"=",this.isAvailable);if(!this.isAvailable){this.showUnavailableAlert=true}}}handleGoBackFromAlert=()=>{this.showUnavailableAlert=false;this.onBack?.()};handleColorSelect=e=>{this.selectedColorIndex=e;const t=this.colorOptions[e];W.storeSelectedColor(t.colorId,t.colorName,t.webColor);if(t.imgUrl&&this.product){this.product={...this.product,imgUrl:t.imgUrl}}};handleStorageSelect=e=>{this.selectedStorageIndex=e;const t=this.storageOptions[e];W.storeSelectedStorage(t.storageId,t.storageName);if(t.productId){W.storeChildrenId(t.productId)}};handleInstallmentSelect=e=>{this.selectedInstallments=e};handleAddToCart=async()=>{if(!this.product||this.isAddingToCart)return;this.isAddingToCart=true;try{const e=await G.addToCart(this.product,this.selectedInstallments,this.quantity);if(e.hasError){console.error("[StepProductDetail] Add to cart failed:",e.message);this.error=e.message||"Error al agregar al carrito";return}if(e.code){G.storeMainId(e.code);W.storeMainId(e.code)}console.log("[StepProductDetail] Added to cart, proceeding to plans");this.onNext?.()}catch(e){console.error("[StepProductDetail] Error:",e);this.error="Error al agregar el producto al carrito"}finally{this.isAddingToCart=false}};getCurrentMonthlyPrice(){const e=this.installmentOptions.find((e=>e.months===this.selectedInstallments));return e?.monthlyPrice||this.product?.update_price||0}formatPrice(e){return`$${e.toFixed(2)}`}renderBreadcrumb(){return o("div",{class:"breadcrumb"},o("span",{class:"breadcrumb-item",onClick:this.onBack},"Catálogo"),o("span",{class:"breadcrumb-separator"},">"),o("span",{class:"breadcrumb-item active"},this.product?.productName||"Detalle"))}renderColorSelector(){if(this.colorOptions.length<=1)return null;return o("div",{class:"selector-section"},o("h4",{class:"selector-title"},"Color"),o("div",{class:"color-options"},this.colorOptions.map(((e,t)=>o("button",{class:{"color-circle":true,selected:this.selectedColorIndex===t},style:{backgroundColor:e.webColor},onClick:()=>this.handleColorSelect(t),title:e.colorName},this.selectedColorIndex===t&&o("svg",{class:"check-icon",viewBox:"0 0 24 24",fill:"none",stroke:"white","stroke-width":"3"},o("polyline",{points:"20 6 9 17 4 12"})))))),o("span",{class:"selected-label"},this.colorOptions[this.selectedColorIndex]?.colorName))}renderStorageSelector(){if(this.storageOptions.length===0)return null;return o("div",{class:"selector-section"},o("h4",{class:"selector-title"},"Almacenamiento"),o("div",{class:"storage-options"},this.storageOptions.map(((e,t)=>o("button",{class:{"storage-button":true,selected:this.selectedStorageIndex===t},onClick:()=>this.handleStorageSelect(t)},e.storageName)))))}renderInstallmentSelector(){return o("div",{class:"selector-section"},o("h4",{class:"selector-title"},"Plazos de pago"),o("div",{class:"installment-options"},this.installmentOptions.map((e=>o("button",{class:{"installment-button":true,selected:this.selectedInstallments===e.months},onClick:()=>this.handleInstallmentSelect(e.months)},o("span",{class:"months"},e.months," meses"),o("span",{class:"price"},this.formatPrice(e.monthlyPrice),"/mes"))))))}renderQuantitySelector(){return o("div",{class:"selector-section"})}renderPriceSection(){const e=this.getCurrentMonthlyPrice();const t=this.product?.regular_price||0;return o("div",{class:"price-section"},o("div",{class:"price-row monthly"},o("span",{class:"label"},"Pago mensual"),o("span",{class:"value"},this.formatPrice(e))),o("div",{class:"price-row total"},o("span",{class:"label"},"Precio total"),o("span",{class:"value"},this.formatPrice(t))),o("div",{class:"price-row installments"},o("span",{class:"label"},"Financiado a"),o("span",{class:"value"},this.selectedInstallments," meses")))}renderAvailabilityStatus(){return o("div",{class:"availability-status"},this.isAvailable?o("div",{class:"availability-status--available"},o("svg",{class:"availability-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},o("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),o("polyline",{points:"22 4 12 14.01 9 11.01"})),o("span",null,"Disponible")):o("div",{class:"availability-status--unavailable"},o("svg",{class:"availability-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},o("path",{d:"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"}),o("line",{x1:"12",y1:"9",x2:"12",y2:"13"}),o("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})),o("span",null,"No disponible")))}renderUnavailableAlert(){if(!this.showUnavailableAlert)return null;return o("div",{class:"unavailable-alert-overlay"},o("div",{class:"unavailable-alert"},o("div",{class:"unavailable-alert__icon"},o("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},o("path",{d:"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"}),o("line",{x1:"12",y1:"9",x2:"12",y2:"13"}),o("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"}))),o("h3",{class:"unavailable-alert__title"},"Producto no disponible"),o("p",{class:"unavailable-alert__message"},"Lo sentimos, este equipo no está disponible actualmente. Por favor seleccione otro equipo del catálogo."),o("button",{class:"unavailable-alert__btn",onClick:this.handleGoBackFromAlert},"Volver al catálogo")))}render(){return o(i,{key:"f6f5da2204bacc3f2e22e166e904a942a34b49a1"},o("div",{key:"fb8e8a53343364958196cc8fdb35ec6da995431e",class:"step-product-detail"},this.renderUnavailableAlert(),this.isLoading&&o("div",{key:"cec8da757327a32af784b3fa4690d0aae8d275b8",class:"loading-container"},o("div",{key:"d9345339f269a0cae7b7c98235bd46c679a5173a",class:"spinner"}),o("p",{key:"5a5a3e5a9d7498a61acfa8705141f939e64678ac"},"Cargando producto...")),this.error&&!this.isLoading&&o("div",{key:"cfabad9e3e962e180d25b56211a6e2b3a02b6952",class:"error-container"},o("p",{key:"2310f44a366658042f5f73b960680257d8c6f6c8"},this.error),o("button",{key:"5936dacf538439957fd959094025563e535d13d4",class:"btn-retry",onClick:()=>this.loadProductDetail()},"Reintentar"),o("button",{key:"e79e30d0eb8fbe794b84006c022da93c1cbb9e19",class:"btn-back",onClick:this.onBack},"Volver al catálogo")),!this.isLoading&&!this.error&&this.product&&o("div",{key:"ad4dff462c0c38b35d57ee7fc61baeb54e09f3fb",class:"product-container"},this.renderBreadcrumb(),o("div",{key:"f15d19d5700a7b7f7877535189d529fe82201f80",class:"product-grid"},o("div",{key:"a79b4402d66696c05fc1a77003d5964889868861",class:"product-image-section"},o("ui-image-carousel",{key:"2574169af64849beae90eb982b0ba1b13a63d6a7",images:this.productImages,loop:true,showNavigation:this.productImages.length>1,showIndicators:this.productImages.length>1,autoplayInterval:0})),o("div",{key:"ce58350892cc2d0c595ad56f1a6b3ae986ee892f",class:"product-details-section"},this.product.brandName&&o("span",{key:"c9dbc2ae620998d47c1b46645690868c336d7102",class:"brand-name"},this.product.brandName),o("h1",{key:"4447a1888895e7846bd64dae3259a26e7558b8ee",class:"product-name"},this.product.productName),this.product.shortDescription&&o("p",{key:"f99de4112c2104e652c62fce0f47f3f2c6290d99",class:"product-description"},W.cleanDescription(this.product.shortDescription)),this.renderAvailabilityStatus(),this.renderColorSelector(),this.renderStorageSelector(),this.renderInstallmentSelector(),this.renderQuantitySelector(),this.renderPriceSection(),o("button",{key:"2a0fb17ffb42e9e23bfdb7a2440abb2d7046c530",class:{"btn-add-to-cart":true,loading:this.isAddingToCart,disabled:!this.isAvailable},onClick:this.handleAddToCart,disabled:this.isAddingToCart||!this.isAvailable},this.isAddingToCart?o("span",{class:"loading-text"},o("span",{class:"spinner-small"}),"Agregando..."):!this.isAvailable?"No disponible":"Continuar"),o("button",{key:"e4d48537e4eff5d7fb4fbd537360335b7f96f392",class:"btn-back-link",onClick:this.onBack},"← Volver al catálogo"))),this.product.features&&this.product.features.length>0&&o("div",{key:"4068563e46d85763eea9b0722728a1be6cc67975",class:"features-section"},o("h3",{key:"610bcb5243c5b59f99ae8dc49267c981421e9dda",class:"features-title"},"Características"),o("ul",{key:"7c205b947fabb39342fae99bf635dc4610158718",class:"features-list"},this.product.features.map((e=>o("li",{class:"feature-item"},e))))),this.product.specifications&&this.product.specifications.length>0&&o("div",{key:"2dc48d0f8ddd2daa8558a905103f1fd80ab9206c",class:"specs-section"},o("h3",{key:"b7168f6107e3eb1c01921df3b052905cad91beec",class:"specs-title"},"Especificaciones"),o("div",{key:"d3f4fb10926e83262f18632db967086e0c12b31f",class:"specs-grid"},this.product.specifications.map((e=>o("div",{class:"spec-item"},o("span",{class:"spec-label"},e.name),o("span",{class:"spec-value"},e.value)))))))))}};Ge.style=Je();const Ve=()=>`:host{display:block;width:100%;min-height:100%;background-color:white}.step-shipping{width:100%;max-width:900px;margin:0 auto;padding:1.5rem 1rem}.info-message{font-size:0.875rem;color:#666666;margin:0 0 1.5rem 0;padding:0 !important;background:transparent !important;background-color:transparent !important;line-height:1.5;border:none !important;border-radius:0 !important}.error-alert{display:flex;align-items:center;gap:0.5rem;background:rgb(248.1707317073, 205, 201.8292682927);color:rgb(172.8048780488, 32.5, 22.1951219512);padding:1rem;border-radius:0.5rem;margin-bottom:1.5rem;font-size:0.875rem}.error-alert svg{width:20px;height:20px;flex-shrink:0}.form-container{width:100%}.form-row{display:grid;grid-template-columns:1fr 1fr;gap:1rem 1.5rem;margin-bottom:0.25rem}@media (max-width: 700px){.form-row{grid-template-columns:1fr}}.form-group{margin-bottom:1rem}.form-group.existing-customer{margin-top:0.5rem}.form-label{display:block;font-size:0.875rem;font-weight:500;color:#4D4D4D;margin-bottom:0.25rem}.form-label .required{color:#4D4D4D;margin-right:2px}.form-input{width:100%;padding:10px 12px;border:1px solid #CCCCCC;border-radius:0.25rem;font-size:0.875rem;color:#1A1A1A;background:white;transition:border-color 0.2s, box-shadow 0.2s;box-sizing:border-box}.form-input::placeholder{color:#999999}.form-input:focus{outline:none;border-color:#0097A9;box-shadow:0 0 0 2px rgba(0, 151, 169, 0.1)}.form-input:disabled{background:#F5F5F5;color:#808080;cursor:not-allowed}.form-input.error{border-color:#DA291C}.form-input.error:focus{box-shadow:0 0 0 2px rgba(218, 41, 28, 0.1)}input[type=date]::-webkit-calendar-picker-indicator{cursor:pointer;opacity:0.6}.date-input-wrapper{position:relative}.error-message{display:block;font-size:0.75rem;color:#DA291C;margin-top:0.25rem}.id-field{display:flex;align-items:center;gap:0.5rem;flex-wrap:wrap}.id-field .radio-group{display:flex;flex-direction:row;align-items:center;gap:1rem;flex-shrink:0}.id-field .id-input{flex:1;min-width:150px}.radio-group{display:flex;flex-direction:row;align-items:center;gap:1rem}.radio-group.horizontal{flex-direction:row}.radio-label{display:flex;align-items:center;gap:6px;cursor:pointer;font-size:0.875rem}.radio-label input[type=radio]{display:none}.radio-label .radio-custom{width:16px;height:16px;border:2px solid #999999;border-radius:50%;display:flex;align-items:center;justify-content:center;transition:all 0.2s;flex-shrink:0}.radio-label .radio-custom::after{content:"";width:8px;height:8px;border-radius:50%;background:transparent;transition:background 0.2s}.radio-label input[type=radio]:checked+.radio-custom{border-color:#666666}.radio-label input[type=radio]:checked+.radio-custom::after{background:#666666}.radio-label .radio-text{color:#4D4D4D;font-size:0.75rem;white-space:nowrap}.btn-container{display:flex;justify-content:center;margin-top:1.5rem;padding-top:1rem}.btn-submit{min-width:200px;height:44px;background:#666666;color:white;border:none;border-radius:9999px;font-size:0.875rem;font-weight:500;cursor:pointer;transition:all 0.2s;display:flex;align-items:center;justify-content:center;padding:0 2rem}.btn-submit:hover:not(:disabled){background:#4D4D4D}.btn-submit:disabled{background:#CCCCCC;cursor:not-allowed}.btn-submit.loading{background:#999999}.btn-loading{display:flex;align-items:center;gap:0.5rem}.spinner{width:18px;height:18px;border:2px solid rgba(255, 255, 255, 0.3);border-top-color:white;border-radius:50%;animation:spin 1s linear infinite}@keyframes spin{to{transform:rotate(360deg)}}@media (max-width: 500px){.step-shipping{padding:1rem}.id-field{flex-direction:column;align-items:flex-start}.id-field .radio-group{margin-bottom:0.25rem}.id-field .id-input{width:100%}}`;const He=class{constructor(e){a(this,e)}onNext;onBack;isLoading=false;error=null;name="";secondName="";lastname="";secondLastname="";idType="";idNumber="";expirationDate="";phone="";phone2="";businessName="";position="";address="";city="";zipcode="";email="";existingCustomer="";formErrors={};touched={};componentWillLoad(){this.loadStoredData()}loadStoredData(){const e=te.getStoredShippingAddress();if(e){const t=e.name.split(" ");this.name=t[0]||"";this.lastname=t.slice(1).join(" ")||"";this.email=e.email;this.phone=this.formatPhoneDisplay(e.phone);this.phone2=e.phone2?this.formatPhoneDisplay(e.phone2):"";this.address=e.address1;this.zipcode=e.zip;this.city=e.city}}formatPhoneDisplay(e){const t=e.replace(/\D/g,"");if(t.length===10){return`(${t.slice(0,3)}) ${t.slice(3,6)}-${t.slice(6)}`}return e}handleInputChange=e=>t=>{const a=t.target;let r=a.value;if(e==="phone"||e==="phone2"){r=this.formatPhoneInput(r)}if(e==="zipcode"){r=r.replace(/\D/g,"").slice(0,5);const e=te.getMunicipalityByZip(r);if(e){this.city=e}else if(r.length===5){this.city=""}}this[e]=r;this.touched[e]=true;this.validateField(e)};formatPhoneInput(e){const t=e.replace(/\D/g,"").slice(0,10);if(t.length===0)return"";if(t.length<=3)return`(${t}`;if(t.length<=6)return`(${t.slice(0,3)}) ${t.slice(3)}`;return`(${t.slice(0,3)}) ${t.slice(3,6)}-${t.slice(6)}`}handleRadioChange=(e,t)=>()=>{this[e]=t;this.touched[e]=true;this.validateField(e)};validateField(e){const t={...this.formErrors};switch(e){case"name":if(!this.name.trim()){t.name="El nombre es requerido"}else{delete t.name}break;case"lastname":if(!this.lastname.trim()){t.lastname="El apellido es requerido"}else{delete t.lastname}break;case"secondLastname":if(!this.secondLastname.trim()){t.secondLastname="El segundo apellido es requerido"}else{delete t.secondLastname}break;case"idType":if(!this.idType){t.idType="Seleccione un tipo de identificación"}else{delete t.idType}break;case"idNumber":if(!this.idNumber.trim()){t.idNumber="El número de identificación es requerido"}else{delete t.idNumber}break;case"expirationDate":if(!this.expirationDate){t.expirationDate="La fecha de vencimiento es requerida"}else{delete t.expirationDate}break;case"phone":if(!this.phone.trim()){t.phone="El teléfono es requerido"}else if(!te.isValidPhone(this.phone)){t.phone="Ingresa un teléfono válido (10 dígitos)"}else{delete t.phone}break;case"businessName":if(!this.businessName.trim()){t.businessName="El nombre del negocio es requerido"}else{delete t.businessName}break;case"position":if(!this.position.trim()){t.position="La posición es requerida"}else{delete t.position}break;case"address":if(!this.address.trim()){t.address="La dirección es requerida"}else{delete t.address}break;case"city":if(!this.city.trim()){t.city="La ciudad es requerida"}else{delete t.city}break;case"zipcode":if(!this.zipcode.trim()){t.zipcode="El código postal es requerido"}else if(!te.validateZipCode(this.zipcode)){t.zipcode="Código postal no válido para Puerto Rico"}else{delete t.zipcode}break;case"email":if(!this.email.trim()){t.email="El correo es requerido"}else if(!te.isValidEmail(this.email)){t.email="Ingresa un correo válido"}else{delete t.email}break;case"existingCustomer":if(!this.existingCustomer){t.existingCustomer="Seleccione una opción"}else{delete t.existingCustomer}break}this.formErrors=t;return Object.keys(t).length===0}validateForm(){this.touched={name:true,lastname:true,secondLastname:true,idType:true,idNumber:true,expirationDate:true,phone:true,businessName:true,position:true,address:true,city:true,zipcode:true,email:true,existingCustomer:true};const e=["name","lastname","secondLastname","idType","idNumber","expirationDate","phone","businessName","position","address","city","zipcode","email","existingCustomer"];e.forEach((e=>this.validateField(e)));return Object.keys(this.formErrors).length===0}handleSubmit=async()=>{if(!this.validateForm()){return}this.isLoading=true;this.error=null;try{const e={name:`${this.name} ${this.secondName} ${this.lastname} ${this.secondLastname}`.replace(/\s+/g," ").trim(),email:this.email,phone:te.cleanPhoneNumber(this.phone),phone2:this.phone2?te.cleanPhoneNumber(this.phone2):undefined,address1:this.address,city:this.city,state:"PR",zip:this.zipcode};const t=await te.createAddress(e);if(t.hasError){this.error=t.message||t.errorDesc||"Error al guardar la dirección";return}console.log("[StepShipping] Address created, shipmentId:",t.response);this.onNext?.()}catch(e){console.error("[StepShipping] Error:",e);this.error="Error de conexión. Intenta nuevamente."}finally{this.isLoading=false}};render(){return o(i,{key:"7ae7bebbb3e13d31265012fdf1d0007a58ccc549"},o("div",{key:"f066b9f78003b4258a216e967babf70875c34b7c",class:"step-shipping"},o("p",{key:"8c695e5687cd17c583a7e97ceac601f8b6979994",class:"info-message"},"Por favor, ingresa la información personal solicitada. Su nombre y apellido deben ser iguales a su identificación de gobierno."),this.error&&o("div",{key:"45e0af3f13e97a0198cf137b156f14912b156186",class:"error-alert"},o("svg",{key:"cae16b40569a38151eecf91e3e8bc2fa8700dbd1",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},o("circle",{key:"b8f331848eeb1b0fd5023e98bbe7908cf8a5fedf",cx:"12",cy:"12",r:"10"}),o("line",{key:"75b258a0c98e884c39bc0f39d80a7f69c7c6836b",x1:"12",y1:"8",x2:"12",y2:"12"}),o("line",{key:"774cca2fac86dc19a44a94070945f25bba002a53",x1:"12",y1:"16",x2:"12.01",y2:"16"})),o("span",{key:"24dd26e600ecafd36b87e6098a165b8fb93d2b48"},this.error)),o("div",{key:"86453f1110b995cf95be698da80ba6b350cde36c",class:"form-container"},o("div",{key:"1337c15029ef62ecaaae17ed5c76b0b474d944ba",class:"form-row"},o("div",{key:"c2c0440e02e1576eb32f4a44ced18ccd5392ee0e",class:"form-group"},o("label",{key:"cd7e142575dc19cd01d3a53452a77ed4108a19cc",class:"form-label"},o("span",{key:"cb6791589c6bedf4ec4dd49a90c6818ebc9b0af0",class:"required"},"*"),"Nombre:"),o("input",{key:"7c7f6bb56d58cc613dedd42f7bb5adeed98ac7cd",type:"text",class:{"form-input":true,error:this.touched.name&&!!this.formErrors.name},value:this.name,onInput:this.handleInputChange("name"),placeholder:"Ingresar nombre"}),this.touched.name&&this.formErrors.name&&o("span",{key:"b11ec748d53b4d4362505b5a0eece2410160f135",class:"error-message"},this.formErrors.name)),o("div",{key:"496739bac23e60c715b318e87de60462d773d4fb",class:"form-group"},o("label",{key:"2bd5afa3a5a16eba18c6e691630920461c5aca38",class:"form-label"},"Segundo nombre:"),o("input",{key:"5cd35e05777bfb2378c9330d6f23fe67f4db5350",type:"text",class:"form-input",value:this.secondName,onInput:this.handleInputChange("secondName"),placeholder:"Ingresar segundo nombre (Opcional)"}))),o("div",{key:"8811ecafcce92d5f2c50c6a16fff637844806571",class:"form-row"},o("div",{key:"0642b4e824009299d108a85ecd63ed56ea897145",class:"form-group"},o("label",{key:"6affa3bde930d01c3e53213404e9e3cb3161ec0b",class:"form-label"},o("span",{key:"312a964f1c56afc5085bf4481cc5f877682ed8e0",class:"required"},"*"),"Apellido:"),o("input",{key:"af8d81aa3dce7d5ffcef342c375bc6226e09ce25",type:"text",class:{"form-input":true,error:this.touched.lastname&&!!this.formErrors.lastname},value:this.lastname,onInput:this.handleInputChange("lastname"),placeholder:"Ingresar apellido"}),this.touched.lastname&&this.formErrors.lastname&&o("span",{key:"6ddd4e10b4e772a0b957306e034a7e6619fd8f30",class:"error-message"},this.formErrors.lastname)),o("div",{key:"26fcf42cb306506823d12836350d1ccf1f9f0a3e",class:"form-group"},o("label",{key:"d5afc6f663e81951e9011364de82d1f1e2c04abb",class:"form-label"},o("span",{key:"072ccacda1555a2043ff6b0f3c3eba951602de24",class:"required"},"*"),"Segundo apellido:"),o("input",{key:"eb014bd7177ea3465600e8f37ab537c3d9fba78a",type:"text",class:{"form-input":true,error:this.touched.secondLastname&&!!this.formErrors.secondLastname},value:this.secondLastname,onInput:this.handleInputChange("secondLastname"),placeholder:"Ingresar segundo apellido"}),this.touched.secondLastname&&this.formErrors.secondLastname&&o("span",{key:"65f296fad407839bdea2d890339a93d56941a661",class:"error-message"},this.formErrors.secondLastname))),o("div",{key:"9b1491d42acf45a8f74c7ba661cc4c1432bf9726",class:"form-row"},o("div",{key:"a23a636f4e8da464edab56a4ae8416fab184c0d8",class:"form-group"},o("label",{key:"c88823048a64f456cba72feb0d9938019b54620e",class:"form-label"},o("span",{key:"a7b1b2011cd618e8163d9d44bc5381bfd79706c6",class:"required"},"*"),"Identificación:"),o("div",{key:"c978d3b5795a62479a951aa17bd23f2330121b51",class:"id-field"},o("div",{key:"a8d06dc73cea607435ab41e3874917ff8cb8e538",class:"radio-group"},o("label",{key:"823a2f5fb88a02ef222bc21837e23b4f51ccb23a",class:"radio-label"},o("input",{key:"190b095513a09becbd9afcb6701bb4ae82d9ea2d",type:"radio",name:"idType",checked:this.idType==="license",onChange:this.handleRadioChange("idType","license")}),o("span",{key:"4e5f43b042d2421f33af32295dcb697283bf3221",class:"radio-custom"}),o("span",{key:"2ff76995b3ea2a91f38c5f576f1e8e9e3e3b8631",class:"radio-text"},"Licencia de conducir")),o("label",{key:"83cda857f71d2e57235c7db23a33278f8e27a47e",class:"radio-label"},o("input",{key:"c941b00e6c0424f7f757809c7a8487b968fa9b7c",type:"radio",name:"idType",checked:this.idType==="passport",onChange:this.handleRadioChange("idType","passport")}),o("span",{key:"b9bf3cf45f6a7edda73847faf28451945d043e28",class:"radio-custom"}),o("span",{key:"ff8c1a8cb167efb254bb980ffbbe24ed99b6cdd3",class:"radio-text"},"Pasaporte"))),o("input",{key:"9e706b1c08c3be90654a22f830da2581dc7e2a69",type:"text",class:{"form-input":true,"id-input":true,error:this.touched.idNumber&&!!this.formErrors.idNumber},value:this.idNumber,onInput:this.handleInputChange("idNumber"),placeholder:"Ingresar nro de identificación"})),this.touched.idType&&this.formErrors.idType&&o("span",{key:"7dec316ea77a2887e8236f5c62dc07e5329f3d81",class:"error-message"},this.formErrors.idType),this.touched.idNumber&&this.formErrors.idNumber&&o("span",{key:"ace10559a4beade529a1d7d3524929239979978c",class:"error-message"},this.formErrors.idNumber)),o("div",{key:"5b33f615e67feabab7028f4af6b0aa4eabba0bcd",class:"form-group"},o("label",{key:"b56ca9a6e43259a6ee976a26125345e34a983e64",class:"form-label"},o("span",{key:"fe80746dd75dabfcc7cc8d4c0a2ad2d17c4e5400",class:"required"},"*"),"Fecha de vencimiento:"),o("div",{key:"81e26202ef03fbeea5aec79721ec8c7118628ff1",class:"date-input-wrapper"},o("input",{key:"db2149d07a0bff3f0e637b9cc6d651d06f503f1b",type:"date",class:{"form-input":true,error:this.touched.expirationDate&&!!this.formErrors.expirationDate},value:this.expirationDate,onInput:this.handleInputChange("expirationDate"),placeholder:"Seleccionar"})),this.touched.expirationDate&&this.formErrors.expirationDate&&o("span",{key:"c9a806a8fbbd89180cf9900207a2b3f1d4f02e80",class:"error-message"},this.formErrors.expirationDate))),o("div",{key:"40bb0adc01fd7591bfa094c1dac80eda17512281",class:"form-row"},o("div",{key:"a9eb8eaf0761e9f2f3ab7ea81dc23c7e7cbe480b",class:"form-group"},o("label",{key:"cd16cd0746541416e86740b969e370f6cac9dfad",class:"form-label"},o("span",{key:"85ec660a4c26378dd7ebc6c3518be92341a125a9",class:"required"},"*"),"Teléfono de contacto 1:"),o("input",{key:"365d37fdb282b8376542da16fc2913ce12813877",type:"tel",class:{"form-input":true,error:this.touched.phone&&!!this.formErrors.phone},value:this.phone,onInput:this.handleInputChange("phone"),placeholder:"Ingresar nro de teléfono"}),this.touched.phone&&this.formErrors.phone&&o("span",{key:"ce786b52e786957af6c153c255c1e78e38bb22a7",class:"error-message"},this.formErrors.phone)),o("div",{key:"53dcfb2c8a47fa4b89ab23aa81707a563e08ffd3",class:"form-group"},o("label",{key:"2c8c267b276d9a3be5a276533492aace19c6d8b9",class:"form-label"},"Teléfono de contacto 2:"),o("input",{key:"2ee5ac14a47ce62baf7dd70e98359ba0d61578fd",type:"tel",class:"form-input",value:this.phone2,onInput:this.handleInputChange("phone2"),placeholder:"Ingresar nro de teléfono"}))),o("div",{key:"9109a6a374b5f018ab50910607ba70fd8bb367b5",class:"form-row"},o("div",{key:"46f4c3d535f668630abd62d1e82c9830842955f8",class:"form-group"},o("label",{key:"a0f5a9abd1dc8f6f55c041b9ddd5602410d8de1d",class:"form-label"},o("span",{key:"d7cdd6fca00dba0b402137c39babb3bb0e80072e",class:"required"},"*"),"Nombre del Negocio:"),o("input",{key:"01266ede5d55ba433117dd69c086223e60915aa9",type:"text",class:{"form-input":true,error:this.touched.businessName&&!!this.formErrors.businessName},value:this.businessName,onInput:this.handleInputChange("businessName"),placeholder:"Ingresar nombre del negocio"}),this.touched.businessName&&this.formErrors.businessName&&o("span",{key:"0930d1939f86552449e03d11cc1ee1b27ba8a369",class:"error-message"},this.formErrors.businessName)),o("div",{key:"672a655b281a976db731fe7ecafd7b060140b190",class:"form-group"},o("label",{key:"6bde70537ea0af996539eb48bdd69f1df25d567c",class:"form-label"},o("span",{key:"f6ac8f9932bb9f50096768474c686905f4c2d267",class:"required"},"*"),"Posición en la Empresa:"),o("input",{key:"68a45ae95232a17bd6a05927ddb3878a06f65f88",type:"text",class:{"form-input":true,error:this.touched.position&&!!this.formErrors.position},value:this.position,onInput:this.handleInputChange("position"),placeholder:"Ingresar posición actual"}),this.touched.position&&this.formErrors.position&&o("span",{key:"cb4bea9d7785680f39a3b867550153cffbf7cf43",class:"error-message"},this.formErrors.position))),o("div",{key:"1c2c2012328c63a9fc3dfea778a1df84d8b44bb1",class:"form-row"},o("div",{key:"6bf3b1bd88ac311bddadb53f243f2b3e0627b677",class:"form-group"},o("label",{key:"334a6edc7a9c49694932b1c7ebdce0d45a82990c",class:"form-label"},o("span",{key:"3a28dfac7dacee1d7a88de91db81b9835af03455",class:"required"},"*"),"Dirección:"),o("input",{key:"2b2535ee98ad8ead3fc164ff8a6f62320e856800",type:"text",class:{"form-input":true,error:this.touched.address&&!!this.formErrors.address},value:this.address,onInput:this.handleInputChange("address"),placeholder:"Ingresar dirección"}),this.touched.address&&this.formErrors.address&&o("span",{key:"d5df9464446c21ff791b6dc78b8dff01f30e138b",class:"error-message"},this.formErrors.address)),o("div",{key:"d948573bfc7bfda7c569f6d640ca5bbe2d25862f",class:"form-group"},o("label",{key:"5b844b6e991312a1c9d18bb6e3b75b2f4f4b7783",class:"form-label"},o("span",{key:"3efa4f922cf5b11e91ece600003aff619d37c3a4",class:"required"},"*"),"Ciudad:"),o("input",{key:"2733c88c2ce9a6b9b296c13fdf1841ac4695d097",type:"text",class:{"form-input":true,error:this.touched.city&&!!this.formErrors.city},value:this.city,onInput:this.handleInputChange("city"),placeholder:"Ingresar ciudad"}),this.touched.city&&this.formErrors.city&&o("span",{key:"ffb55325d480121c42cb5ded4568477af6c167e3",class:"error-message"},this.formErrors.city))),o("div",{key:"7209f9417c681860f688c1abb0b6c86ffb18f084",class:"form-row"},o("div",{key:"21dff49c47d67c0e34b802eae167fa71c415a47a",class:"form-group"},o("label",{key:"3e3421aa50ac2fdc8c61a6a20025da2f051ee301",class:"form-label"},o("span",{key:"447b16da22440ce8960f3f4af090d994b8e367b2",class:"required"},"*"),"Código postal"),o("input",{key:"637b0cd9b9ef6a74b7c297db23c33dafe5e45745",type:"text",class:{"form-input":true,error:this.touched.zipcode&&!!this.formErrors.zipcode},value:this.zipcode,onInput:this.handleInputChange("zipcode"),placeholder:"Ingresar código postal",maxLength:5}),this.touched.zipcode&&this.formErrors.zipcode&&o("span",{key:"f2b780128a1cd722ece53145dcd89b3283d45cb8",class:"error-message"},this.formErrors.zipcode)),o("div",{key:"e2119f2a49006a55ec8f6c531d36f36195dd8cb5",class:"form-group"},o("label",{key:"4752cfae5f5584e37d258bafce1da8169b72027c",class:"form-label"},o("span",{key:"d48f17fe4de363a55e3c33744daa11700f715a23",class:"required"},"*"),"Correo electrónico:"),o("input",{key:"735ac9a4774e60a49bf8f697307254175045bdba",type:"email",class:{"form-input":true,error:this.touched.email&&!!this.formErrors.email},value:this.email,onInput:this.handleInputChange("email"),placeholder:"Ingresar Correo electrónico"}),this.touched.email&&this.formErrors.email&&o("span",{key:"33b80978f310afb802bfd6970a4de7aacebce137",class:"error-message"},this.formErrors.email))),o("div",{key:"60795c5c644d4032f0be294dd2a0442ace2ce847",class:"form-group existing-customer"},o("label",{key:"8545bb07e5946b099563e3309f896abe5555d8e3",class:"form-label"},o("span",{key:"133b8ff2339a48aa745b33dc1f6fb554af15920e",class:"required"},"*"),"Cliente existente de Claro PR:"),o("div",{key:"5469554e900b063f4d9f6b04981b2bce6f39ac3c",class:"radio-group horizontal"},o("label",{key:"f7d6687aca7e88c348063114d71f26d868544a51",class:"radio-label"},o("input",{key:"42278570f7941f88f3020447840ee0bc8e1bf7a3",type:"radio",name:"existingCustomer",checked:this.existingCustomer==="yes",onChange:this.handleRadioChange("existingCustomer","yes")}),o("span",{key:"ceaad1ec03f423f5a4a69824f0a51dd8aa7eb1ef",class:"radio-custom"}),o("span",{key:"4ba95da48683351250bd97fab29978828d456035",class:"radio-text"},"Sí")),o("label",{key:"270fa045386f0df39680e6e64480cdbe59818ab7",class:"radio-label"},o("input",{key:"d0667ace3221016a304af893bac31d120ab0e0c5",type:"radio",name:"existingCustomer",checked:this.existingCustomer==="no",onChange:this.handleRadioChange("existingCustomer","no")}),o("span",{key:"afaee58bb1e820aa109a05b2681e291ee2c4e3d8",class:"radio-custom"}),o("span",{key:"e4310b9b40f4736635316e4a99b69cb607980e31",class:"radio-text"},"No"))),this.touched.existingCustomer&&this.formErrors.existingCustomer&&o("span",{key:"ca5c224511a1e8788d07a5434f2ffab43da830d5",class:"error-message"},this.formErrors.existingCustomer)),o("div",{key:"c58c51d0ea1ff520b17e4e549b32ad8cc7702b1e",class:"btn-container"},o("button",{key:"1344359cc5b9fb127f6b8aa77b4af132b88f06ee",class:{"btn-submit":true,loading:this.isLoading},onClick:this.handleSubmit,disabled:this.isLoading},this.isLoading?o("span",{class:"btn-loading"},o("span",{class:"spinner"}),"Procesando..."):"Continuar")))))}};He.style=Ve();const Ye=()=>`@keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes slideUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}@keyframes spin{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}:host{display:block;width:100%}.ui-carousel{position:relative;width:100%;display:flex;align-items:center}.ui-carousel__viewport{flex:1;overflow:hidden;margin:0 0.5rem}@media (min-width: 768px){.ui-carousel__viewport{margin:0 1rem}}.ui-carousel__track{display:flex;transition:transform 0.3s ease-out;will-change:transform}.ui-carousel__track--dragging{transition:none;cursor:grabbing}.ui-carousel__nav{flex-shrink:0;width:40px;height:40px;border-radius:50%;background:#FFFFFF;border:2px solid #DA291C;color:#DA291C;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all 0.2s ease;z-index:2;box-shadow:0 2px 8px rgba(0, 0, 0, 0.1)}.ui-carousel__nav svg{width:20px;height:20px}.ui-carousel__nav:hover:not(:disabled){background:#DA291C;color:#FFFFFF}.ui-carousel__nav:active:not(:disabled){transform:scale(0.95)}.ui-carousel__nav--disabled{opacity:0.3;cursor:not-allowed;pointer-events:none}@media (max-width: 599px){.ui-carousel__nav{width:32px;height:32px}.ui-carousel__nav svg{width:16px;height:16px}}.ui-carousel__pagination{position:absolute;bottom:-2rem;left:50%;transform:translateX(-50%);display:flex;gap:0.5rem;z-index:2}.ui-carousel__dot{width:10px;height:10px;border-radius:50%;border:none;background:#CCCCCC;cursor:pointer;padding:0;transition:all 0.2s ease}.ui-carousel__dot:hover{background:#999999}.ui-carousel__dot--active{background:#DA291C;transform:scale(1.2)}::slotted(*){box-sizing:border-box}`;const We=class{constructor(e){a(this,e)}get el(){return n(this)}totalItems=0;slidesPerView=1;gap=16;showNavigation=true;showPagination=true;loop=false;autoplay=0;breakpoints=[{minWidth:0,slidesPerView:1},{minWidth:600,slidesPerView:2},{minWidth:900,slidesPerView:3},{minWidth:1200,slidesPerView:4}];currentIndex=0;currentSlidesPerView=1;isDragging=false;startX=0;translateX=0;trackEl;autoplayInterval;resizeObserver;handleTotalItemsChange(){this.currentIndex=0;this.updateTranslate()}componentDidLoad(){this.updateSlidesPerView();this.setupResizeObserver();this.startAutoplay()}disconnectedCallback(){this.stopAutoplay();if(this.resizeObserver){this.resizeObserver.disconnect()}}setupResizeObserver(){this.resizeObserver=new ResizeObserver((()=>{this.updateSlidesPerView()}));this.resizeObserver.observe(this.el)}updateSlidesPerView(){const e=this.el.offsetWidth;let t=this.slidesPerView;for(const a of this.breakpoints){if(e>=a.minWidth){t=a.slidesPerView}}this.currentSlidesPerView=t;const a=this.getMaxIndex();if(this.currentIndex>a){this.currentIndex=a}this.updateTranslate()}getMaxIndex(){return Math.max(0,this.totalItems-this.currentSlidesPerView)}goToSlide(e){const t=this.getMaxIndex();if(this.loop){if(e<0){e=t}else if(e>t){e=0}}else{e=Math.max(0,Math.min(e,t))}this.currentIndex=e;this.updateTranslate()}goToPrev=()=>{this.goToSlide(this.currentIndex-1)};goToNext=()=>{this.goToSlide(this.currentIndex+1)};updateTranslate(){if(!this.trackEl)return;const e=100/this.currentSlidesPerView;this.translateX=-(this.currentIndex*e)}startAutoplay(){if(this.autoplay>0){this.autoplayInterval=setInterval((()=>{this.goToNext()}),this.autoplay)}}stopAutoplay(){if(this.autoplayInterval){clearInterval(this.autoplayInterval)}}handleTouchStart=e=>{this.isDragging=true;this.startX=e.touches[0].clientX;this.stopAutoplay()};handleTouchMove=e=>{if(!this.isDragging)return;const t=e.touches[0].clientX;const a=t-this.startX;const r=this.el.offsetWidth/this.currentSlidesPerView;const o=a/r*(100/this.currentSlidesPerView);const i=-(this.currentIndex*(100/this.currentSlidesPerView));this.translateX=i+o};handleTouchEnd=e=>{if(!this.isDragging)return;this.isDragging=false;const t=e.changedTouches[0].clientX;const a=t-this.startX;if(Math.abs(a)>50){if(a>0){this.goToPrev()}else{this.goToNext()}}else{this.updateTranslate()}this.startAutoplay()};getPaginationDots(){const e=Math.ceil(this.totalItems/this.currentSlidesPerView);return Array.from({length:e},((e,t)=>t))}handleDotClick=e=>{this.goToSlide(e*this.currentSlidesPerView)};getCurrentDot(){return Math.floor(this.currentIndex/this.currentSlidesPerView)}render(){const e=this.loop||this.currentIndex>0;const t=this.loop||this.currentIndex<this.getMaxIndex();const a=100/this.currentSlidesPerView;return o(i,{key:"1d71ded8170a2004929ada8d1401d18fbe5dcc0c"},o("div",{key:"01d088bfc7590419709aa83850462f6b1fa6374c",class:"ui-carousel"},this.showNavigation&&o("button",{key:"a820df5e62634206f0d9f46092f84f84a724eb23",class:{"ui-carousel__nav":true,"ui-carousel__nav--prev":true,"ui-carousel__nav--disabled":!e},onClick:this.goToPrev,disabled:!e,"aria-label":"Anterior"},o("svg",{key:"7ee40aa5fa9fd0c8ac38583ebeaf0c15b8b4c49e",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},o("polyline",{key:"882e3d293306f869bd4d8db82a1c0a8720d83d69",points:"15 18 9 12 15 6"}))),o("div",{key:"0bc0eef0e943585d9877ae832a33bac4813c33c1",class:"ui-carousel__viewport"},o("div",{key:"8ce97b79d901f63c3e6da2e750926857d2dddbc9",class:{"ui-carousel__track":true,"ui-carousel__track--dragging":this.isDragging},ref:e=>this.trackEl=e,style:{transform:`translateX(${this.translateX}%)`,gap:`${this.gap}px`},onTouchStart:this.handleTouchStart,onTouchMove:this.handleTouchMove,onTouchEnd:this.handleTouchEnd},o("slot",{key:"bab876ce6a274ce53c476444694cef4e94bf39ad"}))),this.showNavigation&&o("button",{key:"286f8e40d9092b5d837566977e252c36e9fee843",class:{"ui-carousel__nav":true,"ui-carousel__nav--next":true,"ui-carousel__nav--disabled":!t},onClick:this.goToNext,disabled:!t,"aria-label":"Siguiente"},o("svg",{key:"28eabda805720b3bb8c540b4126c000db8ff7433",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},o("polyline",{key:"ad5d5d53067b22fe760c4e6499f027ac61105154",points:"9 18 15 12 9 6"}))),this.showPagination&&this.totalItems>this.currentSlidesPerView&&o("div",{key:"aab818d63c57cea9cfe25a91bb768f8be490cef5",class:"ui-carousel__pagination"},this.getPaginationDots().map((e=>o("button",{class:{"ui-carousel__dot":true,"ui-carousel__dot--active":e===this.getCurrentDot()},onClick:()=>this.handleDotClick(e),"aria-label":`Ir a página ${e+1}`}))))),o("style",{key:"927be72b1c508b1add09174d6402b4dfc5f1aece"},`\n            ::slotted(*) {\n              flex: 0 0 calc(${a}% - ${this.gap*(this.currentSlidesPerView-1)/this.currentSlidesPerView}px);\n              max-width: calc(${a}% - ${this.gap*(this.currentSlidesPerView-1)/this.currentSlidesPerView}px);\n            }\n          `))}static get watchers(){return{totalItems:["handleTotalItemsChange"]}}};We.style=Ye();const Xe=()=>`:host{display:block;width:100%}.ui-image-carousel{position:relative;width:100%}.ui-image-carousel__main{position:relative;width:100%;aspect-ratio:1;background:#F5F5F5;border-radius:0.75rem;overflow:hidden;display:flex;align-items:center;justify-content:center}.ui-image-carousel__track{display:flex;width:100%;height:100%;transition:transform 0.4s ease-out;will-change:transform}.ui-image-carousel__slide{flex:0 0 100%;width:100%;height:100%;display:flex;align-items:center;justify-content:center;padding:1rem;box-sizing:border-box}.ui-image-carousel__image{max-width:100%;max-height:100%;object-fit:contain;opacity:0;transition:opacity 0.3s ease}.ui-image-carousel__image--loaded{opacity:1}.ui-image-carousel__nav{position:absolute;top:50%;transform:translateY(-50%);z-index:10;width:40px;height:40px;border-radius:50%;background:rgba(255, 255, 255, 0.95);border:1px solid #E5E5E5;color:#808080;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all 0.2s ease;box-shadow:0 2px 8px rgba(0, 0, 0, 0.1)}.ui-image-carousel__nav svg{width:20px;height:20px}.ui-image-carousel__nav:hover:not(:disabled){background:#DA291C;border-color:#DA291C;color:white;box-shadow:0 4px 12px rgba(218, 41, 28, 0.3)}.ui-image-carousel__nav:active:not(:disabled){transform:translateY(-50%) scale(0.95)}.ui-image-carousel__nav--prev{left:0.5rem}.ui-image-carousel__nav--next{right:0.5rem}.ui-image-carousel__nav--disabled{opacity:0.3;cursor:not-allowed;pointer-events:none}@media (max-width: 599px){.ui-image-carousel__nav{width:32px;height:32px}.ui-image-carousel__nav svg{width:16px;height:16px}}.ui-image-carousel__indicators{display:flex;justify-content:center;gap:0.5rem;margin-top:0.75rem}.ui-image-carousel__dot{width:8px;height:8px;border-radius:50%;border:none;background:#CCCCCC;cursor:pointer;padding:0;transition:all 0.2s ease}.ui-image-carousel__dot:hover{background:#999999}.ui-image-carousel__dot--active{background:#DA291C;width:24px;border-radius:4px}.ui-image-carousel__thumbnails{display:flex;justify-content:center;gap:0.5rem;margin-top:0.75rem;padding:0 0.5rem;overflow-x:auto}.ui-image-carousel__thumbnails::-webkit-scrollbar{display:none}.ui-image-carousel__thumbnails{-ms-overflow-style:none;scrollbar-width:none}.ui-image-carousel__thumbnail{flex-shrink:0;width:60px;height:60px;border-radius:0.5rem;border:2px solid #E5E5E5;background:#F5F5F5;cursor:pointer;padding:4px;overflow:hidden;transition:all 0.2s ease}.ui-image-carousel__thumbnail img{width:100%;height:100%;object-fit:contain}.ui-image-carousel__thumbnail:hover{border-color:#0097A9}.ui-image-carousel__thumbnail--active{border-color:#DA291C;box-shadow:0 0 0 2px rgba(218, 41, 28, 0.2)}@media (max-width: 599px){.ui-image-carousel__thumbnail{width:48px;height:48px}}.ui-image-carousel__placeholder{display:flex;flex-direction:column;align-items:center;justify-content:center;width:100%;aspect-ratio:1;background:#F5F5F5;border-radius:0.75rem;color:#999999}.ui-image-carousel__placeholder svg{width:64px;height:64px;margin-bottom:0.5rem}.ui-image-carousel__placeholder span{font-size:0.875rem}`;const Ke=class{constructor(e){a(this,e)}images=[];loop=true;showNavigation=true;showIndicators=true;autoplayInterval=0;fallbackImage="";currentIndex=0;loadedImages=new Set;failedImages=new Set;autoplayTimer;touchStartX=0;touchEndX=0;onImagesChange(){this.currentIndex=0;this.loadedImages=new Set;this.failedImages=new Set;this.restartAutoplay()}componentDidLoad(){this.startAutoplay()}disconnectedCallback(){this.stopAutoplay()}startAutoplay(){if(this.autoplayInterval>0&&this.images.length>1){this.autoplayTimer=setInterval((()=>{this.goToNext()}),this.autoplayInterval)}}stopAutoplay(){if(this.autoplayTimer){clearInterval(this.autoplayTimer);this.autoplayTimer=null}}restartAutoplay(){this.stopAutoplay();this.startAutoplay()}goToSlide=e=>{const t=this.images.length;if(t===0)return;if(this.loop){if(e<0){e=t-1}else if(e>=t){e=0}}else{e=Math.max(0,Math.min(e,t-1))}this.currentIndex=e;this.restartAutoplay()};goToPrev=()=>{this.goToSlide(this.currentIndex-1)};goToNext=()=>{this.goToSlide(this.currentIndex+1)};handleTouchStart=e=>{this.touchStartX=e.touches[0].clientX;this.stopAutoplay()};handleTouchEnd=e=>{this.touchEndX=e.changedTouches[0].clientX;this.handleSwipe();this.startAutoplay()};handleSwipe(){const e=this.touchStartX-this.touchEndX;const t=50;if(Math.abs(e)>t){if(e>0){this.goToNext()}else{this.goToPrev()}}}handleImageLoad=e=>{this.loadedImages=new Set([...this.loadedImages,e])};handleImageError=(e,t)=>{this.failedImages=new Set([...this.failedImages,e]);if(this.fallbackImage){const e=t.target;e.src=this.fallbackImage}};getImageSrc(e){const t=this.images[e];if(!t&&this.fallbackImage){return this.fallbackImage}return t||""}render(){const e=this.images.length;const t=e>1;const a=this.loop||this.currentIndex>0;const r=this.loop||this.currentIndex<e-1;if(e===0){return o(i,null,o("div",{class:"ui-image-carousel"},o("div",{class:"ui-image-carousel__placeholder"},o("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},o("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),o("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),o("polyline",{points:"21 15 16 10 5 21"})),o("span",null,"Sin imagen"))))}return o(i,null,o("div",{class:"ui-image-carousel"},o("div",{class:"ui-image-carousel__main",onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd},this.showNavigation&&t&&o("button",{class:{"ui-image-carousel__nav":true,"ui-image-carousel__nav--prev":true,"ui-image-carousel__nav--disabled":!a},onClick:this.goToPrev,disabled:!a,"aria-label":"Imagen anterior"},o("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},o("polyline",{points:"15 18 9 12 15 6"}))),o("div",{class:"ui-image-carousel__track",style:{transform:`translateX(-${this.currentIndex*100}%)`}},this.images.map(((e,t)=>o("div",{class:"ui-image-carousel__slide"},o("img",{src:this.getImageSrc(t),alt:`Imagen ${t+1}`,class:{"ui-image-carousel__image":true,"ui-image-carousel__image--loaded":this.loadedImages.has(t)},onLoad:()=>this.handleImageLoad(t),onError:e=>this.handleImageError(t,e),loading:t===0?"eager":"lazy"}))))),this.showNavigation&&t&&o("button",{class:{"ui-image-carousel__nav":true,"ui-image-carousel__nav--next":true,"ui-image-carousel__nav--disabled":!r},onClick:this.goToNext,disabled:!r,"aria-label":"Imagen siguiente"},o("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},o("polyline",{points:"9 18 15 12 9 6"})))),this.showIndicators&&t&&o("div",{class:"ui-image-carousel__indicators"},this.images.map(((e,t)=>o("button",{class:{"ui-image-carousel__dot":true,"ui-image-carousel__dot--active":t===this.currentIndex},onClick:()=>this.goToSlide(t),"aria-label":`Ir a imagen ${t+1}`})))),t&&o("div",{class:"ui-image-carousel__thumbnails"},this.images.map(((e,t)=>o("button",{class:{"ui-image-carousel__thumbnail":true,"ui-image-carousel__thumbnail--active":t===this.currentIndex},onClick:()=>this.goToSlide(t)},o("img",{src:e||this.fallbackImage,alt:`Miniatura ${t+1}`,loading:"lazy"})))))))}static get watchers(){return{images:["onImagesChange"]}}};Ke.style=Xe();export{le as fixed_service_flow,pe as step_catalogue,fe as step_confirmation,_e as step_contract,Oe as step_form,Le as step_location,Be as step_order_summary,Ue as step_payment,$e as step_plans,Ge as step_product_detail,He as step_shipping,We as ui_carousel,Ke as ui_image_carousel};
//# sourceMappingURL=p-638bd3ff.entry.js.map