{"version":3,"file":"step-payment.js","sourceRoot":"","sources":["../../../../src/components/steps/step-payment/step-payment.tsx"],"names":[],"mappings":"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","sourcesContent":["// ============================================\n// STEP PAYMENT - Payment Processing\n// Fixed Service Flow Web Component\n// Design based on TEL payment-web.component\n// ============================================\n\nimport { Component, Prop, State, h, Host, Element } from '@stencil/core';\nimport { paymentService, PaymentItem, PaymentResult } from '../../../services/payment.service';\nimport { cartService } from '../../../services/cart.service';\nimport { shippingService } from '../../../services/shipping.service';\nimport { CartResponse } from '../../../store/interfaces';\n\ntype PaymentScreen = 'loading' | 'creating-order' | 'payment' | 'processing' | 'error' | 'success';\n\n@Component({\n  tag: 'step-payment',\n  styleUrl: 'step-payment.scss',\n  shadow: true,\n})\nexport class StepPayment {\n  @Element() el: HTMLElement;\n\n  // ------------------------------------------\n  // PROPS\n  // ------------------------------------------\n\n  @Prop() onNext: () => void;\n  @Prop() onBack: () => void;\n\n  // Optional: External payment iframe URL\n  @Prop() paymentIframeUrl?: string;\n\n  // ------------------------------------------\n  // STATE\n  // ------------------------------------------\n\n  @State() screen: PaymentScreen = 'loading';\n  @State() error: string | null = null;\n  @State() cart: CartResponse | null = null;\n  @State() orderBan: string = '';\n  @State() totalAmount: number = 0;\n  @State() paymentItems: PaymentItem[] = [];\n  @State() iframeUrl: string = '';\n  @State() iframeHeight: string = '500px';\n  @State() paymentResult: PaymentResult | null = null;\n\n  // User info for payment\n  private userName: string = '';\n  private userLastName: string = '';\n  private userEmail: string = '';\n\n  // ------------------------------------------\n  // LIFECYCLE\n  // ------------------------------------------\n\n  componentWillLoad() {\n    this.loadCartAndPreparePayment();\n  }\n\n  componentDidLoad() {\n    // Listen for payment iframe messages\n    window.addEventListener('message', this.handleIframeMessage);\n  }\n\n  disconnectedCallback() {\n    window.removeEventListener('message', this.handleIframeMessage);\n  }\n\n  // ------------------------------------------\n  // METHODS\n  // ------------------------------------------\n\n  private async loadCartAndPreparePayment() {\n    this.screen = 'loading';\n    this.error = null;\n\n    try {\n      // Get cart data\n      const cartResponse = await cartService.getCart();\n\n      if (cartResponse.hasError) {\n        this.error = cartResponse.message || 'Error al cargar el carrito';\n        this.screen = 'error';\n        return;\n      }\n\n      if (!cartResponse.products || cartResponse.products.length === 0) {\n        this.error = 'El carrito está vacío';\n        this.screen = 'error';\n        return;\n      }\n\n      this.cart = cartResponse;\n\n      // Build payment items\n      this.paymentItems = paymentService.buildPaymentItems({\n        depositAmount: cartResponse.depositAmount,\n        totalDownPayment: cartResponse.totalDownPayment,\n        totalTax: cartResponse.totalTax,\n        totalPrice: cartResponse.totalPrice,\n        installmentAmount: cartResponse.installmentAmount,\n        cartUpdateResponse: cartResponse.cartUpdateResponse,\n      });\n\n      // Calculate total\n      this.totalAmount = this.paymentItems.length > 0\n        ? paymentService.calculateTotalAmount(this.paymentItems)\n        : cartResponse.totalPrice || 0;\n\n      // Get user info from shipping\n      const shippingAddress = shippingService.getStoredShippingAddress();\n      if (shippingAddress) {\n        const nameParts = shippingAddress.name.split(' ');\n        this.userName = nameParts[0] || '';\n        this.userLastName = nameParts.slice(1).join(' ') || '';\n        this.userEmail = shippingAddress.email;\n      }\n\n      // Create the order\n      await this.createOrder();\n\n    } catch (err) {\n      console.error('[StepPayment] Error:', err);\n      this.error = 'Error de conexión';\n      this.screen = 'error';\n    }\n  }\n\n  private async createOrder() {\n    this.screen = 'creating-order';\n\n    try {\n      const zipCode = shippingService.getZipCode();\n\n      const response = await paymentService.createOrder({\n        flowId: '5', // CLARO HOGAR flow\n        frontFlowId: '1',\n        frontFlowName: 'CLARO HOGAR Purchase',\n        amount: this.totalAmount.toString(),\n        email: this.userEmail,\n        zipCode: zipCode,\n        deposit: (this.cart?.totalDownPayment || 0).toString(),\n      });\n\n      if (response.hasError) {\n        this.error = response.errorDisplay || response.message || 'Error al crear la orden';\n        this.screen = 'error';\n        return;\n      }\n\n      this.orderBan = response.ban || '';\n\n      // Now get the payment iframe\n      await this.initializePaymentIframe();\n\n    } catch (err) {\n      console.error('[StepPayment] Create order error:', err);\n      this.error = 'Error al crear la orden';\n      this.screen = 'error';\n    }\n  }\n\n  private async initializePaymentIframe() {\n    if (this.totalAmount <= 0) {\n      // Free purchase - no payment needed\n      await this.handleFreePayment();\n      return;\n    }\n\n    try {\n      const iframeRequest = {\n        firstName: this.userName,\n        lastName: this.userLastName,\n        email: this.userEmail,\n        amount: this.totalAmount,\n        transactionType: this.paymentItems.length > 0 ? 'MULTIPLE' : 'payment',\n        selectBan: this.orderBan,\n        permissions: {\n          provision: true,\n          displayConfirmation: true,\n          emailNotification: true,\n          showInstrument: true,\n          stroeInstrument: true,\n          useBanZipCode: true,\n        },\n        paymentItems: this.paymentItems.length > 0 ? this.paymentItems : undefined,\n      };\n\n      const response = await paymentService.getPaymentIframe(iframeRequest);\n\n      if (response.errorInfo?.hasError || !response.url) {\n        this.error = response.errorInfo?.errorDisplay || 'Error al inicializar el pago';\n        this.screen = 'error';\n        return;\n      }\n\n      this.iframeUrl = response.url;\n      this.screen = 'payment';\n\n    } catch (err) {\n      console.error('[StepPayment] Init iframe error:', err);\n      this.error = 'Error al inicializar el formulario de pago';\n      this.screen = 'error';\n    }\n  }\n\n  private handleIframeMessage = (event: MessageEvent) => {\n    if (typeof event.data !== 'string') return;\n\n    try {\n      const data = JSON.parse(atob(event.data));\n\n      if (data.state === 'dimensions') {\n        this.iframeHeight = data.data.height;\n      }\n\n      if (data.state === 'canceled') {\n        this.handlePaymentCancel();\n      }\n\n      if (data.state === 'paymentResult') {\n        if (data.data) {\n          const resultString = data.data;\n          const result = JSON.parse(resultString).paymentResult;\n          const paymentResult = JSON.parse(atob(result)) as PaymentResult;\n\n          if (paymentResult.success) {\n            this.handlePaymentSuccess(paymentResult);\n          } else {\n            this.handlePaymentError(paymentResult);\n          }\n        }\n      }\n    } catch {\n      // Ignore non-payment messages\n    }\n  };\n\n  private async handlePaymentSuccess(result: PaymentResult) {\n    this.screen = 'processing';\n    this.paymentResult = result;\n\n    try {\n      const recordResponse = await paymentService.recordPayment({\n        ban: this.orderBan,\n        cardNumber: result.paymentCard || '',\n        cardType: result.paymentMethod || '',\n        authorizationNumber: result.authorizationNumber || '',\n        referenceNumber: result.provisioning?.referenceNumber || '',\n        description: result.description || '',\n        operationId: result.operationId || '',\n        amount: this.totalAmount.toString(),\n        deposit: (this.cart?.totalDownPayment || 0).toString(),\n      });\n\n      if (recordResponse.hasError) {\n        this.error = recordResponse.errorDisplay || 'Error al registrar el pago';\n        this.screen = 'error';\n        return;\n      }\n\n      // Store payment result and proceed\n      paymentService.storePaymentResult(result);\n      this.screen = 'success';\n\n      // Auto-proceed after short delay\n      setTimeout(() => {\n        this.onNext?.();\n      }, 2000);\n\n    } catch (err) {\n      console.error('[StepPayment] Record payment error:', err);\n      this.error = 'Error al registrar el pago';\n      this.screen = 'error';\n    }\n  }\n\n  private async handlePaymentError(result: PaymentResult) {\n    await paymentService.recordPaymentError(\n      this.orderBan,\n      '',\n      result.description || 'Payment failed',\n      result.operationId || '',\n      (this.cart?.totalDownPayment || 0).toString(),\n      result.paymentMethod || '',\n      result.paymentCard || '',\n      this.totalAmount.toString()\n    );\n\n    this.error = result.description || 'El pago no pudo ser procesado';\n    this.screen = 'error';\n  }\n\n  private handlePaymentCancel() {\n    this.onBack?.();\n  }\n\n  private async handleFreePayment() {\n    this.screen = 'processing';\n\n    try {\n      const operationId = Math.floor(Math.random() * 900000 + 100000).toString();\n\n      const recordResponse = await paymentService.recordPayment({\n        ban: this.orderBan,\n        cardNumber: '1111',\n        cardType: 'V',\n        authorizationNumber: 'FREEPR',\n        referenceNumber: 'FREEPROMO',\n        description: 'Free promotion',\n        operationId: operationId,\n        amount: '0',\n        deposit: '0',\n      });\n\n      if (recordResponse.hasError) {\n        this.error = recordResponse.errorDisplay || 'Error al procesar';\n        this.screen = 'error';\n        return;\n      }\n\n      this.screen = 'success';\n      setTimeout(() => {\n        this.onNext?.();\n      }, 2000);\n\n    } catch (err) {\n      console.error('[StepPayment] Free payment error:', err);\n      this.error = 'Error al procesar';\n      this.screen = 'error';\n    }\n  }\n\n  private handleRetry = () => {\n    this.loadCartAndPreparePayment();\n  };\n\n  private formatPrice(price: number): string {\n    return `$${(price || 0).toFixed(2)}`;\n  }\n\n  // ------------------------------------------\n  // RENDER\n  // ------------------------------------------\n\n  private renderLoading() {\n    return (\n      <div class=\"loading-container\">\n        <div class=\"spinner\"></div>\n        <p>Cargando información del pago...</p>\n      </div>\n    );\n  }\n\n  private renderCreatingOrder() {\n    return (\n      <div class=\"loading-container\">\n        <div class=\"spinner\"></div>\n        <h3>Preparando tu orden</h3>\n        <p>Por favor espera mientras procesamos tu solicitud...</p>\n        <p class=\"warning\">No cierres esta ventana ni navegues a otra página.</p>\n      </div>\n    );\n  }\n\n  private renderPaymentForm() {\n    return (\n      <div class=\"payment-container\">\n        <div class=\"payment-summary\">\n          <h3>Resumen del pago</h3>\n          <div class=\"amount-display\">\n            <span class=\"label\">Total a pagar:</span>\n            <span class=\"value\">{this.formatPrice(this.totalAmount)}</span>\n          </div>\n          {this.paymentItems.length > 0 && (\n            <div class=\"payment-items\">\n              {this.paymentItems.map((item) => (\n                <div class=\"payment-item\">\n                  <span class=\"item-type\">{this.getPaymentTypeLabel(item.paymentType)}</span>\n                  <span class=\"item-amount\">{this.formatPrice(item.amount)}</span>\n                </div>\n              ))}\n            </div>\n          )}\n        </div>\n\n        <div class=\"iframe-container\">\n          {this.iframeUrl ? (\n            <iframe\n              src={this.iframeUrl}\n              width=\"100%\"\n              height={this.iframeHeight}\n              frameBorder=\"0\"\n              title=\"Payment Form\"\n            ></iframe>\n          ) : (\n            <div class=\"iframe-placeholder\">\n              <div class=\"spinner\"></div>\n              <p>Cargando formulario de pago...</p>\n            </div>\n          )}\n        </div>\n\n        <button class=\"btn-cancel\" onClick={() => this.handlePaymentCancel()}>\n          Cancelar\n        </button>\n      </div>\n    );\n  }\n\n  private renderProcessing() {\n    return (\n      <div class=\"loading-container\">\n        <div class=\"spinner\"></div>\n        <h3>Procesando pago</h3>\n        <p>Por favor espera mientras confirmamos tu pago...</p>\n      </div>\n    );\n  }\n\n  private renderSuccess() {\n    return (\n      <div class=\"success-container\">\n        <div class=\"success-icon\">\n          <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n            <path d=\"M22 11.08V12a10 10 0 1 1-5.93-9.14\"></path>\n            <polyline points=\"22 4 12 14.01 9 11.01\"></polyline>\n          </svg>\n        </div>\n        <h3>Pago exitoso</h3>\n        <p>Tu pago ha sido procesado correctamente.</p>\n        <p class=\"redirect-note\">Redirigiendo a la confirmación...</p>\n      </div>\n    );\n  }\n\n  private renderError() {\n    return (\n      <div class=\"error-container\">\n        <div class=\"error-icon\">\n          <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n            <circle cx=\"12\" cy=\"12\" r=\"10\"></circle>\n            <line x1=\"15\" y1=\"9\" x2=\"9\" y2=\"15\"></line>\n            <line x1=\"9\" y1=\"9\" x2=\"15\" y2=\"15\"></line>\n          </svg>\n        </div>\n        <h3>Error en el pago</h3>\n        <p>{this.error}</p>\n        <div class=\"error-actions\">\n          <button class=\"btn-retry\" onClick={this.handleRetry}>\n            Intentar nuevamente\n          </button>\n          <button class=\"btn-back\" onClick={() => this.onBack?.()}>\n            Volver\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  private getPaymentTypeLabel(type: string): string {\n    const labels: Record<string, string> = {\n      DEPOSIT: 'Depósito',\n      DOWNPAYMENT: 'Pago inicial',\n      TAXES: 'Impuestos',\n      INSTALLMENT: 'Cuotas',\n      PASTDUEONLY: 'Balance pendiente',\n    };\n    return labels[type] || type;\n  }\n\n  render() {\n    return (\n      <Host>\n        <div class=\"step-payment\">\n          {/* Header */}\n          <div class=\"header\">\n            {this.screen !== 'processing' && this.screen !== 'success' && (\n              <button class=\"btn-back-nav\" onClick={() => this.onBack?.()}>\n                <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n                  <path d=\"M19 12H5M12 19l-7-7 7-7\"></path>\n                </svg>\n                Regresar\n              </button>\n            )}\n            <h1 class=\"title\">Pago</h1>\n          </div>\n\n          {/* Content based on screen */}\n          <div class=\"content\">\n            {this.screen === 'loading' && this.renderLoading()}\n            {this.screen === 'creating-order' && this.renderCreatingOrder()}\n            {this.screen === 'payment' && this.renderPaymentForm()}\n            {this.screen === 'processing' && this.renderProcessing()}\n            {this.screen === 'success' && this.renderSuccess()}\n            {this.screen === 'error' && this.renderError()}\n          </div>\n        </div>\n      </Host>\n    );\n  }\n}\n"]}